\section{Coils }\label{coils}

\subsection{Chilled-Water-Based Air Cooling Coil}\label{chilled-water-based-air-cooling-coil}

The input object Coil:Cooling:Water is simpler than the detailed geometry model. The simple model provides a good prediction of the air and water outlet conditions without requiring the detailed geometric input required for the detailed model. A greatly simplified schematic of enthalpy and temperature conditions in a counter flow cooling/dehumidifying coil is shown in the schematic Figure~\ref{fig:simplified-schematic-of-coolingdehumidifying}. The input required to model the coil includes only a set of thermodynamic design inputs, which require no specific manufacturer's data. The coil simulation model is essentially a modification of one presented by Elmahdy and Mitalas (1977), TRNSYS, 1990 and Threlkeld, J.L. 1970. The model calculates the UA values required for a Dry, Wet and Part Wet \& Part Dry Coil and iterates between the Dry and Wet Coil to output the fraction wet. There are two modes of flow operation for this model: CrossFlow or CounterFlow. The default mode is CounterFlow. In addition the coil has two modes of analysis: Simple Analysis and Detailed Analysis. The Simple analysis mode operates the coil as either wet or dry while the detailed mode simulates the coil as part wet part-dry. While the detailed mode provides more accurate results, it is significantly slower than the simple model. The simple mode gives good results for an annual simulation but will not be adequate for a time step performance analysis.

\begin{figure}[hbtp] % fig 162
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image3304.svg.png}
\caption{  Simplified Schematic of Cooling/Dehumidifying Coil \protect \label{fig:simplified-schematic-of-coolingdehumidifying}}
\end{figure}

\subsubsection{Heat Transfer and Energy Balance}\label{heat-transfer-and-energy-balance}

The cooling coil may be completely dry, completely wet with condensation, or it may have wet and dry sections.~ The actual condition of the coil surface depends on the humidity and temperature of the air passing over the coil and the coil surface temperature.~ The part-dry part-wet case represents the most general scenario for the coil surface conditions.~ There are subroutines present in the model for both the dry and wet regions of the coil, and a subroutine that iterates between the dry and wet subroutines to calculate the fraction of the coil surface that is wet.~ For each region the heat transfer rate from air to water may be defined by the rate of enthalpy change in the air and in the water.~ The rates must balance between each medium for energy to be conserved.

\subsubsection{Model Description}\label{model-description-007}

The Model has two blocks: 1\(^{st}\) = Design Block with the Design Inputs. This block calculates the Design U-Factor Times Area Value (UA) values required by the model. Using these UA values the model simulates the operating conditions.~ The operating block is the one containing the operating conditions, the conditions at which the coil operates. Following is the list of Design and Operating inputs and subsequently the Design and Operating variables used in the model.

% table 52
\begin{longtable}[c]{p{1.79in}p{4.2in}}
\caption{Design Inputs (User Inputs) \label{table:design-inputs-user-inputs}} \tabularnewline
\toprule 
Input Field & Description \tabularnewline
\midrule
\endfirsthead

\caption[]{Design Inputs (User Inputs)} \tabularnewline
\toprule 
Input Field & Description \tabularnewline
\midrule
\endhead

DesWaterVolFlowRate & Maximum Water Volume Flow Rate \tabularnewline
DesAirVolFlowRate & Maximum Air Volume Flow Rate \tabularnewline
DesInletWaterTemp & Inlet Water Temperature at Design Condition \tabularnewline
DesInletAirTemp & Inlet Air Temperature at Design Condition \tabularnewline
DesOutletAirTemp & Outlet Air Temperature at Design Condition \tabularnewline
DesInletAirHumRat & Inlet Air Humidity Ratio at Design Conditions \tabularnewline
DesOutletAirHumRat & Outlet Air Humidity Ratio at Design Conditions \tabularnewline
\bottomrule
\end{longtable}

% table 53
\begin{longtable}[c]{p{1.84in}p{4.16in}}
\caption{Operating Conditions (From Nodes -- not user inputs) \label{table:operating-conditions-from-nodes-not-user}} \tabularnewline
\toprule 
Condition Variable & Description \tabularnewline
\midrule
\endfirsthead

\caption[]{Operating Conditions (From Nodes -- not user inputs)} \tabularnewline
\toprule 
Condition Variable & Description \tabularnewline
\midrule
\endhead

InletWaterMassFlowRate & Entering Water Mass Flow Rate at operating condition \tabularnewline
InletWaterTemp & Inlet Water Temperature at operating condition \tabularnewline
InletAirMassFlowRate & Entering Air Mass Flow Rate at operating condition \tabularnewline
InletAirTemp & Inlet Air Temperature at operating condition \tabularnewline
InletAirHumRat & Entering air humidity ratio at operating conditions \tabularnewline
\bottomrule
\end{longtable}

\subsubsection{Intermediate calculated U-Factor Times Area Values: The Crux of the Model}\label{intermediate-calculated-u-factor-times-area-values-the-crux-of-the-model}

The various U-Factor Times Area values (UA) required by this model are calculated from the above inputs, which are explained later in the document.~ The various UA are:

% table 54
\begin{longtable}[c]{p{1.5in}p{4.5in}}
\caption{UA Descriptions of Model \label{table:ua-descriptions-of-model}} \tabularnewline
\toprule 
UA Variable Name & Description \tabularnewline
\midrule
\endfirsthead

\caption[]{UA Descriptions of Model} \tabularnewline
\toprule 
UA Variable Name & Description \tabularnewline
\midrule
\endhead

CoilUATotal & Overall heat transfer coefficient (W/\(^{\circ}\)C) \tabularnewline
CoilUAInternal & Overall internal UA (W/\(^{\circ}\)C) \tabularnewline
CoilUAExternal & Overall external UA (W/\(^{\circ}\)C) \tabularnewline
CoilUInternal & Internal overall heat transfer coefficient (W/m-\(^{\circ}\)C) \tabularnewline
CoilUWetExternal & Wet part external overall heat transfer coefficient (W/m-\(^{\circ}\)C) \tabularnewline
CoilUDryExternal & Dry part external overall heat transfer coefficient (W/m-\(^{\circ}\)C) \tabularnewline
\bottomrule
\end{longtable}

The UA values are calculated assuming a wet coil at the design conditions. Following are a few important calculations to understand the working of the model.~ The model is basically divided into two blocks: the Design Block and the Operating Block.

The Design Block is a one time calculation. The aim of the Design Block is to calculate the Coil UA for use in the operating Block.

\subsubsection{Design Block Calculations}\label{design-block-calculations}

The design block has the code for calculating the six Coil UA values required by the operating block. Reasonable assumptions have been made in the calculations to maintain the simplicity of the model.

Heat transfer in a wet coil model is based on enthalpy rather than temperature to take into account latent effects. While heat transfer rates are commonly expressed as the product of an overall heat transfer coefficient, UA, and a temperature difference, the use of enthalpy-based heat transfer calculations requires an enthalpy-based heat transfer coefficient which we denote as DesUACoilTotalEnth and hence the equation.

\begin{equation}
Q = DesUACoilTotalEnth * (H_{air,mean} - H_{water,mean})
\end{equation}

The value of Q is calculated using product of air mass flow rate and difference in inlet and outlet air enthalpies at design conditions.

The relation between the enthalpy-based UA and the temperature-based UA is:

\begin{equation}
DesUACoilTotalEnth = CoilUA / C_{p}
\end{equation}

where CoilUA is the conventional heat transfer coefficient and C\(_{p}\) is the specific heat of the air.

We need the following quantities for our design calculations. The \emph{Psy} functions are the EnergyPlus built-in psychrometric functions.

\begin{equation}
{\dot m_{air}} = {\rho_{air}}{\dot V_{air}}
\end{equation}

\begin{equation}
{h_{air,in}} = {\mathop{\rm PsyHFnTdbW}\nolimits} ({T_{air,in}},{w_{air,in}})
\end{equation}

\begin{equation}
{h_{air,out}} = {\mathop{\rm PsyHFnTdbW}\nolimits} ({T_{air,out}},{w_{air,out}})
\end{equation}

\begin{equation}
{h_{w,sat,in}} = {\rm{PsyHFnTdbW}}({T_{w,in}},{\rm{PsyWFnTdpPb}}({T_{w,in}},{P_{atm}}))
\end{equation}

\begin{equation}
{\dot Q_{coil}} = {\dot m_{air}}({h_{air,in}} - {h_{air,out}})
\end{equation}

\begin{equation}
{T_{w,out}} = {T_{w,in}} + {\dot Q_{coil}}/({\dot m_{w,\max }}{C_{p,w}})
\end{equation}

\begin{equation}
{h_{w,sat,out}} = {\rm{PsyHFnTdbW}}({T_{w,out}},{\rm{PsyWFnTdpPb}}({T_{w,out}},{P_{atm}}))
\end{equation}

We now calculate the design coil bypass factor. The bypass factor is not used in subsequent calculations. It is calculated solely to use as check on the reasonableness of the user-input design inlet and outlet conditions. First we make an initial estimate of the apparatus dew point temperature:

\begin{equation}
{T_{air,dp,app}} = {\rm{PsyTdpFnWPb}}({w_{air,out}},{P_{atm}})
\end{equation}

We also need the ``slope'' of temperature versus humidity ratio on the psych chart between the inlet and outlet air conditions:

\begin{equation}
{S_{T,w}} = ({T_{air,in}} - {T_{air,out}})/({w_{air,in}} - {w_{air,out}})
\end{equation}

We now obtain the actual design apparatus dewpoint temperature by iterating over the following two equations:

\begin{equation}
{w_{air,dp,app}} = {\rm{PsyWFnTdpPb}}({T_{air,dp,app}},{P_{atm}})
\end{equation}

\begin{equation}
{T_{air,dp,app}} = {T_{air,in}} - {S_{T,w}}({w_{air,in}} - {w_{air,dp,app}})
\end{equation}

The apparatus dewpoint enthalpy is then:

\begin{equation}
{h_{air,dp,app}} = {\rm{PsyHFnTdbW}}({T_{air,dp,app}},{w_{air,dp,app}})
\end{equation}

and the coil bypass factor is:

\begin{equation}
{F_{coilbypass}} = ({h_{air,out}} - {h_{air,dp,app}})/({h_{air,in}} - {h_{air,dp,app}})
\end{equation}

If the iterative procedure doesn't converge, or the coil bypass factor is too large (greater than 0.5), or the apparatus dewpoint enthalpy is less than the saturated air enthalpy at the water inlet temperature, the design outlet air conditions are reset to 90\% relative humidity at the same outlet enthalpy. The above design calculations are then repeated.

We are now ready to calculate the design coil UA. This will be accomplished by inverting the simple coil calculation routine \emph{CoolingCoil} using the root solver method. First we make an initial estimate of the coil UA.

\begin{equation}
    \Delta {h_{lmd}} = \frac{({h_{air,in}} - {h_{w,sat,out}}) - ({h_{air,out}} - {h_{w,sat,in}})}{log(\frac{{h_{air,in}} - {h_{w,sat,out}}}{{h_{air,out}} - {h_{w,sat,in}}})}
\end{equation}

\begin{equation}
U{A_{coil,enthalpy - based}} = {\dot Q_{coil}}/\Delta {h_{lmd}}
\end{equation}

\begin{equation}
U{A_{coil,ext}} = {C_{p,air}}U{A_{coil,enthalpy - based}}
\end{equation}

We set the internal UA to 3.3 times the external UA (as a typical value for a coil). Then the total UA is:

\begin{equation}
  UA_{coil,tot} = \frac{1}{{(1/U{A_{coil,int}} + 1/U{A_{coil,ext}})}}
\end{equation}

The next step is to estimate the coil external heat transfer surface area. This is done in the function \emph{EstimateHEXSurfaceArea}:

\begin{equation}
Are{a_{coil,ext}} = {\rm{EstimateHEXSurfaceArea}}
\end{equation}

using the following assumptions:

\begin{itemize}
\item
  Tube inside diameter = 0.0122 (m)
\item
  Tube side water velocity = 2.0 (m/s)
\item
  Inside to outside coil surface area ratio (Ai/Ao) = 0.07 (-)
\item
  Fins overall efficiency = 0.92 (-)
\item
  Aluminum fins, 12 fins per inch with fins to total outside surface area ratio of 90\%.
\item
  Airside combined heat and mass transfer coefficient = 140 (W/m\(^2\)-\(^{\circ}\)C)
\end{itemize}

Interior and exterior U values (really UA's per unit exterior surface area) are calculated by dividing the above UA's by the area. The resulting U\(_{coil,ext}\) is assumed to be U\(_{coil,ext,wet}\); U\(_{coil,ext,dry}\) is set equal to U\(_{coil,ext,wet}\). We now have all the starting values needed for inverting the simple coil model using the chosen root solver iterative method. Once the iteration is completed, we have coil UA's and U's that yield the design outlet air and water enthalpies given the inlet design conditions and flow rates. Note that the simple coil model can not exactly match the specified design outlet air temperature and humidity ratio. It can only match the design air outlet enthalpy. Generally the simple coil model will yield outlet conditions near the saturation curve if any dehumidification is occuring. Typical outlet relative humidities are around 95\%.

\subsubsection{Variable UA}\label{variable-ua}

The above calculations yield coil UA's for the design inlet conditions and air and water flow rates. As the flow rates vary during the time step calculations, the UA's need to be adjusted, since coil UA's are a rather strong function of air and water side flow rates. Each time step the coil UA's are modified using the same formulas as are used in the hot water coil model. Refer to that model for the flow dependences.

\subsubsection{Operating Block Calculations:}\label{operating-block-calculations}

There are two modes of coil analysis in the operating block. They are the Simple analysis mode and the detailed analysis mode. The simple analysis mode assumes the coil to be either all wet or either all dry and execute the model , on the other hand the detailed mode checks for part wet part dry mode of operation and reports surface area wet fraction of coil, however the program execution time in detailed mode is noticeably higher.

The operating block for Detailed Mode Analysis of this coil model is divided into three modes of coil performance. The modes being:

\begin{itemize}
  \item
    Coil is completely dry: There is no moisture condensation on the coil surface and the coil is a dry coil. This is an extreme condition when the entering air has very low humidity ratio or is dry air.
  \item
    Coil is completely wet: The entire coil is wet due to complete condensation on the surface of the coil.
  \item
    Part Wet Part Dry Mode: This is the usual/frequent mode of operation of coil where part of the coil at entry of air is dry and as air cools condensation occurs and part of the coil becomes wet.
\end{itemize}

The Part Wet Part Dry Mode of operation is essentially a function the Coil Completely Dry and Coil Completely Wet mode. This subroutine iterates between the Dry Coil and the Wet Coil to give outputs, a detailed explanation is given later in the document. The operating block requires 5 inputs, which are mentioned earlier in the document. These inputs are automatically generated from the node connections in Energy Plus. The user does not have to input any information to run this coil model.

The option to identify which mode of operation the coil should perform ie, for a given set of inputs would the coil be Dry, Wet or Part Wet Part Dry, is decided by set of conditions described below.

\begin{itemize}
  \item
    \textbf{IF} (\textbf{Temperature Dewpoint Air \textless{} Water Inlet Temperature}) \textbf{THEN} the coil is Dry and we call the Subroutine Coil Completely Dry. ~In this case outlet temperature of air would be higher than the air dewpoint and hence there would be no condensation.
  \item
    \textbf{IF} (\textbf{Temperature Dewpoint Air \textgreater{} Water Inlet Temperature}) \textbf{THEN} the coil is completely wet, call subroutine Coil Completely Wet, it is assumed that moisture condensation occurs over completely surface of the coil. However we go ahead and check for the coil being partially wet with the following condition.
  \item
    \textbf{IF (AirDewPointTemp \textless{} AirInletCoilSurfTemp) THEN} the coil is Partially Wet because there is possibility that air temperature will go below its dewpoint and moisture will condense on latter part of the cooling coil.
\end{itemize}

The Operating Block for Simple Mode Analysis is divided into two modes of coil performance, the two modes being:

\begin{itemize}
  \item
    Coil is completely dry: There is no moisture condensation on the coil surface and the coil is a dry coil.
  \item
    Coil is completely wet: The entire coil is wet due to complete condensation on the surface of the coil.
\end{itemize}

The option to identify which mode of operation the Simple mode analysis should perform ie, for a given set of inputs would the coil be Dry or Wet is decided by set of conditions described below.

\begin{itemize}
  \item
    \textbf{IF} (\textbf{Temperature Dewpoint Air \textless{} Water Inlet Temperature}) \textbf{THEN} the coil is Dry and we call the Subroutine Coil Completely Dry.~ In this case outlet temperature of air would be higher than the air dewpoint and hence there would be no condensation.
  \item
    \textbf{IF} (\textbf{Temperature Dewpoint Air \textgreater{} Water Inlet Temperature}) \textbf{THEN} the coil is completely wet, call subroutine Coil Completely Wet, it is assumed that moisture condensation occurs over completely surface of the coil. However we go ahead and check for the coil being partially wet with the following condition.
\end{itemize}

The above is a simple mode of analysis and the results are very slightly different from the detailed mode of analysis. The algorithms used in Simple mode and the Detailed mode are identically similar. The surface area wet fraction in the coil is reported as 1.0 or 0.0 for wet or dry coil respectively. The program defaults to simple mode of analysis for enabling higher execution speed.

\subsubsection{Effectiveness Equations}\label{effectiveness-equations}

There are two modes of flow for the coil, CounterFlow or CrossFlow. The default mode is CounterFlow. According to the mode of flow the following NTU - Effectiveness relationships are used to calculate coil effectiveness, which is used later by all the three modes (Dry, Wet, Part Wet) for calculating air outlet conditions and heat transfer.

Following are the relations used for calculating effectiveness equation for the heat exchangers.

\emph{Counter Flow Heat Exchanger Effectiveness Equation:}

\begin{equation}
{\eta_{CounterFlow}} = \frac{{(1 - Exp( - NTU \times (1 - Rati{o_{StreamCapacity}})))}}{{1 - Rati{o_{StreamCapacity}} \times Exp( - NTU \times (1 - Rati{o_{StreamCapacity}}))}}
\label{eq:CounterFlowHeatExchangerEffectiveness}
\end{equation}

In Equation~\ref{eq:CounterFlowHeatExchangerEffectiveness}, the variable Ratio\(_{StreamCapacity}\) is defined as below:

\begin{equation}
Rati{o_{StreamCapacity}} = \frac{{MinCapacit{y_{Stream}}}}{{MaxCapacit{y_{Stream}}}}
\label{eq:RatioStreamCapacity}
\end{equation}

In Equation~\ref{eq:RatioStreamCapacity}, the capacities of stream are defined as below in Equation~\ref{eq:MinMaxCapacityStream}:

\begin{equation}
(Min,Max)\,\,Capacit{y_{Stream}} = {(MassFlowRate \times Cp)_{air,water}}
\label{eq:MinMaxCapacityStream}
\end{equation}

NTU as shown in Equation~\ref{eq:CounterFlowHeatExchangerEffectiveness} is defined as the Number of Transfer Units and is a function of Coil UA and the Minimum Capacity of Stream. The Coil UA is a variable in this equation and depends on which mode of the coil operation (Dry, Wet, Part Wet) is calling upon Equation~\ref{eq:CounterFlowHeatExchangerEffectiveness}, i.e., if it is Coil Completely Dry calling upon the effectiveness equation with the value of Dry UA total, which in our case is defined as CoilUA\_total. Equation~\ref{eq:NTUCounterFlowHeatExchanger} gives definition for NTU.

\begin{equation}
NTU = \frac{{CoilUA}}{{MinStrea{m_{Capacity}}}}
\label{eq:NTUCounterFlowHeatExchanger}
\end{equation}

\emph{Cross Flow Heat Exchanger Effectiveness Equation:}

\begin{equation}
{\eta_{CrossFlow}} = 1 - EXP\left\{ {\frac{{Exp( - NTU \times Rati{o_{StreamCapacity}} \times NT{U^{ - 0.22}}) - 1}}{{Rati{o_{StreamCapacity}} \times NT{U^{ - 0.22}}}}} \right\}
\label{eq:EtaCrossFlow}
\end{equation}

The variables in the above equation have already been defined earlier. Depending on the mode of operation of the coil model, the CrossFlow or CounterFlow equations are used to calculate the effectiveness.

\subsubsection{Coil Outlet Conditions}\label{coil-outlet-conditions}

Calculating the Outlet Stream Conditions using the effectiveness value from Equation~\ref{eq:CounterFlowHeatExchangerEffectiveness} or~\ref{eq:EtaCrossFlow} depending on the mode of flow. The energy difference between the outlet and inlet stream conditions gives the amount of heat transfer that has actually take place. The temperature of air and water at the outlet of the coil are given by the following equations:

\begin{equation}
TempAi{r_{Out}} = TempAi{r_{inlet}} - {\eta_{cross,counter}} \times \frac{{MaxHeatTransfer}}{{StreamCapacit{y_{Air}}}}
\label{eq:HeatExchangerOutAirTemp}
\end{equation}

\begin{equation}
TempWate{r_{Out}} = TempWate{r_{Inlet}} + {\eta_{Cross,counter}} \times \frac{{MaxHeatTransfer}}{{StreamCapacit{y_{Water}}}}
\label{eq:HeatExchangerOutWaterTemp}
\end{equation}

In Equations~\ref{eq:HeatExchangerOutAirTemp} and~\ref{eq:HeatExchangerOutWaterTemp} above, the maximum heat transfer is calculated as shown in the following equation:

\begin{equation}
MaxHeatTransfer = MinStrea{m_{Capacity}} \times (TempAi{r_{Inlet}} - TempWate{r_{Inlet}})
\end{equation}

\subsubsection{Coil Completely Dry Calculations (operating block)}\label{coil-completely-dry-calculations-operating-block}

Since the coil is dry, the sensible load is equal to total load and the same with the humidity ratios at inlet and outlet, as in Equations~\ref{eq:HeatExchangerQSensibleDryCoil} and~\ref{eq:HeatExchangerHumRatioDryCoil}.

\begin{equation}
QSensibl{e_{DryCoil}} = QTota{l_{DryCoil}}
\label{eq:HeatExchangerQSensibleDryCoil}
\end{equation}

\begin{equation}
HumRati{o_{Inlet}} = HumRati{o_{Outlet}}
\label{eq:HeatExchangerHumRatioDryCoil}
\end{equation}

Total Heat Transfer in dry coil is as follows:

\begin{equation}
{Q_{TotalDryCoil}} = CapacityAir \times (AirTem{p_{In}} - AirTem{p_{Outlet}})
\end{equation}

The variables in the above equation are calculated earlier in Equations~\ref{eq:HeatExchangerOutAirTemp} and~\ref{eq:HeatExchangerOutWaterTemp} to give the total cooling load on the coil.

\subsubsection{Coil Completely Wet Calculations (operating block)}\label{coil-completely-wet-calculations-operating-block}

In wet coil we need to account for latent heat transfer, hence calculations are done using enthalpy of air and water instead of stream temperatures Hence we need to define coil UA for the wet coil based on enthalpy of the operating streams and not design streams.

Similar to Equations~\ref{eq:HeatExchangerOutAirTemp} and~\ref{eq:HeatExchangerOutWaterTemp}, we calculate the air outlet enthalpy and water outlet enthalpy, i.e. by replacing temperature with enthalpy for the respective streams. The input variable for Coil UA in Equation~\ref{eq:NTUCounterFlowHeatExchanger} for calculating NTU, in this case it would be enthalpy based and is given as shown in Equation~\ref{eq:CoilUAEnthalpyBased}:

\begin{equation}
CoilU{A_{\,Enthalpy\,Based}} = \frac{1}{{\left( {\frac{{CpSa{t_{Intermediate}}}}{{CoilU{A_{\,Internal}}}} + \frac{{C{p_{Air}}}}{{CoilU{A_{\,External}}}}} \right)}}
\label{eq:CoilUAEnthalpyBased}
\end{equation}

Total Coil Load in the case of a Wet Coil is the product of mass flow rate of air and enthalpy difference between the inlet and outlet streams as given in the following equation:

\begin{equation}
{Q_{Total}} = {\dot{m}_{air}} \times (EnthAi{r_{Inlet}} - EnthAi{r_{Outlet}})
\end{equation}

Once the enthalpy is known the outlet temperatures and outlet humidity ratios of the wet coil are calculated as in equations below.

\textbf{IF (TempCondensation \textless{} PsyTdpFnWPb(InletAirHumRat ,Patm)) THEN}

\begin{equation}
AirTem{p_{Out}} = AirTem{p_{inlet}} - (AirTem{p_{inlet}} - Condensatio{n_{Temp}}) \times \eta
\label{eq:AirTempOutWithCondensation}
\end{equation}

and

\begin{equation}
OutletAirHumdityRatio = PsyWFnTdbH(OutletAirTemp,EnthAirOutlet)
\end{equation}

\textbf{ELSE}

There is no condensation.  Thus, the inlet and outlet humidity ratios are equal, and the outlet temperature is a function of the outlet air enthalpy as shown below:

\begin{equation}
OutletAirTemp = PsyTdbFnHW(EnthalpyAirOutlet, OutletAirHumRat)
\end{equation}

and

\begin{equation}
OutletAirHumRat = InletAirHumRat
\end{equation}

\textbf{ENDIF}

Effectiveness \(\eta\) used in Equation~\ref{eq:AirTempOutWithCondensation} is defined in Equation~\ref{eq:EtaWithCondensation} and the condensation temperature is calculated using a psychrometric function as in Equation~\ref{eq:CondensationTemp}.

\begin{equation}
\eta  = 1 - Exp\left\{ { - \frac{{CoilU{A_{\,External}}}}{{Capacitanc{e_{Air}}}}} \right\}
\label{eq:EtaWithCondensation}
\end{equation}

\begin{equation}
Condensatio{n_{Temp}} = {\rm{PsyTsatFnHPb(Ent}}{{\rm{h}}_{{\rm{AirCondensateTemp}}}}{\rm{,P_{atm}) }}
\label{eq:CondensationTemp}
\end{equation}

\begin{equation}
Ent{h_{\,AirCondensateTemp}} = Ent{h_{\,AirInlet}} - \frac{{\left( {Ent{h_{\,AirInlet}} - Ent{h_{\,AirOutlet}}} \right)}}{\eta }
\end{equation}

Once the air outlet temperature are known, then the sensible load is calculated as a product of the capacitance of air and the temperature difference at the inlet and outlet, as in Equation~\ref{eq:HeatExchangerQSensible}:

\begin{equation}
{Q_{Sensible}} = Capacitanc{e_{Air}} \times \left( {AirTem{p_{Inlet}} - AirTem{p_{Outlet}}} \right)
\label{eq:HeatExchangerQSensible}
\end{equation}

\subsubsection{Coil Part Wet Part Dry Calculations (operating block)}\label{coil-part-wet-part-dry-calculations-operating-block}

The Coil would perform under part wet part dry conditions when Air Dewpoint Temperature is less than Coil surface temperature at inlet to air. In this case part of the coil used value of Dry UA for heat transfer and part the coil used Wet UA value for heat transfer.

This problem is solved utilizing the fact that the Exit conditions from the Dry Part of the Coil would become the inlet conditions to the wet part of the coil (see Figure~\ref{fig:simplified-schematic-of-coolingdehumidifying}) and the coil model determines by iteration what fraction of the coil is wet and based on that it calculates the areas and subsequently the UA values of that dry and wet part, based on the area of the dry and wet part respectively. Explained below are the steps followed for estimating the wet dry behavior of the coil.

First, iterate between the Dry Coil and the Wet Coil. First calculate Coil Completely Dry performance by estimating the wet dry interface water temperature using equation and inputting this variable as the water inlet temperature to dry Coil.

\begin{equation}
  WetDryInterfac{e_{WaterTemp}} = {\rm{WaterTem}}{{\rm{p}}_{{\rm{Inlet}}}}{\rm{ + Are}}{{\rm{a}}_{{\rm{WetFraction}}}}{\rm{*(WaterTem}}{{\rm{p}}_{{\rm{Outlet}}}}{\rm{ - WaterTem}}{{\rm{p}}_{{\rm{Inlet}}}}{\rm{)}}
\end{equation}

The value of Surface Area Wet fraction is estimated initially as follows:

\begin{equation}
Are{a_{\,WetFractionEstimate}} = \frac{{AirDewP{t_{\,Temp}} - InletWate{r_{\,Temp}}}}{{OutletWate{r_{\,Temp}} - InletWate{r_{\,Temp}}}}
\label{eq:AreaWetFractionEstimate}
\end{equation}

For the above mentioned iteration the value of Coil UA for Wet and Dry part need to be varied according to the new respective area of the wet and dry parts. This estimate of Wet and Dry area is a product of the estimated Surface Area Fraction and total coil external area, which keeps varying as will be explained further in the document.

UA value for Dry part of the Coil is estimated as below.

\begin{equation}
CoilU{A_{Dry\,External}} = \frac{{SurfAre{a_{Dry}}}}{{\frac{1}{{Coil{U_{Dry\,External}}}} + \frac{1}{{Coil{U_{Internal}}}}}}
\end{equation}

where Surface Area Dry = (Total Coil Area -- Wet Part Area), where the Wet part area is the product of Surface fraction Wet and Total Coil Area.

UA value for the Wet part of the Coil requires Wet UA external and Wet UA Internal, which are calculated as below.

\begin{equation}
WetPartUA{\,_{External}} = Coil{U_{Wet\,External}} \times SurfaceAreaWet
\end{equation}

\begin{equation}
WetPartUA{\,_{Internal}} = Coil{U_{Internal}} \times SurfaceAreaWet
\end{equation}

It is essential to remember that the mode of calculation for the coils remains the same as in completely wet and completely dry mode, only the UA values and water, air outlet and inlet values change.

Now iterate between the Dry Coil and wet Coil with the above respective UA, and usual operating inputs except the variable water inlet temperature for dry Coil is replaced with Wet Dry Interface Water temperature, and in the Wet Coil the Outlet Air Temperature from dry Coil is the inlet air temperature to Wet Coil. The iteration proceeds till the Outlet Water Temperature from Wet Coil equals the Wet Dry Interface Water Temp, which is the input to Dry Coil.

\emph{Dry Part Inputs, Iteration Case 1: Explained In Programming Fashion}

\textbf{CALL CoilCompletelyDry}(WetDryInterfcWaterTemp, InletAirTemp, DryCoilUA, OutletWaterTemp, WetDryInterfcAirTemp, WetDryInterfcHumRat, DryCoilHeatTranfer)

Input the calculated values calculated by Dry Coil above into Wet Coil below:

\textbf{CALL CoilCompletelyWet}(InletWaterTemp, WetDryInterfcAirTemp, WetDryInterfcHumRat, WetPartUAInternal, WetPartUAExternal, EstimateWetDryInterfcWaterTemp, OutletAirTemp, OutletAirHumRat, WetCoilTotalHeatTransfer, WetCoilSensibleHeatTransfer, EstimateSurfAreaWetFraction, WetDryInterfcSurfTemp)

Iterate Between the above two Wet and Dry Coil calls until \textbf{WetDryInterfcWaterTemp = EstimateWetDryInterfcWaterTemp}. The key is to have the difference between the variables (WetDryInterfcWaterTemp - OutletWaterTemp) in the Dry Coil equal to (InletWaterTemp -EstimatedWetDryInterfcWaterTemp) in the Wet Coil. This equality quantized the relative part of coil that is dry and the part that is wet on the basis of the heat transfer that has occurred.

After the above convergence check for the coil being dry, iterate to calculate surface fraction area wet.

\textbf{IF}

\begin{equation}
\left\{ {(AreaFractio{n_{Wet}} \le \,0.0)\,\,.AND.(WetDryInterfac{e_{SurfTemp}} > AirDewPt)} \right\}
\label{eq:WetDryCoilConvergenceCheck}
\end{equation}

\textbf{THEN CoilCompletelyDry}

If Equation~\ref{eq:WetDryCoilConvergenceCheck} is satisfied, then the coil is dry and simply output the value for Dry Coil calculated else the coil is partially wet and then iterate to find the surface fraction area wet. Start with the initial guess value of surface area fraction (Equation~\ref{eq:AreaWetFractionEstimate}) wet and iterate on the entire loop starting from Equation~\ref{eq:AreaWetFractionEstimate} until the Wet Dry Interface Temperature equals the Air Dewpoint Temperature. The value of Surface Area fraction wet at which the interface air temperature equals is dewpoint is the transition point from wet to dry and gives the \% of coil that is dry and \% that is wet.

Graphs Showing the Performance of the coil model at optimum operating conditions are shown below. All values of variable used have been normalized.

\begin{figure}[hbtp] % fig 163
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image3348.png}
\caption{Air Outlet Temperature Vs. Air Mass Flow Rate \protect \label{fig:air-outlet-temperature-vs-air-mass-flow-rate}}
\end{figure}

\begin{figure}[hbtp] % fig 164
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image3349.png}
\caption{Sensible Load Variations Vs. Air mass Flow Rate \protect \label{fig:sensible-load-variations-vs-air-mass-flow}}
\end{figure}

\begin{figure}[hbtp] % fig 165
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image3350.png}
\caption{Total and Sensible Load Variations Vs. Air Mass Flow Rate \protect \label{fig:total-and-sensible-load-variations-vs-air}}
\end{figure}

\begin{figure}[hbtp] % fig 166
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image3351.png}
\caption{Surface Area Fraction Wet Vs Air Mass Flow Rate \protect \label{fig:surface-area-fraction-wet-vs-air-mass-flow}}
\end{figure}

\subsubsection{References}\label{references-011}

IBPSA BuildSim-2004. 2004. Colarado Boulder: An Improvement of Ashrae Secondary HVAC toolkit Simple Cooling Coil Model for Building Simulation, Rahul J Chillar, Richard J Liesen M\&IE ,UIUC.

Stoecker, W.F. \textless{}dates unspecified\textgreater{} Design of Thermal Systems,: ME 423 Class Notes , M\& IE Dept UIUC.

Brandemeuhl, M. J. 1993. HVAC2 Toolkit: Algorithms and Subroutines for Secondary HVAC Systems Energy Calculations, ASHRAE.

Elmahdy, A.H. and Mitalas, G.P.~ 1977. ``A Simple Model for Cooling and Dehumidifying Coils for Use In Calculating Energy Requirements for Buildings ASHRAE Transactions, Vol.83 Part 2, pp.~103-117.

Threlkeld, J.L.~ 1970.~ Thermal Environmental Engineering, 2nd Edition, Englewood Cliffs: Prentice-Hall,Inc. pp.~254-270.

ASHRAE Secondary HVAC Toolkit TRNSYS.~ 1990.~ A Transient System Simulation Program: Reference Manual. Solar Energy Laboratory, Univ. Wisconsin-Madison, pp.~4.6.8-1 - 4.6.8-12.

Kays, W.M. and A.L. London. 1964. Compact Heat Exchangers, 2nd Edition, New York: McGraw-Hill.

Clark, D.R.. 1985. HVACSIM+ Building Systems and Equipment Simulation Program Reference Manual, Pub. No. NBSIR 84-2996, National Bureau of Standards, U.S. Department of Commerce, January, 1985

Elmahdy, A.H. 1975. Analytical and Experimental Multi-Row Finned-Tube Heat Exchanger Performance During Cooling and Dehumidifying Processes, Ph.D.~Thesis, Carleton University, Ottawa, Canada, December, 1975.

Elmahdy, A.H., and Mitalas, G.P. 1977. ``A Simple Model for Cooling and Dehumidifying Coils for Use in Calculating Energy Requirements for Buildings,'' ASHRAE Transactions, Vol.~ 83, Part 2, pp.~103-117.

\subsection{Chilled-Water-Based Detailed Geometry Air Cooling Coil}\label{chilled-water-based-detailed-geometry-air-cooling-coil}

The input object Coil:Cooling:Water:DetailedGeometry provides a coil model that predicts changes in air and water flow variables across the coil based on the coil geometry. A greatly simplified schematic of enthalpy and temperature conditions in a counterflow cooling/dehumidifying coil is shown in the following schematic figure. In addition, the variables required to model a cooling/dehumidifying coils and their definitions are extensively listed in ``Table~\ref{table:coil-geometry-and-flow-variables-for-coils}. Coil Geometry and Flow Variables for Coils''. The input required to model the coil includes a complete geometric description that, in most cases, should be derivable from specific manufacturer's data.~ The coil simulation model is essentially the one presented by Elmahdy and Mitalas (1977) and implemented in HVACSIM+ (Clark 1985), a modular program also designed for energy analysis of building systems. The model solves the equations for the dry and wet sections of the coil using log mean temperature and log mean enthalpy differences between the liquid and the air streams.~ Elmahdy and Mitalas state that crossflow counterflow coils with at four rows or more are approximated well by this model.~ This does not constitute a major limitation since cooling and dehumidifying coils typically have more than four rows.

\begin{figure}[hbtp] % fig 167
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image3352.svg.png}
\caption{Simplified Schematic of Cooling/Dehumidifying Coil \protect \label{fig:simplified-schematic-of-coolingdehumidifying-001}}
\end{figure}

\subsubsection{Heat Transfer and Energy Balance}\label{heat-transfer-and-energy-balance-1}

The cooling coil may be completely dry, completely wet with condensation, or it may have wet and dry sections.~ The actual condition of the coil surface depends on the humidity and temperature of the air passing over the coil and the coil surface temperature.~ The partly wet-partly dry case represents the most general scenario for the coil surface conditions.~ The all dry and all wet cases can be considered as limiting solutions of the wet or dry areas respectively going to zero.~ In the general case, equations are written for both the dry and wet regions of the coil.~ For each region the heat transfer rate from air to water may be defined by the rate of enthalpy change in the air and in the water.~ The rates must balance between each medium for energy to be conserved.~ Equations~\ref{eq:QdDotmCpdT} through~\ref{eq:QwDotmdH} express the energy balance between the water and the air for the case of dry and wet coils respectively.~ Equations~\ref{eq:QwDotmCpdT} and~\ref{eq:QwDotUALMHD} represent the heat transfer rate between water and air based on the actual performance of the coil.~ The UA parameter can be calculated from the parameters in the following table.

% table 55
\begin{longtable}[c]{|p{1.0in}p{2.0in}|p{1.0in}p{2.0in}|}
\caption{Coil Geometry and Flow Variables for Coils \label{table:coil-geometry-and-flow-variables-for-coils}} \tabularnewline
\toprule 
\endfirsthead

\caption[]{Coil Geometry and Flow Variables for Coils} \tabularnewline
\toprule 
\endhead

A & area & LMHD & log mean enthalpy difference \tabularnewline
A & air, air side & LMTD & log mean temperature difference \tabularnewline
aa, bb & coeff. in enthalpy approximation & $\dot m$ & mass flow rate \tabularnewline
C1, C2 & coeff. in air side film coeff. & mf & metal and fouling \tabularnewline
C\(_p\) & specific heat & $\mu$ & viscosity \tabularnewline
D & diameter, effective diameter & o & outside (air side) \tabularnewline
Dhdr & hydraulic diameter on air side & Pr & Prandtl number \tabularnewline
D & dry region & $\dot Q$ & heat transfer rate \tabularnewline
$\delta$ & thickness & R & overall thermal resistance \tabularnewline
$\Delta$ & spacing & Re & Reynolds number \tabularnewline
F & heat transfer film coefficient & $\rho$ & ratio of diameters \tabularnewline
fai & variable in fin eff. calculation & s & surface, outside of metal \tabularnewline
fin, fins & air side fin geometry & St & Stanton number \tabularnewline
H & enthalpy & T & temperature \tabularnewline
$\eta$ & efficiency & tube & water tube \tabularnewline
I0() & mod Bessel fn, 1st kind, ord 0 & UAdry & dry heat xfer coeff. * dry area \tabularnewline
I1() & mod Bessel fn, 1st kind, ord 1 & UcAw & wet heat xfer coeff. * wet area \tabularnewline
K0() & mod Bessel fn, 2nd kind, ord 0 & ub, ue & variables in fin eff. calculation \tabularnewline
K1() & mod Bessel fn, 2nd kind, ord 1 & V & average velocity \tabularnewline
I & inside (water side) & w & water, water side, or wet region \tabularnewline
K1 & variable in sol'n form of eq. & wa & humidity ratio \tabularnewline
K & thermal conductivity & Z & variables in sol'n form of eq. \tabularnewline
L & length & 1, 2, 3 & positions (see diagram) \tabularnewline
\bottomrule
\end{longtable}

Equations~\ref{eq:QdDotmCpdT} through~\ref{eq:QwDotUALMHD} represent two sets of three equations with 7 unknowns: \({\dot Q_d}\), T\(_{a,1}\), T\(_{a,2}\), T\(_{w,2}\), T\(_{w,3}\), \({\dot m_a}\), \({\dot m_w}\).~However, normally at least four of these variables are specified, for example: inlet water temperature, outlet air temperature, water flow rate, air flow rate, so that the system of equations is effectively closed.

\begin{equation}
{\dot Q_d} = {\dot m_a}C_{p,a}\left( {{T_{a,1}} - {T_{a,2}}} \right)
\label{eq:QdDotmCpdT}
\end{equation}

\begin{equation}
{\dot Q_d} = {\dot m_w}C_{p,w}\left( {{T_{w,3}} - {T_{w,2}}} \right)
\end{equation}

\begin{equation}
{\dot Q_d} = \left( {U{A_{dry}}} \right)\left( {LMTD} \right)
\end{equation}

\begin{equation}
{\dot Q_w} = {\dot m_a}\left( {{H_{a,2}} - {H_{a,3}}} \right)
\label{eq:QwDotmdH}
\end{equation}

\begin{equation}
{\dot Q_w} = {\dot m_w}C_{p,w}\left( {{T_{w,2}} - {T_{w,1}}} \right)
\label{eq:QwDotmCpdT}
\end{equation}

\begin{equation}
{\dot Q_w} = \left( {{U_c}{A_w}} \right)\left( {LMHD} \right)
\label{eq:QwDotUALMHD}
\end{equation}

In order to manipulate these equations, the log mean temperature and enthalpy differences are expanded as shown in Equations~\ref{eq:CoilLMTD} and~\ref{eq:CoilLMHD}.~ Finally, a linear approximation of the enthalpy of saturated air over the range of surface temperature is made using Equation~\ref{eq:CoilHw}.~ Note that in Equation~\ref{eq:CoilLMHD} H\(_w\) refers to the enthalpy of saturated air at the water temperature.

\begin{equation}
LMTD = \frac{{\left( {{T_{a,1}} - {T_{w,3}}} \right) - \left( {{T_{a,2}} - {T_{w,2}}} \right)}}{{\ln \frac{{{T_{a,1}} - {T_{w,3}}}}{{{T_{a,2}} - {T_{w,2}}}}}}
\label{eq:CoilLMTD}
\end{equation}

\begin{equation}
LMHD = \frac{{\left( {{H_{a,2}} - {H_{w,2}}} \right) - \left( {{H_{a,3}} - {H_{w,1}}} \right)}}{{\ln \frac{{{H_{a,2}} - {H_{w,2}}}}{{{H_{a,3}} - {H_{w,1}}}}}}
\label{eq:CoilLMHD}
\end{equation}

\begin{equation}
{H_w} = aa + bb {T_w}
\label{eq:CoilHw}
\end{equation}

Equation~\ref{eq:CoilTw2Equation} is derived from the above equations and is used to solve for the coil conditions when all of the inlet conditions are given as input.~ Operating in this manner, the coil does not have a controlled outlet air temperature.

\begin{equation}
{T_{w,2}} = \frac{{\left( {1 - Z} \right)\left( {{H_{a,1}} - aa - K1 C_{p,a} {T_{a,1}}} \right) + Z {T_{w,1}}\left( {bb - \frac{{{m_w}C_{p,w}}}{{{m_a}}}} \right)}}{{bb - Z\frac{{{m_w}C_{p,w}}}{{{m_a}}} - \left( {1 - Z} \right) K1 C_{p,a}}}
\label{eq:CoilTw2Equation}
\end{equation}

An alternative solution method is to define the coil leaving air temperature as an input with a variable water flow rate.~ In this case Equations~\ref{eq:CoilTw2-419} and~\ref{eq:CoilTw2-420} are more convenient.~ Equations~\ref{eq:CoilZ-421} through~\ref{eq:CoilZd-423} define terms that are used to simplify Equations~\ref{eq:CoilTw2Equation},~\ref{eq:CoilTw2-419} and~\ref{eq:CoilTw2-420}.

\begin{equation}
{T_{w,2}} = \frac{{\left( {1 - Z} \right)\left( {{H_{a,3}} - aa} \right) + {T_{w,1}}\left( {\frac{{{m_w}C_{p,w}}}{{{m_a}}} - bb Z} \right)}}{{\frac{{{m_w}C_{p,w}}}{{{m_a}}} - bb}}
\label{eq:CoilTw2-419}
\end{equation}

\begin{equation}
{T_{w,2}} = \frac{{\left( {{Z_d} - 1} \right){T_{a1}}C_{p,a} + {T_{w,3}}\left( {C_{p,a} - {Z_d}\frac{{{m_w}C_{p,w}}}{{{m_a}}}} \right)}}{{{Z_d}\left( {C_{p,a} - \frac{{{m_w}C_{p,w}}}{{{m_a}}}} \right)}}
\label{eq:CoilTw2-420}
\end{equation}

\begin{equation}
Z = exp\left( {{U_c}{A_w}\left( {\frac{1}{{{m_a}}} - \frac{{bb}}{{{m_w}C_{p,w}}}} \right)} \right)
\label{eq:CoilZ-421}
\end{equation}

\begin{equation}
K1 = \frac{{{Z_d} - 1}}{{{Z_d} - \frac{{{m_a}C_{p,a}}}{{{m_w}C_{p,w}}}}}
\end{equation}

\begin{equation}
{Z_d} = exp\left( {{U_c}{A_{dry}}\left( {\frac{1}{{{m_a}C_{p,a}}} - \frac{1}{{{m_w}C_{p,w}}}} \right)} \right)
\label{eq:CoilZd-423}
\end{equation}

\subsubsection{Underlying Correlations, Properties, and Assumptions}\label{underlying-correlations-properties-and-assumptions}

Overall heat transfer coefficients are calculated from the specified coil geometry and by using empirical correlations from fluid mechanics and heat transfer.~ For the water side, Equation~\ref{eq:Coilfi} gives the film heat transfer coefficient in SI units:

\begin{equation}
{f_i} = 1.429\left( {1 + 0.0146 {T_w}} \right)V_w^{0.8}D_i^{ - 0.2}
\label{eq:Coilfi}
\end{equation}

This is valid for Reynolds numbers greater than 3100 based on water flow velocity and pipe inside diameter and is given in Elmahdy and Mitalas(1977) as recommended in the standard issued by the Air-Conditioning and Refrigeration Institute (1972) for air-cooling coils.~ The definition of overall inside thermal resistance follows directly as shown in Equation~\ref{eq:CoilRi}.

\begin{equation}
{R_i} = \frac{1}{{{f_i}{A_i}}}
\label{eq:CoilRi}
\end{equation}

Equation~\ref{eq:Coilfo} gives the film coefficient for the air side.~ Another form of the same equation is Equation~\ref{eq:CoilC1Rea}, which is familiar from the data presented in Kays and London (1984).~ For coil sections that have a wet surface due to condensation, the air side film coefficient is modified according to Equation~\ref{eq:Coilfow}.~ The correction term, a function of air Reynolds number, is valid for Reynolds numbers between 400 and 1500.~ The coefficients in Equations~\ref{eq:Coilfo} and~\ref{eq:CoilC1Rea} are calculated by Equations~\ref{eq:CoilC1} and~\ref{eq:CoilC2} that are functions of the coil geometry.~ Elmahdy (1977) explains the modifier for the wet surface and coefficients for the film coefficient.~ Equations~\ref{eq:CoilDhdr} through~\ref{eq:Coilmua} show definitions and values of common parameters and properties.

\begin{equation}
  f_o = C_1 Re_a^{C_2} \frac{m_a}{A_{a,minflow}} C_{p,a} Pr_a^{2/3}
\label{eq:Coilfo}
\end{equation}

\begin{equation}
  C_1 Re_a^{C_2} = St_a Pr_a^{2/3}
\label{eq:CoilC1Rea}
\end{equation}

\begin{equation}
{f_{o,w}} = {f_o}\left( {1.425 - 5.1 \times {{10}^{ - 4}}R{e_a} + 2.63 \times {{10}^{ - 7}}Re_a^2} \right)
\label{eq:Coilfow}
\end{equation}

\begin{equation}
{C_1} = 0.159{\left( {\frac{{{\delta_{fin}}}}{{{D_{hdr}}}}} \right)^{ - 0.065}}{\left( {\frac{{{\delta_{fin}}}}{{{L_{fin}}}}} \right)^{0.141}}
\label{eq:CoilC1}
\end{equation}

\begin{equation}
{C_2} =  - 0.323{\left( {\frac{{{\Delta_{fins}}}}{{{L_{fin}}}}} \right)^{0.049}}{\left( {\frac{{{D_{fin}}}}{{{\Delta_{tuberows}}}}} \right)^{0.549}}{\left( {\frac{{{\delta_{fin}}}}{{{\Delta_{fins}}}}} \right)^{ - 0.028}}
\label{eq:CoilC2}
\end{equation}

\begin{equation}
{D_{hdr}} = \frac{{4{A_{a,minflow}}{\delta_{coil}}}}{{{A_{s,total}}}}
\label{eq:CoilDhdr}
\end{equation}

\begin{equation}
R{e_a} = \frac{{4{\delta_{coil}}\left( {1 + {w_a}} \right){m_a}}}{{{A_{s,total}}{\mu_a}}}
\end{equation}

\begin{equation}
P{r_a} = 0.733
\end{equation}

\begin{equation}
{\mu_a} = 1.846 \times {10^{ - 5}}
\label{eq:Coilmua}
\end{equation}

The film coefficients above act on the extended surface of the air side, that is the area of the fins and the tubes.~ Therefore, the fin efficiency must also be considered in calculating the overall thermal resistance on the outside.~ Gardner (1945) gives the derivation of Equation~\ref{eq:Coiletafin}, used as a curve fit to find the fin efficiency as a function of film coefficient.~ This equation is based on circular fins of constant thickness.~ To model a coil with flat fins, an effective diameter -- that of circular fins with the same fin area -- is used.~ Equations~\ref{eq:Coilfai} through~\ref{eq:Coilub} define variables used in Equation~\ref{eq:Coiletafin}.~ The overall efficiency of the surface is shown by Equation~\ref{eq:Coiletao}.~ Note that the efficiency is found by the same equations for the wet surface using the wet surface film coefficient.

\begin{equation}
{\eta_{fin}} = \frac{{ - 2\rho }}{{fai(1 + \rho )}}\left[ {\frac{{{I_1}({u_b}){K_1}({u_e}) - {K_1}({u_b}){I_1}({u_e})}}{{{I_0}({u_b}){K_1}({u_e}) + {K_0}({u_b}){I_1}({u_e})}}} \right]
\label{eq:Coiletafin}
\end{equation}

\begin{equation}
fai = \frac{{({D_{fin}} - {D_{tube}})}}{2}\sqrt {\frac{{2{f_o}}}{{{k_{fin}}{\delta_{fin}}}}}
\label{eq:Coilfai}
\end{equation}

\begin{equation}
\rho  = \frac{{{D_{tube}}}}{{{D_{fin}}}}
\end{equation}

\begin{equation}
{u_e} = \frac{{fai}}{{1 - \rho }}
\end{equation}

\begin{equation}
{u_b} = {u_e}\rho
\label{eq:Coilub}
\end{equation}

\begin{equation}
{\eta_o} = 1 - (1 - {\eta_{fin}})\frac{{{A_{fins}}}}{{{A_{s,total}}}}
\label{eq:Coiletao}
\end{equation}

The definition of overall outside thermal resistance is given in Equation~\ref{eq:CoilRo-441} as a function of fin efficiency and film coefficient.~ For a wet coil surface the resistance must be defined differently because the heat transfer equations are based on enthalpy rather than temperature differences, as shown in Equation~\ref{eq:CoilRow-442}.

\begin{equation}
{R_o} = \frac{1}{{{f_o}{\eta_o}{A_{s,total}}}}
\label{eq:CoilRo-441}
\end{equation}

\begin{equation}
  R_{o,w} = \frac{C_{p,a}/bb}{f_{o,w}\eta_{o,w}A_{s,total}}
\label{eq:CoilRow-442}
\end{equation}

Equation~\ref{eq:CoilRmf} gives the last two overall components of thermal resistance.~ They represent the metal tube wall and internal fouling.~ The fouling factor, due to deposits of dirt and corrosion of the tube inside surfaces, is assumed to be 5x10\(^{-5}\)~m\(^2\)-K/W.~ All components of thermal resistance are added in series to produce the overall heat transfer coefficients shown in Equations~\ref{eq:CoilUAdry} and~\ref{eq:CoilUcAw}.

\begin{equation}
{R_{mf}} = \frac{{{\delta_{tube}}}}{{{k_{tube}}{A_i}}} + \frac{{Fl}}{{{A_i}}}
\label{eq:CoilRmf}
\end{equation}

\begin{equation}
U{A_{dry}} = \frac{{{A_{dry}}}}{{{A_{s,total}}}}\left[ {\frac{1}{{{R_i} + {R_{mf}} + {R_o}}}} \right]
\label{eq:CoilUAdry}
\end{equation}

\begin{equation}
{U_c}{A_w} = \frac{{{A_w}}}{{{A_{s,total}}}}\left[ {\frac{{{1 \mathord{\left/ {\vphantom {1 {bb}}} \right. } {bb}}}}{{{R_i} + {R_{mf}} + {R_{o,w}}}}} \right]
\label{eq:CoilUcAw}
\end{equation}

\subsubsection{Solution Method of Model}\label{solution-method-of-model}

The complicated equations derived above were implemented in a successive substitution solution procedure to calculate the coil performance based on the input parameters.~ The MODSIM implementation of a cooling coil, the TYPE12 subroutine, was the motivation for this approach; the method used there has been retained with modifications for the uncontrolled coil model.~ Clark (1985) contains notes about the MODSIM routine.

In the general case, the cooling coil is only partially wet.~ For an uncontrolled coil, Equation~\ref{eq:CoilTw2Equation} is used to find the water temperature at the boundary.~ Several simple equations in the loop adjust the boundary point until the dry surface temperature at the boundary is equal to the dewpoint of the inlet air.~ For the controlled coil, Equations~\ref{eq:CoilTw2-419} and~\ref{eq:CoilTw2-420} give two calculations of the boundary temperature, and the water flow rate and boundary position are adjusted until the two equations agree.

Special cases occur when the coil is all wet or all dry.~ The coil is solved as if it were all wet before the general case is attempted.~ If the wet surface temperatures at the coil inlet and outlet are both below the dewpoint, no further solution is required.~ However, to ensure a continuous solution as flow variables are changed, when the surface is all dry or when it is wet with only the dry surface equations yielding a surface temperature below the dewpoint at the water outlet, the general solution is used to calculate the unknowns.~ In the solution of the controlled coil the outlet air enthalpy, given some resulting dehumidification, must correspond to the enthalpy at the specified outlet air temperature.

\subsubsection{Application of Cooling Coil Model to Heating Coils}\label{application-of-cooling-coil-model-to-heating-coils}

The implementation of detailed heating coil models in IBLAST was another important aspect of the system/plant integration.~ The same kind of loops exist to provide hot water to the heating coils from the boilers as exist to supply the cooling coils with chilled water from the chillers.~~ Some simplifications can be made, however, since the enthalpy change of the air flowing over a heating coil is entirely sensible.~ There is no condensation in a heating coil.~ In order to allow heating and cooling coils to be specified using the same geometric parameters, a heating coil simulation was developed from the cooling coil model described above by eliminating the wet surface analysis.

In addition, it was concluded that, since much simpler and less computationally expensive heating coil simulations are possible, an option was provided in IBLAST for a heating coil design using only the UA value of the coil, the product of heat transfer coefficient and coil area.~ This model was largely based on the TYPE10 subroutine implemented in MODSIM.~ The equations used to model the performance of the TYPE10 heating coil are as follows:

\begin{equation}
  \begin{array}{rl} 
    T_{a,out} & = T_{a,in} + \left( T_{w,in} - T_{a,in} \right) \varepsilon \left( \frac{\min \left( C_{p,a} \dot m_a,C_{p,w}\dot m_w \right)} {C_{p,a}\dot m_a} \right) \\
    T_{w,out} & = T_{w,in} - \left( T_{a,out} - T_{a,in} \right) \left( \frac{C_{p,a}\dot m_a}{C_{p,w}\dot m_w} \right)
  \end{array}
\end{equation}

where the coil effectiveness is given by:

\begin{equation}
\varepsilon  = 1 - \exp \left( {\frac{{\left\{ {\exp \left[ { - \left( {\frac{{\min \left\{ {{C_{p,a}}{{\dot m}_a},{C_{p,w}}{{\dot m}_w}} \right\}}}{{\max \left\{ {{C_{p,a}}{{\dot m}_a},{C_{p,w}}{{\dot m}_w}} \right\}}}} \right){{\left\{ {NTU} \right\}}^{0.78}}} \right] - 1} \right\}}}{{\left( {\frac{{\min \left\{ {{C_{p,a}}{{\dot m}_a},{C_{p,w}}{{\dot m}_w}} \right\}}}{{\max \left\{ {{C_{p,a}}{{\dot m}_a},{C_{p,w}}{{\dot m}_w}} \right\}}}} \right){{\left\{ {NTU} \right\}}^{ - .22}}}}} \right)
\end{equation}

The parameter NTU is the number of transfer units and is defined as a function of the UA value of the coil as follows:

\begin{equation}
{\rm{NTU}} = \frac{{{\rm{UA}}}}{{{\rm{min}}\left( {{{\rm{C}}_{{\rm{p,a}}}}{{{\rm{\dot m}}}_{\rm{a}}}{\rm{,}}{{\rm{C}}_{{\rm{p,w}}}}{{{\rm{\dot m}}}_{\rm{w}}}} \right)}}
\end{equation}

\subsection{Hot-Water-Based Air Heating Coil}\label{hot-water-based-air-heating-coil}

\subsubsection{Overview}\label{overview-010}

The input object Coil:Heating:Water provides a model that uses an NTU--effectiveness model of a static heat exchanger. The model is an inlet -- outlet model: given the inlet conditions and flow rates and the UA, the effectiveness is calculated using the formula for the effectiveness of a cross-flow heat exchanger with both fluid streams unmixed. The effectiveness then allows the calculation of the outlet conditions from the inlet conditions.

The inputs to the model are: (1) the current inlet temperatures and flow rates of the air and water fluid streams and (2) the UA of the coil. Note that the UA is fixed in this model and is not a function of the flow rates.

There are 2 alternative user inputs for the component: the user may input the design water volumetric flow rate and the UA directly; or the user may choose to input the more familiar design heating capacity plus design inlet \& outlet temperatures and let the program calculate the design UA. These alternative user inputs are fully described in the EnergyPlus Input Output Reference document.

\subsubsection{Model Description}\label{model-description-1-004}

The air and water capacitance flows are defined as:

\begin{equation}
{\dot C_{air}} = {c_{p,air}}\cdot {\dot m_{air}}
\end{equation}

\begin{equation}
{\dot C_{water}} = {c_{p,water}}\cdot {\dot m_{water}}
\end{equation}

The minimum and maximum capacity flows are then:

\begin{equation}
{\dot C_{\min }} = \min ({\dot C_{air}},{\dot C_{water}})
\end{equation}

\begin{equation}
{\dot C_{\max }} = \max ({\dot C_{air}},{\dot C_{water}})
\end{equation}

The capacitance flow ratio is defined as:

\begin{equation}
Z = {\dot C_{\min }}/{\dot C_{\max }}
\end{equation}

The number of transfer units (\emph{NTU}) is:

\begin{equation}
NTU = UA/{\dot C_{\min }}
\end{equation}

The effectiveness is:

\begin{equation}
\varepsilon  = 1 - \exp (\frac{{{e^{ - NTU \cdot Z \cdot \eta }} - 1}}{{Z \cdot \eta }})
\end{equation}

where \(\eta = NT{U^{ - 0.22}}\).

The outlet conditions are then:

\begin{equation}
{T_{air,out}} = {T_{air,in}} + \varepsilon \cdot {\dot C_{\min }}\cdot ({T_{water,in}} - {T_{air,in}})/{\dot C_{air}}
\end{equation}

\begin{equation}
{T_{water,out}} = {T_{water,in}} - {\dot C_{air}}\cdot ({T_{air,out}} - {T_{air,in}})/{\dot C_{water}}
\end{equation}

The output of the coil in watts is:

\begin{equation}
{\dot Q_{coil}} = {\dot C_{water}}\cdot ({T_{water,in}} - {T_{water,out}})
\end{equation}

The UA value is recalculated for each timestep.~ A nominal UA, \emph{UA\(_{0}\)}, at the rating point is calculated by the program using the input for rated conditions and a search routine called root solver.

User input for the ratio of convective heat transfers at the nominal or rated operating point, ``\emph{r},'' is used in the model.~ This ratio is defined as:

\begin{equation}
r = \frac{{{\eta_f}{{\left( {hA} \right)}_{air}}}}{{{{\left( {hA} \right)}_{water}}}}
\end{equation}

where:

\({\eta_f}\) is the fin efficiency, (dimensionless)

\emph{h} is the surface convection heat transfer coefficient

\emph{A} is the surface area.

The value calculated for \emph{UA}\(_{0}\) is used with the input for \emph{r} to characterize the convective heat transfer on the water sides at the nominal rating operation point using:

\begin{equation}
{\left( {{{\left( {hA} \right)}_w}} \right)_0} = U{A_0}\left( {\frac{{r + 1}}{r}} \right)
\end{equation}

and on the air side at the nominal rating point using:

\begin{equation}
{\left( {{\eta_f}{{\left( {hA} \right)}_a}} \right)_0} = r{\left( {hA} \right)_{w,0}}
\end{equation}

Then, the following equations are used to calculate a new UA as a function of the flow rates and inlet temperatures at each timestep.

\begin{equation}
{x_a} = 1 + 4.769\cdot {10^{ - 3}}\left( {{T_{air,in}} - {T_{air,in,0}}} \right)
\end{equation}

\begin{equation}
{\eta_f}{\left( {hA} \right)_a} = {x_a}{\left( {\frac{{{{\dot m}_a}}}{{{{\dot m}_{a,0}}}}} \right)^{0.8}}{\left( {{\eta_f}{{\left( {hA} \right)}_a}} \right)_0}
\end{equation}

\begin{equation}
{x_w} = 1 + \left( {\frac{{0.014}}{{1 + 0.014{T_{water,in,0}}}}} \right)\;\left( {{T_{water,in}} - {T_{water,in,0}}} \right)
\end{equation}

\begin{equation}
{\left( {hA} \right)_w} = {x_w}{\left( {\frac{{{{\dot m}_w}}}{{{{\dot m}_{w,0}}}}} \right)^{0.85}}{\left( {hA} \right)_{w,0}}
\end{equation}

\begin{equation}
UA = {\left( {\frac{1}{{{{\left( {hA} \right)}_w}}} + \frac{1}{{{\eta_f}{{\left( {hA} \right)}_a}}}} \right)^{ - 1}}
\end{equation}

The above formulas are from the following reference, along with further references. The equation for x\(_{w}\) was modified from that published in Wetter (1999) to correct a small error.

\subsubsection{References}\label{references-1-004}

Wetter, M. 1999. Simulation Model: Finned Water-to-Air Coil Without Condensation. LBNL-42355. This document can be downloaded from \href{http://simulationresearch.lbl.gov}{LBNL}.

\subsection{Single-Speed Electric DX Air Cooling Coil}\label{single-speed-electric-dx-air-cooling-coil}

\subsubsection{Overview}\label{overview-1-004}

This model (object names Coil:Cooling:DX:SingleSpeed and \\ Coil:Cooling:DX:TwoStageWithHumidityControlMode, with CoilPerformance:DX:Cooling) simulates the performance of an air-cooled or evaporative-cooled direct expansion (DX) air conditioner. The model uses performance information at rated conditions along with curve fits for variations in total capacity, energy input ratio and part-load fraction to determine the performance of the unit at part-load conditions (Henderson et al. 1992, ASHRAE 1993). Sensible/latent capacity splits are determined by the rated sensible heat ratio (SHR) and the apparatus dewpoint (ADP)/bypass factor (BF) approach. This approach is analogous to the NTU-effectiveness calculations used for sensible-only heat exchanger calculations, extended to a cooling and dehumidifying coil.

This model simulates the thermal performance of the DX cooling coil and the power consumption of the outdoor condensing unit (compressor, fan, crankcase heater and evap condenser water pump). The total amount of heat rejected by the condenser is also calculated and stored for use by other waste heat recovery models (e.g., Coil:Heating:Desuperheater). The performance of the indoor supply air fan varies widely from system to system depending on control strategy (e.g., constant fan vs.~AUTO fan, constant air volume vs.~variable air volume, etc.), fan type, fan motor efficiency and pressure losses through the air distribution system. Therefore, this DX system model does not account for the thermal effects or electric power consumption of the indoor supply air fan. EnergyPlus contains separate models for simulating the performance of various indoor fan configurations, and these models can be easily linked with the DX system model described here to simulate the entire DX air conditioner being considered (e.g., see AirLoopHVAC:Unitary:Furnace:HeatCool, AirLoopHVAC:UnitaryHeatCool, ZoneHVAC:WindowAirConditioner or AirLoopHVAC:UnitaryHeatPump:AirToAir).

\subsubsection{Model Description}\label{model-description-2-004}

The user must input the total cooling capacity, sensible heat ratio (SHR), coefficient of performance (COP) and the volumetric air flow rate across the cooling coil at rated conditions. The capacity, SHR and COP inputs should be ``gross'' values, excluding any thermal or energy impacts due to the indoor supply air fan. The rated conditions are considered to be air entering the cooling coil at 26.7\(^{\circ}\)C drybulb/19.4\(^{\circ}\)C wetbulb and air entering the outdoor condenser coil at 35\(^{\circ}\)C drybulb/23.9\(^{\circ}\)C wetbulb. The rated volumetric air flow should be between 0.00004027 m\(^{3}\)/s and 0.00006041 m\(^{3}\)/s per watt of rated total cooling capacity (300 -- 450 cfm/ton). The rated volumetric air flow to total cooling capacity ratio for 100\% dedicated outdoor air (DOAS) application DX cooling coils should be between 0.00001677 (m\(^{3}\)/s)/W (125 cfm/ton) and 0.00003355 (m\(^{3}\)/s)/W (250 cfm/ton).

The user must also input five performance curves or performance tables that describe the change in total cooling capacity and efficiency at part-load conditions:

1)~~Total cooling capacity modifier curve or table (function of temperature)

2)~~Total cooling capacity modifier curve or table (function of flow fraction)

3)~~Energy input ratio (EIR) modifier curve or table (function of temperature)

4)~~Energy input ratio (EIR) modifier curve or table (function of flow fraction)

5)~~Part load fraction correlation curve or table (function of part load ratio)

\begin{itemize}
\tightlist
\item
  The total cooling capacity modifier curve (function of temperature) is a curve with two independent variables: wet-bulb temperature of the air entering the cooling coil, and dry-bulb temperature of the air entering the air-cooled condenser coil (wet-bulb temperature if modeling an evaporative-cooled condenser). The output of this curve is multiplied by the rated total cooling capacity to give the total cooling capacity at the specific entering air temperatures at which the DX coil unit is operating (i.e., at temperatures different from the rating point temperatures). This curve is typically a biquadratic but any curve or table with two independent variables can be used.
\end{itemize}

Note: The data used to develop the total cooling capacity modifier curve (function of temperature) should represent performance when the cooling coil is `wet' (i.e., coil providing sensible cooling and at least some dehumidification). Performance data when the cooling coil is `dry' (i.e., not providing any dehumidification) should \textbf{not} be included when developing this modifier curve. This model automatically detects and adjusts for `dry coil' conditions (see section ``Dry Coil Conditions'' below).

\begin{equation}
\text{TotCapTempModFac} = \text{Func}\left(T_{wb,i},T_{c,i}\right)
\label{eq:TotCapTempModFac}
\end{equation}

where:

\({T_{wb,i}}\) are the "x" values or the wet-bulb temperature of the air entering the cooling coil (\(^{\circ}\)C)

\({T_{c,i}}\) are the "y" values or the dry-bulb temperature of the air entering an air-cooled condenser or wet-bulb temperature of the air entering an evaporative-cooled condenser (\(^{\circ}\)C).

\begin{itemize}
\tightlist
\item
 The total cooling capacity modifier curve (function of flow fraction) is a curve with one independent variable being the ratio of the actual air flow rate across the cooling coil to the rated air flow rate (i.e., fraction of full load flow). The output of this curve is multiplied by the rated total cooling capacity and the total cooling capacity modifier curve (function of temperature) to give the total cooling capacity at the specific temperature and air flow conditions at which the DX unit is operating. This curve is typically a quadratic but any curve or table with one independent variable can be used.
\end{itemize}

\begin{equation}
\text{TotCapFlowModFac} = \text{Func}\left(ff\right)
\end{equation}

where:

\begin{equation}
ff = \text{flow fraction} = \left( \frac{\text{Actual air mass flow rate}}{\text{Rated air mass flow rate}} \right) = \text{x value}
\end{equation}

\textbf{Note:}~ The actual volumetric air flow rate through the cooling coil for any simulation time step where the DX unit is operating must be between 0.00002684 m\(^{3}\)/s and .00006713 m\(^{3}\)/s per watt of rated total cooling capacity (200 - 500 cfm/ton). The simulation will issue a warning message if this air flow range is exceeded.

\begin{itemize}
\tightlist
\item
  The energy input ratio (EIR) modifier curve (function of temperature) is a curve with two independent variables: wet-bulb temperature of the air entering the cooling coil, and dry-bulb temperature of the air entering the air-cooled condenser coil (wet-bulb temperature if modeling an evaporative-cooled condenser). The output of this curve is multiplied by the rated EIR (inverse of the rated COP) to give the EIR at the specific entering air temperatures at which the DX coil unit is operating (i.e., at temperatures different from the rating point temperatures). This curve is typically a biquadratic but any curve or table with two independent variables can be used.
\end{itemize}

Note: The data used to develop the energy input ratio (EIR) modifier curve (function of temperature) should represent performance when the cooling coil is `wet' (i.e., coil providing sensible cooling and at least some dehumidification). Performance data when the cooling coil is `dry' (i.e., not providing any dehumidification) should \textbf{not} be included when developing this modifier curve. This model automatically detects and adjusts for `dry coil' conditions (see section ``Dry Coil Conditions'' below).

\begin{equation}
\text{EIRTempModFac} = \text{Func}\left(T_{wb,i},T_{c,i}\right)
\label{eq:CoilEIRTempModFac}
\end{equation}

where

\({T_{wb,i}}\) are the "x" values or the wet-bulb temperature of the air entering the cooling coil (\(^{\circ}\)C)

\({T_{c,i}}\) are the "y" values or the dry-bulb temperature of the air entering an air-cooled condenser or wet-bulb temperature of the air entering an evaporative-cooled condenser (\(^{\circ}\)C).

\begin{itemize}
\tightlist
\item
  The energy input ratio (EIR) modifier curve (function of flow fraction) is a curve with one independent variable being the ratio of the actual air flow rate across the cooling coil to the rated air flow rate (i.e., fraction of full load flow). The output of this curve is multiplied by the rated EIR (inverse of the rated COP) and the EIR modifier curve (function of temperature) to give the EIR at the specific temperature and air flow conditions at which the DX unit is operating. This curve is typically a quadratic but any curve or table with one independent variable can be used.
\end{itemize}

\begin{equation}
\text{EIRFlowModFrac} = \text{Func}\left(ff\right)
\end{equation}

where:

\begin{equation}
ff = \text{flow fraction} = \left( \frac{\text{Actual air mass flow rate}}{\text{Rated air mass flow rate}} \right) = \text{x value}
\end{equation}

\begin{itemize}
\tightlist
\item
  The part load fraction correlation (function of part load ratio) is a curve with one independent variable being part load ratio (sensible cooling load / steady-state sensible cooling capacity). The output of this curve is used in combination with the rated EIR and EIR modifier curves to give the ``effective'' EIR for a given simulation time step. The part load fraction (PLF) correlation accounts for efficiency losses due to compressor cycling. This curve is typically a linear, quadratic, or cubic but any curve or table with one independent variable can be used.
\end{itemize}

\begin{equation}
\text{PartLoadFrac} = \text{PLF} = \text{Func}\left(\text{PLR}\right)
\label{eq:PartLoadFrac}
\end{equation}

where

\begin{equation}
\text{PLR} = \text{part load ratio} = \left(\frac{\text{actual sensible cooling load}}{\text{steady-state sensible cooling load}}\right) = \text{x values}
\end{equation}

The part-load fraction correlation should be normalized to a value of 1.0 when the part load ratio equals 1.0 (i.e., no efficiency losses when the compressor(s) run continuously for the simulation time step). For PLR values between 0 and 1 (0 \textless{} = PLR \textless{} 1), the following rules apply:

\begin{equation}
  \begin{array}{rl}
    \text{PLF} &\geq 0.7 \\
    \text{PLF} &\geq \text{PLR}
  \end{array}
\end{equation}

If PLF \textless{} 0.7 a warning message is issued, the program resets the PLF value to 0.7, and the simulation proceeds. The runtime fraction of the coil is defined as PLR/PLF. If PLF \textless{} PLR, then a warning message is issued and the runtime fraction of the coil is limited to 1.0.

A typical part load fraction correlation for a conventional, single-speed DX cooling coil (e.g., residential or small commercial unit) would be:

\begin{equation}
PLF = 0.85 + 0.15(PLR)
\end{equation}

All five part-load curves are accessed through EnergyPlus' built-in performance curve equation manager (curve: quadratic, curve:cubic and curve:biquadratic). It is not imperative that the user utilize all coefficients shown in Equations~\ref{eq:TotCapTempModFac} through~\ref{eq:PartLoadFrac} if their performance equation has fewer terms (e.g., if the user's PartLoadFrac performance curve is linear instead of quadratic, simply enter the values for a and b, and set coefficient c equal to zero).

For any simulation time step, the total (gross) cooling capacity of the DX unit is calculated as follows:

\begin{equation}
{\dot{Q}_{total}} = {\dot{Q}_{total,rated}}\left( {TotCapTempModFac} \right)\left( {TotCapFlowModFac} \right)
\label{eq:Qdottotal}
\end{equation}

In a similar fashion, the electrical power consumed by the DX unit (compressors plus outdoor condenser fans) for any simulation time step is calculated using the following equation:

\begin{equation}
Power = \left( {{\dot{Q}_{total}}} \right)\left( {EIR} \right)\left( {RTF} \right)
\label{eq:CoilPower-456}
\end{equation}

where:

\(\dot{Q}_{total}\) is the total cooling capacity as shown in Equation~\ref{eq:Qdottotal} (W)

\begin{equation}
EIR = \,Energy\,input\,ratio\, = \,\left( {\frac{1}{{CO{P_{rated}}}}} \right)\left( {EIRTempModFac} \right)\left( {EIRFlowModFac} \right)
\end{equation}

\(CO{P_{rated}}\) is the coefficient of performance at rated conditions (user input)

\begin{equation}
RTF{\rm{ }} = {\rm{ }}\left( {{\raise0.7ex\hbox{{PLR}} \!\mathord{\left/ {\vphantom {{PLR} {PartLoadFrac}}}\right.}\!\lower0.7ex\hbox{{PartLoadFrac}}}} \right)\,\, = \,\,runtime~fraction~of~the~cooling~coil
\end{equation}

The total amount of heat rejected by the condenser is then calculated and stored for use by other waste heat recovery models (e.g., Coil:Heating:Desuperheater).

\begin{equation}
{\dot{Q}_{cond}} = {\dot{Q}_{total}}\left( {1 + EIR} \right)
\end{equation}

where \(\dot{Q}_{cond}\) is the total amount of heat rejected by the condenser (W).

The crankcase heater is assumed to operate when the cooling coil's compressor is OFF and the outdoor dry-bulb temperature is below the maximum outdoor temperature for crankcase heater operation. The average crankcase heater power for the simulation time step is calculated as follows:

\begin{equation}
{P_{crankcase}} = {\mathop Q\limits^ \bullet_{cap,crankcase}}\left( {1 - RTF} \right)
\end{equation}

where:

\({P_{crankcase}}\) is the DX cooling coil crankcase heater power (W)

\(\dot{Q}_{cap,crankcase}\) is the crankcase heater capacity (W).

If this cooling coil is used as part of an air-to-air heat pump (Ref. AirLoopHVAC:UnitaryHeat-Pump:AirToAir), the crankcase heater defined for this DX cooling coil is disregarded and the associated output variable is omitted. Instead, the crankcase heater defined for the DX heating coil (Coil:Heating:DX:SingleSpeed) is enabled during the time that the compressor is not running for either heating or cooling. In this instance, RTF in the above equations would be the runtime fraction of the heat pump's heating coil or cooling coil, whichever is greater.

In addition to calculating the total cooling capacity provided by the DX air conditioner, it is important to properly determine the break down of total cooling capacity into its sensible (temperature) and latent (dehumidification) components. The model computes the sensible/ latent split using the rated SHR and the ADP/BF approach (Carrier et al. 1959). When the DX coil model is initially called during an EnergyPlus simulation, the rated total capacity and rated SHR are used to calculate the coil bypass factor (BF) at rated conditions. The rated total capacity and rated SHR are first used to determine the ratio of change in air humidity ratio to air dry-bulb temperature:

\begin{equation}
SlopeRated = \,\left( {\frac{{{\omega_{in}} - {\omega_{out}}}}{{{T_{db,in}}\, - {T_{db,out}}}}} \right)\mathop {}\limits_{rated}
\end{equation}

where:

\(\omega_{in}\) is the humidity ratio of the air entering the cooling coil at rated conditions (kg/kg)

\(\omega_{out}\) is the humidity ratio of the air leaving the cooling coil at rated conditions (kg/kg)

\(T_{db,in}\) is the dry-bulb temperature of the air entering the cooling coil at rated conditions (\(^{\circ}\)C)

\(T_{db,out}\) is the dry-bulb temperature of the air leaving the cooling coil at rated conditions (\(^{\circ}\)C).

Along with the rated entering air conditions, the algorithm then searches along the saturation curve of the psychrometric chart until the slope of the line between the point on the saturation curve and the inlet air conditions matches \emph{SlopeRated}. Once this point, the apparatus dewpoint, is found on the saturation curve the coil bypass factor at rated conditions is calculated as follows:

\begin{equation}
B{F_{rated}} = \,\frac{{{h_{out,rated}}\,\, - \,{h_{ADP}}}}{{{h_{in,rated}}\,\, - \,{h_{ADP}}}}
\end{equation}

where:

\(h_{out,rated}\) is the enthalpy of the air leaving the cooling coil at rated conditions (J/kg)

\(h_{in,rated}\) is the enthalpy of the air entering the cooling coil at rated conditions (J/kg)

\(h_{ADP}\) is the enthalpy of saturated air at the coil apparatus dewpoint (J/kg).

The coil bypass factor is analogous to the ``ineffectiveness'' (1-\(\varepsilon\)) of a heat exchanger, and can be described in terms of the number of transfer of unit (NTU).

\begin{equation}
BF = \,{e^{ - NTU}}\, = \,\,{e^{ - \,{{\left( {\frac{{UA}}{{cp}}} \right)} \mathord{\left/ {\vphantom {{\left( {\frac{{UA}}{{cp}}} \right)} {\dot m}}} \right. } {\dot m}}}}\, = \,{e^{ - \,\,{{Ao} \mathord{\left/ {\vphantom {{Ao} {\dot m}}} \right. } {\dot m}}}}
\label{eq:CoilBypassFactor}
\end{equation}

For a given coil geometry, the bypass factor is only a function of air mass flow rate. The model calculates the parameter A\(_{o}\) in Equation~\ref{eq:CoilBypassFactor} based on BF\(_{rated}\) and the rated air mass flow rate. With A\(_{o}\) known, the coil BF can be determined for non-rated air flow rates.

For each simulation time step when the DX air conditioner operates to meet a cooling load, the total cooling capacity at the actual operating conditions is calculated using Equation~\ref{eq:Qdottotal} and the coil bypass factor is calculated based on Equation~\ref{eq:CoilBypassFactor}. The coil bypass factor is used to calculate the operating sensible heat ratio (SHR) of the cooling coil using Equations~\ref{eq:CoilhADP} and~\ref{eq:CoilSHR}.

\begin{equation}
{h_{ADP}}\,\, = \,{h_{in}}\, - \,\frac{{({{\mathop Q\limits^ \bullet  }_{total}}\,/\dot m)}}{{1 - BF}}
\label{eq:CoilhADP}
\end{equation}

\begin{equation}
SHR\,\, = \,Min\,\left( {\left( {\frac{{{h_{Tin,wADP}}\, - \,{h_{ADP}}}}{{{h_{in}} - {h_{ADP}}}}} \right),\,\,1} \right)
\label{eq:CoilSHR}
\end{equation}

where:

\({h_{in}}\) is the enthalpy of the air entering the cooling coil (J/kg)

\({h_{ADP}}\) is the enthalpy of air at the apparatus dewpoint condition (J/kg)

\({h_{Tin,wADP}}\) is the enthalpy of air at the entering coil dry-bulb temperature and humidity ratio at ADP (J/kg)

\(\dot m\) is the air mass flow rate (kg/s).

With the SHR for the coil at the current operating conditions, the properties of the air leaving the cooling coil are calculated using the following equations:

\begin{equation}
 h_{out} = h_{in} - \frac{\dot{Q}_{total}\cdot PLR}{\dot{m}}
\label{eq:CoilSHRhout}
\end{equation}

\begin{equation}
{h_{Tin,\omega out}}\, = \,{h_{in}} - \,\left( {1 - SHR} \right)\left( {{h_{in}} - {h_{out}}} \right)
\end{equation}

\begin{equation}
{\omega_{out}}\, = \,PsyWFnTdbH({T_{in}},\,\,{h_{Tin,\omega out}})
\label{eq:CoilSHRomegaout}
\end{equation}

\begin{equation}
{T_{db,out}}\, = \,PsyTdbFnHW({h_{out}},\,\,\,{\omega_{out}})
\label{eq:CoilSHRTdbout}
\end{equation}

where:

\({h_{out}}\) is the enthalpy of the air leaving the cooling coil (J/kg)

\({h_{Tin,\,\omega out}}\) is the enthalpy of air at the entering coil dry-bulb temperature and leaving air humidity ratio (J/kg)

\(\,{\omega_{out}}\) is the leaving air humidity ratio (kg/kg)

\(\,{T_{db,out}}\) is the leaving air dry-bulb temperature (\(^{\circ}\)C

\emph{PsyWFnTdbH} is an EnergyPlus psychrometric function, returns humidity ratio given dry-bulb temperature and enthalpy

\emph{PsyTdbFnHW} is an EnergyPlus psychrometric function, returns dry-bulb temperature given enthalpy and humidity ratio.

\subsubsection{Dry Coil Conditions}\label{dry-coil-conditions}

If the model determines that the cooling coil is dry (\(\omega_{in}\) \textless{} \(\omega_{ADP}\)), then Equations~\ref{eq:Qdottotal} and~\ref{eq:CoilPower-456} are invalid since they are functions of entering wet-bulb temperature. Under dry-coil conditions, coil performance is a function of dry-bulb temperature rather than wet-bulb temperature. In this case, the model recalculates the performance of the DX cooling unit using the calculation procedure described above but with \(\omega_{in\\ =}\) \(\omega_{dry,}\) where \(\omega_{dry}\) is the inlet air humidity ratio at the coil dry-out point (SHR = 1.0).

\subsubsection{SHR Calculation Using User Specified SHR Modifier Curves}\label{shr-calculation-using-user-specified-shr-modifier-curves}

This alternative SHR calculation method is based on user specified \emph{SHR} modifying curves for temperature and flow fractions.~ The modifying curves correct the rated \emph{SHR} value for a given DX cooling coil entering air temperatures and air mass flow fraction.~ These \emph{SHR} modifying curves are optional additional curve inputs to the DX cooling coil objects.~ These two curves are a biquadratic \emph{SHR} modifier curve for temperature (\emph{SHRFT}), and a quadratic \emph{SHR} correction curve for flow fraction (\emph{SHRFFF}).

\begin{itemize}
\item Biquadratic \emph{SHR} modifier normalized curve for DX cooling coil entering air (outdoor) wet-bulb and dry-bulb temperatures. The coil entering conditions can be outdoor air or pretreated outdoor air.
\item Quadratic SHR modifier curve for flow fraction.
\end{itemize}

The SHR is given by:

\begin{equation}
SHR = SH{R_{rated}} \cdot SHRFT\left( {{T_{wb,i}},{T_{db,i}}} \right) \cdot SHRFFF\left( {FF} \right)
\end{equation}

The cooing coil outlet air enthalpy is given by:

\begin{equation}
{h_{out}} = {h_{in}} - \frac{{{{\dot Q}_{total}}}}{{\dot m}}
\end{equation}

The cooling coil outlet air enthalpy at the coil enlet air temperature and coil outlet humidity ratio is given by:

\begin{equation}
{h_{{T_{in}}{\omega_{out}}}} = {h_{in}} - \left( {1.0 - SHR} \right)\frac{{{{\dot Q}_{total}}}}{{\dot m}}
\end{equation}

The DX cooling coil outlet air humidity ratio is calculated from the psychometric function as follows:

\begin{equation}
{\omega_{out}} = PsyWFnTdbH\left( {{T_{db,\,i}},{h_{{T_{in}}{\omega_{out}}}}} \right)
\end{equation}

The DX cooling coils leaving humidity ratio cannot exceed the DX coil entering air humidity ratio. And for dry air condition entering the cooling coil, the above equation may yield unrealistic (in some cases negative values) coil outlet humidity ratio.~ In this case the coil outlet air humidity is set a small value as follows:

\begin{equation}
{\omega_{out}} = MIN\left( {0.000010,{\omega_{in}}} \right)
\end{equation}

The DX cooling coil outlet air dry-bulb temperature is determined as follows:

\begin{equation}
{T_{db,out}} = PsyTdbFnHW\left( {{h_{out}},{\omega_{out}}} \right)
\end{equation}

where:

\(SHRFT\) is the sensible heat ratio modifier normalized biquadratic curve as a function of coil entering air wet-bulb and dry-bulb temperatures, (-). The DX cooling coil entering air temperature can be the outdoor air condition or pretreated outdoor air when the DX cooling coil is placed after an exhaust heat recovery heat exchangers.

\(SHRFFF\) is the sensible heat ratio modifier normalized quadratic curve as a function of air mass flow fraction.~ Flow fraction is the ratio of actual to rated mass flow rate of air through the DX cooling coil (-).

\(SH{R_{rated}}\) is the sensible heat ratio at rated condition (-).

\subsubsection{Condenser Options: AirCooled vs.~EvaporativelyCooled}\label{condenser-options-aircooled-vs.evaporativelycooled}

As described previously, this model can simulate the performance of air-cooled or evaporative-cooled DX air conditioners. The following paragraphs describe three modeling options.

If the user wants to model an air-cooled condenser, they should simply specify AirCooled in the field Condenser Type. In this case, the Total Cooling Capacity Modifier Curve (function of temperature) and the Energy Input Ratio Modifier Curve (function of temperature) (Equations~\ref{eq:TotCapTempModFac} and~\ref{eq:CoilEIRTempModFac} above) will utilize the outdoor dry-bulb temperature.

If the user wishes to model an evaporatively-cooled condenser AND they have performance curves that are a function of the wet-bulb temperature of air entering the condenser coil, then the user should specify Condenser Type = EvaporativlyCooled and the evaporative condenser effectiveness value should be entered as 1.0. In this case, the Total Cooling Capacity Modifier Curve (function of temperature) and the Energy Input Ratio Modifier Curve (function of temperature) (Equations~\ref{eq:TotCapTempModFac} and~\ref{eq:CoilEIRTempModFac} above) will utilize the outdoor wet-bulb temperature.

If the user wishes to model an air-cooled condenser that has evaporative media placed in front of it to cool the air entering the condenser coil, then the user should specify Condenser Type = EvaporativelyCooled. The user must also enter the appropriate evaporative effectiveness for the media. In this case, the Total Cooling Capacity Modifier Curve (function of temperature) and the Energy Input Ratio Modifier Curve (function of temperature) will utilize the condenser inlet air temperature as calculated below:

\begin{equation}
{T_{c,i}} = \,\left( {{T_{wb,o}}} \right)\,\, + \,\,\left( {1 - EvapCondEffectiveness} \right)\left( {{T_{db,o}}\,\, - {T_{wb,o}}} \right)
\end{equation}

where

\(T_{c,i}\) is the temperature of the air entering the condenser coil (\(^{\circ}\)C)

\(T_{wb,o}\) is the wet-bulb temperature of the outdoor air (\(^{\circ}\)C)

\(T_{db,o}\) is the dry-bulb temperature of the outdoor air (\(^{\circ}\)C).

In this case, the Total Cooling Capacity Modifier Curve (function of temperature) and the Energy Input Ratio Modifier Curve (function of temperature) input fields for this object should reference performance curves that are a function of outdoor dry-bulb temperature. Be aware that the evaporative media will significantly reduce the dry-bulb temperature of the air entering the condenser coil, so the Total Cooling Capacity and EIR Modifier Curves must be valid for the expected range of dry-bulb temperatures that will be entering the condenser coil.

If an evaporatively-cooled condenser is modeled, the power requirements for the water pump are calculated as follows:

\begin{equation}
{P_{evapcondpump}} = {\dot{Q}_{cap,evapcondpump}}\left( {RTF} \right)
\end{equation}

where:

\({P_{evapcondpump}}\) is the DX cooling coil evap condenser pump electric power (W)

\({\dot{Q}_{cap,evapcondpump}}\) is the evaporative condenser pump rated power consumption (W).

Water consumption for the evaporative-cooled condenser is calculated using the difference in air humidity level across the evaporative media and the condenser air mass flow rate:

\begin{equation}
{V_{water}} = \frac{{{{\mathop m\limits^ \bullet  }_{_{air}}}\left( {{\omega_{evapcond,out}} - {\omega_{evapcond,in}}} \right)}}{{{\rho_{water}}}}\left( {RTF} \right)\left( {TimeStepSys} \right)\left( {3600.} \right)\,
\end{equation}

where:

\({V_{water}}\) is the DX cooling coil evap condenser water consumption (m\(^{3}\))

\({\dot{m}_{air}}\) is the evaporative condenser air mass flow rate (kg/s)

\({\omega_{evapcond,in}}\) is the humidity ratio of outdoor air entering the evap condenser (kg/kg)

\({\omega_{evapcond,out}}\) is the humidity ratio of air leaving the evap condenser (kg/kg)

\({\rho_{water}}\) is the density of water at the outdoor dry-bulb temperature (kg/m\(^{3}\))

\emph{TimeStepSys} is the HVAC system simulation time step (hr).

\subsubsection{Condenser Inlet Air Temperature}\label{condenser-inlet-air-temperature}

The air temperature entering the outdoor condenser is based on the weather data used during a simulation. This temperature is either taken directly from the weather data, or can be adjusted based on the height of the outdoor condenser. The input for Condenser Air Inlet Node Name can be used to control this optional feature. If this input is left blank, the air temperature entering the condenser is based solely on the weather data. If this input is not blank, then the node name specified must also be listed in an OutdoorAir:Node or OutdoorAir:NodeList object. When the node name is listed in an OutdoorAir:NodeList object, the air temperature entering the condenser is based solely on the weather data. When the node name is listed in an OutdoorAir:Node object, the height of the node determines the air temperature entering the outdoor condenser (see description of Local Outdoor Air Temperature Calculation in the Atmospheric Variation section of this document for further details).

\subsubsection{Supply Air Fan Control: Cycling vs.~Continuous}\label{supply-air-fan-control-cycling-vs.continuous}

The DX cooling coil model simulates two specific supply air fan operation modes: cycling fan, cycling compressor or continuous fan, cycling compressor. The first operation mode is frequently referred to as ``AUTO fan'', where the compressor(s) and supply air fan operate in unison to meet the zone cooling load, and cycle off together when the cooling load has been met. The second operation mode is often referred to as ``fan ON'', where the compressor(s) cycle on and off to meet the zone cooling load but the supply air fan operates continuously regardless of compressor operation.

Since this DX heating coil can only be used in conjunction with a DX cooling coil (i.e.~heat pumps), and these coils are used in AC equipment that specifies a fan operation mode schedule (e.g AirLoopHVAC:UnitaryHeatPump:AirToAir), the fan operation mode schedule value determines the fan operation mode for each time step throughout the simulation. A fan operation mode schedule value of 0 specifies AUTO fan mode operation while values other than 0 (a 1 is usually used) specify fan ON operation. The use of a schedule allows the fan operation mode to change based on time-of-day or with changes in season.

The EnergyPlus methodology for determining the impact that HVAC equipment has on an air stream is to calculate the mass flow rate and air properties (e.g., enthalpy, dry-bulb temperature, humidity ratio) exiting the equipment. These exiting conditions are passed along as inlet conditions to the next component model in the air stream. Eventually the flow rate and properties of the air being supplied to the conditioned zone are used in the zone energy balance to determine the resulting zone air temperature and humidity ratio. With this methodology, the determination of the air mass flow rate and air properties for the two different supply air fan operation modes is slightly different.

Cycling Fan Mode:

For the case of cycling fan/cycling compressor when humidity control is not specified, the conditions of the air leaving the cooling coil are the steady-state values calculated using Equations~\ref{eq:CoilSHRhout},~\ref{eq:CoilSHRomegaout}, and~\ref{eq:CoilSHRTdbout} above. However the air mass flow rate passed along to the next component (and eventually to the conditioned zone) is the average air mass flow rate for the system simulation time step (determined by the cooling system; see ZoneHVAC:WindowAirConditioner, AirLoopHVAC:Unitary:Furnace:HeatCool, AirLoopHVAC:UnitaryHeatCool, or AirLoopHVAC:UnitaryHeatPump:AirToAir).

For the case of cycling fan/cyling compressor when humidity control is specified, the conditions of the air leaving the cooling coil are calculated as the average conditions during the fan operating period. When the compressor operates in tandem with the fan (i.e., compressor part-load ratio {[}PLR{]} is equal to the fan PLR), the outlet conditions are identical to the calculations described above. When the compressor operates for a shorter duration than the fan (i.e., the compressor PLR is less than the heating/fan PLR), the air properties leaving the cooling coil are calculated as the average conditions during the fan operating period. In this case the calculation of exiting air conditions is analogous to the calculations for continuous fan mode described below except that PLR in the equations represents the ratio of the compressor to the fan operating period. For cycling fan systems, the fan will only operate longer than the compressor, and therefore latent degradation may be modeled (user input), when humidity control is specified, a moisture load exists (i.e., the zone air humidistat senses a moisture load), and a heating load exists where the heating PLR is greater than the cooling PLR.

Continuous Fan Mode:

For the case of continuous fan/cycling compressor, the air mass flow rate is constant. However, the air properties leaving the cooling coil are calculated as the average conditions during the system simulation time step. The model assumes that the exiting air conditions are the steady-state values calculated using Equations~\ref{eq:CoilSHRhout},~\ref{eq:CoilSHRomegaout}, and~\ref{eq:CoilSHRTdbout} above when the compressor(s) operate.~ For the remainder of the system simulation time step, it is assumed that the air exiting the DX coil has the same properties as the air entering the coil. For this supply air fan operating strategy, the leaving air properties are calculated as follows:

\begin{equation}
{h_{out,ContFanCycComp}}\, = \,{h_{out}}\,\left( {PLR} \right) + \,{h_{in}}\,\,\left( {1 - PLR} \right)
\label{eq:CoilhoutContFanCycComp}
\end{equation}

\begin{equation}
{\omega_{out,ContFanCycComp}}\, = \,{\omega_{out}}\,\left( {PLR} \right) + \,{\omega_{in}}\,\,\left( {1 - PLR} \right)
\end{equation}

\begin{equation}
{T_{db,out,ContFanCycComp}} = \,PsyTdbFnHW({h_{out,\,ContFanCycComp}}\,,\,\,\,\,\,{\omega_{out,ContFanCycComp}})
\label{eq:CoilTdboutContFanCycComp}
\end{equation}

\subsubsection{Latent Capacity Degradation}\label{latent-capacity-degradation}

The latent (dehumidification) capacity of a direct-expansion (DX) cooling coil is strongly affected by part-load, or cyclic, operation. This is especially true in applications where the supply air fan operates continuously while the cooling coil cycles on and off to meet the cooling load. During constant fan operation, moisture condenses on the cooling coil when the compressor operates, but part or all of the moisture that is held by the coil evaporates back into the airstream when the cooling coil is deactivated (Figure~\ref{fig:transient-sensible-and-latent-capacity-of-a}). The net effect is that the amount of moisture removed from the air is degraded at part-load conditions as compared to steady-state conditions when the compressor operates continuously (Figure~\ref{fig:field-data-showing-the-net-impact-of-part}).

EnergyPlus is able to model latent capacity degradation based on algorithms developed by Henderson and Rengarajan (1996). The model is applicable to single-stage cooling units, like residential and small commercial air conditioners or heat pumps with less than 19 kW of nominal cooling capacity. The model inputs are described in the EnergyPlus Input/Output Reference for the object Coil:Cooling:DX:SingleSpeed. The model is enabled only if the four numerical inputs are defined (values greater than zero, see IO Reference).

The following discussion applies to both cycling fan and continuous fan operation when the fan operates for a longer period of time than the compressor and air continues to flow over the moisture laden cooling coil after compressor operation has terminated.

\begin{figure}[hbtp] % fig 168
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image3484.png}
\caption{Transient Sensible and Latent Capacity of a Cooling Coil Over an Operating Cycle \protect \label{fig:transient-sensible-and-latent-capacity-of-a}}
\end{figure}

\begin{figure}[hbtp] % fig 169
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image3485.png}
\caption{Field Data Showing the Net Impact of Part-Load Operation on Sensible Heat Ratio \protect \label{fig:field-data-showing-the-net-impact-of-part}}
\end{figure}

\begin{figure}[hbtp] % fig 170
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image3486.png}
\caption{Concepts of Moisture Buildup and Evaporation \protect \label{fig:concepts-of-moisture-buildup-and-evaporation}}
\end{figure}

Figure~\ref{fig:concepts-of-moisture-buildup-and-evaporation} graphically depicts the latent degradation concepts and defines several key model parameters. After the cooling coil starts to operate, the coil temperature is eventually reduced below the dewpoint temperature of the entering air. Moisture from the air then builds on the surface of the coil until time t\(_{o}\) has elapsed and the total moisture mass on the coil is M\(_{o}\). After this time (t\(_{o}\)), moisture begins to fall from the coil and all of the latent capacity provided by the coil is ``useful'' since this condensate is collected and removed from the unit. When the coil cycles off and the supply air fan continues to operate, the initial moisture mass buildup on the coil (M\(_{o}\)) evaporates back into the supply air stream. If the cooling coil cycles back on before all of the moisture has evaporated, then the time until the first condensate removal (t\(_{o}\)) is shorter for this cooling cycle since the coil is already partially wetted.

Figure~\ref{fig:concepts-of-moisture-buildup-and-evaporation} also shows several parameters that are used in the latent degradation model. The ratio of the coil's moisture holding capacity (M\(_{o}\)) and the steady-state latent capacity (\({\dot{Q}_{L}}\)) is defined as \(t_{wet}\): the nominal time for moisture to fall from the coil (ignoring transient effects at startup and starting with a dry coil). The ratio of the initial moisture evaporation rate (\({\dot{Q}_{e}}\)) and the steady-state latent capacity (\({\dot{Q}_{L}}\)) is defined as \(\gamma\). Both \(t_{wet}\) and \(\gamma\) at the rated air volume flow rate and temperature conditions are required model inputs. Two other model inputs are the Maximum ON/OFF Cycling Rate (cycles per hour, \(N_{max}\)) and the time constant (\(\tau\), in seconds) for the cooling coil's latent capacity to reach steady state after startup. The development of the latent degradation model is fully described by Henderson and Rengarajan (1996). The model implemented in EnergyPlus is for their ``linear decay'' evaporation model.

During the simulation, all of the steady-state calculations described previously in Equations~\ref{eq:TotCapTempModFac} through~\ref{eq:CoilSHR} are completed. The latent degradation model then modifies the steady-state sensible heat ratio for the coil as shown below. The value of \(t_{wet}\) at the current air volume flow rate and entering air conditions is first calculated based on the rated value of \(t_{wet}\) entered by the user:

\begin{equation}
{t_{wet}} = Minimum\left( {{t_{wet,rated}}\left( {\frac{{{{\mathop Q\limits^ \bullet  }_{latent,rated}}}}{{{{\mathop Q\limits^ \bullet  }_{latent}}}}} \right),\,\,{t_{wet,\max }}} \right)
\end{equation}

where:

\(t_{wet}\) is the nominal time for condensate removal to begin at the current airflow and entering air conditions, starting with a dry coil (sec)

\(t_{wet,rated}\) is the nominal time for condensate removal to begin at the coil's rated airflow and entering air conditions, starting with a dry coil (sec)

\({\dot{Q}_{latent,rated}}\) is the cooling coil latent capacity at the rated airflow and temperature conditions (W)

\({\dot{Q}_{latent}}\) is the cooling coil latent capacity at the current airflow and temperature conditions (W)

\(t_{wet,max}\) is the maximum allowed value for \(t_{wet}\) (9999.0 sec).

Likewise, the value of \(\gamma\) at the current air volume flow rate and entering air conditions is calculated based on the rated value of \(\gamma\) entered by the user:

\begin{equation}
  \gamma = {\gamma_{rated}}\left( {\frac{{{{\mathop Q\limits^ \bullet  }_{latent,rated}}}}{{{{\mathop Q\limits^ \bullet  }_{latent}}}}} \right)\left( {\frac{{{T_{db,i}} - {T_{wb,i}}}}{{{T_{db,rated}} - {T_{wb,rated}}}}} \right)
\end{equation}

where:

\(\gamma\) is the ratio of the initial moisture evaporation rate from the cooling coil (when the compressor first turns off, in Watts) and the coil's steady-state latent capacity (Watts) at the current air volume flow rate and entering air conditions

\({\gamma_{rated}}\) is equal to \(\gamma\) at the rated air flow and entering air conditions

\(T_{db,i}\) is the dry-bulb temperature of the air entering the cooling coil (\(^{\circ}\)C)

\(T_{wb,i}\) is the wet-bulb temperature of the air entering the cooling coil (\(^{\circ}\)C)

\(T_{db,rated}\) is the dry-bulb temperature of air entering the cooling coil at rated conditions (26.7\(^{\circ}\)C)

\(T_{wb,rated}\) is the wet-bulb temperature of air entering the cooing coil at rated conditions (19.4\(^{\circ}\)C).

The cooling coil on and off times are then calculated based on the maximum number of cycles per hour and the calculated run-time fraction for the coil.

\begin{equation}
{t_{on}} = \frac{{3600}}{{4{N_{\max }}\left( {1 - X} \right)}}
\end{equation}

\begin{equation}
{t_{off}} = \frac{{3600}}{{4{N_{max}}X}}
\end{equation}

where:

\(t_{on}\) is the duration of cooling coil on-cycle (sec)

\(N_{max}\) is the maximum on/off cycles per hour (cph)

\emph{X} is the cooling coil runtime fraction (-)

\(t_{off}\) is the duration of cooling coil off-cycle (sec).

For cycling fan systems, the duration of the heating coil on and off cycles are also calculated. When the heating coil operates for a longer duration of time than the cooling coil, latent degradation can also occur. For this case, the off-cycle time (i.e., the amount of time the fan operates longer than the cooling coil) is recalculated and based on the difference between the heating coil on-cycle time and the cooling coil on-cycle time. Ton and Toff for the heating coil are calculated in the same manner as shown above except that the heating run-time fraction is used for the calculations. This model assumes that the cycling rate of the cooling and heating coils are the same. In addition, since the heating coil cycling rate may be different than the cooling coil (based on run-time fractions), the heating coil may also turn on again before the next cooling coil on-cycle. The following equations are used when the heating coil operates for a longer time period than does the cooling coil.

\begin{equation}
t_{on,heating} = \frac{{3600}}{{4N_{max}\left( {1 - X_{heating}} \right)}}
\end{equation}

\begin{equation}
t_{off,heating} = \frac{{3600}}{{4N_{max}\left( {X_{heating}} \right)}}
\end{equation}

{\scriptsize
\begin{equation}
t_{on,heating} = t_{on,heating} + MAX\left( {0,MIN\left( {t_{on,heating},\left( {\left( {t_{on} + t_{off}} \right) - \left( {t_{on,heating} + t_{off,heating}} \right)} \right)} \right)} \right)
\end{equation}}

\begin{equation}
t_{off} = MIN\left( {t_{off},t_{on,heating} - t_{on}} \right)
\end{equation}

where:

\(t_{on,heating}\) is the duration of heating coil on-cycle (sec)

\(X_{,heating}\) is the heating coil runtime fraction (-)

\(t_{off,heating}\) is the duration of heating coil off-cycle (sec).

The equation for calculating the time \(t_{o}\) when moisture first begins to fall from the cooling coil is shown below, and is solved iteratively by EnergyPlus:

\begin{equation}
\mathop t\nolimits_o^{j + 1}  = \gamma {t_{off}} - \left( {\frac{{\mathop \gamma \nolimits^2 }}{{4{t_{wet}}}}} \right)\mathop t\nolimits_{off}^2  - \tau \left( {\mathop e\nolimits^{\frac{{\mathop t\nolimits_o^j }}{\tau }} \,\, - \,\,1} \right)\,\,,\,\,\,\mathop t\nolimits_{off}^{}  \le \,\left( {\frac{{2{t_{wet}}}}{\gamma }} \right)
\end{equation}

where:

\({t_o}\) is the time where condensate removal begins (sec)

\(\tau\) is the latent capacity time constant at start-up (sec)

\emph{j} is the iteration number.

The part-load latent heat ratio of the cooling coil is then calculated with \(t_o\) , \emph{t\(_{on}\)} and \(\tau\), which is in turn used to calculate the ``effective'' sensible heat ratio of the cooling including part-load latent degradation effects.

\begin{equation}
\frac{{LHR}}{{LH{R_{ss}}}} = Maximum\left( {\left( {\frac{{{t_{on}} - {t_o}}}{{{t_{on}} + \tau \left( {{e^{\left( {\frac{{ - {t_{on}}}}{\tau }} \right)}}\,\, - \,\,1} \right)}}} \right),0.0} \right)
\end{equation}

\begin{equation}
SH{R_{eff}} = 1 - \left( {1 - SH{R_{ss}}} \right)\left( {\frac{{LHR}}{{LH{R_{ss}}}}} \right)
\end{equation}

where:

\(LHR\) is the part-load latent heat ratio

\(LH{R_{ss}}\) is the latent heat ratio at steady-state conditions (\(1 - SH{R_{ss}}\) with \(SH{R_{ss}}\) from Equation~\ref{eq:CoilSHR})

\(SH{R_{eff}}\) is the part-load sensible heat ratio (\(SH{R_{ss}}\) ≤ \(SH{R_{eff}}\) ≤ 1.0)

\(SH{R_{ss}}\) is the steady-state sensible heat ratio (from Equation~\ref{eq:CoilSHR}).

With the ``effective'' SHR for the coil at the current operating conditions, including the impacts of latent degradation, Equations~\ref{eq:CoilSHRhout} through~\ref{eq:CoilSHRTdbout} are then used to calculate the properties of the air leaving the cooling coil when it operates. Finally, Equations~\ref{eq:CoilhoutContFanCycComp} through~\ref{eq:CoilTdboutContFanCycComp} are used to calculate the average leaving air conditions (average when the coil is on and off) for the simulation time step.

\subsubsection{Basin Heater For Single-Speed DX Coil}\label{basin-heater-for-single-speed-dx-coil}

Calculations are also made to estimate the electric power input to the DX coil basin heater. A schedule may be used to disable the basin heater during regular maintenance periods or other time periods (e.g., during summer). If a schedule is not provided, the basin heater is assumed to be available the entire simulation time period. The basin heater operates when it is scheduled on, the outdoor air dry-bulb temperature is below the basin heater setpoint temperature, and the DX coil is not active. The user is required to enter a basin heater capacity (watts per degree Kelvin) and a heater setpoint temperature (\(^{o}\)C) if they want to model basin heater electric power.

\begin{equation}
 P_{basinheater} = \max\PB{0.0, CAP_{basinheater} \PB{T_{setpoint,basin} - T_{db,outdoor} }\PB{1 - RTF}}
\end{equation}

\begin{equation}
  \mathop E\nolimits_{basinheater} = \mathop {(P}\nolimits_{basinheater} )(TimeStepSys)3600
\end{equation}

where:

\(\mathop P\nolimits_{basinheater}\) is the DX coil basin heater electric power (W)

\(\mathop E\nolimits_{basinheater}\) is the DX coil basin heater electric consumption (J)

\(\mathop T\nolimits_{setpoint,basin}\) is the basin heater setpoint temperature (\(^{\circ}\)C)

\(\mathop T\nolimits_{db,outdoor}\) is the outdoor air dry-bulb temperature (\(^{\circ}\)C)

\(\mathop {CAP}\nolimits_{basinheater}\) is the basin heater capacity (W/K)

\(RTF\) is the run time fraction of DX cooling coil.

\subsubsection{Special Calculations for Coil:Cooling:DX:TwoStageWithHumidityControlMode with CoilPerformance:DX:Cooling}\label{special-calculations-for-coilcoolingdxtwostagewithhumiditycontrolmode-with-coilperformancedxcooling}

The multimode DX coil uses 1 to 4 set of performance specifications which all feed into the main DX coil model as described above. The multimode DX coil may have 1 or 2 capacity stages and may have 1 enhanced dehumidification mode in addition to its ``normal'' or base mode performance. Any mode may specify that a portion of the total airflow is bypassed.

\paragraph{Bypass Operation}\label{bypass-operation}

When a mode has coil bypass, the non-bypassed air flow fraction is used to model the DX coil performance as described above. Then the bypassed air stream is mixed with the conditioned air stream and these conditions are place on the coil outlet node.

\paragraph{Multi-Stage Operation}\label{multi-stage-operation}

Multi-stage control is modeled with the DX coil. If 2-stage operation has been specified, stage 1 is assumed to operate first and continue to operate if stage 2 is required. If latent degradation is active, only one of the stages will be degraded. If stage 1 operates for less than the full time step, then latent degradation is applied. If stage 2 operates, then stage 1 is running for the full time step and latent degradation is applied only to the portion of the latent load which is attributed to stage 2 operation.

\paragraph{Enhanced Dehumidification Mode}\label{enhanced-dehumidification-mode}

If enhanced dehumidification mode is available, this is controlled by the parent object of the DX coil, such as DXSystem:AirLoop. A dehumidification mode flag is passed to the coil model which is used to select a different set of performance specifications from a CoilPerformance:DX:Cooling input object. Then the simulation of the DX coil proceeds as described above including any bypass or multi-stage operation.

\paragraph{Subcool Reheat Mode}\label{subcool-reheat-mode}

When 3 operation modes are entered in the Coil:Cooling:DX:CurveFit:Performance object with a parent as Coil:Cooling:DX, the coil is considered as a Subcool Reheat Coil and can perfom normal DX coil operation alone, and combined sensible cooling and dehumidification simultaneously with combination of normal mode and subcool or reheat mode. Load sensible heat ratio (LoadSHR) ( Zone Sensible Load / ( Zone Sensible Load + Zone Latent Load)) determines which mode operates.

The zone sensible and latent loads determine the coil delivered energy between system supply node and controlled zone node. Due to fan heat and outdoor air introduction, the coil inlet node conditions are not equal to ones at the controlled zone node. In other words, the requested coil output sensible heat ratio (CoilSHR) (Sensible Coil output / (Sensible Coil Output + Latent Coile Output)) will be different from LoadSHR. The given LoadSHR needs to be converted into coil sensible heat ratio (CoilSHR), so that coil requested sensible and latent energy can be delivered correctly to control zone temperature and humidity ratio simultaneously.

CoilSHR calculation procedure

1. Get full system sensible and latent outputs in normal mode as SenSysOutput and LatSysOutput.

2. Since system outputs are proportional to part load ratio (PLR), sensible (SenPLR) and latent (LatPLR) part load ratios can be calculated below

	SenPLR = SenLoad / SenSysOutput

	LatPLR = LatLoad / LatSysOutput

3. At the same time, coil sensible and latent outputs across the coil are obtained in Step 2 as SenCoilOutput and LatCoilOutput.

4. If coil sensible and latent outputs are also propotional to the part load ratios, sensible (SenCoil) and latent (LatCoil) coil load at given part load ratios are calculated as

	SenCoil = SenPLR * SenCoilOutput

	LatCoil = LatPLR * LatCoilOutput

It should be pointed out that coil outputs at PLR = 0 are zero.  In other words, both linear functions has zero value of the constant term.

5. Coil sensible heat ratio (CoilSHR) can be calculated as

	CoilSHR = SenCoil / (SenCoil + LatCoil)

After getting CoilSHR, coil performance can be calculated as follows

Simulation logic

1. No latent control

   Perform normal operation with SHR\(_{Normal}\) (See Coil:Cooling:DX:SingleSpeed object)

2. Latent control

a.  If CoilSHR >= SHR\(_{Normal}\)

   Perform normal operation to meet sensible load, adjusted by PLR for a single capacity equipment

	SenLoad = SenOut * PLR

b.  Else if SHR\(_{Normal}\) > CoilSHR And CoilSHR >= SHR\(_{Sub}\)

   Perform combination between normal and subcooling operation

  CoilSHR = SHR\(_{Sub}\) * r\(_{Sub}\) + SHR\(_{Normal}\) * (1 - r\(_{Sub})\)

  SenLoad = [SenOut\(_{Sub}\) * r\(_{Sub}\) + SenOut\(_{Normal}\) * (1 - r\(_{Sub}\))] * PLR

c.  Else if SHR\(_{Sub}\) > CoilSHR And CoilSHR >= SHR\(_{Reheat}\)

   Perform combination between normal and reheat operation

  CoilSHR = SHR\(_{Reheat}\) * r\(_{Reheat}\) + SHR\(_{Normal}\) * (1 - r\(_{Sub}\))

  SenLoad = [SenOut\(_{Sub}\) * r\(_{Sub}\) + SenOut\(_{Normal}\) * (1 - r\(_{Sub}\))] * PLR

Else

    Performreheatg operation

    SenLoad = SenOut\(_{Reheat}\) * PLR

End If

where
 
\(SHR_{Normal}\) = Gross sensible heat ratio in normal mode

\(SHR_{Subl}\) = Gross sensible heat ratio in subcool mode

\(SHR_{Reheatl}\) = Gross sensible heat ratio in reheat mode

\(r_{Sub}\) = Subcooling mode ratio between subcooling and normal operation

\(r_{Reheat}\) = Reheat mode ratio between hot gas reheat and normal operation

\subsubsection{Standard Rating of Single-Speed DX Cooling Coils}\label{standard-rating-of-single-speed-dx-cooling-coils}

For small single-speed direct expansion (DX) cooling coils, the industry standard ratings of Standard Rating Cooling Capacity and Seasonal Energy Efficiency Ratio (SEER) are calculated according to ANSI/AHRI Standard 210/240 (AHRI 2008). These ratings apply to unitary air conditioners and air-source unitary heat pumps with air-cooled condensers with standard rating cooling capacities under 19 kW (\textless{}65,000 Btu/hr). For larger DX cooling coils, the industry standard ratings of Standard Rating Cooling Capacity, Energy Efficiency Ratio (EER), and Integrated Energy Efficiency Ratio (IEER) are calculated according to ANSI/AHRI Standard 340/360 (AHRI 2007). These ratings apply to unitary air conditioners and air-source unitary heat pumps with standard rating cooling capacities from 19 kW to below 73.2 kW (65,000 Btu/hr to \textless{}250,000 Btu/hr).

For the Coil:Cooling:DX:SingleSpeed object in EnergyPlus, these standard ratings are not direct inputs to the model. However, these standard ratings can be calculated using user-entered information for the Coil:Cooling:DX:SingleSpeed object. Since users sometimes lump the performance of several smaller DX cooling units into a single larger cooling coil object for simulation purposes, EnergyPlus outputs the Standard Rating Cooling Capacity, SEER, EER, and IEER regardless of the magnitude of the standard rating cooling capacity of the coil. It is up to the user to determine which standard ratings are applicable to the cooling coil(s) they are modeling. These standard rating values are provided in the eplusout.eio output file (Ref. OutputDetailsAndExamples.pdf) and also in the predefined tabular output reports (Output:Table:SummaryReports object, Equipment Summary). Currently, the standard ratings are only calculated and output for single-speed DX cooling coils with air-cooled condensers. If the single-speed DX coling coil is specified with an evaporatively-cooled condenser, then no standard ratings are output from EnergyPlus at this time.

Note: The standard ratings described in this section require that the DX cooling coil model be evaluated at specific operating conditions (i.e., specific wet-bulb temperatures for air entering the cooling coil and dry-bulb temperatures for air entering the air-cooled {[}outdoor{]} condenser). If the cooling coil performance curves can not be evaluated at the required test conditions, then a standard rating value calculated at the curves limit will be output and a warning message will written to eplusout.err. For example, if the curve object (Curve:Biquadratic) for Total Cooling Capacity Function of Temperature Curve has a minimum value of 21\(^{\circ}\)C for dry-bulb temperature entering the air-cooled condenser coil, the IEER calculation requires that EER\(_{D}\) be calculated at 18.3\(^{\circ}\)C -- so, this would result in IEER calculatd at user specified curve limit as an output and a warning message in the eplusout.err file.

The standard rating cooling capacity (AHRI 2007, AHRI 2008) is calculated as follows:

\begin{equation}
\begin{array}{rl}
\dot{Q}_{StandardRating} =& \dot{Q}_{Total,Rated}\PB{TotCapTempModFac_{Rated}}\PB{TotCapFlowModFac_{Rated}} \\
 & - \PB{FanPowerPerVolFlowRate \cdot \dot{V}_{Rated}}
\end{array}
\end{equation}

where:

\({\dot Q_{StandardRating}}\) is the standard Rating (Net) Cooling Capacity (W)

\({\dot Q_{Total,Rated}}\) is the rated Total (Gross) Cooling Capacity, user input (W)

\(TotCapTempModFa{c_{Rated}}\) is the total Cooling Capacity Function of Temperature Curve evaluated with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil and 35.0\(^{\circ}\)C dry-bulb temperature air entering the air-cooled (outdoor) condenser (dimensionless)

\(TotCapFlowModFa{c_{Rated}}\) is the total Cooling Capacity Function of Flow Fraction Curve evaluated at a flow fraction of 1.0 (dimensionless)

\(FanPowerPerVolFlowRate\) is the rated Evaporator Fan Power Per Volume Flow Rate, user input (W/(m\(^{3}\)/s))

\({\dot V_{Rated}}\) is the rated Air Volume Flow Rate, user input (m\(^{3}\)/s).

The Rated Evaporator Fan Power Per Volume Flow rate is a user-entered value, with a default of 773.3 W/(m\(^{3}\)/s)) if the user leaves this input field blank. The default value is taken from ANSI/AHRI Standards 210/240 and 340/360 where it is defined for systems which do not have a cooling coil fan furnished as part of the system (e.g., a DX cooling coil mounted in the ductwork downstream of a gas furnace where the furnace contains the fan used for air distribution across the gas heating coil and the downstream DX cooling coil). The test conditions in ANSI/AHRI Standards 210/240 and 340/360 vary the external static pressure (i.e., pressure drop associated with ductwork and other devices external to the indoor fan/coil section) seen by the supply air fan based on the standard rating cooling capacity. Note, however, that external static pressure in actual installations is typically much higher. Further details regarding indoor fan power per volume flow rate can be found in Walker and Lutz (2005) and Walker (2007), including differences between Permanent Split Capacitor (PSC) and Brushless Permanent Magnet (BPM) fan motors. Especially at the low external static pressures defined in the ANSI/AHRI Standards, BPM motors (e.g., Electronically Commutated Motors (ECMs)) can draw significantly less power (e.g., 50-75\% less) than PSC motors.

The seasonal energy efficiency ratio (SEER) is calculated as follows:

\begin{equation}
SEER = PL{F_{0.5}} \cdot EE{R_{TestB}}
\end{equation}

\begin{equation}
EE{R_{TestB}} = \frac{{{{\dot Q}_{Total,Net,TestB}}}}{{Powe{r_{Total,TestB}}}}
\end{equation}

\begin{equation}
  \begin{array}{rl}
    \dot{Q}_{Total,Net,TestB} &= \dot{Q}_{Total,Rated} \PB{TotCapTempModFac_{TestB}}\PB{TotCapFlowModFac_{Rated}} \\
                              &- \PB{FanPowerPerVolFlowRate \cdot \dot{V}_{Rated}}
  \end{array}
\end{equation}

\begin{equation}
  \begin{array}{rl}
    Power_{Total,TestB} &= \dot{Q}_{Total,Rated} \PB{TotCapTempModFac_{TestB}}\PB{TotCapFlowModFac_{Rated}}\cdot EIR_{TestB} \\
                        &+ \PB{FanPowerPerVolFlowRate \cdot \dot{V}_{Rated}}
  \end{array}
\end{equation}

\begin{equation}
  EIR_{TestB} = \frac{1}{COP_{rated}}\PB{EIRTempModFac_{TestB}}\PB{EIRFlowModFac_{Rated}}
\end{equation}

where:

\(PLF_{0.5}\) is the part load fraction correlation curve evaluated at a part load ratio (PLR) of 0.5 (dimensionless)

\(EER_{TestB}\) is the energy efficiency ratio with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil, 27.78\(^{\circ}\)C dry-bulb temperature air entering the air-cooled (outdoor) condenser, and rated air volume flow through the cooling coil (W/W)

\({\dot Q_{Total,Net,TestB}}\) is the net total cooling capacity with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil, 27.78\(^{\circ}\)C dry-bulb temperature air entering the air-cooled (outdoor) condenser, and rated air volume flow through the cooling coil (W)

\(TotCapTempModFa{c_{TestB}}\) is the total cooling capacity function of temperature curve evaluated with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil and 27.78\(^{\circ}\)C dry-bulb temperature air entering the air-cooled (outdoor) condenser (dimensionless)

\(Powe{r_{Total,TestB}}\) is the total electric power (compressors, condenser fans and evaporator fan) with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil, 27.78\(^{\circ}\)C dry-bulb temperature air entering the air-cooled (outdoor) condenser, and rated air volume flow through the cooling coil (W)

\(CO{P_{rated}}\) is the Coefficient of Performance at rated conditions, user input (W/W)

\(EIRTempModFa{c_{TestB}}\) is the Energy Input Ratio function of temperature curve evaluated with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil and 27.78\(^{\circ}\)C dry-bulb temperature air entering the air-cooled (outdoor) condenser (dimensionless)

\(EIRFlowModFa{c_{Rated}}\) is the Energy Input Ratio function of flow fraction curve evaluated at a flow fraction of 1.0 (dimensionless).

Energy Efficiency Ratio (EER) is another standard rating (AHRI 2007), and it is defined as the ratio of the total cooling capacity to the total power input at any given set of rating conditions, expressed in W/W (or Btu/W-h). For this class of air-cooled DX cooling coils, EER is calculated at rated test conditions as follows:

\begin{equation}
EE{R_{}} = \frac{{{{\dot Q}_{Standard\,Rating}}}}{{Powe{r_{Total,Rated}}}}
\end{equation}

\begin{equation}
  \begin{array}{rl}
    Power_{Total,Rated} &= \dot{Q}_{Total,Rated} \PB{TotCapTempModFac_{Rated}}\PB{TotCapFlowModFac_{Rated}}\cdot EIR_{Rated} \\
                        &+ \PB{FanPowerPerVolFlowRate \cdot \dot{V}_{Rated}}
  \end{array}
\end{equation}

\begin{equation}
EI{R_{Rated}} = \left( {\frac{1}{{CO{P_{Rated}}}}} \right)(EIRTempModFa{c_{Rated}})(EIRFlowModFa{c_{Rated}})
\end{equation}

where:

\emph{EER} is the Energy Efficiency Ratio (W/W)

\(Powe{r_{Total,Rated}}\) is the total electric power (compressors, condenser fans and evaporator fan) with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil, 35.0\(^{\circ}\)C dry-bulb temperature air entering the air-cooled (outdoor) condenser, and air flow rate across the evaporator at the Rated Air Volume Flow Rate (W).

\(TotCapTempModFa{c_{Rated}}\) is the total cooling capacity function of temperature curve evaluated with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil and 35.0\(^{\circ}\)C dry-bulb temperature air entering the air-cooled (outdoor) condenser (dimensionless)

\(EIRTempModFa{c_{Rated}}\) is the Energy Input Ratio function of temperature curve evaluated with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil and 35.0\(^{\circ}\)C dry-bulb temperature air entering the air-cooled (outdoor) condenser (dimensionless).

The Integrated Energy Efficiency Ratio (IEER) is intended to be a measure of merit for the cooling coil's part-load efficiency. IEER replaced Integrated Part-Load Value (IPLV) as the part-load performance metric in Std. 340/360 as of January 1, 2010. Full details regarding the IEER calculation are available in ANSI/AHRI Std. 340/360 (AHRI 2007). A summary of the IEER calculations made by EnergyPlus for single-speed air-cooled DX cooling coils is provided below:

\begin{equation}
IEER = \,(0.02 \cdot EE{R_A}) + (0.617 \cdot EE{R_B}) + (0.238 \cdot EE{R_C}) + (0.125 \cdot EE{R_D})
\end{equation}

where,

\(EE{R_A}\) is the \emph{EER} at 100\% net capacity at AHRI standard rating conditions (same as EER calculation shown above)

\(EE{R_B}\) is the \emph{EER} at 75\% net capacity and reduced outdoor air temperature

\(EE{R_C}\) is the \emph{EER} at 50\% net capacity and reduced outdoor air temperature

\(EE{R_D}\) is the \emph{EER} at 25\% net capacity and reduced outdoor air temperature.

\begin{equation}
EE{R_{B - D}} = \frac{{LF \cdot {{\dot Q}_{Total,Net,PartLoad}}}}{{Powe{r_{Total,{\kern 1pt} PartLoad}}}}
\end{equation}

\begin{equation}
Powe{r_{Total,{\kern 1pt} PartLoad}} = LF\left( {{C_D} \cdot Powe{r_{CompCondFan,{\kern 1pt} PartLoad}}} \right) + \,\left( {FanPowerPerVolFlowRate \cdot {{\dot V}_{Rated}}} \right)
\end{equation}

\begin{equation}
\begin{split}
Power_{CompCondFan,PartLoad} = \dot{Q}_{Total,Rated}\PB{TotCapTempModFac_{PartLoad}} \\ 
\cdot \PB{TotCapFlowModFac_{Rated}} \cdot EIR_{PartLoad}
\end{split}
\end{equation}

\begin{equation}
EI{R_{PartLoad}} = \left( {\frac{1}{{CO{P_{Rated}}}}} \right)(EIRTempModFa{c_{PartLoad}})(EIRFlowModFa{c_{Rated}})
\end{equation}

where:

\({\dot Q_{Total,Net,PartLoad}}\) is the net total cooling capacity with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil rated air volume flow through the cooling coil (W). The dry-bulb temperature of air entering the air-cooled condenser varies (B = 27.5\(^{\circ}\)C, C = 20.0\(^{\circ}\)C, D = 18.3\(^{\circ}\)C).

\(Powe{r_{Total,PartLoad}}\) is the total electric power (compressors, condenser fans and evaporator fan) with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil and air flow rate across the evaporator at the Rated Air Volume Flow Rate (W). The dry-bulb temperature of air entering the air-cooled condenser varies (B = 27.5\(^{\circ}\)C, C = 20.0\(^{\circ}\)C, D = 18.3\(^{\circ}\)C).

\(Powe{r_{CompCondFan,{\kern 1pt} PartLoad}}\) is the electric power of the compressor and condenser fan at the various part-load ratios, with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil and rated supply air volume flow rate (W). The dry-bulb temperature of air entering the air-cooled condenser varies per the part-load ratio (B = 27.5\(^{\circ}\)C, C = 20.0\(^{\circ}\)C, D = 18.3\(^{\circ}\)C).

\(EIRTempModFa{c_{PartLoad}}\) is the Energy Input Ratio function of temperature curve evaluated with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil and dry-bulb temperature of air entering the air-cooled condenser corresponding to the reduced part-load ratio (B = 27.5\(^{\circ}\)C, C = 20.0\(^{\circ}\)C, D = 18.3\(^{\circ}\)C) (dimensionless).

\({C_D}\) is the degradation coefficient to account for cycling of the compressor = 1.13 -- 0.13\emph{LF}

\(LF\) is the fractional ``on'' time at the desired load point.

The load factor (\emph{LF}) is the fractional ``on'' time for the desired reduced load points (75\%, 50\%, or 25\%) calculated from the following equation:

\begin{equation}
LF = \frac{{\left( {{\raise0.7ex\hbox{{\% Load}} \!\mathord{\left/ {\vphantom {{\% Load} {100}}}\right.}\!\lower0.7ex\hbox{{100}}}} \right) \cdot {{\dot Q}_{StandardRating}}}}{{{{\dot Q}_{Total,Net,PartLoad}}}}
\end{equation}

where \(\% Load\) is the part-load operating points, i.e., 75\% (B), 50\% (C), 25\% (D).

The calculations for \(Q_{Total,Net,PartLoad}\) and \(Power_{Total,PartLoad}\) are calculated in nearly the same way as \(Q_{Total,Net,TestB}\) and \(Power_{Total,TestB}\) are calculated for SEER (defined above). The only difference is that these cooling capacity and power values, used for calculating \(EER_{B} / EER_{C} / EER_{D}\) for IEER, are calculated for a series of dry-bulb temperatures of air entering the air-cooled condenser (B = 27.5\(^{\circ}\)C, C = 20.0\(^{\circ}\)C, D = 18.3\(^{\circ}\)C) and part-load performance degradiation correction is also applied to the condensing unit electric power calculation.

\subsubsection{ANSI/ASHRAE 127 - Standard Ratings of Single-Speed DX Cooling Coils}\label{ansiashrae-127---standard-ratings-of-single-speed-dx-cooling-coils}

For computer and data processing room unitary air conditioners single-speed direct expansion (DX) cooling coils, the standard ratings net total cooling capacity and total cooling electric power inputs are calculated according to ANSI/AHRI Standard 127 (ASHRAE 2012). These ratings apply to unitary air conditioners with air-cooled. If the single-speed DX cooling coil is specified with an evaporatively-cooled condenser, then no standard ratings are output from EnergyPlus at this time. These standard ratings are not direct inputs to the model. However, these standard ratings can be calculated using user-entered information for the Coil:Cooling:DX:SingleSpeed object. These standard rating values are provided in the eplusout.eio output file and also in the predefined tabular output reports (Output:Table:SummaryReports object, Equipment Summary).

\textbf{Note}: The standard ratings described in this section require that the DX cooling coil model be evaluated at sixteen different test conditions (i.e., specific wet-bulb temperatures for air entering the cooling coil and dry-bulb temperatures for air entering the air-cooled {[}outdoor{]} condenser) for each of the four standard tests and four application classes (ASHRAE -- 2012). The four test conditions: A, B, C and D are provided in the ANSI/ASHRAE Standard 127. And the test conditions are different for each application classes described in the standard. In total sixteen performance data of net cooling capacity and total electric power inputs are reported. The total cooling electric power includes the supply fan power.

\begin{longtable}[c]{p{1.0in}p{1.0in}p{1.0in}p{1.0in}p{1.0in}p{1.0in}}
\toprule 
\multicolumn{6}{l}{Rated Cooling Tests} \tabularnewline \midrule
\endhead
& Application Class & A & B & C & D \tabularnewline
& Class 1 & 23.9\(^{\circ}\)C(75.0\(^{\circ}\)F) & 23.9\(^{\circ}\)C(75.0\(^{\circ}\)F) & 23.9\(^{\circ}\)C(75.0\(^{\circ}\)F) & 23.9\(^{\circ}\)C(75.0\(^{\circ}\)F) \tabularnewline
Tdb, Indoor & Class 2 & 29.4\(^{\circ}\)C(85.0\(^{\circ}\)F) & 29.4\(^{\circ}\)C(85.0\(^{\circ}\)F) & 29.4\(^{\circ}\)C(85.0\(^{\circ}\)F) & 29.4\(^{\circ}\)C(85.0\(^{\circ}\)F) \tabularnewline
& Class 3 & 35.0\(^{\circ}\)C(95.0\(^{\circ}\)F) & 35.0\(^{\circ}\)C(95.0\(^{\circ}\)F) & 35.0\(^{\circ}\)C(95.0\(^{\circ}\)F) & 35.0\(^{\circ}\)C(95.0\(^{\circ}\)F) \tabularnewline
& Class 4 & 40.5\(^{\circ}\)C(105\(^{\circ}\)F) & 40.5\(^{\circ}\)C(105\(^{\circ}\)F) & 40.5\(^{\circ}\)C(105\(^{\circ}\)F) & 40.5\(^{\circ}\)C(105\(^{\circ}\)F) \tabularnewline
Tdp, Indoor &  & 35.0\(^{\circ}\)C(95.0\(^{\circ}\)F) & 26.7\(^{\circ}\)C(80.0\(^{\circ}\)F) & 18.3\(^{\circ}\)C(65.0\(^{\circ}\)F) & 4.4\(^{\circ}\)C(40.0\(^{\circ}\)F) \tabularnewline
Tdb, Outdoor &  & 35.0\(^{\circ}\)C(95.0\(^{\circ}\)F) & 26.7\(^{\circ}\)C(80.0\(^{\circ}\)F) & 18.3\(^{\circ}\)C(65.0\(^{\circ}\)F) & 4.4\(^{\circ}\)C(40.0\(^{\circ}\)F) \tabularnewline
\bottomrule
\end{longtable}

The standard rating net total cooling capacity is calculated as follows:

\begin{equation}
\begin{array}{rl}
\dot{Q}_{StandardRating} =& \dot{Q}_{TotalRated}\left(\text{TotCapTempModFac}_{Rated}\right)\left(\text{TotCapFlowModFac}_{Rated}\right) \\
& - \left(\text{FanPowerPerVolFlowRate} \cdot \dot{V}_{Rated}\right)
\end{array}
\end{equation}

where:

\(\dot{Q}_{StandardRating}\) is the standard rating (net) cooling capacity (W)

\(\dot{Q}_{Total,Rated}\) is the rated Total (Gross) Cooling Capacity, user input (W)

\(\text{TotCapTempModFac}_{Rated}\) is the total cooling capacity function of temperature curve evaluated at wet-bulb temperature of air entering the cooling coil and dry-bulb temperature of air entering the air-cooled (outdoor) condenser (dimensionless)

\(\text{TotCapFlowModFac}_{Rated}\) is the total cooling capacity function of flow fraction curve evaluated at a flow fraction of 1.0 (dimensionless)

\(\text{FanPowerPerVolFlowRate}\) is the rated evaporator fan power per volume flow rate, user input (W/(\(m^3\)/s))

\(\dot{V}_{Rated}\) is the rated air volume flow rate, user input (\(m^3\)/s).

The standard rating net total cooling electric power input is calculated as follows:

\begin{equation}
\begin{array}{rl}
  \rm{Power}_{Total} =& \left[ \dot{Q}_{Total,Rated} \left( \rm{TotCapTempModFac} \right) \left( \rm{TotCapFlowModFac}_{Rated} \right) \right] \\
& \cdot \rm{EIR} + \left( \rm{FanPowerPerVolFlowRate} \cdot \dot{V}_{Rated} \right)
\end{array}
\end{equation}

\begin{equation}
  \frac{\rm{EIRTempModFac} \rm{EIRFlowModFac_{Rated}}}{COP_{Rated}}
\end{equation}

where:

\(EER\) is the Energy efficiency ratio at wet-bulb temperature of air entering the cooling coil, dry-bulb temperature of air entering the air-cooled (outdoor) condenser, and rated air volume flow through the cooling coil (W/W)

\(\rm{TotCapTempModFac}\) is the total cooling capacity function of temperature curve evaluated at the test condition of wet-bulb temperature of air entering the cooling coil and dry-bulb temperature of air entering the air-cooled (outdoor) condenser (dimensionless)

\(\rm{Power}_{Total}\) is the total electric power (compressors, condenser fans and evaporator fan) at the test conditions of wet-bulb temperature of air entering the cooling coil, and dry-bulb temperature of air entering the air-cooled (outdoor) condenser, and rated air volume flow through the cooling coil (W)

\(COP_{Rated}\) is the Coefficient of Performance at rated conditions, user input (W/W)

\(\rm{EIRTempModFac}\) is the Energy Input Ratio function of temperature curve evaluated at the test condition of wet-bulb temperature of air entering the cooling coil and dry-bulb temperature of air entering the air-cooled (outdoor) condenser (dimensionless)

\(\rm{EIRFlowModFac}_{Rated}\) is the Energy Input Ratio function of flow fraction curve evaluated at a flow fraction of 1.0 (dimensionless).

Reference:

ASHRAE 2012. ANSI/ASHRAE Standard 127-2012 Method of Testing for Rating Computer and Data Processing Room Unitary Air Conditioners.

\subsubsection{Basin Heater For Two-Stage DX Coil}\label{basin-heater-for-two-stage-dx-coil}

Basin heater for the object Coil:Cooling:DX:TwoStageWithHumidityControlMode operates in the same manner as for Coil:Cooling:DX:SingleSpeed. Refer to the ``Basin Heater For Single-Speed DX Coil'' description above.

If the number of capacity stages is equal to 1 and the CondenserType for that stage is EvapCooled, then the basin heater power is calculated for (1 - RunTimeFractionStage1) of DX coil.

If the number of capacity stages is greater than 1, then

\begin{enumerate}
\item If the CondenserType for stage 1 is EvapCooled, then the basin heater power is calculated for (1 - RunTimeFractionStage1) of DX coil
\item Elseif the CondenserType for stage 2 is EvapCooled, then the basin heater power is calculated for (1 - RunTimeFractionStage2) of DX coil.
\end{enumerate}

\subsubsection{References}\label{references-2-002}

AHRI 2008. ANSI/AHRI Standard 210/240: 2008 Standard for Performance Rating of Unitary Air-Conditioning \& Air-Source Heat Pump Equipment.~ Arlington, VA:~ Air-Conditioning, Heating, and Refrigeration Institute.

AHRI 2007. ANSI/AHRI Standard 340/360: 2007 Standard for Performance Rating of Commercial and Industrial Unitary Air-Conditioning and Heat Pump Equipment.~ Arlington, VA:~ Air-Conditioning, Heating, and Refrigeration Institute.

ASHRAE. 1993. HVAC2 Toolkit: A Toolkit for Secondary HVAC System Energy Calculation. Atlanta: American Society of Heating, Refrigerating and Air-Conditioning Engineers, Inc.

Carrier, W.H., R.E. Cherne, W.A. Grant, and W.H. Roberts. 1959. \emph{Modern air conditioning, heating and ventilating}, 3d ed. New York: Pitman Publishing Corporation.

Henderson, H.I. Jr., K. Rengarajan, and D.B. Shirey III. 1992. The impact of comfort control on air conditioner energy use in humid climates. \emph{ASHRAE Transactions} 98(2): 104-113.

Henderson, H.I. Jr. and K. Rengarajan. 1996. A Model to Predict the Latent Capacity of Air Conditioners and Heat Pumps at Part-Load Conditions with Constant Fan Operation. \emph{ASHRAE Transactions} 102(2): 266-274.

Henderson, H. 1998. The impact of part load air conditioner operation on dehumidification performance: Validating a latent capacity degradation model. Presented at ASHRAE's IAQ \& Energy `98 conference. New Orleans, LA.~ October.

Henderson, H. and D. Shirey. 2003. Understanding the Dehumidification Performance of Air-Conditioning Equipment at Part-Load Conditions. Paper presented at Joint CIBSE/ASHRAE Conference, \emph{Building Sustainability, Value and Profit.} September.~ Edinburgh, Scotland.

Walker, I.S. and Lutz, J.D. 2005. Laboratory Evaluation of Residential Furnace Blower Performance. Berekely, CA:~ Lawrence Berkeley National Laboratory, Report LBNL 58752.

Walker, I.S. 2007. Comparing Residential Furnace Blowers for Rating and Installed Performance. Berkeley, CA:~ Lawrence Berkeley National Laboratory, Environmental Energy Technologies Division Report LBNL 62344.

\subsection{Multi-Speed Electric DX Air Cooling Coil}\label{multi-speed-electric-dx-air-cooling-coil}

\subsubsection{Overview}\label{overview-2-004}

This model (object name Coil:Cooling:DX:MultiSpeed) simulates the performance of an air-to-air direct expansion (DX) cooling system. The main difference compared to the other cooling coil models, such as Coil:Cooling:DX:SingleSpeed, is that this cooling coil allows modeling of two to four discrete compressor speeds. Each speed has a set of corresponding performance information at rated conditions along with curve fits for variations in total capacity, SHR, energy input ratio and part-load fraction to determine the performance of the unit at part-load conditions (DOE 1982).~ The full load supply airflow rate is dependent on the speed number and provided by its parent object (Ref. AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed). The part-load impact on coil energy use is automatically applied to the lowest speed. A choice is provided to determine whether part-load impacts on coil energy use are applied when the coil is operating at speeds greater than speed 1.

This model simulates the thermal performance of the indoor DX cooling coil, and the power consumption of the outdoor unit (multispeed compressor, fans, and crankcase heaters). The performance of the indoor supply air fan varies widely from system to system depending on control strategy (e.g., constant fan vs.~AUTO fan), fan type, fan motor efficiency and pressure losses through the air distribution system. Therefore, this DX system model does not account for the thermal effects or electric power consumption of the indoor supply air fan. EnergyPlus contains separate models for simulating the performance of various indoor fan configurations, and these models can be easily linked with the DX system model described here to simulate the entire DX system being considered. For the time being, this coil model can only be called by the parent object AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed.

When the model determines performance at Speed 1 (the lowest speed) or cycling between OFF and Speed 1, its performance is almost the same as the performance for the Coil:Cooling:DX:SingleSpeed model. However, the outlet conditions are calculated slightly differently. Therefore, the Coil:Cooling:DX:SingleSpeed model may be considered as a subset of the model described here. When the multispeed coil model determines performance at higher speeds (above 1), the model linearly interpolates the performance at two consecutive speeds (n-1 and n) as needed to meet the cooling load, with the fraction of time at each speed established by the speed ratio.

When single mode operation is specified at higher speeds (above 1), defined in the UnitarySystemPerformance:Multispeed object, a child object of AirLoopHVAC:UnitarySystem, its performance is almost the same as the performance for the Coil:Cooling:DX:SingleSpeed model at different flow rate and capacity with given speed number. No linear interpolation is performed between two adjacent speeds. The highest speed which does not exceed the sensible load is used for each HVAC timestep. This operation does not apply to speed 1 operation and the case when the sensible load is above the highest sensible capacity.

\subsubsection{Model Inputs}\label{model-inputs}

The model inputs are also very similar to the inputs of the Coil:Cooling:DX:SingleSpeed object. The main difference is that this multispeed model requires a set of fields at each speed, such as rated capacity, rated SHR, rated COP, two capacity modifiers, two energy input ratio modifiers, part-load correction, and latent degradation inputs. The inputs also include waste heat fraction at the rated conditions and modifier as a function of temperature to calculate recoverable waste heat for heat recovery, which are not available in the similar Coil:Cooling:DX:SingleSpeed object

\subsubsection{Speed 1 Operation}\label{speed-1-operation}

The calculation procedures in this model, including defrost and crankcase heater, are indentical to the Coil:Heating:DX:SingleSpeed object (Ref: Coil:Heating:DX:SingleSpeed) with one exception: outlet node condition calculation when the supply air fan operates continuously (i.e., supply air fan operating mode schedule value is not equal to 0; Ref. AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed).

The following procedure provides the detailed description of the exception.

\begin{itemize}
  \item Total delivered cooling capacity
\end{itemize}

The total delivered cooling capacity for speed 1 operating at the cycling ratio needed to meet the requested cooling load is:

\begin{equation}
{Q_{coil,cycling}} = {\dot{m}_{Speed1}}*CycRatio*({h_{inlet}} - {h_{outlet,full}})
\end{equation}

where:

\emph{Q\(_{coil,cyclingl}\)} is the delivered total cooling capacity for Speed 1 operating at a specific cycling ratio (W)

\({\dot{m}_{Speed\,\,1}}\) is the air mass flow rate through cooling coil at Speed 1 as set by the parent object (kg/s)

\(h_{outlet,full}\) is the specific enthalpy of the coil outlet air during full-load operation at Speed 1 (no cycling) (J/kg)

\(h_{inlet}\) is the specific enthalpy of the coil inlet air (J/kg)

\emph{CycRatio} is the cycling ratio at Speed 1, ratio of requested heating load to the full-load capacity of the coil at Speed 1 (dimensionless).

It is assumed that the coil provides no cooling capacity when the coil is OFF, even if the supply air fan continues to operate.

\begin{itemize}
  \item Outlet air specific enthalpy
\end{itemize}

The average specific enthalpy of the coil outlet air is then calculated based on the total delivered cooling capacity and the average air mass flow rate entering the coil:

\begin{equation}
  h_{outlet,average} = h_{inlet} -  \frac{Q_{coil,cycling}}{{\mathop m\limits^\cdot}_{inlet}}
\end{equation}

where

h\(_{outlet,average}\) is the averaged specific enthalpy at the coil outlet (J/kg)

h\(_{inlet}\) is the specific enthalpy at the coil inlet (J/kg)

Q\(_{coil,cycling}\) is the total capacity at full load (W)

\({\dot{m}_{inlet}}\) is the mass flow rate at the inlet to the coil as established by the parent object (Ref. AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed, Mass Flow Rate Calculation). This flow rate is the average value determined by the parent object, accounting for the specified flow rate when the cooling coil is ON and the specified flow rate when the cooling coil is OFF for the time step being simulated.

\begin{itemize}
  \item Sensible capacity
\end{itemize}

The minimum humidity ratio (HR\(_{min}\)) is based on humidity ratios between inlet and full load outlet as:

\begin{equation}
HR_{min} = Minimum(HR_{inlet}, HR_{full})
\end{equation}

where

HR\(_{inlet}\) is the humidity ratio at the inlet (kg/kg)

HR\(_{full}\) is the full load humidity ratio at the outlet (kg/kg).

The coil sensible capacity may be calculated as:

\begin{equation}
  Q_{coil,sens} = {\dot{m}_{Speed1}}*CycRatio*[{h_{inlet}}({T_{inlet}},H{R_{\min }}) - {h_{outlet,full}}({T_{outlet,full}},H{R_{\min }})]
\end{equation}

where:

Q\(_{coil,sens}\) is the delivered sensible cooling capacity (W)

h\(_{outlet,full}\) is the full load specific enthalpy at the coil outlet as a function of outlet dry-bulb temperature at the full load, and the minimum humidity ratio (J/kg)

h\(_{inlet}\) is the specific enthalpy at the coil inlet (J/kg).

\begin{itemize}
  \item Latent capacity
\end{itemize}

The latent capacity is the difference between total and sensible capacities

\begin{equation}
  Q_{coil,latent} = Q_{coil,cycling} - Q_{coil,sens}
\end{equation}

where Q\(_{coil,latent}\) is the delivered latent cooling capacity (W).

\begin{itemize}
  \item Average outlet air humidity ratio
\end{itemize}

The averaged outlet HR can be calculated as:

\begin{equation}
  HR_{outlet,average} = HR_{inlet} - \frac{Q_{coil,latent}}{{\lambda}\dot{m}_{inlet}}
\end{equation}

where \(\lambda\) is the heat of vaporization as a function of HR\(_{min}\) and CycRatio * T\(_{outlet,full}\)+(1-CycRatio) * T\(_{inlet}\) (J/kg).

\begin{itemize}
  \item Average outlet air temperature
\end{itemize}

Using the above averaged outlet humidity ratio and specific enthalpy, the averaged outlet temperature can be calculated using the psych function of PsyTdbFnHW.

The main reason using the above approach is that outlet conditions are calculated in the same way in low and high speed operation.

The crankcase heater defined for this DX cooling coil is enabled during the time that the compressor is not running for either heating or cooling. The crankcase heater power use from either heating or cooling is reported in the heating coil (Coil:Heating:DX:MultiSpeed).

\subsubsection{Higher Speed Operation}\label{higher-speed-operation-000}

This section describes how higher speed operation is simulated. When the required sensible load is less than the full load sensible capacity at Speed n (Speed Number \textgreater{} 1), the following calculations are performed:

\begin{itemize}
  \item Bypass factor at Speed n-1 and Speed n
\end{itemize}

\begin{equation}
BypassFacto{r_n} = f(RatedBypassFacto{r_n},RatedFlowRat{e_n},ActualFowRat{e_n})
\end{equation}

\begin{equation}
BypassFacto{r_{n - 1}} = f(RatedBypassFacto{r_{n - 1}},RatedFlowRat{e_{n - 1}},ActualFowRat{e_{n - 1}})
\end{equation}

where:

BypassFactor\(_{i}\) is the bypass factor at actual flow rate conditions at Speed i (dimensionless)

RatedBypassFactor\(_{i}\) is the bypass factor at the rated conditions at Speed i (dimensionless)

RatedFowRate\(_{i}\) is the air mass flow rate at the rated conditions at Speed i (kg/s)

ActualFowRate\(_{i}\) is the actual air mass flow rate at Speed i (kg/s)

i is Speed n or Speed n-1.

The bypass factor at Speed n is a function of the bypass factor at the rated conditions, rated airflow rate, and actual flow rate at Speed n. The calculation is performed by a function, called AdjustCBF in the DXCoil module.

\begin{itemize}
  \item Total capacity at Speed n-1 and Speed n
\end{itemize}

\begin{equation}
  TotCa{p_{n - 1}} = f(RatedCa{p_{n - 1}},TotCapTempModFa{c_{n - 1}},TotCapFlowModFa{c_{n - 1}},BypassFacto{r_{n - 1}})
\end{equation}

\begin{equation}
 TotCa{p_n} = f(RatedCa{p_n},TotCapTempModFa{c_n},TotCapFlowModFa{c_n},BypassFacto{r_n})
\end{equation}

where

TotCap\(_{i}\) is the total cooling capacity at given temperatures and flow rates at Speed i (W)

RatedCap\(_{i}\) is the cooling capacity at the rated conditions at Speed i (W)

TotCapTempModFac\(_{i}\) is the total cooling capacity modifier as a function of indoor web-bulb temperature and outdoor air dry-bulb temperature at Speed i

TotCapFlowModFac\(_{i}\) is the total cooling capacity modifier as a function of the ratio of the actual flow rate across the cooling coil to the rated airflow rate at Speed i

i is Speed n or Speed n-1.

The calculation is performed by a subroutine, called CalcTotCapSHR in the DXCoil module.

\begin{itemize}
  \item EIR at Speed n-1 and Speed n
\end{itemize}

\begin{equation}
EI{R_{n - 1}} = RatedEI{R_{n - 1}}*EIRTempModFa{c_{n - 1}}*EIRFlowModFa{c_{n - 1}}
\end{equation}

\begin{equation}
EI{R_n} = RateEI{R_n}*EIRTempModFa{c_n}*EIRFlowModFa{c_n}
\end{equation}

where:

EIR\(_{i}\) is the energy input ratio at given temperatures and flow rates at Speed i (W)

RatedEIR\(_{i}\) is the energy input ratio at the rated conditions at Speed i (W)

EIRTempModFac\(_{i}\) is the energy input ratio modifier as a function of indoor and outdoor air dry-bulb temperature at Speed i

EIRFlowModFac\(_{i}\) is the energy input ratio modifier as a function of ratio of the actual flow rate across the heating coil to the rated airflow rate at Speed i

i is n or n-1.

\begin{itemize}
  \item Full load outlet conditions at Speed n-1 and Speed n
\end{itemize}

The calculation procedure of full load outlet conditions at Speed n-1 and Speed n is the same as the calculation procedure used in the Coil:Cooling:DX:SingleSpeed model (Ref. Coil:Cooling:DX:SingleSpeed). The difference is that the outlet conditions at Speed n-1 are calculated based on the total cooling capacity and mass flow rate at Speed n-1, while the outlet conditions at Speed n are calculated based on the total cooling capacity and mass flow rate at Speed n.

\begin{itemize}
  \item Effective total cooling capacity
\end{itemize}

\begin{equation}
\begin{array}{l}
{Q_{coil,SpeedRatio}} = (SpeedRatio){\dot{m}_{Speed,n}}({h_{inlet}} - {h_{outlet,FullSpeed\;n}}) \\
\;\;\;\;\;\;\;\;\; + (1 - SpeedRatio){\dot{m}_{Speed,n-1}}({h_{inlet}} - {h_{outlet,FullSpeed\;n - 1}})
\end{array}
\end{equation}

where:

\({Q_{coil,SpeedRatio}}\) is the delivered sensible cooling capacity at a given speed ratio between two consecutive speeds (W)

\({\dot{m}_{Speed,n}}\) is the air mass flow rate through cooling coil at Speed n as set by the parent object (kg/s)

\({\dot{m}_{Speed,n-1}}\) is the air mass flow rate through cooling coil at Speed 1 as set by the parent object (kg/s)

h\(_{inlet}\) is the specific enthalpy at the coil inlet (J/kg)

h\(_{outlet,FullSpeed\,n}\) is the full load specific enthalpy at the coil outlet at Speed n (J/kg)

h\(_{outlet,FullSpeed\,n-1}\) is the full load specific enthalpy at the coil outlet at Speed n-1 (J/kg).

\begin{itemize}
  \item Average outlet air specific enthalpy
\end{itemize}

\begin{equation}
  {h_{outlet,average}} = {h_{inlet}} - \frac{Q_{coil,SpeedRatio}}{\dot{m}_{inlet}}
\end{equation}

where:

h\(_{outlet,average}\) is the averaged specific enthalpy at the coil outlet (J/kg)

h\(_{inlet}\) is the specific enthalpy at the coil inlet (J/kg)

\({\dot{m}_{inlet}}\) is the mass flow rate at the inlet to the coil as established by the parent object (Ref. AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed, Mass Flow Rate Calculation). This flow rate is the average value determined by the parent object, accounting for the specified flow rate when the heating coil is at Speed n and the specified flow rate when the heating coil is at Speed n-1 for the time step being simulated.

\begin{itemize}
  \item Effective sensible cooling capacity
\end{itemize}

The minimum humidity ratio (HR\(_{min}\)) is calculated as:

\begin{equation}
HR_{min} = Minimum[HR_{inlet}, (SpeedRatio)HR_{full,n}+(1.0-SpeedRatio)HR_{full,n-1})]
\end{equation}

The effective sensible cooling capacity is expressed as:

\begin{equation}
\begin{array}{l}
{Q_{coil,sens}} = {\dot{m}_{Speed,n}}(SpeedRatio)[{h_{inlet}}({T_{inlet}},H{R_{min}}) - {h_{outlet,FullSpeed,n}}({T_{outlet,n}},H{R_{min}})] \\
\;\;\;\;\;\;\;\;\;\;\;\;\;\; + {\dot{m}_{Speed,n-1}}(1 - SpeedRatio)[{h_{inlet}}({T_{inlet}},H{R_{min}}) - {h_{outlet,FullSpeed,n-1}}({T_{outlet,n-1}},H{R_{min}})]
\end{array}
\end{equation}

where:

Q\(_{coil,sens}\) is the effective sensible cooling capacity (W)

h\(_{outlet,FullSpeed,n}\) is the full load specific enthalpy at the coil outlet at Speed n as a function of outlet dry-bulb temperature at the full load, and the minimum humidity ratio (J/kg)

h\(_{outlet,FullSpeed,n-1}\) is the full load specific enthalpy at the coil outlet at Speed n-1 as a function of outlet dry-bulb temperature at the full load, and the minimum humidity ratio (J/kg)

h\(_{inlet}\) is the specific enthalpy at the coil inlet (J/kg).

\begin{itemize}
  \item Average outlet air humidity ratio and temperature
\end{itemize}

The effective latent cooling capacity is the difference between the total and sensible capacity:

\begin{equation}
{Q_{coil,latent}} = {Q_{coil,SpeedRatio}} - {Q_{coil,sens}}
\end{equation}

where Q\(_{coil,latent}\) is the effective latent cooling capacity (W).

The average outlet air HR can be calculated as:

\begin{equation}
  HR_{outlet,average} = HR_{inlet} - \frac{Q_{coil,latent}}{{\lambda} \dot{m}_{inlet}}
\end{equation}

where \(\lambda\) is the heat of vaporization as a function of HR\(_{min}\) and SpeedRatio*T\(_{outlet,n}\)+(1-SpeedRatio)*T\(_{outlet,n-1}\) (J/kg).

At the given averaged outlet humidity ratio and specific enthalpy, the averaged outlet temperature can be calculated using the psych function of PsyTdbFnHW.

\begin{itemize}
  \item Calculate combined energy input
\end{itemize}

When the input for the field `Apply Part Load Fraction to Speeds Greater than 1' is No in the object (equivalent to a single compressor), the combined energy output is calculated as follows:

\begin{equation}
CoolingPower = (TotCa{p_n})(EI{R_n})(SpeedRatio) + (TotCa{p_{n-1}})(EI{R_{n-1}})(1.0 - SpeedRatio)
\end{equation}

When the input for the field 'Apply Part Load Fraction to Speeds Greater than 1' is Yes in the object (equivalent to multiple compressors), the combined energy output is calculated as follows:

\begin{equation}
CoolingPower = (TotCa{p_n})(EI{R_n})(RTF) + (TotCa{p_{n - 1}})(EI{R_{n - 1}})(1.0 - RTF)
\end{equation}

where CoolingPower is the power used (W) and RTF is the run time fraction at Speed n.

\begin{itemize}
  \item Latent degradation
\end{itemize}

When the supply fan operation mode is ContinuousFanWithCyclingCompressorand the input of the Apply Latent Degradation to Speeds Greater than 1 is Yes, the latent degradation is included at Speed n. The calculation procedure is the same as one in the Coil:Cooling:DX:SingleSpeed object. The difference is that the rated values and run time fraction at Speed n are used. The adjusted SHR is used to calculate full load outlet conditions at Speed n.

It is expected to have less latent degradation at Speed n than Speed 1. Therefore, smaller values of the latent degradation inputs at Speed n than those at Speed 1 are recommended.

\begin{itemize}
  \item Crankcase heater
\end{itemize}

There is no power need at higher speed operation.

\subsubsection{Higher Speed Operation with Single Mode Operation}\label{higher-speed-operation-with-single-mode-operation}

This section describes how higher speed operation is simulated with single mode operation. When the required sensible load is less than the full load sensible capacity at Speed n (Speed Number \textgreater{} 1), its performance is almost the same as the performance for the Coil:Cooling:DX:SingleSpeed model at different flow rate and capacity with given Speed n. No linear interpolation is performed between two adjacent speeds.

\subsubsection{Waste heat calculation}\label{waste-heat-calculation-000}

The waste heat generated by this coil object is calculated as:

\begin{equation}
{Q_{WasteHeat}} = (Fraction)(TempModifier)(CoolingPower)
\end{equation}

where Fraction is the rated waste heat fraction of the energy input and TempModifer is the waste heat modifier as a function of indoor and outdoor air dry-bulb temperature.

\subsubsection{Basin Heater For Multi-Speed DX Coil}\label{basin-heater-for-multi-speed-dx-coil}

Basin heater for the object Coil:Cooling:DX:MultiSpeed operates in the same manner as for Coil:Cooling:DX:SingleSpeed. Refer to the Basin Heater For Single-Speed DX Coil description above.

\subsubsection{Standard Rating of Multi-Speed DX Cooling Coils}\label{standard-rating-of-multi-speed-dx-cooling-coils}

For multi-speed direct expansion cooling coils, the industry standard ratings of Standard Rating Seasonal Energy Efficiency Ratio (SEER) are calculated according to ANSI/AHRI Standard 210/240 (AHRI 2008). These standard ratings can be calculated using the user-entered information for the Coil:Cooling:DX:MultiSpeed object. According to Standard 210/240, the Standard Rating SEER applies to air-to-air unitary heat pumps and air conditions with rated cooling capacities under 19,000 Watts (\textless{}65,000 Btu/h). The Cooling Mode Test Conditions for Units Having two-capacity Compressor standard tests A\(_{2}\), B\(_{2}\), B\(_{1}\), and F\(_{1}\) are also provided in Table~\ref{table:cooling-mode-test-conditions-for-units-having}. Cooling Mode Test Conditions for Units Having a Two-Capacity Compressor. The equations required to calculate the net cooling capacity and SEER value are described next.

\subsubsection{Standard Rating Cooling Capacity}\label{standard-rating-cooling-capacity}

The standard net cooling capacity of multi-speed DX cooling coil is reported at the maximum speed and full load A2 test condition only. The Standard Rating (Net) Cooling Capacity calculation is the same as single speed DX cooling coil procedure when calculated at maximum speed.The procedure for calculating the Standard Rating Cooling Capacity is given by:

\begin{equation}
{\dot Q_{StandardRating}} = \dot Q_{T,\,CRated}^{k = 2} \cdot CAPFT_{TestA2}^{k = 2} \cdot CAPFFF_{TestA2}^{k = 2}
\end{equation}

\begin{equation}
{\dot Q_{Standard\,Rating\,Net}} = {\dot Q_{StandardRating}} - Fa{n_{Power,\,CRated}}
\end{equation}

\begin{equation}
Fa{n_{Power,\,CRated}} = FanPowerPerVolFlowRat{e^{k = 2}} \cdot \dot V_{CRated}^{k = 2}
\end{equation}

where:

\({\dot Q_{StandardRating\,Net}}\) is the total standard \textbf{(net)} cooling capacity (W) of the air-conditioning or heat pump equipment in cooling mode determined from ANSI/AHRI Standard 210/240 and A2 test conditions shown in Table~\ref{table:cooling-mode-test-conditions-for-units-having}. The standard cooling test conditions for air-cooled condenser are: indoor coil entering air dry-bulb and wet-bulb temperatures 26.7\(^{\circ}\)C/19.4\(^{\circ}\)C and outdoor coil entering air dry-bulb and wet-bulb temperatures 35.0\(^{\circ}\)C/23.9\(^{\circ}\)C

\({\dot Q_{StandardRating}}\) is the total standard cooling capacity (W) of the air-conditioning or heat pump equipment determined from ANSI/AHRI Standard 210/240 and A2 test conditions shown in Table~\ref{table:cooling-mode-test-conditions-for-units-having}. The standard cooling test conditions for air-cooled are: indoor coil entering air dry-bulb and wet-bulb temperatures 26.7\(^{\circ}\)C/19.4\(^{\circ}\)C and outdoor coil entering air dry-bulb and wet-bulb temperatures 35.0\(^{\circ}\)C/23.9\(^{\circ}\)C

\(\dot Q_{T,\,CRated}^{k = 2}\) is the rated total cooling capacity at maximum speed, user input (W)

\(CAPFT_{TestA2}^{k = 2}\) is the user-specified bi-quadratic curve evaluated at the indoor coil entering air wet-bulb temperature (19.4\(^{\circ}\)C) and outdoor coil entering air dry-bulb temperature (35.0\(^{\circ}\)C) for air-cooled condenser per A2 test condition as specified in Table~\ref{table:cooling-mode-test-conditions-for-units-having} (dimensionless)

\(CAPFFF_{TestA2}^{k = 2}\) is the user-specified quadratic or cubic curve modifying the total cooling capacity as function of flow fraction, (dimensionless).~ This curve is evaluated at a flow fraction of 1.0.

\(Fa{n_{Power,\,Rated}}\) is the supply air fan power at rated conditions at high (maximum) compressor speed (W)

\(\dot V_{_{CRated}}^{k = 2}\) is the rated air volume flow rate at high (maximum) compressor speed, user input (m\(^{3}\)/s)

\(FanPowerPerVolFlowRat{e^{k = 2}}\) is the rated indoor coil fan power per volume flow rate is a user-entered value, with a default of 773.3 W/(m\(^{3}\)/s)) if the user leaves this input field blank. The default value is taken from ANSI/ASHRAE Standard 210/240 -2008 where it is defined for systems which do not have an indoor coil fan furnished as part of the system. See the description given below how this value is calculated, user input (W/(m\(^{3}\)/s)).

The Rated Evaporator (Indoor Coil) Fan Power Per Volume Flow rate is a user-entered value, with a default of 773.3 W/(m\(^{3}\)/s)) if the user leaves this input field blank. The default value is taken from ANSI/ASHRAE Standard 210/240-2008 where it is defined for systems which do not have an Indoor Coil (Evaporator) fan furnished as part of the system. The test conditions in ANSI/AHRI Standard 210/240 vary the external static pressure (i.e., pressure drop associated with ductwork and other devices external to the indoor fan/coil section) seen by the supply air fan based on the standard rating cooling capacity.

\subsubsection{Seasonal Energy Efficiency Ratio (SEER) for Multi-Speed DX Coil}\label{seasonal-energy-efficiency-ratio-seer-for-multi-speed-dx-coil}

The SEER value for multi-speed compressor air conditioner or air-to-air heat pumps per AHRI/ANSI Std. 210/240 -- 2008 is calculated as follows:

\begin{equation}
SEER = \frac{{\sum\limits_{j = 1}^8 {\frac{{{q_c}({T_j})}}{N}} }}{{\sum\limits_{j = 1}^8 {\frac{{{e_c}({T_j})}}{N}} }}
\end{equation}

where:

\(q_{c}\)(T\(_{j}\))/N is the ratio of space cooling capacity provided by the unit during periods of the space cooling season when the outdoor temperature fell within the range represented by bin temperature \(T_{j}\) to the total number of hours in the cooling season (N), (W)

\(e_{c}\)(T\(_{j}\))/N is the ratio of the electrical energy consumed by the unit during periods of the space cooling season when the outdoor temperature fell within the range represented by bin temperature Tj to the total number of hours in the cooling season (N), W.

\emph{j} is the bin number, dimensionless. For cooling season, j ranges from 1 to 8.

\(T_{j}\) is the outdoor air bin temperature (\(^{\circ}\)C). Outdoor temperatures are ``binned'' such that calculations are only performed based one temperature within the bin. Bins of 2.8\(^{\circ}\)C with 8 cooling season bin temperatures being 19.44\(^{\circ}\)C, 22.22\(^{\circ}\)C, 25.0\(^{\circ}\)C, 27.78\(^{\circ}\)C, 30.56\(^{\circ}\)C, 33.33\(^{\circ}\)C, 36.11\(^{\circ}\)C, 38.89\(^{\circ}\)C.

For multi-speed compressor the SEER value is weighted average performance at different outdoor air temperature bins.~ The eight outdoor air temperature bins and the corresponding weight are provided in Table~\ref{table:distribution-of-fractional-hours-with-in}. Distribution of Fractional Hours with in Cooling Season Temperature Bins.

The steady-state cooling capacity delivered and the electric power inputs when the DX coil is operating at minimum compressor speed (\emph{k = 1}), and outdoor air temperature \(T_{j}\), are determined by linear interpolation using the values of B1 and F1 tests as follows:

\begin{equation}
\dot Q_c^{k = 1}({T_j}) = \dot Q_c^{k = 1}(19.44) + \frac{{\dot Q_c^{k = 1}(27.78) - \dot Q_c^{k = 1}(19.44)}}{{27.78 - 19.44}}\left( {{T_j} - 19.44} \right)
\end{equation}

\begin{equation}
\dot E_c^{k = 1}({T_j}) = \dot E_c^{k = 1}(19.44) + \frac{{\dot E_c^{k = 1}(27.78) - \dot E_c^{k = 1}(19.44)}}{{27.78 - 19.44}}\left( {{T_j} - 19.44} \right)
\end{equation}

The steady-state cooling capacities and electric power inputs at the minimum speed and test condition \(B_{1}\) and \(F_{1}\) are calculated from the minimum (low) speed performance curves as follows:

\begin{equation}
\dot Q_c^{k = 1}(27.78) = \dot Q_{T,\,CRated}^{k = 1} \cdot CAPFT_{TestB1}^{k = 1} \cdot CAPFFF_{TestB1}^{k = 1} - FanPower_{CRated}^{k = 1}
\end{equation}

\begin{equation}
\dot E_c^{k = 1}(27.78) = \left[ {\frac{{\dot Q_c^{k = 1}(27.78)}}{{COP_{CRated}^{k = 1}}}} \right] \cdot EIRFT_{TestB1}^{k = 1} \cdot EIRFFF_{TestB1}^{k = 1} + FanPower_{CRated}^{k = 1}
\end{equation}

\begin{equation}
\dot Q_c^{k = 1}(19.44) = \dot Q_{T,\,CRated}^{k = 1} \cdot CAPFT_{TestF1}^{k = 1} \cdot CAPFFF_{TestF1}^{k = 1} - FanPower_{CRated}^{k = 1}
\end{equation}

\begin{equation}
\dot E_c^{k = 1}(19.44) = \left[ {\frac{{\dot Q_c^{k = 1}(19.44)}}{{COP_{CRated}^{k = 1}}}} \right] \cdot EIRFT_{TestF1}^{k = 1} \cdot EIRFFF_{TestF1}^{k = 1} + FanPower_{CRated}^{k = 1}
\end{equation}

\begin{equation}
FanPower_{CRated}^{k = 1} = FanPowerPerVolFlowRat{e^{k = 1}} \cdot {\rm{\dot V}}_{CRated}^{k = 1}
\end{equation}

where:

\(\dot Q_{T,\,CRated}^{k = 1}\) is the rated total cooling capacity at minimum compressor speed specified by users (W)

\(COP_{CRated}^{k = 1}\) is the rated gross COP at minimum compressor speed specified by users (-)

\(CAPFT_{TestB1}^{k = 1}\) is the cooling capacities modifier curve for temperature at minimum compressor speed and B1 test condition (-)

\(CAPFFF_{TestB1}^{k = 1}\) is the cooling capacities modifier curve for flow fraction at minimum compressor speed and B1 test condition (-)

\(EIRFT_{TestB1}^{k = 1}\) is the EIR modifier curve for temperature at minimum compressor speed and B1 test condition (-)

\(EIRFFF_{TestB1}^{k = 1}\) is the EIR modifier curve for flow fraction at minimum compressor speed and B1 test condition (-)

\(CAPFT_{TestF1}^{k = 1}\) is the cooling capacities modifier curve for temperature at minimum compressor speed and F1 test condition (-)

\(CAPFFF_{TestF1}^{k = 1}\) is the cooling capacities modifier curve for flow fraction at minimum compressor speed and F1 test condition (-)

\(EIRFT_{TestF1}^{k = 1}\) is the EIR modifier curve for temperature at minimum compressor speed and F1 test condition (-)

\(EIRFFF_{TestF1}^{k = 1}\) is the EIR modifier curve for flow fraction at minimum compressor speed and F1 test condition (-)

\(FanPower_{CRated}^{k = 1}\) is the the rated supply air fan power when the unit is operating at minimum compressor speed (W)

\(V_{CRated}^{k = 1}\) is the rated cooling supply air volume flow rate at minimum compressor speed specified by users (-)

\(FanPowerPerVolFlowRat{e^{k = 1}}\) is the rated indoor coil fan power per volume flow rate at low (minimum) compressor speed specified value by the user (W/(m\(^3\)/s)).

The steady-state cooling capacity delivered and the electric power inputs when the DX cooling coil is operating at maximum (high) compressor speed (\emph{k = 2}), and outdoor air temperature \(T_{j}\), are determined as follows:

\begin{equation}
\dot Q_c^{k = 2}({T_j}) = \dot Q_c^{k = 2}(27.78) + \frac{{\dot Q_c^{k = 2}(35.0) - \dot Q_c^{k = 2}(27.78)}}{{35.0 - 27.78}}\left( {{T_j} - 27.78} \right)
\end{equation}

\begin{equation}
\dot E_c^{k = 2}({T_j}) = \dot E_c^{k = 2}(27.78) + \frac{{\dot E_c^{k = 2}(35.0) - \dot E_c^{k = 2}(27.7)}}{{35.0 - 27.78}}\left( {{T_j} - 27.78} \right)
\end{equation}

The steady-state cooling capacities and electric power input at the maximum speed and test condition \(A_{2}\) and \(B_{2}\) are determined from the maximum (high) speed performance curves as follows:

\begin{equation}
\dot Q_c^{k = 2}(35.0) = \dot Q_{T,\,CRated}^{k = 2} \cdot CAPFT_{TestA2}^{k = 2} \cdot CAPFFF_{TestA2}^{k = 2} - FanPower_{CRated}^{k = 2}
\end{equation}

\begin{equation}
\dot E_c^{k = 2}(35.0) = \left[ {\frac{{\dot Q_c^{k = 2}(35.0)}}{{COP_{CRated}^{k = 2}}}} \right] \cdot EIRFT_{TestA2}^{k = 2} \cdot EIRFFF_{TestA2}^{k = 2} + FanPower_{CRated}^{k = 2}
\end{equation}

\begin{equation}
  \dot Q_c^{k = 2}(27.78) = \dot Q_{T,\,CRated}^{k = 2} \cdot CAPFT_{TestB2}^{k = 2} \cdot CAPFFF_{TestB2}^{k = 2} - FanPower_{CRated}^{k = 2}
\end{equation}

\begin{equation}
  \dot E_c^{k = 2}(27.78) = \left[ {\frac{{\dot Q_c^{k = 2}(19.44)}}{{COP_{CRated}^{k = 2}}}} \right] \cdot EIRFT_{TestB2}^{k = 2} \cdot EIRFFF_{TestB2}^{k = 2} + FanPower_{CRated}^{k = 2}
\end{equation}

\begin{equation}
  FanPower_{CRated}^{k = 2} = FanPowerPerVolFlowRat{e^{k = 2}} \cdot {\rm{\dot V}}_{CRated}^{k = 2}
\end{equation}

where:

\(\dot Q_{T,\,CRated}^{k = 2}\) is the rated total cooling capacity at maximum (high) compressor speed specified by users (W)

\(COP_{CRated}^{k = 2}\) is the rated gross COP at maximum (high) compressor speed specified by users (-)

\(CAPFT_{TestA2}^{k = 2}\) is the cooling capacity modifier curve for temperature at maximum (high) compressor speed and \emph{A}\(_{2}\) test condition (-)

\(CAPFFF_{TestA2}^{k = 2}\) is the cooling capacity modifier curve for flow fraction at maximum (high) compressor speed and \emph{A}\(_{2}\) test condition (-)

\(EIRFT_{TestA2}^{k = 2}\) is the EIR modifier curve for temperature at maximum (high) compressor speed and \emph{A}\(_{2}\) test condition (-)

\(EIRFFF_{TestA2}^{k = 2}\) is the EIR modifier curve for flow fraction at maximum (high)~ compressor speed and \emph{A}\(_{2}\) test condition (-)

\(CAPFT_{TestB2}^{k = 2}\) is the cooling capacity modifier curve for temperature at maximum (high) compressor speed and \emph{B}\(_{2}\) test condition (-)

\(CAPFFF_{TestB2}^{k = 2}\) is the cooling capacity modifier curve for flow fraction at maximum (high) compressor speed and \emph{B}\(_{2}\) test condition (-)

\(EIRFT_{TestB2}^{k = 2}\) is the EIR modifier curve for temperature at maximum (high) compressor speed and \emph{B}\(_{2}\) test condition (-)

\(EIRFFF_{TestB2}^{k = 2}\) is EIR modifier curve for flow fraction at maximum (high) compressor speed and \emph{B}\(_{2}\) test condition (-)

\(FanPower_{CRated}^{k = 2}\) is the the rated supply air fan power when the unit is operating at maximum (high) compressor speed (W)

\(V_{CRated}^{k = 2}\) is the rated supply air volume flow rate at maximum (high) compressor speed specified by users (-)

\(FanPowerPerVolFlowRat{e^{k = 2}}\) is the the Rated Evaporator (Indoor Coil) Fan Power Per Volume Flow rate at maximum (high) compressor speed specified value by the user (W/(m\(^3\)/s)).

The above steps show how the cooling capacity and electric power inputs are determined when the DX cooling coil is operating at minimum (low) and maximum (high) compressor speeds.~ But the unit may operate at minimum (low) speed capacity, cycle on--off, cycle between successiave lower and higher compressor speed capacity, or operate at maximum (high) speed capacity depending on the building cooling load. The operating range of the DX cooling coil is determined based on the building cooling load for each binned outside air temperature. The building cooling load at an outdoor air temperature \(T_{j}\), is calculated as follows:

\begin{equation}
BL({T_j}) = \left( {\frac{{{T_j} - 18.3}}{{35.0 - 18.3}}} \right)\left( {\frac{{\dot Q_c^{k = 2}(35.0)}}{{1.1}}} \right)
\end{equation}

where:

\emph{BL(T}\(_{j}\)) is the building space cooling load corresponding to outdoor temperature of \(T_{j}\) (W)

\(\dot Q_c^{k = 2}(35.0)\) is the the cooling capacity determined from the standard A2 test (W).

The temperatures 35.0\(^{\circ}\)C and 18.3\(^{\circ}\)C in the building load calculation equation represent the outdoor design air temperature, and zero-load base temperature, respectively (ANSI/ASHRAE, 2008).~ 1.1 is a sizing factor.

The cooling capacity delivered and the electric power inputs calculations when the DX cooling coil is cycling on-off, operating at minimum (low) compressor speed, cycling between successive minimum (low) and maximum (high) compressor speed, or operating at maximum (high) compressor speed are described next.

\emph{Case 1}:~ The steady state cooling capacity when the unit is operating at or below the minimum (low) speed compressor capacity, i.e., when the building cooling load is less or equal to the minimum (low) compressor speed capacity, is calculated as follows:

\begin{equation}
\dot Q_c^{k = 1}({T_j}) \ge BL({T_j})
\end{equation}

\begin{equation}
\frac{{{q_c}({T_j})}}{N} = \left[ {{X^{k = 1}}({T_j}) \cdot \dot Q_c^{k = 1}({T_j})} \right] \cdot \frac{{{n_j}}}{N}
\end{equation}

\begin{equation}
\frac{{{e_c}({T_j})}}{N} = \left[ {\frac{{{X^{k = 1}}({T_j})}}{{PL{F_j}}}\dot E_c^{k = 1}({T_j})} \right] \cdot \frac{{{n_j}}}{N}
\end{equation}

\begin{equation}
{X^{k = 1}}({T_j}) = \frac{{BL({T_j})}}{{\dot Q_c^{k = 1}({T_j})}}
\end{equation}

\begin{equation}
PL{F_j} = 1 - C_D^c\left[ {1 - {X^{k = 1}}({T_j})} \right]
\end{equation}

where:

\emph{X(T\(_{j}\))} is the cooling mode load factor or part-load ratio for temperature bin j (-)

n\(_{i}\)/N is the fractional bin hours for the cooling season; the ratio of the number of hours during the cooling season when the outdoor temperature fell within the range represented by bin temperature \emph{T\(_{j}\)} to the total number of hours in the cooling season (-). (see Table~\ref{table:distribution-of-fractional-hours-with-in})

\(C_D^c\) is the cooling coefficient of degradation, default value is 0.25.

\emph{Case 2}:~ The unit cycles between successive the minimum (low) and maximum (high) compressor speed capacity to meet the building cooling load at outdoor air temperature \emph{T\(_{j}\)}.~ That is, the cooling building load is between the units successive minimum (low) and maximum (high) compressor speed capacities:

\begin{equation}
\dot Q_c^{k = 1}({T_j}) < BL({T_j}) < \dot Q_c^{k = 2}({T_j})
\end{equation}

\begin{equation}
  \frac{{{q_c}({T_j})}}{N} = \left[ {{X^{k = 1}}({T_j}) \cdot \dot Q_c^{k = 1}({T_j}) + \left( {1 - {X^{k = 1}}({T_j})} \right) \cdot \dot Q_c^{k = 2}({T_j})} \right] \cdot \frac{{{n_j}}}{N}
\end{equation}

\begin{equation}
  \frac{{{e_c}({T_j})}}{N} = \left[ {{X^{k = 1}}({T_j}) \cdot \dot E_c^{k = 1}({T_j}) + \left( {1 - {X^{k = 1}}({T_j})} \right) \cdot \dot E_c^{k = 2}({T_j})} \right] \cdot \frac{{{n_j}}}{N}
\end{equation}

\begin{equation}
{X^{k = 1}}({T_j}) = \frac{{\dot Q_c^{k = 2}({T_j}) - BL({T_j})}}{{\dot Q_c^{k = 2}({T_j}) - \dot Q_c^{k = 1}({T_j})}}
\end{equation}

\emph{Case 3}:~ The steady-state cooling capacity when the unit is operating continuously at maximum (high) compressor speed capacity at outdoor air temperature \(T_{j}\). That is the building cooling load is greater or equal to the available capacity at maximum (high) compressor speed:

\begin{equation}
BL({T_j}) \ge \dot Q_c^{k = 2}({T_j})
\end{equation}

For units when operating continuously at maximum (high) compressor speed (k = 2) at temperature \(T_{j}\), the delivered cooling capacity and electric power inputs are calculated as follows:

\begin{equation}
\frac{{{q_c}({T_j})}}{N} = \left[ {\dot Q_c^{k = 2}({T_j})} \right] \cdot \frac{{{n_j}}}{N}
\end{equation}

\begin{equation}
\frac{{{e_c}({T_j})}}{N} = \left[ {\dot E_c^{k = 2}({T_j})} \right] \cdot \frac{{{n_j}}}{N}
\end{equation}

% table 56
\begin{longtable}[c]{>{\raggedright}p{1.5in}p{0.7in}p{0.7in}p{0.7in}p{0.7in}p{0.7in}>{\raggedright}p{1.0in}}
\caption{Cooling Mode Test Conditions for Units Having a Two-Capacity Compressor \label{table:cooling-mode-test-conditions-for-units-having}} \tabularnewline
\toprule 
Test & \multicolumn{2}{p{1.4in}}{\raggedright Air Entering Indoor Unit Temperature (\(^{\circ}\)F/\(^{\circ}\)C)} & \multicolumn{2}{p{1.4in}}{\raggedright Air Entering Outdoor Unit Temperature (\(^{\circ}\)F/\(^{\circ}\)C)} \tabularnewline
\cmidrule(r){2-3}
\cmidrule(l){4-5}
Description & Dry Bulb & Wet Bulb & Dry Bulb & Wet Bulb & Compressor Capacity & Cooling Air Volume Rate \tabularnewline
\midrule
\endfirsthead

\caption[]{Cooling Mode Test Conditions for Units Having a Two-Capacity Compressor} \tabularnewline
\toprule 
Test & \multicolumn{2}{p{1.4in}}{\raggedright Air Entering Indoor Unit Temperature (\(^{\circ}\)F/\(^{\circ}\)C)} & \multicolumn{2}{p{1.4in}}{\raggedright Air Entering Outdoor Unit Temperature (\(^{\circ}\)F/\(^{\circ}\)C)} \tabularnewline
\cmidrule(r){2-3}
\cmidrule(l){4-5}
Description & Dry Bulb & Wet Bulb & Dry Bulb & Wet Bulb & Compressor Capacity & Cooling Air Volume Rate \tabularnewline
\midrule
\endhead

A2 Test-required (steady, wet coil) & 80.0/26.7 & 67.0/19.4 & 95.0/35.0 & 75.0/23.9 & High & Cooling Full-load \tabularnewline
B2 Test-required (steady, wet coil) & 80.0/26.7 & 67.0/19.4 & 82.0/27.8 & 65.0/18.3 & High & Cooling Full-load \tabularnewline
B1 Test-required (steady, wet coil) & 80.0/26.7 & 67.0/19.4 & 82.0/27.8 & 65.0/18.3 & Low & Cooling Minimum \tabularnewline
C2 Test-optional (steady, dry coil) & 80.0/26.7 &  & 82.0/27.8 &  & High & Cooling Full-load \tabularnewline
D2 Test-required (cyclic, dry coil) & 80.0/26.7 &  & 82.0/27.8 &  & High &  \tabularnewline
C1 Test-optional (steady, dry coil) & 80.0/26.7 &  & 82.0/27.8 &  & Low & Cooling Minimum \tabularnewline
D1 Test-optional (cyclic, dry coil) & 80.0/26.7 &  & 82.0/27.8 &  & Low &  \tabularnewline
F1 Test-optional (steady, dry coil) & 80.0/26.7 & 67.0/19.4 & 67.0/19.4 & 53.5/11.9 & High & Cooling Minimum \tabularnewline
\bottomrule
\multicolumn{7}{l}{Source: AHRI Standard 210-240, 2008; Table 5, Page 65}
\end{longtable}

% table 57
\begin{longtable}[c]{p{1.5in}p{1.5in}p{1.5in}p{1.5in}}
\caption{Distribution of Fractional Hours with in Cooling Season Temperature Bins \label{table:distribution-of-fractional-hours-with-in}} \tabularnewline
\toprule 
\endfirsthead

\caption[]{Distribution of Fractional Hours with in Cooling Season Temperature Bins} \tabularnewline
\toprule 
\endhead

Bin Number j & Bin Temperature Range (\(^{\circ}\)C) & Representative Temperature for bin (\(^{\circ}\)C) & Fraction of Total Temperature Bin Hours Nj/N \tabularnewline
1 & Dry Bulb & Wet Bulb & Dry Bulb \tabularnewline
2 & 18.33 - 20.56 & 19.44 & 0.214 \tabularnewline
3 & 21.11 - 23.33 & 22.22 & 0.231 \tabularnewline
4 & 23.89 - 26.11 & 25 & 0.216 \tabularnewline
5 & 26.67 - 28.89 & 27.78 & 0.161 \tabularnewline
6 & 29.44 - 31.67 & 30.56 & 0.104 \tabularnewline
7 & 32.22 - 34.44 & 33.33 & 0.052 \tabularnewline
8 & 35.00 - 37.22 & 36.11 & 0.018 \tabularnewline
\bottomrule
\multicolumn{4}{l}{Source: AHRI Standard 210-240, 2008; Table 16, Page 94}
\end{longtable}

\subsubsection{Energy Management System Coil Speed Override}\label{energy-management-system-coil-speed-level-override-1}

The cooling coil speed level and cycling/speed ratio can be actuated by EMS at run-time. When EMS is used to overwrite the “Unitary System DX Coil Speed Value”, the speed levels are set based on EMS values rather than speed levels determined by the Non-EMS EnergyPlus control logic. The EMS override coil speed value is a continuous number below maximum coil speed level allowed. With any EMS override coil speed value, if the input value is a integer, the speed level is set as the exact speed value input, with the cycling or speed ratio = 1.0. Otherwise, if the floating point part is greater than zero, the speed level is calculated as the closest integer greater than the EMS speed value, and the cycling/speed ratio is set as the floating point part of the EMS speed value. For example, if EMS overrides coil speed value = 1.2, the speed level number is set as 2 with a speed ratio at 0.2.

\subsubsection{References}\label{references-3-001}

See the references for the single speed DX cooling coil earlier in this document.

\subsection{Two-Speed Electric DX Air Cooling Coil}\label{two-speed-electric-dx-air-cooling-coil}

\subsubsection{Overview}\label{overview-3-003}

The input object Coil:Cooling:DX:TwoSpeed provides a model that is meant to represent either a 2 speed (fan and compressor) DX cooling unit (compressor, evaporator, condenser) or a variable speed DX cooling unit in which the variation of compressor speed and air flow rate is nearly linear as a function of cooling part load. In EnergyPlus Coil:Cooling:DX:TwoSpeed is used as the cooling coil in packaged variable volume systems (PVAV). The model is based upon the single speed DX unit Coil:Cooling:DX:SingleSpeed. Basically the model for Coil:Cooling:DX:TwoSpeed employs a separate single speed model at high speed (full load) and low speed (minimum load) and interpolates between these 2 states to obtain the needed cooling output. Below minimum load the unit cycles on/off, just like the single speed unit.

\subsubsection{Inputs and Data}\label{inputs-and-data-001}

The input is similar to that for Coil:Cooling:DX:SingleSpeed except there needs to be two complete sets of performance data. The user inputs a rated total cooling capacity, rated SHR, rated COP, and rated air volumetric flow rate for the high speed and low speed states. Performance curves -- cooling capacity as a function of entering air wet-bulb temperature and outside dry-bulb temperature (wet-bulb if there is an evaporatively cooled condenser), EIR as a function of the same two temperatures -- must be defined and referenced for both high and low speed states. The performance characteristics of the evaporative condenser, if present, also need to be given at high and low speed states: effectiveness, air volumetric flow rate, and pump power consumption. The full list of inputs is given in the Input/Output Reference document.

The data for Coil:Cooling:DX:TwoSpeed is stored in the array structure \emph{DXCoil} in the program module \emph{DXCoils}

\subsubsection{Calculation}\label{calculation-000}

Calculation is performed in routine \emph{CalcMultiSpeedDXCoil} in module \emph{DXCoils}. The inputs to the calculation are the coil index (denoting a specific coil with its particular performance parameters), the speed ratio, and the cycling ratio. The speed ratio is an artificial parameter between 0 and 1. If the speed ratio (\emph{SR}) is greater than zero, the performance of the unit will be:

\begin{equation}
SR\cdot HighSpeedPerformance + (1 - SR)\cdot LowSpeedPerformance
\end{equation}

Here \emph{HighSpeedPerformance} means the electricity consumption, cooling output, and outlet conditions of the unit if the unit were operating at high speed (full load). Similarly \emph{LowSpeed Performance} means the electricity consumption, cooling output, and outlet conditions if the unit were operating at low speed (minimum non-cycling load). The calculations for each state are the same as for the single speed, cycling DX unit Coil:Cooling:DX:SingleSpeed.

If the speed ratio is zero and the cycling ratio is \textgreater{} 0, the unit will be in cycling mode. The unit will be on for \emph{cycling ratio} fraction of the time step, off for the remainder of the time step. While on, the unit will perform according to the low speed performance parameters.

\subsubsection{Simulation and Control}\label{simulation-and-control-001}

Coil:Cooling:DX:TwoSpeed is not used by itself; it is used as part of an encompassing component or system that provides control for the unit. In setting up a PVAV system, for instance, Coil:Cooling:DX:TwoSpeed is part of the component CoilSystem:Cooling:DX, which controls Coil:Cooling:DX:TwoSpeed. When used in the CoilSystem:Cooling:DX component, the simulation allows for either temperature \emph{or} temperature and dehumidification control based on a dehumidification control selection in the CoilSystem:Cooling:DX component. If None is selected the simulation runs the DX unit to satisfy a supply air temperature setpoint. It typically varies the speed ratio in an iterative solution process to establish the operating point that will give the desired unit outlet air temperature. If CoolReheat is selected, the simulation first runs the DX unit to satisfy a supply air temperature setpoint. However, in this case if the DX unit outlet air humidity ratio is above the humidity ratio setpoint, the simulation will increase the speed and/or cycling ratio to meet the desired unit outlet air humidity ratio. The humidity ratio setpoint is specified through the use of a humidistat (ref. ZoneControl:Humidistat) and a setpoint manager (ref. SetpointManager:SingleZone:Humidity:Maximum, SetpointManager:MultiZone:MaximumHumidity:Average,~ SetpointManager:MultiZone:Humidity:Maximum or SetpointManager:OudoorAirPretreat). When used with the CoilSystem:Cooling:DX component, the dehumidification control type Multimode is not allowed.

\subsubsection{Basin Heater For Two-Speed DX Coil}\label{basin-heater-for-two-speed-dx-coil}

Basin heater for the object Coil:Cooling:DX:TwoSpeed operates in the same manner as for Coil:Cooling:DX:SingleSpeed. Refer to the ``Basin Heater For Single-Speed DX Coil'' description above.

\subsubsection{Standard Ratings}\label{standard-ratings}

The Coil:Cooling:DX:TwoSpeed object includes industry standard ratings of Standard Rating Cooling Capacity, Energy Efficiency Ratio (EER), and Integrated Energy Efficiency Ratio (IEER) which are calculated according to ANSI/AHRI Standard 340/360-2007 with Addenda 1 and 2 (AHRI 2007). These ratings apply to unitary air conditioners with air-cooled condensers with standard rated cooling capacities from 19 kW (65,000 Btu/h) to below 220 kW (760,000 Btu/h).

For the Coil:Cooling:DX:TwoSpeed object in EnergyPlus, these standard ratings are not direct inputs to the model. However, these standard ratings can be calculated using user-entered information for the Coil:Cooling:DX:TwoSpeed object. These standard rating values are provided in the eplusout.eio output file (Ref. OutputDetailsAndExamples.pdf) and also in the predefined tabular output reports (Output:Table:SummaryReports object, Equipment Summary report, DX Cooling Coil table and VAV DX Cooling Standard Rating Details table). Currently, the standard ratings are only calculated and output for Packaged VAV cooling coils with air-cooled condensers and variable-air-volume fans. If the two-speed DX coling coil is specified with an evaporatively-cooled condenser or along with a constant volume fan, then no standard ratings are output from EnergyPlus at this time.

The standard rating cooling capacity is calculated as follows:

\begin{equation}
\dot{Q}_{StandardRating} = \dot{Q}_{Total,Rated} TotCapTempModFac_{Rated} TotCapFlowModFac_{Rated} - FanHeatCorrection
\end{equation}

where:

\({\dot Q_{StandardRating}}\) is the standard rating (net) cooling capacity (W)

\({\dot Q_{Total,Rated}}\) is the rated total (gross) cooling capacity, user input (W)

\(TotCapTempModFa{c_{Rated}}\) is the total cooling capacity function of temperature curve evaluated with 19.4\(^{\circ}\)C wet-bulb temperature air entering the cooling coil and 35.0\(^{\circ}\)C dry-bulb temperature air entering the air-cooled (outdoor) condenser (dimensionless)

\(TotCapFlowModFa{c_{Rated}}\) is the total cooling capacity function of flow fraction curve evaluated at a flow fraction of 1.0 (dimensionless)

\(FanHeatCorrection\) is the rate that air is heated by the supply fan (W).

\(FanHeatCorrection\) is calculated in one of two ways depending on the user's input for the field called Unit Internal Static Air Pressure.~ If this field was left blank, then the fan heat is calculated using:

\begin{equation}
FanHeatCorrection = {\dot V_{RatedHighSpeed}}*773.3
\end{equation}

where:

\({\dot V_{RatedHighSpeed}}\) is the rated air volume flow rate at high speed, user input (m\(^{3}\)/s).

The value of 773.3 W/(m\(^{3}\)/s) (365 W/1000cfm) is specified by ANSI/AHRI 340/360 for indoor-coil-only units that are not provided with a supply fan.

If an internal static pressure is provided, then the fan heat is modeled by evaluating the full model for Fan:VariableVolume.~ This is different that the ratings calculated for single-speed DX equipment which does not use data from an associated fan object.~ The program detects the VAV fan associated with the two-speed coil and uses the input data for that fan but with a different total air pressure rise.~ The total pressure is the sum of the internal pressure and the external pressure (i.e., pressure drop associated with ductwork and other devices external to the indoor fan/coil section). The test conditions in ANSI/AHRI Standard 340/360 vary the (minimum) external static pressure seen by the supply air fan based on the standard rating cooling capacity (see Table \# 5 in ANSI/AHRI Standard 340/360).~ For the part load test points the supply air flow is reduced and the external pressure varies with the square of the flow ratio (see Note 1 in Table \# 6 in ANSI/AHRI Standard 340/360-2007 with Addenda 1 and 2). The entire VAV fan model in EnergyPlus is evaluated at the specified air flow rate and the total static pressure for rating and the fan heat is calculated using

\begin{equation}
FanHeatCorrection = Enthalp{y_{leavingFan}} - Enthalp{y_{enteringFan}}
\end{equation}

Energy Efficiency Ratio (EER) is another standard rating (AHRI 2007), and it is defined as the ratio of the total cooling capacity to the total power input at any given set of rating conditions, expressed in W/W (or Btu/W-h). For this class of air-cooled DX cooling coils, EER is calculated at rated test conditions as follows:

\begin{equation}
  EER = \frac{{\dot Q}_{Standard\,Rating}}{Power_{Total,Rated}}
\end{equation}

\begin{equation}
    Power_{Total,Rated} = \dot{Q}_{Total,Rated} TotCapTempModFac_{Rated} TotCapFlowModFac_{Rated} EIR_{Rated} + FanPowerCorrection
\end{equation}

\begin{equation}
  EIR_{Rated} = \left( {\frac{1}{{CO{P_{Rated}}}}} \right)(EIRTempModFa{c_{Rated}})(EIRFlowModFa{c_{Rated}})
\end{equation}

where:

\emph{EER} is the Energy Efficiency Ratio (W/W)

\(Power_{Total,Rated}\) is the total electric power (compressors, condenser fans and evaporator fan) with 19.4\(^{\circ}\)C wet-bulb temperature air entering the cooling coil, 35.0\(^{\circ}\)C dry-bulb temperature air entering the air-cooled (outdoor) condenser, and air flow rate across the evaporator at the rated high speed air flow rate.

Similar to the fan heat correction, the fan power correction is calculated in one of two ways depending on the input for internal static pressure.~ If no internal static is provided, fan power is calculated using:

\begin{equation}
  FanPowerCorrection = {\dot V_{RatedHighSpeed}} * 773.3
\end{equation}

If the internal static pressure is provided, then the entire VAV fan model in EnergyPlus is evaluated at the rated high speed air flow rate and the total static pressure for rating and the then the fan power calculated by the fan model is used for the fan power correction.

\(TotCapTempModFac_{Rated}\) is the total cooling capacity function of temperature curve evaluated with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil and 35.0\(^{\circ}\)C dry-bulb temperature air entering the air-cooled (outdoor) condenser (dimensionless)

\(EIRTempModFa{c_{Rated}}\) is the Energy Input Ratio function of temperature curve evaluated with 19.44\(^{\circ}\)C wet-bulb temperature air entering the cooling coil and 35.0\(^{\circ}\)C dry-bulb temperature air entering the air-cooled (outdoor) condenser (dimensionless).

The Integrated Energy Efficiency Ratio (IEER) is intended to be a measure of merit for the cooling coil's part-load efficiency. IEER replaced Integrated Part-Load Value (IPLV) as the part-load performance metric in Std. 340/360 as of January 1, 2010. Full details regarding the IEER calculation are available in ANSI/AHRI Std. 340/360 (AHRI 2007). A summary of the IEER calculations made by EnergyPlus for two-speed air-cooled DX cooling coils is provided below:

\begin{equation}
  IEER = \,(0.02 \cdot EE{R_A}) + (0.617 \cdot EE{R_B}) + (0.238 \cdot EE{R_C}) + (0.125 \cdot EE{R_D})
\end{equation}

where:

\(EER_A\) is the \emph{EER} at 100\% net capacity at AHRI standard rating conditions (same as EER calculation shown above but in Btu/h)

\(EER_B\) is the \emph{EER} at 75\% net capacity and reduced outdoor air temperature Btu/h

\(EER_C\) is the \emph{EER} at 50\% net capacity and reduced outdoor air temperature Btu/h

\(EER_D\) is the \emph{EER} at 25\% net capacity and reduced outdoor air temperature Btu/h.

The following table summarizes the test points.

% table 58
\begin{longtable}[c]{p{0.8in}p{0.8in}p{0.8in}p{0.8in}p{0.8in}p{2.0in}}
\caption{Test points for Two-Speed DX Coil Ratings \label{table:test-points-for-two-speed-dx-coil-ratings}} \tabularnewline
\toprule 
Point & Net Capacity & Coil inlet wetbulb & Coil inlet drybulb & Condenser inlet drybulb & Supply air flow rate \tabularnewline
\midrule
\endfirsthead

\caption[]{Test points for Two-Speed DX Coil Ratings} \tabularnewline
\toprule 
Point & Net Capacity & Coil inlet wetbulb & Coil inlet drybulb & Condenser inlet drybulb & Supply air flow rate \tabularnewline
\midrule
\endhead

A & 100\% & 19.4\(^{\circ}\)C & 26.7\(^{\circ}\)C & 35.0\(^{\circ}\)C & Rated High speed flow rate \tabularnewline
\midrule
B & 75\% & 19.4\(^{\circ}\)C & 26.7\(^{\circ}\)C & 27.5\(^{\circ}\)C & Root solver result where \tabularnewline
C & 50\% & 19.4\(^{\circ}\)C & 26.7\(^{\circ}\)C & 20.0\(^{\circ}\)C & coil leaving drybulb\tabularnewline
D & 25\% & 19.4\(^{\circ}\)C & 26.7\(^{\circ}\)C & 18.3\(^{\circ}\)C & matches Point A\tabularnewline
\bottomrule
\end{longtable}

The units are assumed to be VAV and Standard 340/360 is be applied as for VAV indoor supply fan.~ Because the standard stipulates ``the airflow rate at part load should be adjusted to maintain the full load measured leaving dry-bulb temperature,'' the part load rating test points ``B'', ``C'', and ``D'' are evaluated by using the entire DX coil model calculations to obtain the supply air conditions leaving the coil and iterating on supply air flow rate to find the supply air flow rate.~ The numerical method called root solver is used to find the supply flow rate at each of the part load test points.~ Once the supply air flow rate is known, the two-speed DX coil model results are used to determine EER at the part load test points.

When evaluating the two-speed DX coil model, the speed ratio and cycling ratio are specified based on the desired or target net capacity.~ When the low speed net capacity is lower than the target part load net capacity, the speed ratio is calculated using:

\begin{equation}
SpeedRatio = \frac{{DesiredNetCapacity - LowSpeedNetCapacity}}{{HighSpeedNetCapacity - LowSpeedNetCapacity}}
\end{equation}

When the low speed net capacity is higher than a target part load net capacity then the unit must cycle to meet the lower load.~ The speed ratio is then set to 0.0 (minimum unloading) and the cycling ratio is calculated using:

\begin{equation}
CyclingRatio = \frac{{DesiredNetCapacity}}{{LowSpeedNetCapacity}}
\end{equation}

The results for EER, COP, and supply air mass flow rate at the part load test points are reported to the EIO file and a predefined table report called VAV DX Cooling Standard Rating Details.

\subsubsection{Energy Management System Coil Speed Level Override}\label{energy-management-system-coil-speed-level-override-2}

The heating coil speed level and cycling/speed ratio can be actuated by EMS at run-time. When EMS is used to overwrite the “Unitary System DX Coil Speed Value”, the speed levels are set based on EMS values rather than speed levels determined by the Non-EMS EnergyPlus control logic. The EMS override coil speed value is a continuous number below maximum coil speed level allowed. With any EMS override coil speed value, if the input value is a integer, the speed level is set as the exact speed value input, with the cycling or speed ratio = 1.0. Otherwise, if the floating point part is greater than zero, the speed level is calculated as the closest integer greater than the EMS speed value, and the cycling/speed ratio is set as the floating point part of the EMS speed value. For example, if EMS overrides coil speed value = 1.2, the speed level number is set as 2 with a speed ratio at 0.2.

\subsubsection{References}\label{references-4-001}

See the references for the single speed DX cooling coil earlier in this document.

\subsection{Variable Speed DX Cooling Coil}\label{variable-speed-dx-cooling-coil}

\subsubsection{Overview}\label{overview-4-002}

The Coil:Cooling:DX:VariableSpeed object will simulate the performance of a DX cooling coil used in combination with a variable-speed unitary air conditioner and air-to-air heat pump. It fits into the parent objects of AirLoopHVAC:UnitaryHeatCool, ZoneHVAC:PackagedTerminalAirConditioner, AirLoopHVAC:UnitaryHeatPump:AirToAir and ZoneHVAC:PackagedTerminalHeatPump, etc.

The rated conditions for obtaining the capacities, COPs and SHR~ are indoor dry-bulb temperature at 26.67\(^{\circ}\)C (80\(^{\circ}\)F), wet bulb temperature at 19.44\(^{\circ}\)C (67\(^{\circ}\)F),~ and the source side entering air temperature at 35\(^{\circ}\)C (95\(^{\circ}\)F).

Variable-speed cooling coils lead to varied dehumidification behaviors, that the Bypass Factor (BF) is not only dependent on the indoor air flow rate, but also on the refrigerant mass flow rate, i.e.~the compressor speed. The methods of calculating Bypass factor and Sensible Heat Transfer Ratio at each speed are the same as the water source variable-speed cooling coil (object name Coil:Cooling:WaterToAirHeatPump:VariableSpeedEquationFit).

\subsubsection{Model Description}\label{model-description-3-003}

The Coil:Cooling:DX:VariableSpeed object is modeled in a manner similar to Coil:Cooling:WaterTo-AirHeatPump:VariableSpeedEquationFit. Of course, rather than referencing a water-cooled condenser, the new coil object references to outdoor air-cooled condenser, and has the air entering temperature in place of the condenser water entering temperature.

It shall be noted for the total cooling capacity and flow rate inputs, two fields are autosizable, which are Rated Total Cooling Capacity at Selected Nominal Speed Level and Rated Volumetric Air Flow Rate at Selected Nominal Speed Level. They are used to scale the performances of an actual unit and correlate with the actual loop flow. Except the two fields, all other total cooling capacity and flow rate inputs at individual speed levels should be directly obtained from Reference Unit catalog.

The Rated Total Cooling Capacity at Selected Nominal Speed Level contains the rated total cooling capacity to match the building sensible or latent cooling load.~ The rated cooling capacity is used to determine a capacity scaling factor, as compared to the Reference Unit catalog capacity at the nominal speed level.

\begin{equation}
{\rm{Capacity~Scale~Factor}} = \frac{{{\rm{Rated~Total~Cooling~Capacity}}}}{{{\rm{Reference~Unit~Total~Cooling~Capacity}}@{\rm{Nominal~Speed~Level}}}}
\end{equation}

And then, this scaling factor is used to determine capacities at rated condition for other speed levels, as below,

\begin{equation}
\begin{array}{l}
{\rm{Rated~Total~Cooling~Capacity}}@{\rm{Speed~Level}}\left( {\rm{x}} \right) = \\
{\rm{Capacity~Scale~Factor}} \times {\rm{Reference~Unit~Total~Cooling~Capacity}}@{\rm{Speed~Level}}({\rm{x}})
\end{array}
\end{equation}

The Rated Volumetric Air Flow Rate is used to determine an internal scaling factor, and calculate the air flow rates in the parent objects, as follows:

\begin{equation}
{\rm{Air~Flow~Scale~Factor}} = \frac{{{\rm{Rated~Volumetric~Air~Flow~Rate}}}}{{{\rm{Reference~Unit~Vol~Air~Flow~Rate}}@{\rm{Nominal~Speed~Level}} \times {\rm{CapacityScaleFactor}}}}
\end{equation}

And the loop volumetric air flow rates in the parent objects are calculated as below:

\begin{equation}
\begin{array}{l}
{\rm{Loop~Volumetric~Air~Flow~Rate}}@{\rm{Speed~Level}}\left( {\rm{x}} \right) = \\ {\rm{Air~Flow~Scale~Factor}} \times {\rm{Reference~Unit~Vol~Air~Flow~Rate}}@{\rm{Speed~Level}}({\rm{x}}) \times {\rm{Capacity~Scale~Factor}}
\end{array}
\end{equation}

If the volumetric air flow rate at one speed level is higher than the flow rate allowed by the fan in the parent object, the flow rate will be set back to the fan flow rate.

If \({\rm{Air~Flow~Scale~Factor}}\) equals to unity, the loop air flow rate become the design flow rates of the original unit (after scaled by the rated total cooling capacity). The Rated Volumetric Air Flow Rate is introduced here to correlate with the actual flow rate in the air loop, in case that these differ from the design specifications. Certainly, it is recommended that the Rated Volumetric Air Flow Rate is selected in the way that \({\rm{Air~Flow~Scale~Factor}}\) is unity, so as to get more accurate results from the performance curves.

If the condenser is evaporatively cooled, it is necessary to know the condenser air flow rate, so as to calculate the water evaporation rate. We will have fields for specifying the Reference Unit condenser volumetric air flow rates at individual speed levels, and these inputs are optional. If the condenser air flow rates are not inputted by the user, default values of condenser volumetric air flow rate as a function of the rated total cooling capacity will be used. Condenser air flow rates of the simulated unit are calculated as below,

\begin{equation}
  \begin{array}{l}
    \rm{Condenser~Volumetric~Air~Flow~Rate} @ \rm{Speed~Level} \left( {\rm{x}} \right) = \\
    \quad \quad \rm{Reference~Unit~Condenser~Vol~Air~Flow~Rate} @ \rm{Speed~Level} (\rm{x}) \times \\
    \quad \quad \quad \rm{Capacity~Scale~Factor}
  \end{array}
\end{equation}

\subsubsection{Performance Curves}\label{performance-curves}

This object includes 4 curve objects at each individual speed level.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item Total cooling capacity modifier curve (function of temperature)
\item Total cooling capacity modifier curve (function of air flow fraction)
\item Energy input ratio (EIR) modifier curve (function of temperature)
\item Energy input ratio (EIR) modifier curve (function of air flow fraction)
\end{enumerate}

The flow fraction modifier curves are used as a placeholder, to account for off-design flow rates if needed. If the manufacturer doesn't provide the off-design performances, we can simply use a default modification multiplier of 1.0.

At the lowest speed, there will be one additional performance curve to correlate the part-load condition, i.e.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{4}
\tightlist
\item
  Part load fraction correlation (function of part load ratio)
\end{enumerate}

More information on each of these curves is given below.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item Total cooling capacity modifier curve (function of temperature)
\end{enumerate}

The total cooling capacity modifier as a function of temperature curve (CAP-FT) is a biquadratic curve with two independent variables: wet-bulb temperature of the air entering the cooling coil and the condenser entering air temperature. The output of this curve is multiplied by the rated total cooling capacity at the speed, to give the total cooling capacity at the specific entering air WB and condenser inlet air DB at which the DX unit is operating (i.e., at temperatures different from the rating point temperatures).

Note: The data used to develop the total cooling capacity modifier curve (function of temperature) should represent performance when the cooling coil is `wet' (i.e., coil providing sensible cooling and at least some dehumidification). Performance data when the cooling coil is `dry' (i.e., not providing any dehumidification) should not be included when developing this modifier curve. This model automatically detects and adjusts for `dry coil' conditions.

\begin{equation}
{\rm{TotCapTempModFac}} = {\rm{a}} + {\rm{b*W}}{{\rm{B}}_{\rm{i}}} + {\rm{c*WB}}_{\rm{i}}^2 + {\rm{d*D}}{{\rm{B}}_{\rm{o}}} + {\rm{e*D}}{{\rm{B}}_{\rm{o}}}^2 + {\rm{f*W}}{{\rm{B}}_{\rm{i}}}{\rm{*D}}{{\rm{B}}_{\rm{o}}}
\end{equation}

where:

WB\(_{i}\) is the wet-bulb temperature of the air entering the indoor cooling coil (\(^{\circ}\)C)

DB\(_{o}\) is the dry-bulb temperature of the air entering the condenser coil (\(^{\circ}\)C)

a-f is the regression curve-fit coefficients.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\item Total cooling capacity modifier curve (function of air flow fraction)
\end{enumerate}

The total cooling capacity modifier curve (function of air flow fraction) is a cubic curve with the independent variable being the ratio of the actual air flow rate across the cooling coil to the design air flow rate (i.e., fraction of design flow at the speed).

\begin{equation}
{\rm{TotCapAirFlowModFac}} = {\rm{a}} + {\rm{b*f}}{{\rm{f}}_{\rm{a}}} + {\rm{c*ff}}_{\rm{a}}^2 + {\rm{d*ff}}_{\rm{a}}^3
\end{equation}

where:

ff\(_{a}\) is the actual air mass flow rate/design air mass flow rate, at one speed level

a-d are the regression curve fit coefficients.  If no data for correction is available, the user can simply use a = 1.0 and set the other coefficients to 0.0.

\begin{equation}
  \begin{array}{l}
    {\rm{DesignAirMassFlowRate}}@{\rm{SpeedLevel}}({\rm{x}}) = {\rm{}}\\\quad \quad \quad {\rm{ReferenceUnitAirMassFlowRate}}@{\rm{SpeedLevel}}({\rm{x}}) \times {\rm{CapacityScaleFactor}}
  \end{array}
\end{equation}

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  Energy input ratio (EIR) modifier curve (function of temperature)
\end{enumerate}

The energy input ratio modifier curve as a function of temperature (EIR-FT) is a biquadratic curve with two independent variables: wet-bulb temperature of the air entering the cooling coil and the condenser entering air temperature. The output of this curve is multiplied by the rated EIR (inverse of the rated COP) at the speed level, to give the EIR at the specific entering air temperatures at which the DX unit is operating (i.e., at temperatures different from the rating point temperatures).

\begin{equation}
{\rm{EIRTempModFac}} = {\rm{a}} + {\rm{b*W}}{{\rm{B}}_{\rm{i}}} + {\rm{c*WB}}_{\rm{i}}^2 + {\rm{d*D}}{{\rm{B}}_{\rm{o}}} + {\rm{e*D}}{{\rm{B}}_{\rm{o}}}^2 + {\rm{f*W}}{{\rm{B}}_{\rm{i}}}{\rm{*D}}{{\rm{B}}_{\rm{o}}}
\end{equation}

where a-f are regression curve fit coefficients.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{3}
\tightlist
\item
  Energy input ratio (EIR) modifier curve (function of air flow fraction)
\end{enumerate}

\begin{equation}
{\rm{EIRAirFlowModFac}} = {\rm{a}} + {\rm{b*f}}{{\rm{f}}_{\rm{a}}} + {\rm{c*ff}}_{\rm{a}}^2 + {\rm{d*ff}}_{\rm{a}}^3
\end{equation}

where a-d are regression curve fit coefficients.  If no data is available for correction, the user can simply use a = 1.0 and set the other coefficients to 0.0.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{4}
\tightlist
\item
  Part load fraction correlation (function of part load ratio)
\end{enumerate}

This field defines the name of a quadratic or cubic performance curve (Ref: Performance Curves) that parameterizes the variation of electrical power input to the unit as a function of the part load ratio (PLR, Sensible or Latent Load/Steady-State Sensible or Latent Capacity for Speed 1). The description of the part load fraction correlation for the variable-speed DX cooling coil is similar to the variable-speed DX heating coil.

\subsubsection{Lowest Speed Operation}\label{lowest-speed-operation}

The lowest speed operation of the variable-speed DX cooling coil is similar to the single speed DX cooling coil. The total (gross) cooling capacity of the variable-speed DX coil is calculated as follows:

\begin{equation}
  \begin{array}{l}
    \rm{Q}_{\rm{total},1} = \rm{Rated~Total~Cooling~Capacity} @ \rm{Speed~Level} \left( 1 \right) \rm{*} \\
    \quad \quad \rm{TotCapTempModFa} \rm{c}_1 \rm{*TotCapAirFlowModFa} \rm{c}_1
  \end{array}
\end{equation}

And the EIR is calculated as:

\begin{equation}
\rm{EI} \rm{R}_1 = \frac{1.0}{\rm{Reference~Unit~COP} @ \rm{Speed}(1)}{\rm{EIRTempModFa}}{\rm{c}_1}{\rm{*EIRAirFlowModFa}}{\rm{c}_1}
\end{equation}

And the power consumption excluding the indoor fan is:

\begin{equation}
{\rm{Powe}}{{\rm{r}}_1} = {{\rm{Q}}_{{\rm{total}},1}}{\rm{*EI}}{{\rm{R}}_1}{\rm{*RTF}}
\end{equation}

At the lowest speed, the dehumidification calculation is exactly the same as the single speed DX coil. That is to use the rated SHR and the design air flow rate at the lowest speed to calculate rated bypass factor of BF\(_{rated,1}\), and the corresponding effective surface area of A\(_{o,1}\). With A\(_{o,1}\) known, the coil BF can be adjusted for non-rated air flow rates.

The part load ratio for sensible cooling is:

\begin{equation}
{\rm{PLR}} = {\rm{SensibleCoolingLoad}}/({{\rm{Q}}_{{\rm{total}},1}}{\rm{*SH}}{{\rm{R}}_1})
\end{equation}

For latent cooling:

\begin{equation}
{\rm{PLR}} = {\rm{LatentCoolingLoad}}/[{{\rm{Q}}_{{\rm{total}},1}}{\rm{*}}(1.0 - {\rm{SH}}{{\rm{R}}_1})]
\end{equation}

\subsubsection{Higher Speed Operation}\label{higher-speed-operation-1-000}

At the speed level between the lowest and the highest, there is no part-load loss. A parameter of speed ratio (SpeedRatio) is used to define the capacity partition between Speed x-1 and Speed x.

The design air flow rate at the speed ratio are given as following:

\begin{equation}
  \begin{array}{l}
    \rm{DesignAirFlowRateSpeedRatio} = \rm{Reference~Unit~Air~Mass~Flow~Rate} @ \rm{Speed~Level} \left( \rm{x} - 1 \right) \rm{*} \\
    \quad \quad \quad \rm{CapacityScaleFactor*} \left( 1 - \rm{SpeedRatio} \right) + \\
    \quad \quad \rm{Reference~Unit~Air~Mass~Flow~Rate} @ \rm{Speed~Level} \left( \rm{x} \right) \rm{*} \\
    \quad \quad \quad \rm{CapacityScaleFactor*SpeedRatio}
  \end{array}
\end{equation}

The fraction of air flow is given by \({\rm{f}}{{\rm{f}}_{{\rm{a}},{\rm{x}} - 1}}\) = \({\rm{f}}{{\rm{f}}_{{\rm{a}},{\rm{x}}}}\) = actual air mass flow rate/DesignAirFlowRateSpeedRatio.

The total cooling capacities and EIRs at Speed x-1 and Speed x are calculated:

\begin{equation}
  \begin{array}{l}
    \rm{Q}_{\rm{total},\rm{x} - 1} = \rm{Rated~Total~Cooling~Capacity} @ \rm{Speed~Level} \left( \rm{x} - 1 \right) \rm{*} \\
    \quad \quad \quad \rm{TotCapTempModFa} \rm{c}_{\rm{x} - 1} \rm{*TotCapAirFlowModFa} \rm{c}_{\rm{x} - 1}
  \end{array}
\end{equation}

\begin{equation}
  \begin{array}{l}
    \rm{Q}_{\rm{total},\rm{x}} = \rm{Rated~Total~Cooling~Capacity} @ \rm{Speed~Level} \left( \rm{x} \right) \rm{*} \\
    \quad \quad \quad \rm{TotCapTempModFa} \rm{c}_{\rm{x}} \rm{*TotCapAirFlowModFa} \rm{c}_{\rm{x}}
  \end{array}
\end{equation}

\begin{equation}
{\rm{EI}}{{\rm{R}}_{{\rm{x}} - 1}} = \frac{{1.0}}{{{\rm{Reference~Unit~COP}}@{\rm{Speed}}({\rm{x}} - 1)}}{\rm{EIRTempModFa}}{{\rm{c}}_{{\rm{x}} - 1}}{\rm{*EIRAirFlowModFa}}{{\rm{c}}_{{\rm{x}} - 1}}
\end{equation}

\begin{equation}
{\rm{EI}}{{\rm{R}}_{\rm{x}}} = \frac{{1.0}}{{{\rm{Reference~Unit~COP}}@{\rm{Speed}}\left( {\rm{x}} \right)}}{\rm{EIRTempModFa}}{{\rm{c}}_{\rm{x}}}{\rm{*EIRAirFlowModFa}}{{\rm{c}}_{\rm{x}}}
\end{equation}

The total cooling capacity at the corresponding speed ratio is:

\begin{equation}
{{\rm{Q}}_{{\rm{total}},{\rm{SpeedRatio}}}} = \left( {1.0 - {\rm{SpeedRatio}}} \right){\rm{*}}{{\rm{Q}}_{{\rm{total}},{\rm{x}} - 1}} + {\rm{SpeedRatio*}}{{\rm{Q}}_{{\rm{total}},{\rm{x}}}}
\end{equation}

and the power consumption, excluding the indoor fan, is:

\begin{equation}
{\rm{Powe}}{{\rm{r}}_{{\rm{SpeedRatio}}}} = \left( {1.0 - {\rm{SpeedRatio}}} \right){\rm{*}}{{\rm{Q}}_{{\rm{total}},{\rm{x}} - 1}}{\rm{*EI}}{{\rm{R}}_{{\rm{x}} - 1}} + {\rm{SpeedRatio*}}{{\rm{Q}}_{{\rm{total}},{\rm{x}}}}{\rm{*EI}}{{\rm{R}}_{\rm{x}}}
\end{equation}

The net heat discharged from the condenser is:

\begin{equation}
{{\rm{Q}}_{{\rm{cond}},{\rm{SpeedRatio}}}} = {\rm{Powe}}{{\rm{r}}_{{\rm{SpeedRatio}}}} + {{\rm{Q}}_{{\rm{total}},{\rm{SpeedRatio}}}}
\end{equation}

and the effective surface area in the correlations of BF factor is calculated as below:

\begin{equation}
{{\rm{A}}_{{\rm{o}},{\rm{SpeedRatio}}}} = \left( {1 - {\rm{SpeedRatio}}} \right){\rm{*}}{{\rm{A}}_{{\rm{o}},{\rm{x}} - 1}} + {\rm{SpeedRatio*}}{{\rm{A}}_{{\rm{o}},{\rm{x}}}}
\end{equation}

Using A\(_{o,SpeedRatio}\) in the same BF and SHR calculation procedure as the single speed DX cooling coil, we can get BF\(_{SpeedRatio}\) and SHR\(_{SpeedRatio}\).  The sensible cooling capacity is calculated using:

\begin{equation}
{{\rm{Q}}_{{\rm{sensible}},{\rm{SpeedRatio}}}} = {{\rm{Q}}_{{\rm{total}},{\rm{SpeedRatio}}}}{\rm{*SH}}{{\rm{R}}_{{\rm{SpeedRatio}}}}
\end{equation}

If the variable-speed DX cooling coil used to match the sensible cooling load, then:

\begin{equation}
{{\rm{Q}}_{{\rm{sensible}},{\rm{SpeedRatio}}}} = {\rm{SensibleLoad}}
\end{equation}

If it intends to match the latent cooling load, then:

\begin{equation}
{{\rm{Q}}_{{\rm{total}},{\rm{SpeedRatio}}}}{\rm{*}}\left( {1.0 - {\rm{SH}}{{\rm{R}}_{{\rm{SpeedRatio}}}}} \right) = {\rm{LatentLoad}}
\end{equation}

If the speed reaches the highest level, the speed ratio becomes 1.0, and Speed n represents the highest speed.

\subsubsection{Evaporatively Cooled Condenser}\label{evaporatively-cooled-condenser}

If using evaporative pre-cooling pad upstream of the condenser, the user must also enter the appropriate evaporative effectiveness for the media at each compressor speed, so as to correlate variation of the effectiveness as a function of compressor speed, i.e.~the variation of condenser air flow rate. The evaporative effectiveness is interpolated between speed levels as:

\begin{equation}
{\rm{Effectivenes}}{{\rm{s}}_{{\rm{SpeedRatio}}}} = \left( {1.0 - {\rm{SpeedRatio}}} \right){\rm{*Effectivenes}}{{\rm{s}}_{{\rm{x}} - 1}} + {\rm{SpeedRatio*Effectivenes}}{{\rm{s}}_{\rm{x}}}
\end{equation}

The interpolated effectiveness at the speed ratio is used to calculate the air temperature reduction across the evaporative cooling pad, and the decreased air temperature entering the condenser coil is used in place of the ambient temperature as:

\begin{equation}
{{\rm{T}}_{{\rm{c}},{\rm{i}}}} = {{\rm{T}}_{{\rm{wb}},{\rm{o}}}} + (1.0 - {\rm{Effectivenes}}{{\rm{s}}_{{\rm{SpeedRatio}}}}){\rm{*}}({{\rm{T}}_{{\rm{db}},{\rm{o}}}} - {{\rm{T}}_{{\rm{wb}},{\rm{o}}}})
\end{equation}

where:

\({{\rm{T}}_{{\rm{c}},{\rm{i}}}}\) is the condenser entering air temperature (\(^{\circ}\)C)

\({{\rm{T}}_{{\rm{wb}},{\rm{o}}}}\) is the outdoor air wet bulb temperature (\(^{\circ}\)C)

\({{\rm{T}}_{{\rm{db}},{\rm{o}}}}\) is the outdoor air dry bulb temperature (\(^{\circ}\)C).

The water consumption rate is calculated based on the interpolated condenser air flow rate at the speed ratio, i.e.~the condenser flow rate at the speed ratio is:

\begin{equation}
{\dot m_{condair,{\rm{}}SpeedRatio}} = \left( {1.0 - SpeedRatio} \right){\rm{*}}{\dot m_{condair,{\rm{}}x - 1}} + SpeedRatio{\rm{*}}{\dot m_{condair,{\rm{}}x}}
\end{equation}

\subsection{Electric Air Heating Coil}\label{electric-air-heating-coil}

The electric air heating coil (object name: Coil:Heating:Electric) is a simple capacity model with a user-input efficiency.~ In many cases, this efficiency for the electric coil will be 100\%.~ This coil only has air nodes to connect it in the system.~ The coil can be used in the air loop simulation or in the zone equipment as a reheat coil.~ Depending on where it is used determines if this coil is temperature or capacity controlled.~ If used in the air loop simulation it will be controlled to a specified temperature on the setpoint node by the SetpointManager.~ If it is used in zone equipment, it will be controlled from the zone thermostat by meeting the zone demand.~ See Input Output Reference for additional information.

For a coil that is controlled to meet the zone demand, it will meet the zone demand unless this demand exceeds the capacity of the coil specified by the user.  The following code section demonstrates the simulation of the electric air heating coil.

~ ! Control output to meet load QCoilReq

~ IF((AirMassFlow \textgreater{} 0.0 .AND. HeatingCoil(CoilNum)\%NominalCapacity \textgreater{} 0.0) .and. \&

~~~~ (GetCurrentScheduleValue(HeatingCoil(CoilNum)\%SchedPtr) \textgreater{} 0.0) .and. \&

~~~~ (QCoilReq \textgreater{} 0.0) .and. (TempSetPoint = = 0.0)) THEN

~ ~~~~!check to see if the Required heating capacity is greater than the user! specified capacity.

~~~~~ IF(QCoilReq \textgreater{} HeatingCoil(CoilNum)\%NominalCapacity) Then

~~~~~~~ QCoilCap = HeatingCoil(CoilNum)\%NominalCapacity

~~~~~ Else

~~~~~~~ QCoilCap = QCoilReq

~~~~~ End IF

~~~~~ TempAirOut = TempAirIn + QCoilCap/CapacitanceAir

~~~~~ HeatingCoilLoad = QCoilCap

~~~~ !The HeatingCoilLoad is the change in the enthalpy of the Heating

~~~~~ HeatingCoil(CoilNum)\%ElecUseLoad = HeatingCoilLoad/Effic

For a temperature setpoint coil, the delta temperature from the coil inlet temperature to the setpoint is determined and the capacity of the coil is calculated and is met if that demand is less than the user specified capacity.  The following code section demonstrates this.

~~ ! Control coil output to meet a setpoint temperature.

~~ Else IF((AirMassFlow \textgreater{} 0.0 .AND. HeatingCoil(CoilNum)\%NominalCapacity \textgreater{} 0.0) .and. \&

~~~~ (GetCurrentScheduleValue(HeatingCoil(CoilNum)\%SchedPtr) \textgreater{} 0.0) .and. \&

~~~~ (QCoilReq = = 0.0) .and. \&

~~~~ (ABS(TempSetPoint-TempAirIn) \textgreater{} TempControlTol) ) THEN

~~~~~ QCoilCap = CapacitanceAir*(TempSetPoint - TempAirIn)

~~~~~ ! check to see if setpoint above enetering temperature. If not, set

~~~~~ ! output to zero.

~~~~~ IF(QCoilCap \(\leq\) 0.0) THEN

~~~~~~~ QCoilCap = 0.0

~~~~~~~ TempAirOut = TempAirIn

~~~~~ !check to see if the Required heating capacity is greater than the user

~~~~~ ! specified capacity.

~~~~~ Else IF(QCoilCap \textgreater{} HeatingCoil(CoilNum)\%NominalCapacity) Then

~~~~~~~ QCoilCap = HeatingCoil(CoilNum)\%NominalCapacity

~~~~~~~ TempAirOut = TempAirIn + QCoilCap/CapacitanceAir

~~~~~ Else

~~~~~~~ TempAirOut = TempSetPoint

~~~~~ End IF

~~~~~ HeatingCoilLoad = QCoilCap

~~~~ !The HeatingCoilLoad is the change in the enthalpy of the Heating

~~~~~ HeatingCoil(CoilNum)\%ElecUseLoad = HeatingCoilLoad/Effic

\subsection{Fuel-fired Air Heating Coil}\label{gas-air-heating-coil}

The fuel-powered heating coil (object name: Coil:Heating:Fuel) is a simple capacity model with user inputted burner efficiency.~ The default for the burner efficiency is 80\%.~ This coil only has air nodes to connect it in the system.~ The coil can be used in the air loop simulation or in the zone equipment as a reheat coil.~ Depending on where it is used determines if this coil is temperature or capacity controlled.~ If used in the air loop simulation it will be controlled to a specified temperature scheduled from the SetpointManager.~ If it is used in zone equipment, it will be controlled from the zone thermostat by meeting the zone demand.~ The fuel coil has additional features that can add a part load correction and a parasitic fuel or electric load.

The parasitic electric load associated with the gas coil operation, such as an inducer fan, etc.~ This will be modified by the PLR (or coil runtime fraction if a part-load fraction correlation is provided in the next input field) to reflect the time of operation in a simulation time step.

The parasitic fuel load associated with the gas coil's operation (Watts), such as a standing pilot light.~ The model assumes that this parasitic load is consumed only for the portion of the simulation time step where the gas heating coil is not operating.

\subsubsection{Field: Part Load Fraction Correlation (function of part load ratio)}\label{field-part-load-fraction-correlation-function-of-part-load-ratio}

The part load correction defines the name of a quadratic or cubic performance curve (Ref: Performance Curves) that parameterizes the variation of fuel consumption rate by the heating coil as a function of the part load ratio (PLR, sensible heating load/nominal capacity of the heating coil).~ For any simulation time step, the nominal fuel consumption rate (heating load/burner efficiency) is divided by the part-load fraction (PLF) if a part-load curve has been defined.~ The part-load curve accounts for efficiency losses due to transient coil operation.

The part-load fraction correlation should be normalized to a value of 1.0 when the part load ratio equals 1.0 (i.e., no efficiency losses when the heating coil runs continuously for the simulation time step).~ For PLR values between 0 and 1 ( 0 \textless{} = PLR \textless{} 1), the following rules apply:

\textbf{PLF \textgreater{} = 0.7~~ and~~ PLF \textgreater{} = PLR}

If PLF \textless{} 0.7 a warning message is issued, the program resets the PLF value to 0.7, and the simulation proceeds.~ The runtime fraction of the heating coil is defined a PLR/PLF. If PLF \textless{} PLR, then a warning message is issues and the runtime fraction of the coil is limited to 1.0.

A typical part load fraction correlation for a conventional gas heating coil (e.g., residential furnace) would be:

\begin{equation}
PLF = 0.8 + 0.2\cdot PLR
\end{equation}

For a better understanding of how the coil meets the temperature setpoint in the air loop or the zone demand as zone equipment, see Coil:Electric:Heating for additional information.~ Also see Input Output Reference for additional input information.

\subsection{Multi-Stage Electric and Gas Air Heating Coil}\label{multi-stage-electric-and-gas-air-heating-coil}

\subsubsection{Overview}\label{overview-5-001}

These models (object names Coil:Heating:Electric:MultiStage and Coil:Heating:Gas:MultiStage) simulate the performance of multi stage electric and gas heating systems with two to four discrete air flow stages. Each stage has a set of user inputted gas burner efficiency, Nominal capacity, and Parasitic electric load (for gas coil only). The full load supply airflow rate is dependent on the stage number and is set by its parent object (Ref: AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed). The part-load impact on coil energy use is automatically applied to the lowest stage.

When the model determines performance at Stage 1 (the lowest stage) or cycling between OFF and Stage 1, its performance is almost the same as the performance for the Coil:Heating:Electric and~ Coil:Heating:Fuel models. However, the outlet conditions are calculated slightly differently. Therefore, the Coil:Heating:Electric and~ Coil:Heating:Fuel model may be considered as subsets of the multistage model described here. When the multistage coil model determines performance at higher stages (above 1), the model linearly interpolates the performance at two consecutive stages (n-1 and n) as needed to meet the heating load, with the fraction of time at each speed established by the speed ratio. For the time being, this coil model can only be called by the parent object AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed.

\subsubsection{Model Inputs}\label{model-inputs-1}

The model inputs are also very similar to the inputs of the Coil:Heating:Electric and~ Coil:Heating:Fuel objects. The main difference is that this multistage model requires a set of fields at each speed, such as nominal capacity, and efficiency.

\subsubsection{Stage 1 Operation}\label{stage-1-operation}

The following procedure provides the detailed description of the exception.

\begin{itemize}
  \item Total delivered heating capacity
\end{itemize}

The total delivered heating capacity for Stage 1 operating at the cycling ratio needed to meet the requested heating load is:

\begin{equation}
  Q_{coil,cycling} = {\dot{m}_{Speed~1}} \left( CycRatio \right) (h_{inlet} - h_{outlet,full})
\end{equation}

where:

\emph{Q\(_{coil,cycling}\)} is the delivered sensible heating capacity for Stage 1 operating at a specific cycling ratio (W)

\({\dot{m}_{Speed~1}}\) is the air mass flow rate through heating coil at Speed 1 as set by the parent object (kg/s)

\emph{h\(_{outlet,full}\)} is the specific enthalpy of the coil outlet air during full-load operation at Stage 1 (no cycling) (J/kg)

\emph{h\(_{inlet}\)} is the specific enthalpy of the coil inlet air (J/kg)

\emph{CycRatio} is the cycling ratio at Stage 1, ratio of requested heating load to the full-load capacity of the coil at Stage 1 (dimensionless).

It is assumed that the coil provides no heating capacity when the coil is OFF, even if the supply air fan continues to operate.

\begin{itemize}
  \item Outlet air specific enthalpy
\end{itemize}

The average specific enthalpy of the coil outlet air is then calculated based on the delivered sensible heating capacity and the average air mass flow rate entering the coil:

\begin{equation}
  h_{outlet,average} = h_{inlet} - \frac{Q_{coil,cycling}}{{\mathop m\limits^\cdot }_{inlet}}
\end{equation}

where:

\emph{h\(_{outlet,average}\)} is the average specific enthalpy at the coil outlet (J/kg)

\({\dot{m}_{inlet}}\) is the mass flow rate at the inlet to the coil as established by the parent object (Ref. AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiStage, Mass Flow Rate Calculation). This flow rate is the average value determined by the parent object, accounting for the specified flow rate when the heating coil is ON and the specified flow rate when the heating coil is OFF for the time step being simulated.

\begin{itemize}
  \item Outlet air temperature
\end{itemize}

The heating coil's outlet air humidity ratio equals the inlet air humidity ratio since the coil does not change the moisture content of the air. So the average outlet air temperature is calculated based on the inlet air humidity ratio and the average outlet air enthalpy using the psychrometric function PsyTdbFnHW.

The main reason for using the above approach is that outlet air conditions are calculated in the same way for all operating Stages.

\subsubsection{Higher Stage Operation}\label{higher-stage-operation}

This section describes how higher Stage operation is simulated. When the required sensible load is less than the full load sensible capacity at Stage n (Stage Number \textgreater{} 1), the following calculations are performed:

\begin{itemize}
  \item Total delivered heating capacity at Stage n-1 and Stage n
\end{itemize}

\begin{equation}
TotCa{p_{n - 1}} = MSNominalCa{p_{n - 1}}
\end{equation}

\begin{equation}
TotCa{p_n} = MSNominalCa{p_n}
\end{equation}

where:

\emph{TotCap\(_{i}\)} is the total delivered heating capacity at given temperatures and flow rates at Stage i (W)

\emph{MSNominalCap\(_{i}\)} is the heating capacity at the rated conditions at Stage i (W)

i is Stage n or Stage n-1.

\begin{itemize}
  \item Full load outlet air specific enthalpy at Stage n-1 and Stage n
\end{itemize}

\begin{equation}
{h_{outlet,full~Speed~n}} = {h_{inlet}} - (MSNominalCa{p_n}/{\dot{m}_{inlet}})
\end{equation}

\begin{equation}
{h_{outlet,full~Speed~n-1}} = {h_{inlet}} - (MSNominalCa{p_{n - 1}}/{\dot{m}_{inlet}})
\end{equation}

where:

\emph{h\(_{outlet,full~Speed~n}\)} is the specific enthalpy of the coil outlet air during full-load operation at Stage n (no cycling) (J/kg)

\emph{h\(_{outlet,full~Speed~n-1}\)} is the specific enthalpy of the coil outlet air during full-load operation at Stage n-1 (no cycling) (J/kg).

\begin{itemize}
  \item Effective total heating capacity
\end{itemize}

\begin{equation}
  \begin{array}{rl}
    Q_{coil,SpeedRatio} =& \left( SpeedRatio \right){\dot{m}_{Speed~n}}(h_{inlet} - h_{outlet,full~Speed~n}) \\
                         &+ (1 - SpeedRatio) {\dot{m}_{Speed~n-1}}(h_{inlet} - h_{outlet,full~Speed~n-1})
  \end{array}
\end{equation}

where:

\({{Q_{coil,SpeedRatio}}}\) is the delivered sensible heating capacity at a given Stage ratio between two consecutive Stages (W)

\(\dot{m}_{Speed~n}\) is the air mass flow rate through heating coil at Stage n as set by the parent object (kg/s)

\(\dot{m}_{Speed~n-1}\) is the air mass flow rate through heating coil at Stage 1 as set by the parent object (kg/s).

\begin{itemize}
  \item Average outlet air enthalpy
\end{itemize}

\begin{equation}
  h_{outlet,average} = h_{inlet} - \frac{Q_{coil,SpeedRatio}}{{\mathop m\limits^\cdot }_{inlet}}
\end{equation}

where:

\emph{h\(_{outlet,average}\)} is the average specific enthalpy at the coil outlet (J/kg)

\emph{h\(_{inlet}\)} is the specific enthalpy of the coil inlet air (J/kg)

\({\dot m_{inlet}}\) is the mass flow rate at the inlet to the coil as established by the parent object (Ref. AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiStage, Mass Flow Rate Calculation). This flow rate is the average value determined by the parent object, accounting for the specified flow rate when the heating coil is at Stage n and the specified flow rate when the heating coil is at Stage n-1 for the time step being simulated.

\begin{itemize}
  \item Average outlet air temperature
\end{itemize}

    The heating coil's outlet air humidity ratio equals the inlet air humidity ratio since the coil does not change the moisture content of the air. So the average outlet air temperature is calculated based on the inlet air humidity ratio and the average outlet air enthalpy using the psychrometric function PsyTdbFnHW.

\begin{itemize}
  \item
    Full load energy inputs at Stage n-1 and Stage n
\end{itemize}

\begin{equation}
HeatingPowe{r_n} = MSNominalCa{p_n}/MSEfficienc{y_n}
\end{equation}

\begin{equation}
HeatingPowe{r_{n - 1}} = MSNominalCa{p_{n - 1}}/MSEfficienc{y_{n - 1}}
\end{equation}

where:

\emph{MSEfficiency\(_{n}\)} is the efficiency at stage n

\emph{MSEfficiency\(_{n-1}\)} is the efficiency at stage n-1.

\begin{itemize}
  \item Calculate combined energy input
\end{itemize}

\begin{equation}
HeatingPower = HeatingPowe{r_n}\left( {SpeedRatio} \right) + HeatingPowe{r_{n - 1}}(1.0 - SpeedRatio)
\end{equation}

where HeatingPower is the power used (W).

\subsection{Single-Speed Electric Heat Pump DX Air Heating Coil}\label{single-speed-electric-heat-pump-dx-air-heating-coil}

\subsubsection{Overview}\label{overview-6-000}

This model (object name Coil:Heating:DX:SingleSpeed) simulates the performance of an air-to-air direct expansion (DX) heating system. The model uses performance information at rated conditions along with curve fits for variations in total capacity, energy input ratio and part-load fraction to determine the performance of the unit at part-load conditions (DOE 1982).~ Adjustment factors are applied to total capacity and input power to account for frost formation on the outdoor coil.

This model simulates the thermal performance of the indoor DX heating coil, and the power consumption of the outdoor unit (compressors, fans, crankcase heaters and defrost heaters). The performance of the indoor supply air fan varies widely from system to system depending on control strategy (e.g., constant fan vs.~AUTO fan, constant air volume vs.~variable air volume, etc.), fan type, fan motor efficiency and pressure losses through the air distribution system. Therefore, this DX system model does not account for the thermal effects or electric power consumption of the indoor supply air fan. EnergyPlus contains separate models for simulating the performance of various indoor fan configurations, and these models can be easily linked with the DX system model described here to simulate the entire DX system being considered (e.g., see AirLoopHVAC:UnitaryHeatPump:AirToAir).

\subsubsection{Model Inputs}\label{model-inputs-2}

The user must input the total heating capacity, coefficient of performance (COP) and the volumetric airflow rate across the heating coil at rated conditions. The capacity and COP inputs should be ``gross'' values, excluding any thermal or energy impacts due to the indoor supply air fan. The rating condition is considered to be outdoor air at 8.33\(^{\circ}\)C dry-bulb and 6.11\(^{\circ}\)C wet-bulb temperatures (i.e., air entering the outdoor coil), with air entering the indoor DX heating coil at 21.11\(^{\circ}\)C dry-bulb and 15.55\(^{\circ}\)C wet-bulb temperatures. The rated volumetric air flow across the DX heating coil should be between 0.00004027 m\(^{3}\)/s and 0.00006041 m\(^{3}\)/s per watt of rated total heating capacity (300 -- 450 cfm/ton).

Depending on the defrost strategy that is selected, the user must also input up to six performance curves that describe the change in total heating capacity and efficiency at part-load conditions, and efficiency during reverse-cycle defrosting:

\begin{itemize}
  \item
The total heating capacity modifier curve (function of temperature) can be a function of both the outdoor and indoor air dry-bulb temperature or only the outdoor air dry-bulb temperature. User has the choice of a bi-quadratic curve with two independent variables or a quadratic curve as well as a cubic curve with a single independent variable. The bi-quadratic curve is recommended if sufficient manufacturer data is available as it provides sensitivity to the indoor air dry-bulb temperature and a more realistic output. The output of this curve is multiplied by the rated total heating capacity to give the total heating capacity at specific temperature operating conditions (i.e., at an outdoor or indoor air temperature different from the rating point temperature).

\begin{equation}
TotCapTempModFac = a + b\left( {{T_{db,o}}} \right) + c{\left( {{T_{db,o}}} \right)^2}
\label{eq:SSEHPDXAirHeatCoilTotCapTempModFac}
\end{equation}

or

\begin{equation}
TotCapTempModFac = a + b\left( {{T_{db,o}}} \right) + c{\left( {{T_{db,o}}} \right)^2} + d{\left( {{T_{db,o}}} \right)^3}
\end{equation}

or

\begin{equation}
TotCapTempModFac = a + b\left( {{T_{db,i}}} \right) + c{\left( {{T_{db,i}}} \right)^2} + d\left( {{T_{db,o}}} \right) + e{\left( {{T_{db,o}}} \right)^2} + f\left( {{T_{db,i}}} \right)\left( {{T_{db,o}}} \right)
\end{equation}

where:

\({T_{db,i}}\) is the dry-bulb temperature of the air entering the indoor coil (\(^{\circ}\)C)

\({T_{db,o}}\) is the dry-bulb temperature of the air entering the outdoor coil (\(^{\circ}\)C).

  \item
The total heating capacity modifier curve (function of flow fraction) is a quadratic or cubic curve with the independent variable being the ratio of the actual air flow rate across the heating coil to the rated air flow rate (i.e., fraction of full load flow). The output of this curve is multiplied by the rated total heating capacity and the total heating capacity modifier curve (function of temperature) to give the total heating capacity at the specific temperature and air flow conditions at which the coil is operating.

\begin{equation}
TotCapFlowModFac = a + b\left( {ff} \right) + c{\left( {ff} \right)^2}
\end{equation}

or

\begin{equation}
TotCapFlowModFac = a + b\left( {ff} \right) + c{\left( {ff} \right)^2} + d{\left( {ff} \right)^3}
\end{equation}

where:

\begin{equation}
ff = flow~fraction = \left( {\frac{{Actual~air~mass~flow~rate}}{{Rated~air~mass~flow~rate}}} \right)
\end{equation}

\textbf{Note:}~ The actual volumetric airflow rate through the heating coil for any simulation time step where the DX unit is operating should be between 0.00002684 m\(^{3}\)/s and .00008056 m\(^{3}\)/s per watt of rated total heating capacity (200 - 600 cfm/ton). The simulation will issue a warning message if this airflow range is exceeded.

  \item
The energy input ratio (EIR) modifier curve (function of temperature) can be a function of both the outdoor and indoor air dry-bulb temperature or only the outdoor air dry-bulb temperature. User has the choice of a bi-quadratic curve with two independent variables or a quadratic curve as well as a cubic curve with a single independent variable. The bi-quadratic curve is recommended if sufficient manufacturer data is available as it provides sensitivity to the indoor air dry-bulb temperature and a more realistic output. The output of this curve is multiplied by the rated EIR (inverse of the rated COP) to give the EIR at specific temperature operating conditions (i.e., at an outdoor or indoor air temperature different from the rating point temperature).

\begin{equation}
EIRTempModFac = a + b\left( {{T_{db,o}}} \right) + c{\left( {{T_{db,o}}} \right)^2}
\end{equation}

or

\begin{equation}
EIRTempModFac = a + b\left( {{T_{db,o}}} \right) + c{\left( {{T_{db,o}}} \right)^2} + d{\left( {{T_{db,o}}} \right)^3}
\end{equation}

or

\begin{equation}
EIRTempModFac = a + b\left( {{T_{db,i}}} \right) + c{\left( {{T_{db,i}}} \right)^2} + d\left( {{T_{db,o}}} \right) + e{\left( {{T_{db,o}}} \right)^2} + f\left( {{T_{db,i}}} \right)\left( {{T_{db,o}}} \right)
\end{equation}

  \item
The energy input ratio (EIR) modifier curve (function of flow fraction) is a quadratic or cubic curve with the independent variable being the ratio of the actual air flow rate across the heating coil to the rated air flow rate (i.e., fraction of full load flow). The output of this curve is multiplied by the rated EIR (inverse of the rated COP) and the EIR modifier curve (function of temperature) to give the EIR at the specific temperature and air flow conditions at which the coil is operating.

\begin{equation}
EIRFlowModFac = a + b\left( {ff} \right) + c{\left( {ff} \right)^2}
\end{equation}

or

\begin{equation}
EIRFlowModFac = a + b\left( {ff} \right) + c{\left( {ff} \right)^2}\, + d{\left( {ff} \right)^3}
\end{equation}

  \item
The part-load fraction correlation (function of part-load ratio) is a quadratic or cubic curve with the independent variable being part-load ratio (sensible heating load / steady-state heating capacity). The output of this curve is used in combination with the rated EIR and EIR modifier curves to give the ``effective'' EIR for a given simulation time step. The part-load fraction (PLF) correlation accounts for efficiency losses due to compressor cycling.

\begin{equation}
PartLoadFrac = PLF = a + b\left( {PLR} \right) + c{\left( {PLR} \right)^2}
\label{eq:SSEHPDXHeatAirCoilPartLoadFrac1}
\end{equation}

or

\begin{equation}
PartLoadFrac = a + b\left( {PLR} \right) + c{\left( {PLR} \right)^2} + d{\left( {PLR} \right)^3}
\label{eq:SSEHPDXHeatAirCoilPartLoadFrac2}
\end{equation}

where:

\begin{equation}
PLR = part-load~ratio = \left( {\frac{{sensible~heating~load}}{{steady-state~sensible~heating~capacity}}} \right)
\end{equation}

The part-load fraction correlation should be normalized to a value of 1.0 when the part load ratio equals 1.0 (i.e., no efficiency losses when the compressor(s) run continuously for the simulation time step). For PLR values between 0 and 1 ( 0 \textless{} = PLR \textless{} 1), the following rules apply:  PLF \textgreater{} = 0.7 and PLF \textgreater{} = PLR.

If PLF \textless{} 0.7 a warning message is issued, the program resets the PLF value to 0.7, and the simulation proceeds. The runtime fraction of the coil is defined a PLR/PLF. If PLF \textless{} PLR, then a warning message is issued and the runtime fraction of the coil is limited to 1.0.

A typical part load fraction correlation for a conventional, single-speed DX heating coil (e.g., residential heat pump) would be:  PLF = 0.85 + 0.15(PLR).

  \item
The defrost energy input ratio (EIR) modifier curve (function of temperature) is a bi-quadratic curve with two independent variables: outdoor air dry-bulb temperature and the heating coil entering air wet-bulb temperature. The output of this curve is multiplied by the heating coil capacity, the fractional defrost time period and the runtime fraction of the heating coil to give the defrost power at the specific temperatures at which the coil is operating. This curve is only required when a reverse-cycle defrost strategy is specified.

\begin{equation}
DefrostEIRTempModFac = \,a + \,b\left( {{T_{wb,i}}} \right)\,\, + \,\,c{\left( {{T_{wb,i}}} \right)^2} + \,\,d\left( {{T_{db,o}}} \right)\,\, + \,\,e{\left( {{T_{db,o}}} \right)^2} + f\left( {{T_{wb,i}}} \right)\left( {{T_{db,o}}} \right)
\label{eq:SSEHPDXAirHeatCoilDefrostEIRTempModFac}
\end{equation}

where:

\({T_{wb,i}}\) is the wet-bulb temperature of the air entering the indoor heating coil (\(^{\circ}\)C)

\({T_{db,o}}\) is the dry-bulb temperature of the air entering the outdoor coil (\(^{\circ}\)C).
\end{itemize}

All six curves are accessed through EnergyPlus' built-in performance curve equation manager (curve:quadratic, curve:cubic and curve:biquadratic). It is not imperative that the user utilize all coefficients shown in the preceding Equations~\ref{eq:SSEHPDXAirHeatCoilTotCapTempModFac} through~\ref{eq:SSEHPDXAirHeatCoilDefrostEIRTempModFac} in items (1) through (6) if their performance equation has fewer terms (e.g., if the user's PartLoadFrac performance curve is linear instead of quadratic or cubic, simply enter the appropriate values for the coefficients a and b, and set the remaining coefficients to zero).

The next input item for the Heating DX single speed coil is the supply air fan operation mode. Either the supply air fan runs continuously while the DX coil cycles on/off, or the fan and coil cycle on/off together. The next two inputs define the minimum outdoor dry-bulb temperature that the heat pump compressor will operate and the maximum outdoor dry-bulb temperature for defrost operation. Crankcase heater capacity and crankcase heater cutout temperature are entered in the following two inputs. The final four inputs cover the type of defrost strategy (reverse-cycle or resistive), defrost control (timed or on-demand), the fractional defrost time period (timed defrost control only), and the resistive defrost heater capacity if a resistive defrost strategy is selected.

\subsubsection{Model Description}\label{model-description-4-001}

The general flow of the model is as follows:

\begin{enumerate}
\item If the outdoor air dry-bulb temperature is below the specified minimum temperature for compressor operation or the DX heating coil is not scheduled to operate, simply pass through the heating coil inlet air conditions as the coil outlet conditions, set power and heating rates equal to zero, and set crankcase heater power equal to the crankcase heater capacity value specified by the input file.
\item If the outdoor air dry-bulb temperature is above the specified minimum temperature for compressor operation and the DX heating coil is scheduled to operate, then:
\begin{enumerate}
\item If the outdoor dry-bulb temperature is below the specified maximum outdoor dry-bulb temperature for defrost operation, calculate a heating capacity multiplier, input power multiplier and fractional defrost time period depending on the defrost strategy and defrost control type specified for the heating coil.
\item Using the rated heating capacity and COP, the part-load curves specified for the DX heating coil, the defrost multipliers calculated above (if applicable), and the part-load ratio that is being requested of the heating coil, determine the following: heating coil exiting air conditions (dry-bulb temperature, humidity ratio and enthalpy), total DX coil heating rate, electric power during heating (compressors and outdoor fans), electric power during defrost, and crankcase heater power.
\end{enumerate}
\end{enumerate}

The following paragraphs give a detailed description of the model calculations that are performed when the DX heating coil is operating (i.e., scenario \# 2 above).

\subsubsection{Frost Adjustment Factors}\label{frost-adjustment-factors}

Frost formation on the outdoor coil, and the need to periodically defrost this coil, has a significant impact on heating capacity and energy use by the DX heating system. If the outdoor air dry-bulb temperature is below the specified maximum temperature for defrost operation, then the model calculates adjustment factors for heating capacity and input power due to frost formation, and the fractional defrost time period, depending on the defrost strategy and defrost control type specified for the heating coil. This method of accounting for the impacts of frosting/defrost was taken from the model used in DOE-2.1E (ESTSC 2001, Miller and Jaster 1985).

The model first estimates the outdoor coil temperature according to a linear empirical relationship with outdoor air dry-bulb temperature as the independent variable.

\begin{equation}
{T_{coil,out}} = 0.82{T_{db,o}} - 8.589
\end{equation}

The difference between the outdoor air humidity ratio (from the weather file) and the saturated air humidity ratio at the estimated outdoor coil temperature is then calculated, and this value is used as an indication of frost formation on the outdoor coil.

\begin{equation}
\Delta {\omega_{\,coil,out}}\, = \,MAX\left[ {1.0E - 6,\,\,\,{\omega_{outdoor}}\, - \,\,{\omega_{sat}}\left( {{T_{coil,out}}\,,{\rm{OutBaroPress}}} \right)} \right]
\end{equation}

Frost formation on the outdoor coil must be periodically removed. The fraction of compressor runtime when the coil is being defrosted is either entered by the user (for timed defrost) or is calculated by the model (for on-demand defrost) using an empirical equation and \(\Delta {\omega_{\,coil,out}}\) . Adjustment factors to total heating coil capacity and input power due to frost formation on the outdoor coil are also calculated by empirical models with \(\Delta {\omega_{\,coil,out}}\) ~or fractional defrost time period as the independent variable. The defrost time period fraction and adjustment factors due to frost formation on the outdoor coil vary depending on the defrost control type as shown below.

\emph{Timed Defrost}:

\begin{equation}
Fractional~Defrost~Time = time~period~specified~by~user = {t_{frac,defrost}}
\end{equation}

\begin{equation}
Heating~Capacity~Multiplier = 0.909 - 107.33\left( {\Delta {\omega_{\,coil,out}}} \right)
\label{eq:SSEHPDXHeatingCapacityMultiplierTimedDefrost}
\end{equation}

\begin{equation}
Input~Power~Multiplier = 0.9 - 36.45\left( {\Delta {\omega_{\,coil,out}}} \right)
\label{eq:SSEHPDXInputPowerMultiplierTimedDefrost}
\end{equation}

\emph{On-Demand Defrost}:

\begin{equation}
Fractional~Defrost~Time = \frac{1}{{1 + \left( {\frac{{0.01446}}{{\Delta {\omega_{\,coil,out}}}}} \right)}} = {t_{frac,defrost}}
\end{equation}

\begin{equation}
Heating~Capacity~Multiplier = 0.875\left( {1 - {t_{frac,defrost}}} \right)
\label{eq:SSEHPDXHeatingCapacityMultiplierOnDemandDefrost}
\end{equation}

\begin{equation}
Input~Power~Multiplier = 0.954\left( {1 - {t_{frac,defrost}}} \right)
\label{eq:SSEHPDXInputPowerMultiplierOnDemandDefrost}
\end{equation}

If the outdoor air dry-bulb temperature is above the specified maximum temperature for defrost operation, the fractional defrost time period is set to zero and the heating capacity/input power multipliers are set to unity.

\subsubsection{Defrost Operation}\label{defrost-operation}

If the fractional defrost time period is greater than zero for the simulation time step, then the model calculates the electrical power used during defrost. The method for calculating defrost power varies based on the defrost strategy specified (i.e., reverse-cycle or resistive). In the case of reverse-cycle defrost, the additional heating load due to defrost (indoor cooling during defrost) is also calculated so that it may be added to the existing heating load when calculating input power for the compressor(s) and outdoor coil fan(s).

\emph{Reverse-Cycle}:

\begin{equation}
{Q_{defrost}} = 0.01\left( {{t_{frac,defrost}}} \right)\left( {7.222 - {T_{db,o}}} \right)\left( {\frac{{{Q_{total,rated}}}}{{1.01667}}} \right)
\end{equation}

\begin{equation}
{P_{defrost}} = DefrostEIRTempModFac\left( {\frac{{{Q_{total,rated}}}}{{1.01667}}} \right)\left( {{t_{frac,defrost}}} \right)\left( {RTF} \right)
\end{equation}

\emph{Resistive}:

\begin{equation}
{Q_{defrost}} = 0.0
\end{equation}

\begin{equation}
{P_{defrost}} = \left( {{Q_{cap,defrost}}} \right)\left( {{t_{frac,defrost}}} \right)\left( {RTF} \right)
\end{equation}

where:

\({Q_{defrost}}\) is the additional indoor heating load due to reverse-cycle defrost (\emph{W})

\({Q_{total,rated}}\) is the total full-load heating capacity of the coil at rated conditions (W)

\({P_{defrost}}\) is the average defrost power for the simulation time step (W)

\({Q_{cap,defrost}}\) is the capacity of the resistive defrost heating element (W)

\emph{DefrostEIRTempModFac} is the energy input ratio modifier curve applicable during defrost

\begin{equation}
RTF = \left( \frac{PLR}{PartLoadFrac} \right) = runtime~fraction~of~the~heating~coil
\end{equation}

\subsubsection{Heating Operation}\label{heating-operation-000}

For any simulation time step, the total heating capacity of the DX unit is calculated as follows:

\begin{equation}
Q_{total} = Q_{total,rated}\left( {TotCapTempModFac} \right)\left( {TotCapFlowModFac} \right)
\label{eq:SSEHPDXHeatingCoilQtotal}
\end{equation}

If the outdoor air dry-bulb temperature is below the maximum temperature for defrost operation, then the total heating capacity is further adjusted due to outdoor coil frost formation based on the results of Equation~\ref{eq:SSEHPDXHeatingCoilQtotal} and Equation~\ref{eq:SSEHPDXHeatingCapacityMultiplierTimedDefrost} or~\ref{eq:SSEHPDXHeatingCapacityMultiplierOnDemandDefrost}.

\begin{equation}
Q_{total} = Q_{total}\left( {HeatingCapacityMultiplier} \right)
\label{eq:SSEHPDXHeatingCoilQtotal2}
\end{equation}

In a similar fashion, the electrical power draw by the DX unit (compressors plus outdoor coil fans) for any simulation time step is calculated. For a reverse-cycle defrost strategy, the additional heating load (\emph{Q\(_{defrost}\)}) generated during defrost operation is added to the heating load being requested by adjusting the part-load ratio. If a resistive defrost strategy is selected, \emph{Q\(_{defrost}\)} = 0. The part-load fraction correlation for the heating coil (user input, Equation~\ref{eq:SSEHPDXHeatAirCoilPartLoadFrac1} or~\ref{eq:SSEHPDXHeatAirCoilPartLoadFrac2}) is used in the calculation of electrical power draw to account for efficiency losses due to compressor cycling.

\begin{equation}
  PLR = MIN \left( 1.0,~PLR + \left( \frac{Q_{defrost}}{Q_{total}} \right) \right)
\end{equation}

\begin{equation}
PartLoadFrac = a + b\left( {PLR} \right) + c{\left( {PLR} \right)^2} + d{\left( {PLR} \right)^3}
\end{equation}

\begin{equation}
  P_{heating} = \frac{{\left( {{Q_{total}}} \right)\left( {EIR} \right)\left( {PLR} \right)}}{{PartLoadFrac}} \times InputPowerMultiplier
\end{equation}

where

\({P_{heating}}\) is the average compressor and outdoor fan power for the simulation time step (W)

\({Q_{total}}\) is the total heating capacity from Equation~\ref{eq:SSEHPDXHeatingCoilQtotal2} (W)

\begin{equation}
  EIR = Energy~Input~Ratio = \left( {\frac{1}{{CO{P_{rated}}}}} \right)\left( {EIRTempModFac} \right)\left( {EIRFlowModFac} \right)
\end{equation}

\(CO{P_{rated}}\) is the coefficient of performance at rated conditions (user input)

\emph{InputPowerMultiplier} is the power adjustment due to frost if applicable as in Equation~\ref{eq:SSEHPDXInputPowerMultiplierTimedDefrost} or~\ref{eq:SSEHPDXInputPowerMultiplierOnDemandDefrost}.

The crankcase heater is assumed to operate when the heating coil's compressor is OFF, and the average crankcase heater power for the simulation time step is calculated as follows:

\begin{equation}
  {P_{crankcase}} = {Q_{cap,crankcase}}\left( {1 - RTF} \right)
\end{equation}

\begin{equation}
RTF = \left( \frac{PLR}{PartLoadFrac} \right) = runtime~fraction~of~the~heating~coil
\end{equation}

where:

\({P_{crankcase}}\) is the average crankcase heater power for the simulation time step (W)

\({Q_{cap,crankcase}}\) is the crankcase heater capacity (W).

If this heating coil is used as part of an air-to-air heat pump (Ref. AirLoopHVAC:UnitaryHeat-Pump:AirToAir), the crankcase heater defined for this DX heating coil is enabled during the time that the compressor is not running for either heating or cooling (and the crankcase heater power defined in the DX cooling coil object is disregarded in this case). In this instance, RTF in the above equations would be the runtime fraction of the heat pump's heating coil or cooling coil, whichever is greater.

The properties of the air leaving the heating coil at full-load operation are calculated using the following equations:

\begin{equation}
  h_{outlet} = h_{inlet} + \frac{Q_{total}}{\dot{m}}
 \label{eq:SSEHPDXHeatingCoilhoutlet}
\end{equation}

\begin{equation}
{\omega_{outlet}} = {\omega_{inlet}}
\label{eq:SSEHPDXHeatingCoilomegaoutlet}
\end{equation}

\begin{equation}
{T_{db,outlet}} = PsyTdbFnHW({h_{outlet}},{\omega_{outlet}})
\label{eq:SSEHPDXHeatingCoilTdboutlet}
\end{equation}

where:

\({h_{outlet}}\) is the enthalpy of the air leaving the heating coil (J/kg)

\(\,{\omega_{outlet}}\) is the leaving air humidity ratio (kg/kg)

\(\,{T_{db,outlet}}\) is the leaving air dry-bulb temperature (°C)

\emph{PsyTdbFnHW} is an EnergyPlus psychrometric function, returns dry-bulb temp given enthalpy and humidity ratio.

\subsubsection{Condenser Inlet Air Temperature}\label{condenser-inlet-air-temperature-1}

The air temperature entering the outdoor condenser is based on the weather data used during a simulation. This temperature is either taken directly from the weather data, or can be adjusted based on the height of the outdoor condenser. Since this DX heating coil can only be used in conjunction with a DX cooling coil, the input for Condenser Air Inlet Node Name in the DX cooling coil object can be used to control this optional feature. If this input is left blank, the air temperature entering the condenser is based solely on the weather data. If this input is not blank, then the node name specified must also be listed in an OutdoorAir:Node or OutdoorAir:NodeList object. When the node name is listed in an OutdoorAir:NodeList object, the air temperature entering the condenser is based solely on the weather data. When the node name is listed in an OutdoorAir:Node object, the height of the node determines the air temperature entering the outdoor condenser (see description of Local Outdoor Air Temperature Calculation in the Atmospheric Variation section of this document for further details).

\subsubsection{Supply Air Fan Control: Cycling vs.~Continuous}\label{supply-air-fan-control-cycling-vs.continuous-1}

One of the inputs to the DX coil model is the supply air fan operation mode: cycling fan, cycling compressor (CyclingFanAndCompressor) or continuous fan, cycling compressor (ContinuousFanWithCyclingCompressor). The first operation mode is frequently referred to as ``AUTO fan'', where the compressor(s) and supply air fan operate in unison to meet the zone heating load, and cycle off together when the heating load has been met. The second operation mode is often referred to as ``fan ON'', where the compressor(s) cycle on and off to meet the zone heating load but the supply air fan operates continuously regardless of compressor operation.

Since this DX heating coil can only be used in conjunction with a DX cooling coil (i.e.~heat pumps), and these coils are used in AC equipment that specifies a fan operation mode schedule (e.g AirLoopHVAC:UnitaryHeatPump:AirToAir), the selection made in the DX heating coil is currently ignored and the fan operation mode schedule value determines the fan operation mode for each time step throughout the simulation. A fan operation mode schedule value of 0 specifies AUTO fan mode operation while values other than 0 specify fan ON operation. The use of a schedule allows the fan operation mode to change based on time-of-day or with changes in season.

The EnergyPlus methodology for determining the impact that HVAC equipment has on an air stream is to calculate the mass flow rate and air properties (e.g., enthalpy, dry-bulb temperature, humidity ratio) exiting the equipment. These exiting conditions are passed along as inlet conditions to the next component model in the air stream. Eventually the flow rate and properties of the air being supplied to the conditioned zone are used in the zone energy balance to determine the resulting zone air temperature and humidity ratio.

With this methodology, the determination of the air mass flow rate and air properties for the two different supply air fan operation modes is slightly different. For the case of cycling fan/cycling compressor, the conditions of the air leaving the heating coil are the steady-state values calculated using Equations~\ref{eq:SSEHPDXHeatingCoilhoutlet},~\ref{eq:SSEHPDXHeatingCoilomegaoutlet}, and~\ref{eq:SSEHPDXHeatingCoilTdboutlet} above. However the air mass flow rate passed along to the next component (and eventually to the conditioned zone) is the average air mass flow rate for the system simulation time step (determined by the heating system; see AirLoopHVAC:UnitaryHeatPump:AirToAir). For this fan control type, the heating coil part-load fraction (Equation~\ref{eq:SSEHPDXHeatAirCoilPartLoadFrac1} or ~\ref{eq:SSEHPDXHeatAirCoilPartLoadFrac2}) is also passed to Fan:OnOff (if used) to properly calculate the supply air fan power and associated fan heat.

For the case of continuous fan/cycling compressor, the air mass flow rate is constant. However, the air properties leaving the heating coil are calculated as the average conditions during the system simulation time step. The model assumes that the exiting air conditions are the steady-state values calculated using Equations~\ref{eq:SSEHPDXHeatingCoilhoutlet},~\ref{eq:SSEHPDXHeatingCoilomegaoutlet}, and~\ref{eq:SSEHPDXHeatingCoilTdboutlet} above when the compressor(s) operate. For the remainder of the system simulation time step, it is assumed that the air exiting the DX coil has the same properties as the air entering the coil. For this supply air fan operating strategy, the leaving air properties are calculated as follows:

\begin{equation}
{h_{outlet,ContFanCycComp}} = {h_{outlet}}\left( {PLR} \right) + {h_{inlet}}\left( {1 - PLR} \right)
\end{equation}

\begin{equation}
{\omega_{outlet,ContFanCycComp}} = {\omega_{outlet}}\left( {PLR} \right) + {\omega_{inlet}}\left( {1 - PLR} \right)
\end{equation}

\begin{equation}
{T_{db,outlet,ContFanCycComp}} = PsyTdbFnHW({h_{outlet,ContFanCycComp}},{\omega_{outlet,ContFanCycComp}})
\end{equation}

\subsubsection{References}\label{references-5-001}

DOE. 1982. \emph{DOE-2 engineers manual}, version 2.1A. LBL-11353. Berkeley, CA: Lawrence Berkeley National Laboratory.

ESTSC. 2001. DOE-2.1E Version 110 (source code).Oak Ridge, TN: Energy Science and Technology Software Center.

Miller, R.L. and Jaster, H. 1985. Performance of Air-Source Heat Pumps. EM-4226. Palo Alto, CA: Electric Power Research Institute.

\subsection{Single-Speed DX Heating Coil Standard Ratings}\label{single-speed-dx-heating-coil-standard-ratings}

For single-speed direct expansion (DX) heating coils, the industry standard ratings of High Temperature Heating Standard (Net) Rating Capacity, Low Temperature Heating Standard (Net) Rating Capacity and Heating Seasonal Performance Factor (HSPF) are calculated according to ANSI/AHRI Standard 210/240 (AHRI 2008). The rated Energy Efficiency Ratio (EER) is not calculated for any DX heatings coils at this time.

For the Coil:Heating:DX:SingleSpeed object in EnergyPlus, these standard ratings are not direct inputs to the model. However, these standard ratings can be calculated using user-entered information for the Coil:Heating:DX:SingleSpeed object. These standard rating values are provided in the eplusout.eio output file (Ref. OutputDetailsAndExamples.pdf) and also in the predefined tabular output reports (Output:Table:SummaryReports object, Equipment Summary). Currently, the standard ratings are only calculated and output for single-speed DX heating coils.

Note: The standard ratings described in this section require that the DX heating coil model be evaluated at specific operating conditions (i.e., specific temperatures for air entering the heating coil and for air entering the air-cooled {[}outdoor{]} condenser). If the heating coil performance curves can not be evaluated at the required test conditions, then a standard rating value will be calculated at user specified curve limit as an output and a warning message will written to eplusout.err. For example, if the curve object (Curve:Biquadratic) for Total Heating Capacity Function of Temperature Curve has a minimum value of -5\(^{\circ}\)C for dry-bulb temperature entering the condenser coil, the HSPF calculation requires that heating capacity and EIR be calculated at -8.33\(^{\circ}\)C, so this would result in HSPF value calculated at -5\(^{\circ}\)C as an output and a warning message in the eplusout.err file.

\subsubsection{High Temperature Heating Standard (Net) Rating Capacity}\label{high-temperature-heating-standard-net-rating-capacity}

The procedure for calculating the Standard Rating Heating Capacity is given by:

\begin{equation}
{\dot Q_{HighStandardRating}} = {\dot Q_{total,Rated}}\left( {TotCapTempModFa{c_{Rated}}} \right)
\end{equation}

\begin{equation}
{\dot Q_{HighStandardRating,Net}} = {\dot Q_{HighStandardRating}} + Fa{n_{Power,Rated}}
\end{equation}

where:

\({\dot Q_{HighStandardRating,Net}}\) is the total standard (net) heating capacity (W) of the air-source heat pump equipment in heating mode determined from ANSI/AHRI Standard 210/240 and test conditions shown in Table~\ref{table:heating-mode-test-conditions-for-units-having}. The standard heating test conditions for air-cooled condenser are: indoor coil entering air dry-bulb 21.1\(^{\circ}\)C and outdoor coil entering air dry-bulb 8.33\(^{\circ}\)C

\({\dot Q_{HighStandardRating}}\) is the total standard heating capacity (W) of the air-source heat pump equipment in heating mode determined from ANSI/AHRI Standard 210/240 and test conditions shown in Table~\ref{table:generalized-climatic-region-information}. The standard heating test conditions for air-cooled condenser are: indoor coil entering air dry-bulb 21.1\(^{\circ}\)C and outdoor coil entering air dry-bulb 8.33\(^{\circ}\)C

\({\dot Q_{total,Rated}}\) is the rated total heating capacity, user input (W)

\(TotCapTempModFa{c_{Rated}}\) is the user-specified bi-quadratic curve evaluated at the indoor coil entering air dry-bulb 21.1\(^{\circ}\)C and outdoor coil entering air dry-bulb 8.33\(^{\circ}\)C for air-cooled condenser as specified in Table~\ref{table:heating-mode-test-conditions-for-units-having} (dimensionless)

\(Fa{n_{Power,Rated}}\) is the supply air fan power at rated conditions, (W). The Rated Indoor Coil Fan Power Per Volume Flow rate is a user-entered value, with a default of 773.3 W/(m\(^3\)/s)) if the user leaves this input field blank. The default value is taken from ANSI/ASHRAE Standard 210/240-2008 where it is defined for systems which do not have an Indoor Coil fan furnished as part of the system. See the description given at the end of this section for how this value is calculated.

\subsubsection{Low Temperature Heating Standard (Net) Rating Capacity}\label{low-temperature-heating-standard-net-rating-capacity}

The procedure for calculating the Low Temperature Standard Rating Heating Capacity is given by:

\begin{equation}
{\dot Q_{LowStandardRating}} = {\dot Q_{total,Rated}}\left( {TotCapTempModFa{c_{H3Test}}} \right)
\end{equation}

\begin{equation}
{\dot Q_{LowStandardRating,Net}} = {\dot Q_{LowStandardRating}} + Fa{n_{Power,\,Rated}}
\end{equation}

where:

\({\dot Q_{LowStandardRating,Net}}\) is the total standard (net) heating capacity (W) of the air-source heat pump equipment in heating mode determined from ANSI/AHRI Standard 210/240 and test conditions shown in Table~\ref{table:generalized-climatic-region-information}. The standard heating test conditions for air-cooled condenser are: indoor coil entering air dry-bulb 21.1\(^{\circ}\)C and outdoor coil entering air dry-bulb -8.33\(^{\circ}\)C

\({\dot Q_{LowStandardRating}}\) is the total standard heating capacity (W) of the air-source heat pump equipment in heating mode determined from ANSI/AHRI Standard 210/240 and test conditions shown in Table~\ref{table:heating-mode-test-conditions-for-units-having}. The standard heating test conditions for air-cooled condenser are: indoor coil entering air dry-bulb 21.1\(^{\circ}\)C and outdoor coil entering air dry-bulb -8.33\(^{\circ}\)C

\({\dot Q_{total,Rated}}\) is the rated total heating capacity, user input (W)

\(TotCapTempModFa{c_{H3Test}}\) is the user-specified bi-quadratic curve evaluated at the indoor coil entering air dry-bulb 21.1\(^{\circ}\)C and outdoor coil entering air dry-bulb -8.33\(^{\circ}\)C for air-cooled condenser as specified in Table~\ref{table:generalized-climatic-region-information}, (dimensionless).

\(Fa{n_{Power,Rated}}\) is the supply air fan power at rated conditions (W). The Rated Indoor Coil Fan Power Per Volume Flow rate is a user-entered value, with a default of 773.3 W/(m3/s)) if the user leaves this input field blank. The default value is taken from ANSI/ASHRAE Standard 210/240-2008 where it is defined for systems which do not have an Indoor Coil fan furnished as part of the system. See the description given at the end of this section for how this value is calculated.

\subsubsection{Heating Seasonal Performance Factor (HSPF)}\label{heating-seasonal-performance-factor-hspf}

Heating Seasonal Performance Factor (HSPF) is defined as the total space heating required during the space heating season, divided by the total electrical energy consumed by the heat pump system during the same season.

Calculations of HSPF of a heat pump having a single-speed compressor that was tested with a fixed speed indoor fan installed, a constant-air-volume-rate indoor fan installed, or with no indoor fan installed is given below.

\begin{equation}
HSPF = \frac{{\sum\limits_j^J {\left[ {\frac{{{n_j}}}{N} \cdot BL({T_j})} \right]} }}{{\sum\limits_j^J {\left[ {\frac{{{e_h}({T_j})}}{N}} \right]}  + \sum\limits_j^J {\left[ {\frac{{RH({T_j})}}{N}} \right]} }} \cdot {F_{def}}
\end{equation}

where:

\(\frac{{{e_h}({T_j})}}{N}\) is the ratio of the electrical energy consumed by the heat pump during periods of the ~space heating season when the outdoor temperature fell within the range represented by bin temperature \({T_j}\) to the total number of hours (N) in the heating season (W)

\(\frac{{RH({T_j})}}{N}\) = The ratio of the electrical energy used for resistive space heating during periods when the outdoor temperature fell within the range represented by bin temperature \({T_j}\) ~to the total number of hours (N) in the heating season (W)

\({T_j}\) is the outdoor bin temperature (\(^{\circ}\)C). Outdoor temperatures are ``binned'' such that calculations are only performed based one temperature within the bin. Bins of 2.78\(^{\circ}\)C are used

\(\frac{{{n_j}}}{N}\) is the fractional bin hours for the heating season; the ratio of the number of hours during the heating season when the outdoor temperature fell within the range represented by bin temperature \({T_j}\) ~to the total number of hours in the heating season, dimensionless. Obtain \(\frac{{{n_j}}}{N}\) ~values from Table 17 of AHRI Std. 210/240-2008 (Table~\ref{table:generalized-climatic-region-information} below).

\(j\) is the bin number (dimensionless)

\(J\) is, for each generalized climatic region, the total number of temperature bins (dimensionless). Referring to Table~\ref{table:generalized-climatic-region-information}, \(J\) is the highest bin number (\(j\)) having a nonzero entry for the fractional bin hours for the generalized climatic region of interest.

\({F_{def}}\) is the demand defrost credit described in section 3.9.2 of AHRI Std. 210/240-2008 (dimensionless).~ For simplification, assigned a value of 1 for timed defrost control and a value of 1.03 for demand defrost control.

\(BL({T_j})\) is the building space conditioning load corresponding to an outdoor temperature of\({T_j}\); the heating season building load also depends on the generalized climatic region's outdoor design temperature and the design heating requirement (W).

Building heating load can be evaluated by using the following equation:

\begin{equation}
  BL({T_j}) = \frac{{\left( {18.33 - {T_j}} \right)}}{{\left( {18.33 - {T_{OD}}} \right)}} \cdot C \cdot DHR
\end{equation}

where:

\(T_{OD}\) is the outdoor design temperature (\(^{\circ}\)C. An outdoor design temperature is specified for each generalized climatic region in Table 17 of AHRI Std. 210/240-2008 (Table~\ref{table:generalized-climatic-region-information} below).

\(C\) is 0.77, a correction factor which tends to improve the agreement between calculated and measured building loads (dimensionless)

\(DHR\) is the Design Heating Requirement (W). This is the amount of heating required to maintain a given indoor temperature at a particular outdoor design temperature.

For a single speed heat pump with a fixed speed indoor fan installed, a constant-air-volume-rate indoor fan installed, or with no indoor fan installed, the minimum and maximum design heating requirements for each generalized climatic region can be calculated as follows:

\begin{equation}
  DHR_{min} =
  \left\{ 
    \begin{array}{l}
      {\dot{Q}_h}(8.33) \cdot (1.8) \cdot \left( {\frac{{18.33 - {T_{OD}}}}{{60.0}}} \right), {~for~Regions~I,~II,~III,~IV,~and~VI} \\
      {\dot{Q}_h}(8.33),{~for~Region~V}
    \end{array}
  \right\}
\end{equation}

\begin{equation}
  DHR_{max} =
  \left\{ 
    \begin{array}{l}
      {2 \cdot \dot{Q}_h}(8.33) \cdot (1.8) \cdot \left( {\frac{{18.33 - {T_{OD}}}}{{60.0}}} \right), {~for~Regions~I,~II,~III,~IV,~and~VI} \\
      {2.2 \cdot \dot{Q}_h}(8.33),{~for~Region~V}
    \end{array}
  \right\}
\end{equation}

Both \(DH{R_{\min }}\) and \(DH{R_{\max }}\) above should be rounded to the nearest standardized DHR given in Table~\ref{table:standardized-design-heating-requirements-w}.

The intermediate term used in the calculations of HSPF can be calculated using the equations described below.

\begin{equation}
\frac{{{e_h}({T_j})}}{N} = \frac{{X({T_j}) \cdot \mathop {{E_h}}\limits^ \cdot  ({T_j}) \cdot \delta ({T_j})}}{{PL{F_j}}} \cdot \frac{{{n_j}}}{N}
\end{equation}

\begin{equation}
\frac{{RH({T_j})}}{N} = \left[ {BL({T_j}) - \left( {X({T_j}) \cdot \mathop {{Q_h}}\limits^ \cdot  ({T_j}) \cdot \delta ({T_j})} \right)} \right] \cdot \frac{{{n_j}}}{N}
\end{equation}

Where,

\begin{equation}
X({T_j}) = \left\{ 
    \begin{array}{l}
      BL({T_J})/\mathop {{Q_h}}\limits^ \cdot  ({T_j}) \\
      {\rm{or}} \\
      1
    \end{array}
  \right\}
\end{equation}

whichever is less; the heating mode load factor for temperature bin \(j\), dimensionless.

\(\mathop {{Q_h}}\limits^ \cdot ({T_j})\) is the space heating capacity of the heat pump when operating at outdoor temperature \({T_j}\) (W)

\(\mathop {{E_h}}\limits^ \cdot ({T_j})\) is the electrical power consumption of the heat pump when operating at outdoor temperature \({T_j}\) (W)

\(\delta ({T_j})\) is the heat pump low temperature cut-out factor (dimensionless)

\(PL{F_j}\) is the part load factor (dimensionless)

The part load factor is determined as follows:

\begin{equation}
PL{F_j} = 1 - {C_{{D^h}}}[1 - X({T_j})]
\end{equation}

where \({C_{{D^h}}}\) is the degradation coefficient which is defaulted to the value of 0.25.

The low temperature cut-out factor \(\delta ({T_j})\) is determined as follows:

\begin{equation}
\delta ({T_j}) = \left\{ 
    \begin{array}{l}
      {\rm{0,~if~}}{T_j} \le {T_{off}}{\rm{~or~}}\frac{{\mathop {{Q_h}}\limits^ \cdot  ({T_j})}}{{\mathop {{E_h}}\limits^ \cdot  ({T_j})}} < 1 \\
      {\rm{1/2,~if~}}{T_{off}} < {T_j} \le {T_{on}}{\rm{~and~}}\frac{{\mathop {{Q_h}}\limits^ \cdot  ({T_j})}}{{\mathop {{E_h}}\limits^ \cdot  ({T_j})}} \ge 1 \\
      {\rm{1,~if~}}{T_j} > {T_{on}}{\rm{~and~}}\frac{{\mathop {{Q_h}}\limits^ \cdot  ({T_j})}}{{\mathop {{E_h}}\limits^ \cdot  ({T_j})}} \ge 1
    \end{array}
  \right.
\end{equation}

where:

\({T_{off}}\) is the outdoor temperature when the compressor is automatically shut off (\(^{\circ}\)C). Note that if no such temperature exists, \({T_j}\) is always greater than \({T_{off}}\) and\({T_{on}}\).

\({T_{on}}\) is the outdoor temperature when the compressor is automatically turned back on, if applicable, following an automatic shut-off (\(^{\circ}\)C).

Calculate \(\dot{Q}_{h} \cdot ({T_j})\) and \(\dot{E}_{h} \cdot ({T_j})\) using:

\begin{equation}
\dot{Q}_{h}({T_j}) = \left\{ \begin{array}{l}\dot{Q}_{h}(-8.33) + \frac{{\left[ {\dot{{Q}_{h}}(8.33) - \dot{{Q_h}}(-8.33)} \right] \cdot \left( {{T_j} + 8.33} \right)}}{{16.67}}{\rm{,~if~}}{T_j} \ge 7.22^{\circ}C {\rm{~or~}}{T_j} \le  -8.33^{\circ}C \\
\dot{Q}_{h}(-8.33) + \frac{{\left[ {\dot{Q}_{h}(1.67) - \dot{Q}_{h}(-8.33)} \right] \cdot \left( {{T_j} + 8.33} \right)}}{{10}}{\rm{,~if~}} -8.33^{\circ}C < {T_j} < 7.22^{\circ}C\end{array} \right.
\end{equation}

\begin{equation}
\dot{E}_{h}({T_j}) = \left\{ \begin{array}{l}\dot{E}_{h}(-8.33) + \frac{{\left[ {\dot{{E}_{h}}(8.33) - \dot{{E_h}}(-8.33)} \right] \cdot \left( {{T_j} + 8.33} \right)}}{{16.67}}{\rm{,~if~}}{T_j} \ge 7.22^{\circ}C {\rm{~or~}}{T_j} \le  -8.33^{\circ}C \\
\dot{E}_{h}(-8.33) + \frac{{\left[ {\dot{E}_{h}(1.67) - \dot{E}_{h}(-8.33)} \right] \cdot \left( {{T_j} + 8.33} \right)}}{{10}}{\rm{,~if~}} -8.33^{\circ}C < {T_j} < 7.22^{\circ}C\end{array} \right.
\end{equation}

\(\dot{Q_h}(-8.33),~\dot{Q_h}(1.67),~\dot{Q_h}(8.33),~\dot{E_h}(-8.33),~\dot{E_h}(1.67)\) and \(\dot{E_h}(8.33)\) are the \textbf{(net)} values calculated using performance curves entered by the user and supply fan power per rated air flow rate.

% table 59
\begin{longtable}[c]{>{\raggedright}p{2.0in}p{0.75in}p{0.75in}p{0.75in}p{0.75in}>{\raggedright}p{1.0in}}
\caption{Heating Mode Test Conditions for Units Having a Single-Speed Compressor and a Fixed-Speed Indoor Fan, a Constant Air Volume Rate Indoor Fan, or No Indoor Fan \label{table:heating-mode-test-conditions-for-units-having}} \tabularnewline
\toprule 
Test description & \multicolumn{2}{p{1.5in}}{\raggedright Air Entering Indoor Unit Temperature (\(^{\circ}\)C)} & \multicolumn{2}{p{1.5in}}{\raggedright Air Entering Outdoor Unit Temperature (\(^{\circ}\)C)} & Heating Air Volume Rate \tabularnewline
\cmidrule(r){2-3}
\cmidrule(l){4-5}
& Dry Bulb & Wet Bulb & Dry Bulb & Wet Bulb & \tabularnewline
\midrule
\endfirsthead

\caption[]{Heating Mode Test Conditions for Units Having a Single-Speed Compressor and a Fixed-Speed Indoor Fan, a Constant Air Volume Rate Indoor Fan, or No Indoor Fan} \tabularnewline
\toprule 
Test description & \multicolumn{2}{p{1.5in}}{\raggedright Air Entering Indoor UnitTemperature (°C)} & \multicolumn{2}{p{1.5in}}{\raggedright Air Entering Outdoor UnitTemperature (°C)} & Heating Air Volume Rate \tabularnewline
\cmidrule(r){2-3}
\cmidrule(l){4-5}
& Dry Bulb & Wet Bulb & Dry Bulb & Wet Bulb & \tabularnewline
\midrule
\endhead

H1 Test (Required, Steady) & 21.11 & 15.56 & 8.33 & 6.11 & Heating Full-load \tabularnewline
H1C Test (Required, Steady) & 21.11 & 15.56 & 8.33 & 6.11 & (2) \tabularnewline
H2 Test (Required, Steady) & 21.11 & 15.56 & 1.67 & 0.56 & Heating Full-load \tabularnewline
H3 Test (Required, Steady) & 21.11 & 15.56 & -8.33 & -9.44 & Heating Full-load \tabularnewline
\bottomrule
\multicolumn{6}{p{6in}}{\raggedright Notes: 1) Heating air volume arte are defined in section 3.1.4.4 of ANSI/AHRI 210/240-2008  2) Maintain the airflow nozzles static pressure difference ro velocity pressure during the ON periodat the same pressure difference or velocity pressure as measured during the H1 Test.} \tabularnewline
\multicolumn{6}{p{6in}}{Source: Table 9, Page 74, ANSI/AHRI Standard 210/240-2008}
\end{longtable}

% table 60
\begin{longtable}[c]{p{0.75in}p{0.75in}p{0.75in}p{0.75in}p{0.75in}p{0.75in}p{0.75in}p{0.75in}}
\caption{Generalized Climatic Region Information \label{table:generalized-climatic-region-information}} \tabularnewline
\toprule 
\multicolumn{2}{p{1.5in}}{\raggedright Region Number} & I & II & III & IV & V & VI \tabularnewline
\multicolumn{2}{p{1.5in}}{\raggedright Heating Load Hours, HLH} & 750 & 1250 & 1750 & 2250 & 2750 & *2750 \tabularnewline
\multicolumn{2}{p{1.5in}}{\raggedright Outdoor Design Temperature, \(T_{OD}\) (°C)} & 2.78 & -2.78 & -8.33 & -15 & -23.33 & -1.11 \tabularnewline
\midrule
\(j\) & \(T_j\) (°C) & \multicolumn{6}{c}{Fractional Bin Hours \(\frac{n_j}{N}\)} \tabularnewline
\midrule
\endfirsthead

\caption[]{Generalized Climatic Region Information} \tabularnewline
\toprule 
\(j\) & \(T_j\) (°C) & \multicolumn{6}{c}{Fractional Bin Hours \(\frac{n_j}{N}\)} \tabularnewline
\midrule
\endhead

1 & 16.67 & .291 & .215 & .153 & .132 & .106 & .113 \tabularnewline
2 & 13.89 & 0.239 & 0.189 & 0.142 & 0.111 & 0.092 & 0.206 \tabularnewline
3 & 11.11 & 0.194 & 0.163 & 0.138 & 0.103 & 0.086 & 0.215 \tabularnewline
4 & 8.33 & 0.129 & 0.143 & 0.137 & 0.093 & 0.076 & 0.204 \tabularnewline
5 & 5.56 & 0.081 & 0.112 & 0.135 & 0.1 & 0.078 & 0.141 \tabularnewline
6 & 2.78 & 0.041 & 0.088 & 0.118 & 0.109 & 0.087 & 0.076 \tabularnewline
7 & 0 & 0.019 & 0.056 & 0.092 & 0.126 & 0.102 & 0.034 \tabularnewline
8 & -2.78 & 0.005 & 0.024 & 0.042 & 0.087 & 0.094 & 0.008 \tabularnewline
9 & -5.56 & 0.001 & 0.008 & 0.021 & 0.055 & 0.074 & 0.003 \tabularnewline
10 & -8.33 & 0 & 0.002 & 0.009 & 0.036 & 0.055 & 0 \tabularnewline
11 & -11.11 & 0 & 0 & 0.005 & 0.026 & 0.047 & 0 \tabularnewline
12 & -13.89 & 0 & 0 & 0.002 & 0.013 & 0.038 & 0 \tabularnewline
13 & -16.67 & 0 & 0 & 0.001 & 0.006 & 0.029 & 0 \tabularnewline
14 & -19.44 & 0 & 0 & 0 & 0.002 & 0.018 & 0 \tabularnewline
15 & -22.22 & 0 & 0 & 0 & 0.001 & 0.01 & 0 \tabularnewline
16 & -25 & 0 & 0 & 0 & 0 & 0.005 & 0 \tabularnewline
17 & -27.78 & 0 & 0 & 0 & 0 & 0.002 & 0 \tabularnewline
18 & -30.56 & 0 & 0 & 0 & 0 & 0.001 & 0 \tabularnewline
\bottomrule
\multicolumn{8}{l}{* Pacific Coast Region} \tabularnewline
\multicolumn{8}{l}{Source: Table 17, Page 99, ANSI/AHRI Standard 210/240-2008}
\end{longtable}

% table 61
\begin{longtable}[c]{p{1.5in}p{1.5in}p{1.5in}p{1.5in}}
\caption{Standardized Design Heating Requirements (W) \label{table:standardized-design-heating-requirements-w}} \tabularnewline
\toprule 
\tabularnewline
\endfirsthead

\caption[]{Standardized Design Heating Requirements (W)} \tabularnewline
\toprule 
\tabularnewline
\endhead

1465.356 & 7326.78 & 14653.56 & 26376.41 \tabularnewline
2930.712 & 8792.136 & 17584.27 & 29307.12 \tabularnewline
4396.068 & 10257.49 & 20514.98 & 32237.83 \tabularnewline
5861.424 & 11722.85 & 23445.7 & 38099.26 \tabularnewline
\bottomrule
\multicolumn{4}{l}{Source: Table 18, Page 100, ANSI/AHRI Standard 210/240-2008}
\end{longtable}

\subsection{Multi-Speed Electric Heat Pump DX Air Heating Coil}\label{multi-speed-electric-heat-pump-dx-air-heating-coil}

\subsubsection{Overview}\label{overview-7-000}

This model (object name Coil:Heating:DX:MultiSpeed:) simulates the performance of an air-to-air direct expansion (DX) heating system. The main difference compared to the other heating coil model (Coil:Heating:DX:SingleSpeed) is that this heating coil allows modeling of two to four discrete compressor speeds. Each speed has a set of corresponding performance information at rated conditions along with curve fits for variations in total capacity, energy input ratio and part-load fraction to determine the performance of the unit at part-load conditions (DOE 1982). The full load supply airflow rate is dependent on the speed number and is set by its parent object (Ref: AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed). The part-load impact on coil energy use is automatically applied to the lowest speed. A choice is provided to determine whether part-load impacts on coil energy use are applied when the coil is operating at speeds greater than Speed 1. Adjustment factors applied to total capacity and input power to account for frost formation on the outdoor coil are calculated at each speed.

This model simulates the thermal performance of the indoor DX heating coil, and the power consumption of the outdoor unit (multispeed compressor, fans, crankcase heaters and defrost heaters). The performance of the indoor supply air fan varies widely from system to system depending on control strategy (e.g., constant fan vs.~AUTO fan), fan type, fan motor efficiency and pressure losses through the air distribution system. Therefore, this DX system model does not account for the thermal effects or electric power consumption of the indoor supply air fan. EnergyPlus contains separate models for simulating the performance of various indoor fan configurations, and these models can be easily linked with the DX system model described here to simulate the entire DX system being considered. For the time being, this coil model can only be called by the parent object AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed.

When the model determines performance at Speed 1 (the lowest speed) or cycling between OFF and Speed 1, its performance is almost the same as the performance for the Coil:Heating:DX:SingleSpeed model. However, the outlet conditions are calculated slightly differently. Therefore, the Coil:Heating:DX:SingleSpeed model may be considered as a subset of the model described here. When the multispeed coil model determines performance at higher speeds (above 1), the model linearly interpolates the performance at two consecutive speeds (n-1 and n) as needed to meet the heating load, with the fraction of time at each speed established by the speed ratio.

When single mode operation is specified at higher speeds (above 1), defined in the UnitarySystemPerformance:Multispeed object, a child object of AirLoopHVAC:UnitarySystem, its performance is almost the same as the performance for the Coil:Heating:DX:SingleSpeed model at different flow rate and capacity with given speed number. No linear interpolation is performed between two adjacent speeds. The highest speed which does not exceed the sensible load is used for each HVAC timestep. This operation does not apply to speed 1 operation and the case when the sensible load is above the highest sensible capacity.

\subsubsection{Model Inputs}\label{model-inputs-3}

The model inputs are also very similar to the inputs of the Coil:Heating:DX:SingleSpeed object. The main difference is that this multispeed model requires a set of fields at each speed, such as rated capacity, rated COP, two capacity modifiers, two energy input ratio modifiers, and part-load correction. The inputs also include waste heat fraction and modifier as a function of temperature to calculate recoverable waste heat for heat recovery, which are not available in the similar Coil:Heating:DX:SingleSpeed object.

\subsubsection{Speed 1 Operation}\label{speed-1-operation-1}

The calculation procedures in this model, including defrost and crankcase heater, are indentical to the Coil:Heating:DX:SingleSpeed object (Ref: Coil:Heating:DX:SingleSpeed) with one exception: outlet node condition calculation when the supply air fan operation mode is ContinuousFanWithCyclingCompressor. The following procedure provides the detailed description of the exception.

\begin{itemize}
  \item Total delivered heating capacity
\end{itemize}

The total delivered heating capacity for speed 1 operating at the cycling ratio needed to meet the requested heating load is:

\begin{equation}
{Q_{coil,cycling}} = {\dot{m}_{Speed~1}}\left( {CycRatio} \right)({h_{inlet}} - {h_{outlet,full}})
\end{equation}

where:

\emph{Q\(_{coil,cycling}\)} is the delivered sensible heating capacity for Speed 1 operating at a specific cycling ratio (W)

\(\dot{m}_{Speed~1}\) is the air mass flow rate through heating coil at Speed 1 as set by the parent object (kg/s)

\emph{h\(_{outlet,full}\)} is the specific enthalpy of the coil outlet air during full-load operation at Speed 1 (no cycling) (J/kg)

\emph{h\(_{inlet}\)} is the specific enthalpy of the coil inlet air (J/kg)

\emph{CycRatio} is the cycling ratio at Speed 1, ratio of requested heating load to the full-load capacity of the coil at Speed 1 (dimensionless).

It is assumed that the coil provides no heating capacity when the coil is OFF, even if the supply air fan continues to operate.

\begin{itemize}
  \item Outlet air specific enthalpy
\end{itemize}

The average specific enthalpy of the coil outlet air is then calculated based on the delivered sensible heating capacity and the average air mass flow rate entering the coil:

\begin{equation}
  h_{outlet,average} = h_{inlet} - \frac{Q_{coil,cycling}}{\dot{m}_{inlet}}
\end{equation}

where:

\emph{h\(_{outlet,average}\)} is the average specific enthalpy at the coil outlet (J/kg)

\({\dot m_{inlet}}\) is the mass flow rate at the inlet to the coil as established by the parent object (Ref. AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed, Mass Flow Rate Calculation). This flow rate is the average value determined by the parent object, accounting for the specified flow rate when the heating coil is ON and the specified flow rate when the heating coil is OFF for the time step being simulated.

\begin{itemize}
  \item Outlet air temperature
\end{itemize}

The heating coil's outlet air humidity ratio equals the inlet air humidity ratio since the coil does not change the moisture content of the air. So the average outlet air temperature is calculated based on the inlet air humidity ratio and the average outlet air enthalpy using the psychrometric function PsyTdbFnHW.

The main reason for using the above approach is that outlet air conditions are calculated in the same way for all operating speeds.

The crankcase heater defined for this DX heating coil is enabled during the time that the compressor is not running for either heating or cooling. The crankcase heater power use from either heating or cooling is reported in the heating coil.

\subsubsection{Higher Speed Operation}\label{higher-speed-operation-2}

This section describes how higher speed operation is simulated. When the required sensible load is less than the full load sensible capacity at Speed n (Speed Number \textgreater{} 1), the following calculations are performed:

Total delivered heating capacity at Speed n-1 and Speed n

\begin{equation}
  TotCa{p_{n - 1}} = RatedCa{p_{n - 1}}\left( {TotCapTempModFa{c_{n - 1}}} \right)\left( {TotCapFlowModFa{c_{n - 1}}} \right)
\end{equation}

\begin{equation}
  TotCa{p_n} = RatedCa{p_n}\left( {TotCapTempModFa{c_n}} \right)\left( {TotCapFlowModFa{c_n}} \right)
\end{equation}

where:

\emph{TotCap\(_{i}\)} is the total delivered heating capacity at given temperatures and flow rates at Speed i (W)

\emph{RatedCap\(_{i}\)} is the heating capacity at the rated conditions at Speed i (W)

\emph{TotCapTempModFac\(_{i}\)} is the total heating capacity modifier as a function of indoor and outdoor air dry-bulb temperature at Speed i

\emph{TotCapFlowModFac\(_{i}\)} is the total heating capacity modifier as a function of the ratio of the actual flow rate across the heating coil to the rated airflow rate at Speed i

i is Speed n or Speed n-1.

\begin{itemize}
  \item EIR at Speed n-1 and Speed n
\end{itemize}

\begin{equation}
EI{R_{n - 1}} = RatedEI{R_{n - 1}}\left( {EIRTempModFa{c_{n - 1}}} \right)\left( {EIRFlowModFa{c_{n - 1}}} \right)
\end{equation}

\begin{equation}
EI{R_n} = RateEI{R_n}\left( {EIRTempModFa{c_n}} \right)\left( {EIRFlowModFa{c_n}} \right)
\end{equation}

where:

\emph{EIR\(_{i}\)} is the energy input ratio at given temperatures and flow rates at Speed i (W)

\emph{RatedEIR\(_{i}\)} is the energy input ratio at the rated conditions at Speed i (W)

\emph{EIRTempModFac\(_{i}\)} is the energy input ratio modifier as a function of indoor and outdoor air dry-bulb temperature at Speed i

\emph{EIRFlowModFac\(_{i}\)} is the energy input ratio modifier as a function of the ratio of the actual flow rate across the heating coil to the rated airflow rate at Speed i

i is Speed n or Speed n-1.

\begin{itemize}
  \item Full load outlet air specific enthalpy at Speed n-1 and Speed n
\end{itemize}

\begin{equation}
  h_{outlet,full~Speed,n} = h_{inlet} - \frac{TotCap_{n} \cdot HeatingCapacityMultiplier}{\dot{m}_{inlet}}
\end{equation}

\begin{equation}
  h_{outlet,full~Speed,n-1} = h_{inlet} - \frac{TotCap_{n-1} \cdot HeatingCapacityMultiplier}{\dot{m}_{inlet}}
\end{equation}

where,

\emph{HeatingCapacityMultiplier} is the frost adjustment factor for heating capacity (See Ref. Coil:Heating:DX:SingleSpeed)

\emph{h\(_{outlet,full~Speed,n}\)} is the specific enthalpy of the coil outlet air during full-load operation at Speed n (no cycling) (J/kg)

\emph{h\(_{outlet,full~Speed,n-1}\)} is the specific enthalpy of the coil outlet air during full-load operation at Speed n-1 (no cycling) (J/kg).

\begin{itemize}
  \item Effective total heating capacity
\end{itemize}

\begin{equation}
  \begin{array}{rl}
    Q_{coil,SpeedRatio} &= \PB{SpeedRatio} \dot{m}_{Speed~n} \PB{h_{inlet} - h_{outlet,full~Speed,n}} \\
                        &+ \PB{1 - SpeedRatio} \dot{m}_{Speed~n - 1} \PB{h_{inlet} - h_{outlet,full~Speed,n - 1}}
  \end{array}
\end{equation}

where,

\({{Q_{coil,SpeedRatio}}}\) is the delivered sensible heating capacity at a given speed ratio between two consecutive speeds (W)

\(\dot{m}_{Speed~n}\) is the air mass flow rate through heating coil at Speed n as set by the parent object (kg/s)

\(\dot{m}_{Speed~n-1}\) is the air mass flow rate through heating coil at Speed 1 as set by the parent object (kg/s).

\begin{itemize}
  \item Average outlet air enthalpy
\end{itemize}

\begin{equation}
  h_{outlet,average} = h_{inlet} - \frac{Q_{coil,SpeedRatio}}{\dot{m}_{inlet}}
\end{equation}

where:

\emph{h\(_{outlet,average}\)} is the average specific enthalpy at the coil outlet (J/kg)

\emph{h\(_{inlet}\)} is the specific enthalpy of the coil inlet air (J/kg)

\({\dot m_{inlet}}\) is the mass flow rate at the inlet to the coil as established by the parent object (Ref. AirLoopHVAC:UnitaryHeatPump:AirToAir:MultiSpeed, Mass Flow Rate Calculation). This flow rate is the average value determined by the parent object, accounting for the specified flow rate when the heating coil is at Speed n and the specified flow rate when the heating coil is at Speed n-1 for the time step being simulated.

\begin{itemize}
  \item Average outlet air temperature
\end{itemize}

The heating coil's outlet air humidity ratio equals the inlet air humidity ratio since the coil does not change the moisture content of the air. So the average outlet air temperature is calculated based on the inlet air humidity ratio and the average outlet air enthalpy using the psychrometric function PsyTdbFnHW.

\begin{itemize}
  \item Full load energy inputs at Speed n-1 and Speed n
\end{itemize}

\begin{equation}
HeatingPowe{r_n} = TotCa{p_n}\left( {EI{R_n}} \right)\left( {HeatingCapacityMultiplier} \right)\left( {InputPowerMultiplier} \right)
\end{equation}

\begin{equation}
HeatingPowe{r_{n - 1}} = TotCa{p_{n - 1}}\left( {EI{R_{n - 1}}} \right)\left( {HeatingCapacityMultiplier} \right)\left( {InputPowerMultiplier} \right)
\end{equation}

where \emph{InputPowerMultiplier} is the frost adjustment factor for heating power calculation (Ref. Coil:Heating:DX:SingleSpeed).

\begin{itemize}
  \item Calculate combined energy input
\end{itemize}

When the input for the field `Apply Part Load Fraction to Speeds Greater than 1' is No (equivalent to a single compressor), the combined energy output is calculated as follows:

\begin{equation}
HeatingPower = HeatingPowe{r_n}\left( {SpeedRatio} \right) + HeatingPowe{r_{n - 1}}(1.0 - SpeedRatio)
\end{equation}

When the input for the field 'Apply Part Load Fraction to Speeds Greater than 1' is Yes (equivalent to multiple compressors), the combined energy output is calculated as follows:

\begin{equation}
HeatingPower = HeatingPowe{r_n}\left( {RTF} \right) + HeatingPowe{r_{n - 1}}(1.0 - RTF)
\end{equation}

where:

HeatingPower is the power used (W)

RTFis the run time fraction (SpeedRatio/Part-load Fraction) at Speed n.

\begin{itemize}
  \item Calculate defrost power
\end{itemize}

When the defrost strategy is resistive, the power calculation is the same as Speed 1 operation (Ref. Coil:Heating:DX:SingleSpeed). When the defrost strategy is reverse-cycle, the following calculations are performed:

\begin{equation}
{Q_{defrost,n}} = 0.01({t_{frac,defrost}})(7.222 - {T_{db,o}})\left( {\frac{{{Q_{total,rated,n}}}}{{1.01667}}} \right)
\end{equation}

\begin{equation}
{P_{defrost,n - 1}} = DefrostEIRTempModFac\left( {\frac{{{Q_{total,rated,n - 1}}}}{{1.01667}}} \right)({t_{frac,defrost}})
\end{equation}

\begin{equation}
{P_{defrost,n}} = DefrostEIRTempModFac\left( {\frac{{{Q_{total,rated,n}}}}{{1.01667}}} \right)({t_{frac,defrost}})
\end{equation}

where:

\({Q_{defrost,n}}\) is the additional indoor heating load due to reverse-cycle defrost at Speed n (\emph{W})

\({Q_{total,rated,n}}\) is the total full-load heating capacity of the coil at rated conditions at Speed n (W)

\({P_{defrost,n - 1}}\) is the full load defrost power for the simulation time step at Speed n-1 (W)

\({P_{defrost,n}}\) is the full load defrost power for the simulation time step at Speed n (W)

\({Q_{total,rated,n - 1}}\) is the capacity of the resistive defrost heating element at Speed n-1 (W)

\({Q_{total,rated,n}}\) is the capacity of the resistive defrost heating element at Speed n (W)

DefrostEIRTempModFac is the defrost energy input ratio (EIR) modifier curve (Ref. Coil:Heating:DX:SingleSpeed).

T\(_{frac,defrost}\) is the fractional defrost time (Ref. Coil:Heating:DX:SingleSpeed).

When the input for the field `Apply Part Load Fraction to Speeds Greater than 1' is No (equivalent to a single compressor), the average defrost power is calculated as follows:

\begin{equation}
{P_{defrost}} = {P_{defrost,n}}(SpeedRatio) + {P_{defrost,n - 1}}(1.0 - SpeedRatio)
\end{equation}

When the input for the field 'Apply Part Load Fraction to Speeds Greater than 1' is Yes (equivalent to multiple compressors), the combined defrost energy is calculated as follows:

\begin{equation}
{P_{defrost}} = {P_{defrost,n}}(RTF) + {P_{defrost,n - 1}}(1.0 - RTF)
\end{equation}

where:

\({P_{defrost}}\) is the average defrost power used (W)

RTF is the run time fraction (SpeedRatio/Part-load Fraction) at Speed n.

\begin{itemize}
  \item Crankcase heater
\end{itemize}

There is no power need at higher speed operation.

\subsubsection{Higher Speed Operation with Single Mode Operation}\label{higher-speed-operation-with-single-mode-operation-1}

This section describes how higher speed operation is simulated with single mode operation. When the required sensible load is less than the full load sensible capacity at Speed n (Speed Number \textgreater{} 1), its performance is almost the same as the performance for the Coil:Heating:DX:SingleSpeed model at different flow rate and capacity with given Speed n. No linear interpolation is performed between two adjacent speeds. The highest speed which does not exceed the sensible load is used for each HVAC timestep. This operation does not apply to the case when the sensible load is above the highest sensible capacity.

\subsubsection{Waste heat calculation}\label{waste-heat-calculation-1-000}

The waste heat generated by this coil object is calculated as:

\begin{equation}
{Q_{WasteHeat}} = (Fraction)(TempModifier)(HeatingPowe)
\end{equation}

where:

Fraction is the rated waste heat fraction of the energy input

TempModifier is the waste heat modifier as a function of indoor and outdoor air dry-bulb temperature.

\subsubsection{Standard Rating of Multi-Speed DX Heating Coils}\label{standard-rating-of-multi-speed-dx-heating-coils}

For multi-speed direct expansion heating coils, the industry standard ratings of Standard Rating Heating Seasonal Performance Factor (HSPF) are calculated according to NSI/AHRI Standard 210/240 (AHRI 2008). These standard ratings can be calculated using the user-entered information for the Coil:Heating:DX:MultiSpeed object.~ According to Standard 210/240, the Standard Rating HSPF applies to air-to-air unitary heat pumps with rated heating capacities under 19,000 watts (65,000 Btu/h). The Heating Mode Test Conditions for Units Having two-capacity Compressor standard tests H0\(_{1}\), H1\(_{1}\), H2\(_{1}\), H3\(_{1}\), H1\(_{2}\), H2\(_{2}\), and H3\(_{2}\) are also provided in Table~\ref{table:heating-mode-test-conditions-for-units-having-001}. The rated Energy Efficiency Ratio (EER) is not calculated for any DX Heating Coils as this time. The equations required to calculate the net heating capacity and HSPF values are described next.

\subsubsection{Standard Ratings Heating Capacity}\label{standard-ratings-heating-capacity}

\emph{The Standard Rating (Net) Heating Capacity calculation is calculated using the same procedure as the single speed DX heating coils except the capacities are evaluated at the maximum speed only.~ Refer to the standard ratings calculation for Coil:DX:Heating:SingelSpeed for description of the procedure.}

The Rated Supply Fan Power Per Volume Flow Rate is a user-entered value, with a default of 773.3 W/(m\(^{3}\)/s)) if the user leaves this input field blank. The default value is taken from ANSI/ASHRAE Standard 210/240-2008 where it is defined for systems which do not have an Indoor Coil (Evaporator) fan furnished as part of the system. The test conditions in ANSI/AHRI Standard 210/240 vary the external static pressure (i.e., pressure drop associated with ductwork and other devices external to the indoor fan/coil section) seen by the supply air fan based on the standard rating cooling capacity. New input field Rated Supply Fan Power Per Volume Flow Rate for each speed will be added to the IDD.

\subsubsection{Heating seasonal performance factors (HSPF) for Multi-Speed DX Coil}\label{heating-seasonal-performance-factors-hspf-for-multi-speed-dx-coil}

The following section describes the test condition for heating mode tests for Air-Source Heat Pumps, including heating-only heat pumps, and the equations required to calculate the HSPF. The HSPF for multi-speed compressor heat pumps in Btu/W-h is given by:

\begin{equation}
HSPF{\rm{ = }}\frac{{\sum\limits_{\rm{j}}^{\rm{M}} {\frac{{{n_j}}}{N} \cdot BL\left( {{T_j}} \right)} }}{{\sum\limits_{\rm{j}}^{\rm{M}} {\frac{{{e_h}\left( {{T_j}} \right)}}{N}{\rm{ + }}} \sum\limits_{\rm{j}}^{\rm{M}} {\frac{{RH\left( {{T_j}} \right)}}{N}} }} \cdot {F_{def}}
\end{equation}

where:

BL(T\(_{j}\)) is the building space conditioning load corresponding to an outdoor temperature of T\(_{j}\); the heating season building load also depends on the generalized climatic region's outdoor design temperature and the design heating requirement (Btu/h).

e\(_{h}\)(T\(_{j}\))/N is the ratio of the electrical energy consumed by the heat pump during periods of the space heating season when the outdoor temperature fell within the range represented by bin temperature T\(_{j}\) to the total number of hours (N) in the heating season (W). For heat pumps having a heat comfort controller, this ratio may also include electrical energy used by resistive elements to maintain a minimum air delivery temperature.

RH(T\(_{j}\))/N is the ratio of the electrical energy used for resistive space heating during periods when the outdoor temperature fell within the range represented by bin temperature T\(_{j}\) to the total number of hours (N) in the heating season (W). Resistive space heating is modeled as being used to meet that portion of the building load that the heat pump does not meet because of insufficient capacity or because the heat pump automatically turns off at the lowest outdoor temperatures.

T\(_{j}\) is the outdoor bin temperature (\(^{\circ}\)C). Outdoor temperatures are ``binned'' such that calculations are only performed based one temperature within the bin. Bins of 2.78\(^{\circ}\)C are used.

n\(_{j}\)/N is the fractional bin hours for the heating season; the ratio of the number of hours during the heating season when the outdoor temperature fell within the range represented by bin temperature T\(_{j}\) to the total number of hours in the heating season, dimensionless, given in Table~\ref{table:generalized-climatic-region-information}.

j is the bin number (dimensionless)

M is for each generalized climatic region, the total number of temperature bins, dimensionless. Referring to Table~\ref{table:generalized-climatic-region-information}, M is the highest bin number (j) having a nonzero entry for the fractional bin hours for the generalized climatic region of interest.

\({F_{def}}\) is the demand defrost credit described in section 3.9.2 of AHRI Std. 210/240-2008, dimensionless.~ For simplification, assigned a value of 1 for timed defrost control and a value of 1.03 for demand defrost control.

The building heating load is calculated as follows:

\begin{equation}
BL\left( {{T_j}} \right){\rm{ = }}\frac{{{\rm{18}}{\rm{.33 - }}{T_j}}}{{{\rm{18}}{\rm{.33 - }}{T_{OD}}}} \cdot C \cdot DHR
\end{equation}

The minimum and maximum design heating requirements for each generalized climate regions are given by:

\begin{equation}
DHR_{min} = \left\{  \begin{array}{cl}
                         8.33 \dot{Q}_h^{k = 2} \frac{18.33-T_{OD}}{33.33} & \text{for Regions I, II, III, IV, and VI} \\
                         8.33 \dot{Q}_h^{k = 2} & \text{for Region V}
                     \end{array}
            \right.
\end{equation}

and

\begin{equation}
DHR_{min} = \left\{  \begin{array}{cl}
                         2 \cdot 8.33 \dot{Q}_h^{k = 2} \frac{18.33-T_{OD}}{33.33} & \text{for Regions I, II, III, IV, and VI} \\
                         2 \cdot 8.33 \dot{Q}_h^{k = 2} & \text{for Region V}
                     \end{array}
            \right.
\end{equation}

where:

C = 0.77, a correction factor which tends to improve the agreement between calculated and measured building loads (dimensionless)

DHR is the design heating requirement for each generalized climate region (Btu/h)

\(\dot Q_h^{k = 2}(8.33)\) is the heating capacity determined from H1\(_{2}\) test (W).

The heating capacity delivered and electric power input of the heat pump when operating at minimum (low) compressor capacity and outdoor air temperature of \emph{T\(_{j}\)} is given by:

\begin{equation}
{\rm{\dot Q}}_h^{k = 1}{\rm{(}}{{\rm{T}}_{\rm{j}}}{\rm{) = }}\left\{ 
    \begin{array}{l}
      {\rm{\dot Q}}_h^{k = 1}(8.33) + \;\frac{{\left[ {{\rm{\dot Q}}_h^{k = 1}{\rm{(16}}{\rm{.67) - \dot Q}}_h^{k = 1}{\rm{(8}}{\rm{.33)}}} \right] \cdot \left( {{{\rm{T}}_{\rm{j}}} - 8.33} \right)}}{{\left( {16.67 - 8.33} \right)}}\,{\rm{,~if }}\,{{\rm{T}}_{\rm{j}}} \ge 4.44{\rm{^\circ C}} \\
      {\rm{\dot Q}}_h^{k = 1}( - 8.33) + \;\frac{{\left[ {{\rm{\dot Q}}_h^{k = 1}{\rm{(1}}{\rm{.67) - \dot Q}}_h^{k = 1}{\rm{( - 8}}{\rm{.33)}}} \right] \cdot \left( {{{\rm{T}}_{\rm{j}}} + 8.33} \right)}}{{\left( {1.67 + 8.33} \right)}}\,{\rm{,~if }}\, - 8.33{\rm{^\circ C}} \le {{\rm{T}}_{\rm{j}}} < 4.44{\rm{^\circ C}} \\
      {\rm{\dot Q}}_h^{k = 1}( - 8.33) + \;\frac{{\left[ {{\rm{\dot Q}}_h^{k = 1}{\rm{(8}}{\rm{.33) - \dot Q}}_h^{k = 1}{\rm{( - 8}}{\rm{.33)}}} \right] \cdot \left( {{{\rm{T}}_{\rm{j}}} + 8.33} \right)}}{{\left( {8.33 + 8.33} \right)}}\,{\rm{,~if }}{{\rm{T}}_{\rm{j}}} <  - 8.33{\rm{^\circ C}}\,
    \end{array}
  \right\}
\end{equation}

\begin{equation}
{\rm{\dot E}}_h^{k = 1}{\rm{(}}{{\rm{T}}_{\rm{j}}}{\rm{) = }}\left\{
    \begin{array}{l}
      {\rm{\dot E}}_h^{k = 1}(8.33) + \;\frac{{\left[ {{\rm{\dot E}}_h^{k = 1}{\rm{(16}}{\rm{.67) - \dot E}}_h^{k = 1}{\rm{(8}}{\rm{.33)}}} \right] \cdot \left( {{{\rm{T}}_{\rm{j}}} - 8.33} \right)}}{{\left( {16.67 - 8.33} \right)}}\,{\rm{,~if }}\,{{\rm{T}}_{\rm{j}}} \ge 4.44{\rm{^\circ C}} \\
      {\rm{\dot E}}_h^{k = 1}( - 8.33) + \;\frac{{\left[ {{\rm{\dot E}}_h^{k = 1}{\rm{(1}}{\rm{.67) - \dot E}}_h^{k = 1}{\rm{( - 8}}{\rm{.33)}}} \right] \cdot \left( {{{\rm{T}}_{\rm{j}}} + 8.33} \right)}}{{\left( {1.67 + 8.33} \right)}}\,{\rm{,~if }}\, - 8.33{\rm{^\circ C}} \le {{\rm{T}}_{\rm{j}}} < 4.44{\rm{^\circ C}} \\
      {\rm{\dot E}}_h^{k = 1}( - 8.33) + \;\frac{{\left[ {{\rm{\dot E}}_h^{k = 1}{\rm{(8}}{\rm{.33) - \dot E}}_h^{k = 1}{\rm{( - 8}}{\rm{.33)}}} \right] \cdot \left( {{{\rm{T}}_{\rm{j}}} + 8.33} \right)}}{{\left( {8.33 + 8.33} \right)}}\,{\rm{,~if }}{{\rm{T}}_{\rm{j}}} <  - 8.33{\rm{^\circ C}}\,
    \end{array}
  \right\}
\end{equation}

where:

\({\rm{\dot Q}}_h^{k = 1}\left( {{\rm{16}}{\rm{.67}}} \right){\rm{~and~}}\,{\rm{\dot E}}_h^{k = 1}\left( {{\rm{16}}{\rm{.67}}} \right)\) are determined from the H0\(_{1}\) test

\({\rm{\dot Q}}_h^{k = 1}\left( {{\rm{8}}{\rm{.33}}} \right) {\rm{~and~}} {\rm{\dot E}}_h^{k = 1}\left( {{\rm{8}}{\rm{.33}}} \right)\) are determined from the H1\(_{1}\) test

\({\rm{\dot Q}}_h^{k = 1}\left( {{\rm{1}}{\rm{.67}}} \right) {\rm{~and~}} {\rm{\dot E}}_h^{k = 1}\left( {{\rm{1}}{\rm{.67}}} \right)\) are determined from the H2\(_{1}\) test

\({\rm{\dot Q}}_h^{k = 1}\left( {{\rm{ - 8}}{\rm{.33}}} \right) {\rm{~and~}} {\rm{\dot E}}_h^{k = 1}\left( {{\rm{ - 8}}{\rm{.33}}} \right)\) are determined from the H3\(_{1}\) test.

An alternative to conducting or evaluating the performance at the H2\(_{1}\) test is to approximate the capacity and electric power inputs as follows:

\begin{equation}
{\rm{\dot Q}}_h^{k = 1}\left( {{\rm{1}}{\rm{.67}}} \right) = 0.9 \cdot \left\{ {{\rm{\dot Q}}_h^{k = 1}\left( {{\rm{ - 8}}{\rm{.33}}} \right) + 0.6\left[ {{\rm{\dot Q}}_h^{k = 1}\left( {{\rm{8}}{\rm{.33}}} \right) - {\rm{\dot Q}}_h^{k = 1}\left( {{\rm{ - 8}}{\rm{.33}}} \right)} \right]} \right\}
\end{equation}

\begin{equation}
{\rm{\dot E}}_h^{k = 1}\left( {{\rm{1}}{\rm{.67}}} \right) = 0.985 \cdot \left\{ {{\rm{\dot E}}_h^{k = 1}\left( {{\rm{ - 8}}{\rm{.33}}} \right) + 0.6\left[ {{\rm{\dot E}}_h^{k = 1}\left( {{\rm{8}}{\rm{.33}}} \right) - {\rm{\dot E}}_h^{k = 1}\left( {{\rm{ - 8}}{\rm{.33}}} \right)} \right]} \right\}
\end{equation}

The heating capacity delivered and electric power input of the heat pump when operating at maximum (high) compressor speed and outdoor air temperature of \emph{T\(_{j}\)} is given by:

\begin{equation}
\dot Q_h^{k = 2}({T_j}) = \left\{ \begin{array}{l}\dot Q_h^{k = 2}( - 8.33) + \frac{{\left[ {\dot Q_h^{k = 2}(8.33) - \dot Q_h^{k = 2}( - 8.33)} \right] \cdot \left( {{T_j} + 8.33} \right)}}{{8.33 + 8.33}},\quad if~{T_j} \ge 7.2^\circ C\,or\,{T_j} \le  - 8.33^\circ C\\\dot Q_h^{k = 2}( - 8.33) + \frac{{\left[ {\dot Q_h^{k = 2}(1.67) - \dot Q_h^{k = 2}( - 8.33)} \right] \cdot \left( {{T_j} + 8.33} \right)}}{{1.67 + 8.33}},\quad if~ - 8.33^\circ C < {T_j} < 7.2^\circ C\end{array} \right.
\end{equation}

\begin{equation}
\dot E_h^{k = 2}({T_j}) = \left\{ \begin{array}{l}\dot E_h^{k = 2}( - 8.33) + \frac{{\left[ {\dot E_h^{k = 2}(8.33) - \dot E_h^{k = 2}( - 8.33)} \right] \cdot \left( {{T_j} + 8.33} \right)}}{{8.33 + 8.33}},\quad if~{T_j} \ge 7.2^\circ C\,or\,{T_j} \le  - 8.33^\circ C\\\dot E_h^{k = 2}( - 8.33) + \frac{{\left[ {\dot E_h^{k = 2}(1.67) - \dot E_h^{k = 2}( - 8.33)} \right] \cdot \left( {{T_j} + 8.33} \right)}}{{1.67 + 8.33}},\quad if~ - 8.33^\circ C < {T_j} < 7.2^\circ C\end{array} \right.
\end{equation}

where:

\(\dot Q_h^{k = 2}\left( {{\rm{8}}{\rm{.33}}} \right) {\rm{~and~}} \dot E_h^{k = 2}\left( {{\rm{8}}{\rm{.33}}} \right)\) are determined from the H1\(_{2}\) test

\(\dot Q_h^{k = 2}\left( {{\rm{1}}{\rm{.67}}} \right) {\rm{~and~}} \dot E_h^{k = 2}\left( {{\rm{1}}{\rm{.67}}} \right)\) are determined from the H2\(_{2}\) test

\(\dot Q_h^{k = 2}\left( {{\rm{ - 8}}{\rm{.33}}} \right) {\rm{~and~}} \dot E_h^{k = 2}\left( {{\rm{ - 8}}{\rm{.33}}} \right)\) are determined from the H3\(_{2}\) test.

The electric energy used by the heat pumps differs depending up on whether the heat pump would operate at low (minimum) capacity, cycle between successive lower and higher speed capacities, or operate at high speed capacity in responding to the building load.~ The procedure for each operation cases is described next.

\emph{Case 1}:~ The steady state heating capacity when the unit is operating at minimum or low capacity, i.e., when the building heating load is less or equal to the low capacity:

\begin{equation}
\dot Q_c^{k = 1}\left( {{T_j}} \right) \ge BL\left( {{T_j}} \right)
\end{equation}

\begin{equation}
\frac{{{{\rm{e}}_h}\left( {{{\rm{T}}_{\rm{j}}}} \right)}}{{\rm{N}}}{\rm{ = }}\frac{{{{\rm{X}}^{k = 1}}\left( {{{\rm{T}}_{\rm{j}}}} \right) \cdot {\rm{\dot E}}_h^{k = 1}\left( {{{\rm{T}}_{\rm{j}}}} \right) \cdot {\rm{\delta }}\left( {{{\rm{T}}_{\rm{j}}}} \right)}}{{PL{F_j}}} \cdot \frac{{{{\rm{n}}_{\rm{j}}}}}{{\rm{N}}}
\end{equation}

\begin{equation}
\frac{{RH\left( {{{\rm{T}}_{\rm{j}}}} \right)}}{{\rm{N}}}{\rm{ = }}BL\left( {{{\rm{T}}_{\rm{j}}}} \right) \cdot \left[ {{\rm{1 - }}{{\rm{\delta }}^\prime}\left( {{{\rm{T}}_{\rm{j}}}} \right)} \right] \cdot \frac{{{{\rm{n}}_{\rm{j}}}}}{{\rm{N}}}
\end{equation}

\begin{equation}
{{\rm{X}}^{k = 1}}\left( {{{\rm{T}}_{\rm{j}}}} \right){\rm{ = MIN}}\left\{ \begin{array}{l}BL\left( {{{\rm{T}}_{\rm{j}}}} \right){\rm{/\dot Q}}_h^{k = 1}\left( {{{\rm{T}}_{\rm{j}}}} \right)\\1.0\end{array} \right\}
\end{equation}

\begin{equation}
{\delta ^\prime}{\rm{(}}{{\rm{T}}_{\rm{j}}}{\rm{) = }}\left\{ \begin{array}{l}0,\quad {\rm{if}}\,{{\rm{T}}_{\rm{j}}}\, \le \,{{\rm{T}}_{{\rm{off}}}}\,\\1/2,\quad {\rm{if}}\,{{\rm{T}}_{{\rm{off}}}} < {{\rm{T}}_{\rm{j}}}\, \le \,{{\rm{T}}_{{\rm{on}}}}\\1,\quad {\rm{if}}\,{{\rm{T}}_{\rm{j}}}\, > \,{{\rm{T}}_{{\rm{on}}}}\end{array} \right\}
\end{equation}

\begin{equation}
PL{F_{\rm{j}}}{\rm{ = 1 - }}C_D^h \cdot \left[ {{\rm{1 - }}{{\rm{X}}^{k = 1}}{\rm{(}}{T_j}{\rm{)}}} \right]
\end{equation}

where \(C_D^h\) is the degradation coefficient which has a minimum value of 0.25.

\emph{Case 2}:~ The unit cycles between the low (minimum) and high (maximum) compressor capacity to meet the building heating load at outdoor air temperature \emph{T\(_{j}\)}.~ That is, the heating building load is between the unit low and high compressor capacities:

\begin{equation}
\dot Q_h^{k = 1}({T_j}) < BL({T_j}) < \dot Q_h^{k = 2}({T_j})
\end{equation}

\begin{equation}
\frac{{{e_c}({T_j})}}{N} = \left[ {{X^{k = 1}}({T_j}) \cdot \dot E_h^{k = 1}({T_j}) + {X^{k = 2}}({T_j}) \cdot \dot E_h^{k = 2}({T_j})} \right] \cdot {\delta ^\prime}({T_j}) \cdot \frac{{{n_j}}}{N}
\end{equation}

\begin{equation}
\frac{{RH\left( {{{\rm{T}}_{\rm{j}}}} \right)}}{{\rm{N}}}{\rm{ = BL}}\left( {{{\rm{T}}_{\rm{j}}}} \right) \cdot \left[ {{\rm{1 - }}{{\rm{\delta }}^\prime}\left( {{{\rm{T}}_{\rm{j}}}} \right)} \right] \cdot \frac{{{n_j}}}{N}
\end{equation}

\begin{equation}
{\delta ^\prime}{\rm{(}}{{\rm{T}}_{\rm{j}}}{\rm{) = }}\left\{ \begin{array}{l}0,\quad {\rm{if}}\,{{\rm{T}}_{\rm{j}}}\, \le \,{{\rm{T}}_{{\rm{off}}}}\,\\ {\frac{1}{2}},\quad {\rm{if}}\,{{\rm{T}}_{{\rm{off}}}} < {{\rm{T}}_{\rm{j}}}\, \le \,{{\rm{T}}_{{\rm{on}}}}\\ 1,\quad {\rm{if}}\,{{\rm{T}}_{\rm{j}}}\, > \,{{\rm{T}}_{{\rm{on}}}}\end{array} \right\}
\end{equation}

\begin{equation}
{X^{k = 1}}({T_j}) = \frac{{\dot Q_h^{k = 2}({T_j}) - BL({T_j})}}{{\dot Q_h^{k = 2}({T_j}) - \dot Q_h^{k = 1}({T_j})}}
\end{equation}

\begin{equation}
{X^{k = 2}}({T_j}) = 1 - {X^{k = 1}}({T_j})
\end{equation}

\emph{Case 3}:~ The steady-state heating capacity when the unit is operating continuously at high or maximum compressor capacity at outdoor air temperature \emph{T\(_{j}\)}. The building heating load is greater than the available capacity at maximum or high compressor capacity:

\begin{equation}
BL\left( {{T_j}} \right) \ge \dot Q_c^{k = 2}\left( {{T_j}} \right)
\end{equation}

For units when operating continuously at maximum compressor speed (k = 2) speed at temperature \emph{T\(_{j}\)}, the delivered heating capacity and electric power inputs are calculated as follows:

\begin{equation}
  \frac{e_c(T_j)}{N} = \left[ \dot{E}_h^{k = 2}(T_j) \cdot \delta''(T_j) \right] \cdot \frac{n_j}{N}
\end{equation}

\begin{equation}
  \frac{RH(T_j)}{N} = \left\{ BL(T_j) - \left[\dot{Q}_h^{k = 2}(T_j) \cdot \delta''(T_j) \right] \right\} \cdot \frac{n_j}{N}
\end{equation}

\begin{equation}
\delta''(T_j) = \left\{
\begin{array}{l}
  0,\quad \text{if~}T_j \le T_{\text{off}} \text{~or~} \frac{\dot{Q}_h^{k = 2}(T_j)}{\dot{E}_h^{k=2}(T_j)} < 1 \\
  \frac{1}{2},\quad \text{if~} T_{\text{off}} < T_j \le T_{\text{on}} \text{~and~}\frac{\dot{Q}_h^{k=2}(T_j)}{\dot{E}_h^{k=2}(T_j)} \ge 1 \\
  1,\quad \text{if~}T_j > T_{\text{on}} \text{~and~} \frac{\dot{Q}_h^{k=2}(T_j)}{\dot{E}_h^{k=2}(T_j)} \ge 1
\end{array} \right\}
\end{equation}

where:

X(T\(_{j}\)) is the heating mode load factor for temperature bin j (-)

\({{\rm{\dot Q}}_{\rm{h}}}\left( {{{\rm{T}}_{\rm{j}}}} \right)\) is the space heating capacity of the heat pump when operating at outdoor temperature T\(_{j}\) (W)

\({{\rm{\dot E}}_{\rm{h}}}\left( {{{\rm{T}}_{\rm{j}}}} \right)\) is the electrical power consumption of the heat pump when operating at outdoor temperature T\(_{j}\) (W)

\({\rm{\delta }}\left( {{{\rm{T}}_{\rm{j}}}} \right)\) is the heat pump low temperature cut-off factor (-)

\(T_{off}\) is the outdoor temperature when the compressor is automatically shut off (\(^{\circ}\)C). (If no such temperature exists, Tj is always greater than T\(_{off}\) and T\(_{on}\)).

\(T_{on}\) is the outdoor temperature when the compressor is automatically turned back on, if applicable, following an automatic shut-off (\(^{\circ}\)C).

% table 62
\begin{longtable}[c]{p{1.2in}p{0.7in}p{0.7in}p{0.7in}p{0.7in}p{0.85in}p{1.0in}}
\caption{Heating Mode Test Conditions for Units Having Two-Capacity Compressor \label{table:heating-mode-test-conditions-for-units-having-001}} \tabularnewline
\toprule 
Test & \multicolumn{2}{l}{Air Entering Indoor} & \multicolumn{2}{l}{Air Entering Outdoor} & Compressor & Heating Air \tabularnewline
Description & \multicolumn{2}{l}{Unit Temperature} & \multicolumn{2}{l}{Unit Temperature} & Speed & Volume Flow Rate \tabularnewline
\midrule
& Dry Bulb \(^{\circ}\)C (\(^{\circ}\)F) & Wet Bulb \(^{\circ}\)C (\(^{\circ}\)F) & Dry Bulb \(^{\circ}\)C (\(^{\circ}\)F) & Wet Bulb \(^{\circ}\)C \(^{\circ}\)F) \tabularnewline

H01 Test  (required,steady)  & 21.1 (70) & 15.6 (60) (max) & 16.7 (62)  & 18.3 (56.5) & Low  & Heating Minimum (1)   \tabularnewline
H12 Test  (required,steady)  & 21.1 (70) & 15.6 (60) (max) & 8.33 (47)  & 6.11 (43)   & High & Heating Full-Load (2) \tabularnewline
H1C2 Test (required, cyclic) & 21.1 (70) & 15.6 (60) (max) & 8.33 (47)  & 6.11 (43)   & High &                       \tabularnewline
H11 Test  (required,steady)  & 21.1 (70) & 15.6 (60) (max) & 8.33 (47)  & 6.11 (43)   & Low  & Heating Minimum (1)   \tabularnewline
H1C1 Test (required, cyclic) & 21.1 (70) & 15.6 (60) (max) & 8.33 (47)  & 6.11 (43)   & Low  &                       \tabularnewline
H22 Test  (required)         & 21.1 (70) & 15.6 (60) (max) & 1.67 (35)  & 0.56 (33)   & High & Heating Full-Load     \tabularnewline
H21 Test  (required)         & 21.1 (70) & 15.6 (60) (max) & 1.67 (35)  & 0.56 (33)   & Low  & Heating Minimum       \tabularnewline
H32 Test  (required,steady)  & 21.1 (70) & 15.6 (60) (max) & -8.33 (17) & -9.44 (15)  & High & Heating Full-Load     \tabularnewline
H31 Test  (required,steady)  & 21.1 (70) & 15.6 (60) (max) & -8.33 (17) & -9.44 (15)  & Low  & Heating Minimum       \tabularnewline
\midrule
\multicolumn{7}{l}{Source: Table 11, ANSI/AHRI Standard 210/240-2008}

\end{longtable}

\subsubsection{References}\label{references-6-000}

AHRI 2008. ANSI/AHRI Standard 210/240: 2008 Standard for Performance Rating of Unitary Air-Conditioning \& Air-Source Heat Pump Equipment.~ Arlington, VA:~ Air-Conditioning, Heating, and Refrigeration Institute.

See the references for the single speed DX heating coil earlier in this document.

\subsection{Variable Speed DX Heating Coil}\label{variable-speed-dx-heating-coil}

\subsubsection{Overview}\label{overview-8-000}

The latest technology for commercial air conditioners and air-to-air heat pumps can utilize a variable speed compressor with a variable speed indoor blower and outdoor fan. The indoor and outdoor air flow rates are usually a function of the compressor speed. Refrigerant mass flow rate is a function of compressor speed as well as outdoor heat exchanger entering air temperature and indoor dry bulb or wet bulb. The control system adjusts the equipment capacity based on zone temperature measurements relative to the thermostat set point. The control logic determines what compressor speed is required to control to the zone temperature requirement in response to increased or decreased capacity (heating or cooling load). The compressor, fan and blower speeds are not discrete values and can be considered to vary infinitesimally between the minimum and maximum compressor speed. At the minimum compressor speed (which is different for heating and cooling), for a continuous fan, the supply airflow is fixed and the unit will have to cycle for reduced part loads below this point. For a cycling fan, the fan will cycle with the compressor.

Similar to variable-speed water source heat pump, we expand the number of speed levels and the corresponding curve sets up to ten. The number of speed levels is selectable by the user. The user can provide speed levels at any number from 1 to 10. In the case that the given speed levels are above 1, the model would do linear interpolation between neighboring speeds. The more curves, the more accurate. Furthermore, using linear interpolation and inputting air flow rates at individual speed levels facilitates arbitrary relationships of flow rate as a function of the compressor speed level.

The Coil:Heating:DX:VariableSpeed object will simulate the performance of a DX heating coil used in combination with a variable-speed air-to-air heat pump. It will fit into the parent objects of AirLoopHVAC:UnitaryHeatPump:AirToAir and

ZoneHVAC:PackagedTerminalHeatPump, etc.

The rated conditions for obtaining the capacities and COPs~ are at indoor dry-bulb temperature of 21.1\(^{\circ}\)C (70\(^{\circ}\)F) and the source side entering air temperature of 8.3\(^{\circ}\)C (47\(^{\circ}\)F). Some equations are provided below to help explain the function of the various performance curves and data fields.

\subsubsection{Model Description}\label{model-description-5}

The Coil:Heating:DX:VariableSpeed object is modeled similar to \\ Coil:Heating:WaterToAirHeatPump:VariableSpeedEquationFit. Of course, rather than referencing a water source evaporator, the new coil object references an air source and has defrosting operation. The evaporator entering air temperature is used in~ lieu of the entering~ water temperature.

It shall be noted for the capacity and flow rate inputs, two fields are autosizable, which are Rated Heating Capacity at the Selected Nominal Speed Level and the Rated Volumetric Air Flow Rate at the Selected Nominal Speed Level. They are used to scale the performances of a specific unit and correlate with the actual loop flow. Except these two fields, all other capacity and flow rate inputs at individual speed levels should be directly obtained from Reference Unit catalog data, specific to an actual unit.

The Rated Heating Capacity at Selected Nominal Speed Level contains the rated capacity to match the building heating load at the design day.~ The rated heating capacity is used to determine a capacity scaling factor, as compared to the Reference Unit capacity at the nominal speed level.

\begin{equation}
{\rm{CapacityScaleFactor}} = \frac{{{\rm{RatedTotalHeatingCapacity}}}}{{{\rm{ReferenceUnitTotalHeatingCapacity}}@{\rm{NominalSpeedLevel}}}}
\end{equation}

And then, this scaling factor is used to determine capacities at rated conditions for other speed levels, RatedTotalHeatingCapacity@SpeedLevel(x) = CapacityScaleFactor times ReferenceUnitTotalHeatingCapacity@SpeedLevel (x)

The Rated Volumetric Air Flow Rate is used to determine an internal scaling factor, and calculate the air flow rates in the parent objects, as follows:

\begin{equation}
{\rm{AirFlowScaleFactor}} = \frac{{{\rm{RatedVolumetricAirFlowRate}}}}{{{\rm{ReferenceUnitVolAirFlowRate}}@{\rm{NominalSpeedLevel}} \times {\rm{CapacityScaleFactor}}}}
\end{equation}

where the loop volumetric air flow rates at various speed levels in the parent objects are calculated as LoopVolumetricAirFlowRate @ SpeedLevel (x) = AirFlowScaleFactor times ReferenceUnitVolAirFlowRate @ SpeedLevel (x) times CapacityScaleFactor.

If the volumetric air flow rate at one speed level is higher than the flow rate allowed by the fan in the parent object, the flow rate will be set back to the fan flow rate.

If \({\rm{AirFlowScaleFactor}}\) equals unity, the loop air flow rate becomes the design flow rate of the Reference Unit (after scaled by the rated heating capacity). The Rated Volumetric Air Flow Rate is introduced here to correlate with the actual flow rate in the air loop, in case that it differs from the design specification. Certainly, it is recommended that the Rated Volumetric Air Flow Rate is selected in the way that \({\rm{AirFlowScaleFactor}}\) ~is unity, so as to get more accurate results from the performance curves.

\subsubsection{Performance curves:}\label{performance-curves-201605050922}

This object includes 4 curve objects at each individual speed level.

\begin{enumerate}
\item Total heating capacity modifier curve (function of temperature).
\item Total heating capacity modifier curve (function of air flow fraction).
\item Energy input ratio (EIR) modifier curve (function of temperature).
\item Energy input ratio (EIR) modifier curve (function of air flow fraction).
\end{enumerate}

The flow fraction modifier curves are used as a placeholder, to account for off-design flow rates if needed. If the manufacturer doesn't provide off-design performances, we can simply use a default modification multiplier of 1.0.

At the lowest speed, there will be one additional performance curve to account for the part-load condition, i.e.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{4}
\item Part load fraction correlation (function of part load ratio).
\end{enumerate}

Additional details on each of the above five curves are provided in the following paragraphs.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\tightlist
\item
  Total heating capacity modifier curve (function of temperature)
\end{enumerate}

The total heating capacity modifier as a function of temperature curve (CAP-FT) is a biquadratic curve with two independent variables: dry-bulb temperature of the air entering the heating coil and the air DB temperature entering the evaporator coil. The output of this curve is multiplied by the rated total heating capacity at the speed, to give the total heating capacity at the specific entering air temperatures at which the ASHP unit is operating (i.e., at temperatures different from the rating point temperatures).

\begin{equation}
{\rm{TotCapTempModFac}} = {\rm{a}} + {\rm{b*D}}{{\rm{B}}_{\rm{i}}} + {\rm{c*DB}}_{\rm{i}}^2 + {\rm{d*D}}{{\rm{B}}_{\rm{o}}} + {\rm{e*D}}{{\rm{B}}_{\rm{o}}}^2 + {\rm{f*D}}{{\rm{B}}_{\rm{i}}}{\rm{*D}}{{\rm{B}}_{\rm{o}}}
\end{equation}

where:

DB\(_{i}\) is the dry-bulb temperature of the air entering the heating coil (\(^{\circ}\)C)

DB\(_{o}\) is the dry-bulb temperature of the air entering the outdoor coil (\(^{\circ}\)C)

a-f are regression curve-fit coefficients.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  Total heating capacity modifier curve (function of air flow fraction)
\end{enumerate}

\begin{equation}
{\rm{TotCapAirFlowModFac}} = {\rm{a}} + {\rm{b*f}}{{\rm{f}}_{\rm{a}}} + {\rm{c*ff}}_{\rm{a}}^2 + {\rm{d*ff}}_{\rm{a}}^3
\end{equation}

where:

ff\(_{a}\) is the actual air mass flow rate/design air mass flow rate, at one speed level

DesignAirMassFlowRate@SpeedLevel(x) is equal to the ReferenceUnitAirMassFlowRate@SpeedLevel(x) times CapacityScaleFactor

a-d are regression curve-fit coefficients.  If no data are available for the correction, the user can simply set a = 1.0 and the other coefficients to 0.0.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  Energy input ratio (EIR) modifier curve (function of temperature)
\end{enumerate}

The energy input ratio modifier curve as a function of temperature (EIR-FT) is a biquadratic curve with two independent variables DB\(_{i}\)~ and DB\(_{o}\). The output of this curve is multiplied by the rated EIR at the speed (inverse of the rated COP), to give the EIR at the specific entering air temperatures at which the ASHP coil unit is operating (i.e., at temperatures different from the rating point temperatures).

\begin{equation}
{\rm{EIRTempModFac}} = {\rm{a}} + {\rm{b*D}}{{\rm{B}}_{\rm{i}}} + {\rm{c*DB}}_{\rm{i}}^2 + {\rm{d*D}}{{\rm{B}}_{\rm{o}}} + {\rm{e*D}}{{\rm{B}}_{\rm{o}}}^2 + {\rm{f*D}}{{\rm{B}}_{\rm{i}}}{\rm{*D}}{{\rm{B}}_{\rm{o}}}
\end{equation}

where a-f are regression curve fit coefficients.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{3}
\tightlist
\item
  Energy input ratio (EIR) modifier curve (function of air flow fraction)
\end{enumerate}

\begin{equation}
{\rm{EIRAirFlowModFac}} = {\rm{a}} + {\rm{b*f}}{{\rm{f}}_{\rm{a}}} + {\rm{c*ff}}_{\rm{a}}^2 + {\rm{d*ff}}_{\rm{a}}^3
\end{equation}

where a-d are regression curve-fit coefficients.  If no data are available for the correction, the user can simply set a = 1.0 and the other coefficients to 0.0.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{4}
\tightlist
\item
  Part load fraction correlation (function of part load ratio)
\end{enumerate}

This field defines the name of a quadratic or cubic performance curve (Ref: Performance Curves) that parameterizes the variation of electrical power input to the unit as a function of the part load ratio (PLR, heating load/steady-state heating capacity for Speed 1):

\begin{equation}
{\rm{PartLoadFrac}} = {\rm{a}} + {\rm{b*PLR}} + {\rm{c*PL}}{{\rm{R}}^2} + {\rm{d*PL}}{{\rm{R}}^3}
\end{equation}

and

\begin{equation}
RTF = (PLR/PartLoadFrac) = runtime~fraction~of~the~heating~coil
\end{equation}

The part load fraction (PLF) correlation accounts for efficiency losses due to compressor cycling. The part load fraction correlation should be normalized to a value of 1.0 when the part load ratio equals 1.0 (i.e., no efficiency losses when the compressor runs continuously for the simulation timestep). For PLR values between 0 and 1 (0 \textless{} = PLR \textless{} 1), the following rules apply:  PLF \textgreater{} = 0.7 and PLF \textgreater{} = PLR

If PLF \textless{} 0.7, the program resets the PLF value to 0.7, and the simulation proceeds. The runtime fraction of the coil is defined as PLR/PLF. If PLF \textless{} PLR, the runtime fraction of the coil is limited to 1.0. A typical part load fraction correlation would be:

\begin{equation}
{\rm{PLF}} = 0.85 + 0.15 \times {\rm{PLR}}
\end{equation}

If the user wishes to model no efficiency degradation due to compressor cycling, the part load fraction correlation should be defined as follows:

\begin{equation}
{\rm{PLF}} = 0.85 + 0.0 \times {\rm{PLR}}
\end{equation}

\subsubsection{Lowest Speed Operation}\label{lowest-speed-operation-201605050922}

The lowest speed operation of the variable-speed DX heating coil is similar to the single speed DX heating coil. The total (gross) heating capacity of the variable-speed DX coil is calculated as follows:

\begin{equation}
  \begin{array}{rl}
    Q_{total,1} &= \rm{RatedTotalHeatingCapacity @ SpeedLevel 1} \\
                &* \rm{TotCapTemModFac}_1 \rm{* TotCapAirFlowModFac}_1
  \end{array}
\end{equation}

And the EIR is calculated as:

\begin{equation}
{\rm{EI}}{{\rm{R}}_1} = \frac{{1.0}}{{{\rm{ReferenceUnitCOP}}@{\rm{Speed}}(1)}}{\rm{*EIRTempModFa}}{{\rm{c}}_1}{\rm{*EIRAirFlowModFa}}{{\rm{c}}_1}
\end{equation}

And the power consumption including the compressor, outdoor fan and accessories (not including indoor fan power) is,

\begin{equation}
{\rm{Powe}}{{\rm{r}}_1} = {{\rm{Q}}_{{\rm{total}},1}}{\rm{*EI}}{{\rm{R}}_1}{\rm{*RTF}}
\end{equation}

The fraction of the actual air mass flow to the design air mass flow rate is calculated:

\begin{equation}
{\rm{f}}{{\rm{f}}_{{\rm{a}},1}} = \frac{{{\rm{actual~air~mass~flow~rate}}}}{{({\rm{ReferenceUnitAirMassFlowRate}}@{\rm{SpeedLevel}}(1) \times {\rm{CapacityScaleFactor}})}}{\rm{}}
\end{equation}

\subsubsection{Higher Speed Operation}\label{higher-speed-operation-1-001}

At the speed level between the lowest and the highest, there is no part-load loss. A parameter of speed ratio (SpeedRatio) is used to define the capacity partition between Speed x-1 and Speed x.

The design air flow rate at the speed ratio are given as following:

\begin{equation}
  \begin{array}{rl}
    \rm{DesignAirFlowRateSpeedRatio} &= \rm{ReferenceUnitAirMassFlowRate @ SpeedLevel} \PB{x-1} \\
                                     &* \rm{CapacityScaleFactor} * \PB{1 - SpeedRatio} \\
                                     &+ \rm{ReferenceUnitAirMassFlowRate @ SpeedLevel} \PB{x} \\
                                     &* \rm{CapacityScaleFactor*SpeedRatio}
  \end{array}
\end{equation}

and the fractions of air flow is given as:

\begin{equation}
ff_{a,x-1} = ff_{a,x} = actual~air~mass~flow~rate/DesignAirFlowRateSpeedRatio
\end{equation}

The total heating capacities and EIRs at Speed x-1 and Speed x are given:

\begin{equation}
\begin{split}
{{\rm{Q}}_{{\rm{total}},{\rm{x}} - 1}} = {\rm{RatedTotalHeatingCapacity}}@{\rm{SpeedLevel}}\left( {{\rm{x}} - 1} \right) \\
{\rm{*TotCapTempModFa}}{{\rm{c}}_{{\rm{x}} - 1}} {\rm{*TotCapAirFlowModFa}}{{\rm{c}}_{{\rm{x}} - 1}}
\end{split}
\end{equation}

\begin{equation}
\begin{split}
{{\rm{Q}}_{{\rm{total}},{\rm{x}}}} = {\rm{RatedTotalHeatingCapacity}}@{\rm{SpeedLevel}}\left( {\rm{x}} \right) \\
{\rm{*TotCapTempModFa}}{{\rm{c}}_{\rm{x}}} {\rm{*TotCapAirFlowModFa}}{{\rm{c}}_{\rm{x}}}
\end{split}
\end{equation}

\begin{equation}
{\rm{EI}}{{\rm{R}}_{{\rm{x}} - 1}} = \frac{{1.0}}{{{\rm{ReferenceUnitCOP}}@{\rm{Speed}}({\rm{x}} - 1)}}{\rm{EIRTempModFa}}{{\rm{c}}_{{\rm{x}} - 1}}{\rm{*EIRAirFlowModFa}}{{\rm{c}}_{{\rm{x}} - 1}}
\end{equation}

\begin{equation}
{\rm{EI}}{{\rm{R}}_{\rm{x}}} = \frac{{1.0}}{{{\rm{ReferenceUnitCOP}}@{\rm{Speed}}({\rm{x}})}}{\rm{EIRTempModFa}}{{\rm{c}}_{\rm{x}}}{\rm{*EIRAirFlowModFa}}{{\rm{c}}_{\rm{x}}}
\end{equation}

The total heating capacity at the corresponding speed ratio is:

\begin{equation}
{{\rm{Q}}_{{\rm{total}},{\rm{SpeedRatio}}}} = \left( {1.0 - {\rm{SpeedRatio}}} \right){\rm{*}}{{\rm{Q}}_{{\rm{total}},{\rm{x}} - 1}} + {\rm{SpeedRatio*}}{{\rm{Q}}_{{\rm{total}},{\rm{x}}}}
\end{equation}

and the power consumption is:

\begin{equation}
{\rm{Powe}}{{\rm{r}}_{{\rm{SpeedRatio}}}} = \left( {1.0 - {\rm{SpeedRatio}}} \right){\rm{*}}{{\rm{Q}}_{{\rm{total}},{\rm{x}} - 1}}{\rm{*EI}}{{\rm{R}}_{{\rm{x}} - 1}} + {\rm{SpeedRatio*}}{{\rm{Q}}_{{\rm{total}},{\rm{x}}}}{\rm{*EI}}{{\rm{R}}_{\rm{x}}}
\end{equation}

The total amount of heat absorbed by the outdoor evaporator is calculated as:

\begin{equation}
{{\rm{Q}}_{{\rm{evap}},{\rm{SpeedRatio}}}} = {{\rm{Q}}_{{\rm{total}},{\rm{SpeedRatio}}}} - {\rm{Powe}}{{\rm{r}}_{{\rm{SpeedRatio}}}}
\end{equation}

Finally:

\begin{equation}
{{\rm{Q}}_{{\rm{total}},{\rm{SpeedRatio}}}} = {\rm{HeatingLoad}}
\end{equation}

If the speed reaches the highest level, the speed ratio becomes 1.0, and Speed x represents the highest speed.

\subsubsection{Defrost Operation}\label{defrost-operation-1}

The defrost operation of a variable-speed DX heating coil is treated the same as the single-speed DX heating coil, except using the total heating capacity at the max speed level to replace the rated heating capacity of the single-speed DX coil, when a reverse-cycle defrost strategy is specified.

We keep the defrost energy input ratio (EIR) modifier curve (function of temperature) as the single speed DX heating coil. It is a biquadratic curve with two independent variables: outdoor air dry-bulb temperature and the heating coil entering air wet-bulb temperature. The output of this curve is multiplied by the heating coil capacity, the fractional defrost time period and the runtime fraction of the heating coil to give the defrost power at the specific temperatures at which the coil is operating. This curve is only required when a reverse-cycle defrost strategy is specified.

\begin{equation}
{\rm{DefrostEIRTempModFac}} = {\rm{a}} + {\rm{b*W}}{{\rm{B}}_{\rm{i}}} + {\rm{c*WB}}_{\rm{i}}^2 + {\rm{d*D}}{{\rm{B}}_{\rm{o}}} + {\rm{e*D}}{{\rm{B}}_{\rm{o}}}^2 + {\rm{f*W}}{{\rm{B}}_{\rm{i}}}{\rm{*D}}{{\rm{B}}_{\rm{o}}}
\end{equation}

where:

WB\(_{i}\) is the wet-bulb temperature of the air entering the indoor coil (\(^{\circ}\)C)

DB\(_{o}\) is the dry-bulb temperature of the air entering the outdoor coil (\(^{\circ}\)C)

a-f are regression curve-fit coefficients.

\subsubsection{Crankcase Heater Operation}\label{crankcase-heater-operation}

This is the same as the single-speed DX heating coil.

\subsection{Desuperheater-Recovery-Based Air Heating Coil}\label{desuperheater-recovery-based-air-heating-coil}

\subsubsection{Overview}\label{overview-9}

The input object Coil:Heating:Desuperheater provides a model that simulates the thermal performance of a refrigerant-to-air heating coil and the parasitic electric consumption of its control valves or other auxiliary devices. The model assumes that the heating energy provided by this coil is reclaimed from the superheated refrigerant gas leaving a compressor and does not impact the performance of the compressor. The objects from which this coil can obtain its heating energy are:

Coil:Cooling:DX:SingleSpeed

Coil:Cooling:DX:TwoSpeed

Coil:Cooling:DX:TwoStageWithHumidityControlMode

Refrigeration:CompressorRack

Refrigeration:Condenser* (multiple objects)

The heat reclaim recovery efficiency (specified by the user) defines the amount of heat available for use by this coil. Approximately 25-30\% of the energy rejected by typical refrigeration system condensers is to reduce the superheated refrigerant vapor temperature to the condensing temperature. Recovery efficiencies higher than 30\% may cause the refrigerant gas to condense which in turn impacts the performance of the refrigeration compressor rack. For this reason, the maximum heat reclaim recovery efficiency for this coil for all sources except the Refrigeration:Condenser:(Air, Water, or Evap)Cooled is 30\%.For these refrigeration condensers, the amount of waste energy available in the superheat region is explicitly calculated, so for these condensers the maximum heat recovery efficiency is 90\% of this superheat energy. Also, for these refrigeration condensers, an estimate of the temperature of the reclaimed heat source is made and compared to the inlet air temperature for the coil. If the reclaimed heat source is too cool, the amount of available reclaim energy is set to zero.

NOTE: When the heating source is a refrigeration compressor rack, the heat rejection location in the Refrigeration:CompressorRack object must be ``Outdoors''. If the compressor rack heat rejection location is ``Zone'', the total amount of heat rejection available for reclaim (e.g., by this desuperheater heating coil) is set to zero by the compressor rack object and the simulation proceeds.

The sources for the waste heat can also be used to supply other coils.~ To avoid double-counting this waste heat, the amount available is corrected to reflect these other uses. For the three DX Cooling Coil sources, this correction is made within the same time step loop.~ For the two refrigeration system sources, the correction is made using the value from the previous time step.

The desuperheater heating coil can be used in air loop simulations for various air heating applications. For example, it can be used as an air reheat coil for high humidity control in the compound objects AirLoopHVAC:Unitary:Furnace:HeatCool and AirLoopHVAC:UnitaryHeatCool (see High Humidity Control With HeatCool Configuration). For this application, the desuperheater coil is controlled based on the calculated heating load to maintain the zone temperature and humidity setpoints (load-based control). The source of reclaimed heat could be the direct expansion (DX) cooling coil itself (Coil:Cooling:DX:SingleSpeed) or a refrigerated case compressor rack (Refrigeration:CompressorRack).

The desuperheater heating coil can also be used with cooling/heating systems that maintain specific air loop (deck) temperatures. For example, Figure~\ref{fig:desuperheater-heating-coil-used-as-a-reheat} shows a schematic diagram of the desuperheater heating coil used in conjunction with the CoilSystem:Cooling:DX object. The desuperheater heating coil must be placed downstream of the DX cooling coil when reclaiming heat from that cooling coil's compressor(s). Desuperheating heating coil placement is unrestricted when reclaiming heat from a refrigeration compressor rack or refrigeration condenser. The configuration in Figure~\ref{fig:desuperheater-heating-coil-used-as-a-reheat} shows the heating coil being controlled via a temperature-based strategy. In this example, the DX cooling coil could be used to the maintain its discharge air temperature at 11°C for zone dehumidification. The desuperheater heating coil could then raise the air dry-bulb temperature to 16°C providing a dry supply air stream at a temperature which does not require much additional heating by terminal units to meet the zone temperature setpoint.

\begin{figure}[hbtp] % fig 171
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4016.png}
\caption{Desuperheater Heating Coil Used as a Reheat Coil with CoilSystem:Cooling:DX \protect \label{fig:desuperheater-heating-coil-used-as-a-reheat}}
\end{figure}

Since the heating provided by the desuperheater coil is based on available waste heat from another system, the selection of fan control for the air loop equipment is essential for proper modeling. When the coil's heating source is a direct expansion cooling coil (Coil:Cooling:DX:SingleSpeed, Coil:Cooling:DX:TwoSpeed, or Coil:Cooling:DX:TwoStageWithHumidityControlMode), the air loop's fan control mode may be auto fan (cycling fan cycling coil), constant fan, or variable volume since the desuperheater heating coil cycles on/off with the DX cooling coil. When the heating source is a compressor rack or condenser for refrigerated cases, the supply air fan control should be either variable volume or constant fan since the desuperheater heating coil will typically be available the entire simulation time step.

NOTE: Use of the desuperheater heating coil in variable air volume systems should be done with caution since the model assumption of a fixed heat reclaim recovery efficiency may not be valid if the air flow rate over the coil varies significantly.

The following sections describe the calculations used for both the load-based and temperature-based strategies that can control the desuperheater heating coil.

\subsubsection{Model Inputs}\label{model-inputs-4}

A minimum of seven inputs must be defined for the desuperheater heating coil. The user must input the coil's name, an availability schedule name, and the heat reclaim recovery efficiency (default of 25\%, with a range of 0\% to 30\% except for detailed refrigeration condensers which have a default of 80\%, with a range of 0\% to 90\%). The next two inputs are the heating coil's inlet and outlet air node names. The user must also enter the desuperheater heat source type and name which are validated when the model inputs are read into the program.

The final two fields are optional. The first of these is the coil temperature setpoint node name. This field is used when the desuperheater heating coil is controlled based on an air loop temperature and a setpoint manager (Ref. SetpointManager:*) is used to place a temperature setpoint on this air node. The latter of these optional fields is the parasitic electric load. This field allows the user to define the electric energy use of parasitic equipment associated with the desuperheater heating coil (e.g.~control valves).

\subsubsection{Model Description}\label{model-description-6}

The model calculates the thermal performance of the heating coil based on the control strategy used. When a temperature setpoint node name is not entered, the control type is assumed to be load-based operation. This method should be used when this coil is specified as the air reheat coil for high humidity control with the compound object AirLoopHVAC:Unitary:Furnace:HeatCool or AirLoopHVAC:UnitaryHeatCool. If the temperature setpoint node name is entered, the control type is temperature-based operation. This method is used when the heating coil is controlled to maintain a dry-bulb temperature setpoint in an air loop.

\subsubsection{Load-Based Operation}\label{load-based-operation}

When load-based operation is selected, a load to be met by the heating coil is requested by the parent object (e.g., AirLoopHVAC:Unitary:Furnace:HeatCool). The model first calculates the heating coil capacity based on the total condenser waste heat rejected by the heating source.

\begin{equation}
{\dot Q_{coil}} = {\dot Q_{cond}} \times {\varepsilon_{reclaim}}
\end{equation}

where:

\({\dot Q_{coil}}\) is the heating capacity of the desuperheater coil (W)

\({\dot Q_{cond}}\) is the total amount of condenser waste heat rejected by the heating source (W)

\({\varepsilon_{reclaim}}\) is the heat reclaim recovery efficiency.

The model then compares the coil's heating capacity to the heating load being requested. If the heating capacity is greater than the heating load, then the amount of reclaimed heat (average heating rate over the simulation time step) is set equal to the requested load and the desuperheater heating coil will cycle off when the requested load is satisfied.

\begin{equation}
{\dot Q_{reclaim}} = {\dot Q_{load}}
\end{equation}

Otherwise the amount of reclaimed heat is set equal to the coil's heating capacity and the desuperheater heating coil will operate the entire time that the waste heat source operates.

\begin{equation}
{\dot Q_{reclaim}} = {\dot Q_{coil}}
\end{equation}

In either case, the coil's leaving air temperature is then calculated based on the amount of heat recovered and the air mass flow rate through the coil.

\begin{equation}
{T_{out}} = {T_{in}} + \frac{{{{\dot Q}_{reclaim}}}}{{\dot m{C_p}}}
\end{equation}

where:

\({T_{out}}\) is the coil outlet air temperature (\(^{\circ}\)C)

\({T_{in}}\) is the coil inlet air temperature (\(^{\circ}\)C)

\(\dot m\) is the air mass flow rate through the heating coil (kg/s)

\({C_p}\) is the specific heat of air entering the heating coil (J/kg-\(^{\circ}\)C).

A final calculation is made to determine the runtime fraction of the desuperheater heating coil. Since the maximum amount of reclaim heat available is dependent on the runtime fraction of the waste heat source, the runtime fraction of the desuperheater heating coil is the product of the waste heat source's runtime fraction and the ratio of the amount of heat reclaimed to the desuperheater coil's heating capacity.

\begin{equation}
RT{F_{coil}} = RT{F_{source}}\left( {\frac{{{{\dot Q}_{reclaim}}}}{{{{\dot Q}_{coil}}}}} \right)
\end{equation}

where:

\(RT{F_{coil}}\) is the runtime fraction of the desuperheater heating coil

\(RT{F_{source}}\) is the runtime fraction of the desuperheater heating source.

The heating coil's outlet air humidity ratio and air mass flow rate are simply set equal to the coil inlet air values. The outlet air enthalpy is calculated based on the outlet air dry-bulb temperature and the outlet air humidity ratio.

\begin{equation}
{h_{out}}\, = \,PsyHFnTdbW({T_{out}},\,\,{\omega_{out}})
\end{equation}

where:

\({h_{out}}\) is the enthalpy of the air leaving the heating coil (J/kg)

\(\,{\omega_{out}}\) is the humidity ratio of the air leaving the heating coil (kg/kg)

\emph{PsyHFnTdbW} is an EnergyPlus psychrometric function, returns enthalpy given dry-bulb temperature and humidity ratio.

\subsubsection{Temperature-Based Operation}\label{temperature-based-operation}

When temperature-based operation is selected, the model first calculates the heating coil capacity based on the total condenser waste heat rejected by the heating source (same as for load-based operation).

\begin{equation}
{\dot Q_{coil}} = {\dot Q_{cond}} \times {\varepsilon_{reclaim}}
\end{equation}

The model then calculates the heating load required to reach the desired setpoint temperature.

\begin{equation}
{\dot Q_{load}} = \dot m{C_p}\left( {{T_{setpoint}} - {T_{in}}} \right)
\end{equation}

where:

\({\dot Q_{load}}\) is the heating load to meet the desired dry-bulb temperature setpoint (W)

\({T_{setpoint}}\) is the desired dry-bulb temperature setpoint (\(^{\circ}\)C).

A comparison is then made to determine if the desuperheater heating coil should be energized. If the calculated load is less than or equal to 0, the coil's inlet air dry-bulb temperature is at or above the setpoint. In this case the desuperheater heating coil is not active and the outlet air dry-bulb temperature is set equal to the inlet air dry-bulb temperature.

\begin{equation}
{\dot Q_{reclaim}} = 0
\end{equation}

\begin{equation}
{T_{out}}{\rm{ }} = {\rm{ }}{T_{in}}
\end{equation}

If the amount of heat required to meet the setpoint is larger than the desuperheater coil's heating capacity, then the amount of reclaimed heat is set equal to the coil heating capacity and the outlet air dry-bulb temperature is calculated.

\begin{equation}
{\dot Q_{reclaim}} = {\dot Q_{coil}}
\end{equation}

\begin{equation}
{T_{out}} = {T_{in}} + \frac{{{{\dot Q}_{reclaim}}}}{{\dot m{C_p}}}
\end{equation}

If the amount of heat required to meet the setpoint is less than the desuperheater coil's heating capacity, the amount of reclaimed heat is set equal to the calculated heating load and the outlet air dry-bulb temperature is set equal to the setpoint temperature. In this case the desuperheater heating coil will cycle off when the requested load is satisfied.

\begin{equation}
{\dot Q_{reclaim}} = {\dot Q_{load}}
\end{equation}

\begin{equation}
{T_{out}}\quad = {T_{setpoint}}
\end{equation}

A final calculation is made to determine the runtime fraction of the desuperheater heating coil. Since the maximum amount of reclaim heat available is dependent on the runtime fraction of the waste heat source, the runtime fraction of the desuperheater heating coil is the product of the waste heat source's runtime fraction and the ratio of the amount of heat reclaimed to the desuperheater coil's heating capacity.

\begin{equation}
RT{F_{coil}} = RT{F_{source}}\left( {\frac{{{{\dot Q}_{reclaim}}}}{{{{\dot Q}_{coil}}}}} \right)
\end{equation}

The heating coil's outlet air humidity ratio and air mass flow rate are simply set equal to the coil inlet air values. The outlet air enthalpy is calculated based on the outlet air dry-bulb temperature and the outlet air humidity ratio.

\begin{equation}
{h_{out}} = PsyHFnTdbW({T_{out}},{\omega_{out}})
\end{equation}

\subsubsection{Parasitic Electric Load}\label{parasitic-electric-load}

The parasitic electric load attributed to the desuperheater heating coil is calculated using the user-supplied input value (\({P_{parasitic}}\)) and the desuperheater heating coil runtime fraction calculated above.

\begin{equation}
{P_{elec}} = {P_{parasitic}} \times RT{F_{coil}}
\end{equation}

The model assumes that this electric load is small and does not contribute to heating the air stream.

\subsubsection{References}\label{references-7}

Kosar, D. 2006. Dehumidification Enhancements, ASHRAE Journal, Vol. 48, No. 2, February 2006.

Kosar, D. et al. 2006. Dehumidification Enhancement of Direct Expansion Systems Through Component Augmentation of the Cooling Coil. 15\(^{th}\) Symposium on Improving Building Systems in Hot and Humid Climates, July 24-26, 2006.

Nimmo, B.G. et al. 1993.DEAC: Desiccant Enhancement of Cooling-Based Dehumidification. ASHRAE Transactions, Vol.99, Part 1, Paper number CH-93-4-4, pp.~842-848.

\subsection{Desuperheater-Recovery-Based Water Heating Coil}\label{desuperheater-recovery-based-water-heating-coil}

\subsubsection{Overview}\label{overview-10}

The input object Coil:WaterHeating:Desuperheater provides a model that simulates the thermal performance of a refrigerant-to-water heating coil and the electric consumption of its water circulation pump, control valves, and other auxiliary devices. The model assumes that the heating energy provided by this coil is reclaimed from the superheated refrigerant gas leaving a compressor and does not impact the performance of the compressor. For water cooled systems, the impact of the desuperheater is reflected by reducing the heat transfer to the condensing plant loop. The objects from which this coil can obtain its heating energy are:

Coil:Cooling:DX:SingleSpeed

Coil:Cooling:DX:TwoSpeed

Coil:Cooling:DX:TwoStageWithHumidityControlMode

Coil:Cooling:WaterToAirHeatPump:EquationFit

Refrigeration:CompressorRack

Refrigeration:Condenser* (multiple objects)

The heat reclaim recovery efficiency (specified by the user) defines the amount of heat available for use by this coil. Approximately 25-30\% of the energy rejected by typical refrigeration system condensers is to reduce the superheated refrigerant vapor temperature to the condensing temperature. Recovery efficiencies higher than 30\% may cause the refrigerant gas to condense, which in turn impacts the performance of the refrigeration compressor rack. For this reason, the maximum heat reclaim recovery efficiency for this coil for all sources except the Refrigeration:Condenser:(Air, Water, or Evap)Cooled is 30\%.For these refrigeration condensers, the amount of waste energy available in the superheat region is explicitly calculated, so for these condensers the maximum heat recovery efficiency is 90\% of this superheat energy. Also, for these refrigeration condensers, an estimate of the temperature of the reclaimed heat source is made and compared to the inlet air temperature for the coil. If the reclaimed heat source is too cool, the amount of available reclaim energy is set to zero. For all heat sources, the model includes the ability to modify the heat reclaim recovery efficiency based on variations in inlet water temperature and outdoor air dry-bulb temperature.

NOTE: When the heating source is a refrigerated case compressor rack, the heat rejection location in the Refrigeration:CompressorRack object must be ``Outdoors''. If the compressor rack heat rejection location is ``Zone'', the total amount of heat rejection available for reclaim (e.g., by this desuperheater heating coil) is set to zero by the compressor rack object and the simulation proceeds.

To model a desuperheater water heating coil, the input data file must include the following objects:

\begin{itemize}
\item Coil:WaterHeating:Desuperheater
\item WaterHeater:Mixed or WaterHeater:Stratified
\item Coil:Cooling:DX:* or Refrigeration:CompressorRack or Refrigeration:Condenser:* or Coil:Cooling:WaterToAirHeatPump:EquationFit
\end{itemize}

A schematic diagram showing the desuperheater water heating coil with its water heater and DX system condenser is shown below.

\begin{figure}[hbtp] % fig 172
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4049.png}
\caption{Schematic of Desuperheater Water Heating Coil \protect \label{fig:schematic-of-desuperheater-water-heating-coil}}
\end{figure}

\subsubsection{Model Description}\label{model-description-7}

The desuperheater heating coil input requires a setpoint temperature schedule and dead band temperature difference, which are independent from the setpoint temperature schedule and dead band temperature difference for the heater (element or burner) associated with the water heater tank. The cut-in temperature for the desuperheater coil is defined as the desuperheater coil's setpoint temperature minus its dead band temperature difference.

\begin{equation}
{T_{cut - in}} = {T_{set\,point}} - {T_{dead\,band}}
\end{equation}

where:

\({T_{cut - in}}\) is the cut-in temperature (\(^{\circ}\)C)

\({T_{set\,point}}\) is the setpoint temperature (\(^{\circ}\)C)

\({T_{dead\,band}}\) is the dead band temperature difference (\(^{\circ}\)C).

Desuperheater water heating coils are typically used to offset energy consumption by the water tank's heater (element or burner). Therefore, the cut-in temperature of the desuperheater coil should always be higher than the water heater tank's setpoint temperature. At times when the water heater tank's setpoint temperature is greater than or equal to the cut-in temperature of the desuperheater coil, the desuperheater is disabled and the water heater tank heating element is used to heat the water. An additional input parameter sets the maximum inlet water temperature allowed for desuperheater heat reclaim. Any time the inlet water temperature to the desuperheater coil is above this maximum allowed temperature, heat reclaim is restricted so that the tank water does exceed this temperature.

When the desuperheater coil is scheduled off by its availability schedule, the water heater tank's setpoint temperature is greater than or equal to the desuperheater coil cut-in temperature, or if the DX system's compressor (source of heat reclaim) is off, the water heating capacity and water mass flow rate for the desuperheater coil are set to zero and the water heater tank is simulated with the desuperheater heating coil disabled. Otherwise, the simulation proceeds by first determining the maximum amount of heat available for heat reclaim. If a heat reclaim efficiency modifier curve object is specified by the user, this bi-quadratic curve is evaluated using the desuperheater coil inlet water temperature and the outdoor air dry-bulb temperature; otherwise, the output is assumed to be equal to 1.

If HEffFTemp is specified:

\begin{equation}
  HEffFTemp = \max\PB{0.0, f\PB{T_{water,inlet},T_{DB,outdoor}}}
\end{equation}

Else:

\begin{equation}
  HEffFTemp = 1.0
\end{equation}

where:

\(HEffFTemp\) is the heat reclaim efficiency modifier

\({T_{water,inlet}}\) is the desuperheater coil inlet water temperature (\(^{\circ}\)C)

\({T_{DB,outdoor}}\) is the outdoor air dry-bulb temperature (\(^{\circ}\)C).

Except for the detailed condenser source, heat reclaim recovery efficiencies higher than 30\% may cause the refrigerant gas to condense which in turn impacts the performance of the refrigeration system. The model is unable to account for this refrigeration system impact, so the product of the rated heat reclaim recovery efficiency and heat reclaim efficiency modifier is not allowed to exceed 0.3.~ For the detailed refrigeration condenser, the limit for the heat reclaim efficiency has been set at 0.9 as follows:

\begin{equation}
{\rm{IF~}}\left( {{\varepsilon_{{\rm{reclaim,rated}}}}} \right)\left( {HEfFTemp} \right) > Limit,{\rm{~THEN~}}HeffFTemp = \frac{{Limit}}{{{\varepsilon_{{\rm{reclaim,rated}}}}}}
\end{equation}

where:

Limit is 0.3 for most sources or 0.9 for detailed condensers

\({\varepsilon_{reclaim,rated}}\) is the rated heat reclaim recovery efficiency.

The heating capacity of the desuperheater coil is then calculated based on the product of total amount of condenser waste heat rejected by the heating source, the desuperheater coil's rated heat reclaim recovery efficiency, and the heat reclaim efficiency modifier.

\begin{equation}
{\dot Q_{coil}} = {{\left( {{{\dot Q}_{cond}}} \right)\left( {{\varepsilon_{reclaim,rated}}} \right)HEffFTemp} \mathord{\left/ {\vphantom {{\left( {{{\dot Q}_{cond}}} \right)\left( {{\varepsilon_{reclaim,rated}}} \right)HEffFTemp} {DXSystemPLR}}} \right. } {DXSystemPLR}}
\end{equation}

where:

\({\dot Q_{coil}}\) is the water heating capacity of the desuperheater coil (W)

\({\dot Q_{cond}}\) is the average rate of condenser waste heat rejected by the heating source (W)

\(DXSystemPLR\) is the part load ratio for the desuperheater coil heating source (1.0 for refrigerated case compressor rack and detailed refrigeration condenser).

The desuperheater is assumed to have a water circulation pump located downstream of the refrigerant-to-water coil. Pump heat is added to the desuperheater water heating capacity based on a user-defined fraction as follows:

\begin{equation}
{\dot Q_{coil}} = {\dot Q_{coil}} + {P_{pump}}\left( {Fra{c_{pumptowater}}} \right)
\end{equation}

where:

\({P_{pump}}\) is the water pump power (W)

\(Fra{c_{pumptowater}}\) is the fraction of pump heat to water

The temperature of the water leaving the desuperheater is then calculated as

\begin{equation}
{T_{water,outlet}} = {T_{water,inlet}} + \frac{{{Q_{coil}}}}{{{{\dot m}_{water}}\cdot {C_{p,water}}}} ~for~ {\dot m_{water}} > 0
\end{equation}

\begin{equation}
{T_{water,outlet}} = {T_{water,inlet}} ~for~ {\dot m_{water}} = 0
\end{equation}

Simulation of the desuperheater heating coil is based on its current mode of operation. This mode of operation is either floating (heating coil off and tank water temperature has not fallen below the heater cut-in temperature) or heating (tank water temperature dropped below the heater cut-in temperature on a previous time step but was unable to reach the heater setpoint temperature). Each mode is handled differently and they will be discussed separately.

\subsubsection{Float Mode}\label{float-mode}

When the water heater tank temperature is floating between the desuperheater coil's cut-in and cut-out temperatures at the end of the previous simulation time step, both the desuperheater coil and the water heater tank's heating element are disabled and a resulting tank temperature is calculated. If the resulting tank temperature is below the desuperheater coil cut-in temperature the desuperheater coil part-load ratio is estimated using a ratio of temperature differences as shown below. The part-load ratio can not be less than zero or greater than the part-load ratio of the DX system from which the desuperheater coil is reclaiming heat.

\begin{equation}
PLR = \,MIN\left( {DXSystemPLR,MAX\left( {0.0,\,\,\left( {\frac{{{T_{cut - in}} - {T_{tank,float}}}}{{{T_{tank,initial}} - {T_{tank,float}}}}} \right)} \right)} \right)
\end{equation}

where:

\(PLR\) is the part load ratio of desuperheater heating coil

\({T_{tank,float}}\) is the tank temperature in float mode when heating capacity is set to zero (\(^{\circ}\)C)

\({T_{tank,initial}}\) is the tank water temperature at the beginning of a simulation time step (\(^{\circ}\)C)

Since the water pump is assumed to cycle on and off with the desuperheater coil, the average water mass flow rate through the desuperheater coil is then set proportional to the PLR calculated above:

\begin{equation}
\dot{m}_{water,avg} = \dot{m}_{water}\left( {PLR} \right)
\end{equation}

where \(\dot{m}_{water,avg}\) is the average desuperheater water mass flow rate for the time step (kg/s).

The water tank temperature is then calculated based on desuperheater heating coil operation (outlet water temperature and average water mass flow rate as calculated above) and with the water tank's heater element enabled. If the resulting water tank temperature is above the desuperheater coil's setpoint temperature, then the part-load ratio is reduced in the same manner described in the heating mode section below.

\subsubsection{Heating Mode}\label{heating-mode}

When the desuperheater heating coil is in heating mode at the end of the previous simulation time step (i.e., desuperheater coil operated during the previous simulation time step but was unable to achieve the setpoint temperature), both the desuperheater and the water heater tank's heating element are enabled. The desuperheater coil outlet water temperature is calculated (as described above) and the water mass flow rate through the desuperheater coil is set to the maximum operating flow rate:

\begin{equation}
\dot{m}_{water,avg} = \dot{m}_{water} \left( {DXSystemPLR} \right)
\end{equation}

If the resulting tank water temperature is above the desuperheater coil's setpoint (cut-out) temperature, the part load ratio of the desuperheater coil is reduced and the water heater tank is simulated again. The process is performed iteratively until the part load ratio of the desuperheater coil achieves the desired setpoint temperature.

\subsubsection{Model Outputs}\label{model-outputs}

After completing the float mode or heating mode calculations and the final desuperheater part load ratio has been determined, the output (report) variables are calculated as follows:

\begin{equation}
Desuperheater~Part~Load~,Ratio = MIN\left( {\frac{{\dot{m}_{water,avg}}}{{\dot{m}_{water}}},DXSystemPLR} \right)
\end{equation}

\begin{equation}
Desuperheater~Water~Heating~Rate~(W) = {\dot Q_{coil}}\left( {PLR} \right)
\end{equation}

\begin{equation}
Desuperheater~Water~Heating~Energy~(J) = {\dot Q_{coil}}\left( {PLR} \right)(3600)\left( {{t_{sys}}} \right)
\end{equation}

\begin{equation}
Desuperheater~Pump~Electric~Power~(W) = {P_{pump}}\left( {PLR} \right)
\end{equation}

\begin{equation}
Desuperheater~Pump~Electric~Consumption~(J) = {P_{pump}}\left( {PLR} \right)\left( {3600} \right)\left( {{t_{sys}}} \right)
\end{equation}

\begin{equation}
Desuperheater~Heat~Reclaim~Efficiency~Modifier~Curve~Output = HEffFTemp
\end{equation}

\begin{equation}
Desuperheater~On{\rm{ - }}Cycle~Parasitic~Electric~Power~(W) = {P_{parasiticload,on}}\left( {PLR} \right)
\end{equation}

\begin{equation}
\begin{split}
Desuperheater~On{\rm{ - }}Cycle~Parasitic~Electric~,Consumption~(J) = \\{P_{parasiticload,on}}\left( {PLR} \right)\left( {3600} \right){t_{sys}}
\end{split}
\end{equation}

\begin{equation}
Desuperheater~Off{\rm{ - }}Cycle~Parasitic~Electric~Power~(W) = {P_{parasiticload,off}}\left( {1 - PLR} \right)
\end{equation}

\begin{equation}
\begin{split}
Desuperheater~Off{\rm{ - }}Cycle~Parasitic~Electric~Consumption~(J) = \\{P_{parasiticload,off}}\left( {1 - PLR} \right)\left( {3600} \right)\left( {{t_{sys}}} \right)
\end{split}
\end{equation}

where:

\({P_{parasiticload,on}}\) is the on-cycle parasitic electric load (W)

\({P_{parasiticload,off}}\) is the off-cycle parasitic electric load (W)

\({t_{sys}}\) is the HVAC system simulation time step (hours).

Note: All output variables, including off cycle parasitic electrical power and energy, equal 0 when the desuperheater heating coil availability schedule equals 0.

\subsection{Heat Exchanger Assisted Air Cooling Coil Systems}\label{heat-exchanger-assisted-air-cooling-coil-systems}

An air-to-air heat exchanger can be used to enhance the dehumidification performance of a conventional cooling coil. EnergyPlus has two compound objects to model this scenario: CoilSystem:Cooling:DX:HeatExchangerAssisted and CoilSystem:Cooling:Water:HeatExchangerAssisted. The input syntax for these compound objects can be found in the EnergyPlus Input/Output Reference.

As shown in Figure~\ref{fig:schematic-of-a-heat-exchanger-assisted}, the air-to-air heat exchanger pre-conditions the air entering the cooling coil, and reuses this energy to post-condition the supply air leaving the cooling coil. This heat exchange process improves the latent removal performance of the cooling coil by allowing it to dedicate more of its cooling capacity toward dehumidification (lower sensible heat ratio).

\begin{figure}[hbtp] % fig 173
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4091.png}
\caption{Schematic of a Heat Exchanger Assisted Cooling Coil \protect \label{fig:schematic-of-a-heat-exchanger-assisted}}
\end{figure}

NOTE: Node naming shown in Figure~\ref{fig:schematic-of-a-heat-exchanger-assisted} is representative for \\
HeatExchanger:AirToAir:SensibleAndLatent. For HeatExchanger:AirToAir:FlatPlate, the exhaust air nodes are referred to as `secondary air' nodes. For HeatExchanger:Desiccant:BalancedFlow (heat exchanger assisted DX coil only), the supply air nodes are referred to as `regeneration air' nodes and the exhaust air nodes as `process air' nodes.

The dehumidification performance of cooling coils can be enhanced using a sensible-only heat exchanger (e.g., heat pipes, runaround coils, cross-flow heat exchangers). For example, a CoilSystem:Cooling:DX:HeatExchangerAssisted object could be used with a HeatExchanger:AirToAir:FlatPlate object or HeatExchanger:AirToAir:SensibleAndLatent object with only sensible effectiveness specified (see resulting psychrometric process in Figure~\ref{fig:psychrometric-process-for-heat-exchanger}). The dehumidification performance of cooling coils can also be enhanced using heat exchangers that transfer both sensible and latent energy (e.g., rotary desiccant heat exchanger). For example, a CoilSystem:Cooling:DX:HeatExchangerAssisted object could be used with a HeatExchanger:Desiccant:BalancedFlow object (see resulting psychrometric process in Figure~\ref{fig:psychrometric-process-for-heat-exchanger-001}).

Note that while the HeatExchanger:AirToAir:SensibleAndLatent and HeatExchanger:Desiccant:BalancedFlow objects can transfer both sensible and latent heat between two air streams, the \\
HeatExchanger:Desiccant:BalancedFlow object with appropriate Performance Data Type object is the proper heat exchanger model to use for the heat exchanger assisted cooling coil described here. The HeatExchanger:AirToAir:SensibleAndLatent object should only be used to model the sensible-only heat exchange case (Figure~\ref{fig:psychrometric-process-for-heat-exchanger}).

\begin{figure}[hbtp] % fig 174
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4092.png}
\caption{Psychrometric Process for Heat Exchanger Assisted Cooling Coil (Sensible HX Only) \protect \label{fig:psychrometric-process-for-heat-exchanger}}
\end{figure}

\begin{figure}[hbtp] % fig 175
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4093.png}
\caption{Psychrometric Process for Heat Exchanger Assisted Cooling Coil (Sensible+Latent HX) \protect \label{fig:psychrometric-process-for-heat-exchanger-001}}
\end{figure}

Modeling of the heat exchanger assisted cooling coil is performed by consecutively modeling the air-to-air heat exchanger and the cooling coil until convergence on a solution is achieved. The detailed modeling calculations for the individual components (air-to-air heat exchangers and cooling coils) are described elsewhere in this document.

Modeling of the heat exchanger assisted cooling coil begins by initializing the air mass flow rate (based on the air mass flow rate placed on the compound object's inlet air node) and passing this value to the exhaust air inlet node of the air-to-air heat exchanger. The heat exchanger and cooling coil are then successively modeled using the calculation routines specific to the type of heat exchanger and cooling coil selected. The air temperature exiting the cooling coil is compared with the air temperature exiting the cooling coil on the previous modeling iteration for this simulation time step. Convergence is reached when the change in this air temperature for successive iterations is within a specified tolerance (0.0005\(^{\circ}\)C). Consecutive modeling of the heat exchanger and cooling coil is terminated and a warning message is issued if the number of modeling iterations exceeds 50.

For the CoilSystem:Cooling:DX:HeatExchangerAssisted object, heat exchanger operation can be controlled based on high humidity levels in a zone. By default, the heat exchanger is assumed to always provide its heat transfer when the associated DX cooling coil is operating and no humidity control mechanism is specified. However, the heat exchanger's energy transfer may be controlled (i.e., turned on and off) based on a zone air humidity level using either a humidistat alone (Figure~\ref{fig:schematic-of-a-heat-exchanger-assisted-dx}) or a humidistat and a maximum humidity setpoint manager (Figure~\ref{fig:schematic-of-heat-exchanger-assisted-dx-coil}) depending on the HVAC system that is utilizing the heat exchanger assisted cooling coil.

The heat exchanger assisted DX cooling coil may be used with furnaces or unitary systems located in an air loop (ref. AirLoopHVAC:Unitary:Furnace:HeatCool or AirLoopHVAC:UnitaryHeatCool). These system objects have three options for dehumidification control (None, Multimode, and CoolReheat). When no dehumidification control is specified in the furnace or unitary system object (None), the heat exchanger is always active when the cooling coil is operating. When multimode or coolreheat dehumidification control is specified, a humidistat is required as shown in Figure~\ref{fig:schematic-of-a-heat-exchanger-assisted-dx}. For the case of multimode dehumidification control, the heat exchanger is only active when the zone air humidity level is above the humidistat setpoint (i.e., the system's cooling coil can't meet the latent cooling load when operating without heat exchanger energy transfer) while the AC system operates to meet the sensible (dry-bulb cooling thermostat) load. For the case of coolreheat dehumidification control, the heat exchanger is always active when the cooling coil operates and this system tries to meet both the sensible (thermostat) and latent (humidistat) loads.

\begin{figure}[hbtp] % fig 176
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4094.png}
\caption{Schematic of a heat exchanger assisted DX cooling coil with optional humidistat \protect \label{fig:schematic-of-a-heat-exchanger-assisted-dx}}
\end{figure}

The heat exchanger assisted DX cooling coil may also be used with a DX system located in an air loop (ref. CoilSystem:Cooling:DX). This system object also has three options for dehumidification control (None, Multimode, and CoolReheat). When no dehumidification control is specified (None), the heat exchanger is always active when the cooling coil is operating. When multimode or coolreheat dehumidification control is specified, a humidistat and a maximum humidity setpoint manager are required as shown in Figure~\ref{fig:schematic-of-heat-exchanger-assisted-dx-coil} (setpoint needs to be placed on the DX system's control node). For multimode dehumidification control, the heat exchanger is only active when the zone humidity levels are above the humidistat setpoint (i.e., the system's cooling coil can't meet the maximum humidity ratio setpoint when operating without heat exchanger energy transfer) while the AC system operates to meet the sensible (dry-bulb cooling thermostat) load. For coolreheat dehumidification control, the heat exchanger is always active when the cooling coil operates and this system tries to meet both the sensible (thermostat) and latent (humidistat) loads.

When the heat exchanger assisted cooling coil is used with a furnace or unitary system (ref. AirLoopHVAC:Unitary:Furnace:HeatCool or AirLoopHVAC:UnitaryHeatCool) or DX system (ref. CoilSystem:Cooling:DX) located in an air loop (or DX system used in an outside air system), an ecomizier function may be customized as necessary. For economizer control, an outdoor air controller (ref. Controller:OutdoorAir) is used to define the economizer control inputs and determine when economizer mode is active. The heat exchanger (ref. HeatExchanger:*) object provides an economizer lockout feature which disables heat recovery any time the economizer is active. This feature can be turned on and off using the heat exchanger lockout input. Heat exchanger assisted cooling coils used with the zone equipment described below disregard this economizer control feature.

\begin{figure}[hbtp] % fig 177
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4095.png}
\caption{Schematic of Heat Exchanger Assisted DX Coil with Humidistat and Setpoint Manager \protect \label{fig:schematic-of-heat-exchanger-assisted-dx-coil}}
\end{figure}

The heat exchanger assisted DX cooling coil may also be used with the unitary changeover bypass system and the unitary air-to-air heat pump system (ref. AirLoopHVAC:UnitaryHeatCool:VAV-ChangeoverBypass and AirLoopHVAC:UnitaryHeatPump:AirToAir); however, the heat exchanger is assumed to always provide its heat transfer when the cooling coil operates and can not be turned on and off based on a zone air humidity setpoint (ref. Figure~\ref{fig:schematic-of-a-heat-exchanger-assisted}). Two zone air conditioners may also use this heat exchanger/coil assembly model for improved dehumidification. The first type is the packaged terminal heat pump (ref. ZoneHVAC:PackagedTerminalHeatPump) where the heat exchanger's heat transfer is always active whenever the cooling coil operates (ref. Figure~\ref{fig:schematic-of-a-heat-exchanger-assisted}). The second type is the window air conditioner (ref. ZoneHVAC:WindowAirConditioner) where the heat exchanger's heat transfer is always active when the cooling coil operates and no humidity control mechanism is specified (ref. Figure~\ref{fig:schematic-of-a-heat-exchanger-assisted}), or the heat exchanger's heat transfer may be controlled based on zone air humidity level when a humidistat and high humidity setpoint manager are specified (maximum humidity ratio setpoint must be placed on the heat exchanger's exhaust air outlet node). For this case, the heat exchanger is only active when the zone air humidity level is above the humidistat setpoint (i.e., the system's cooling coil can't meet the maximum humidity ratio setpoint when operating without heat exchanger energy transfer) while only the sensible (dry-bulb cooling thermostat) load is met by the AC system (ref. Figure~\ref{fig:schematic-of-heat-exchanger-assisted-dx-coil}).

For the CoilSystem:Cooling:Water:HeatExchangerAssisted object, there is currently no method to enable or disable heat exchange based on zone air humidity level. Heat exchange will occur whenever the heat exchanger is available to operate (via its availability schedule) and a temperature difference exists between the two air streams.

\subsubsection{References}\label{references-8}

Kosar, D. 2006. Dehumidification Enhancements, ASHRAE Journal, Vol. 48, No. 2, February 2006.

Kosar, D. et al. 2006. Dehumidification Enhancement of Direct Expansion Systems Through Component Augmentation of the Cooling Coil. 15\(^{th}\) Symposium on Improving Building Systems in Hot and Humid Climates, July 24-26, 2006.

Nimmo, B.G. et al. 1993.DEAC: Desiccant Enhancement of Cooling-Based Dehumidification. ASHRAE Transactions, Vol.99, Part 1, Paper number CH-93-4-4, pp.~842-848.


\subsection{Air Source Integrated Heat Pump}\label{Air-Source-Integrated-Heat-Pump-Section}

\subsubsection{Overview}\label{overview-ASIHP}

Air Source Integrated Heat Pump (ASIHP) is an air source, multi-functional spacing conditioning unit with water heating function (WH), which usually uses a variable-speed compressor, variable-speed indoor blower, and outdoor fan. By recovering the condenser waste heat for water heating, ASIHPs are able to achieve significant energy savings. 

\subsubsection{Model Description}\label{model-description-ASIHP}

The latest technology for commercial air conditioners and air-to-air heat pumps can utilize a variable-speed compressor with a variable-speed indoor blower and outdoor fan. Integrated heat pumps are multi-functional units capable of space conditioning and water heating. They use condenser waste heat for water heating, and thus achieve significant energy saving. The control and operation of ASIHPs are complicated because they have six working modes in total:  (1) space cooling (SC), (2) space heating (SH), (3) dedicated water heating (DWH), (4) combined space cooling and water heating with full condensing (SCWH), (5) combined space cooling and water heating with desuperheating (SCDWH), and (6) combined space heating and water heating with desuperheating (SHDWH). 

The SC mode has the same operation as Coil:Cooling:DX:VariableSpeed. The SH mode has the same operation as Coil:Heating:DX:VariableSpeed. The DWH mode uses outdoor air as the heating source, which can be represented by an object of Coil:WaterHeating:AirToWaterHeatPump:VariableSpeed. The SCWH mode uses indoor air as the heating source and full condenser heat for water heating.  Coil:WaterHeating:AirToWaterHeatPump:VariableSpeed is used for the mode. 

The SCDWH mode uses the superheated section of an outdoor condenser to heat the water. In this combined SCDWH mode, the cooling function is simulated using an object of Coil:Cooling:DX:VariableSpeed, containing temperature correction curves as a function of the indoor air and ambient temperatures at each speed level. The water heating function is simulated using an object of Coil:WaterHeating:AirToWaterHeatPump:VariableSpeed, having temperature correction curves as a function of the ambient air temperature and entering water temperature at each speed level.  It should be noted that the rated power and power correction curves are contained in the Coil:Cooling:DX:VariableSpeed object. Thus, the power values and curves in the Coil:WaterHeating:AirToWater--HeatPump:VariableSpeed are not used. That means the power consumption at each speed level of the SCDWH mode is accounted by the cooling coil part. 

The SHDWH uses the superheated section of an indoor condenser to heat the water. In this combined mode, the heating function is simulated using an object of Coil:Heating:DX:VariableSpeed, having temperature correction curves as a function of the indoor air and ambient temperatures at each speed level. The water heating function is simulated using an object of Coil:WaterHeating:AirTo--WaterHeatPump:VariableSpeed, having temperature correction curves as a function of the ambient air temperature and entering water temperature at each speed level. It should be noted that the rated power and power correction curves are contained in the Coil:Heating:DX:VariableSpeed object. Thus, the power values and curves in the Coil:WaterHeating:AirToWaterHeatPump:VariableSpeed are not used. That means the power consumption at each speed level of the SHDWH mode is accounted by the heating coil. Coil:Heating:DX:VariableSpeed object calculates the total heating capacity added to the indoor air flow. The WH capacity is calculated using Coil:WaterHeating:AirToWaterHeatPump:VariableSpeed. 

The parent object of the ASIHP is named as CoilSystem:IntegratedHeatPump--:AirSource, which is a collection of all the sub-models as above. Also, CoilSystem:IntegratedHeatPump:AirSource facilitates mode switch and control algorithms. 


\subsubsection{Working Modes}\label{Working-Modes-ASIHP}

The ASIHP is a collection of working modes, i.e., objects, as described below: 

Space Cooling Mode (SC):

--Coil object: Coil:Cooling:DX:VariableSpeed. 

--Loop object: AirLoopHVAC:UnitarySystem,  which refers to the CoilSystem:IntegratedHeatPump:AirSource object. 

--Load matching: the same as a regular variable-speed air source heat pump in cooling mode.

Space Heating Mode (SH):

--Coil object: Coil:Heating:DX:VariableSpeed.

--Loop object: AirLoopHVAC:UnitarySystem, which refers to the CoilSystem:IntegratedHeatPump:AirSource object. 

--Load matching: the same as a regular variable-speed air source heat pump in heating mode

Dedicated Water Heating Mode (DWH):

--Coil object: Coil:WaterHeating:AirToWaterHeatPump:VariableSpeed. The water heating coil uses outdoor air as the heating source. 

--Loop object: WaterHeater:HeatPump:PumpedCondenser, which refers to the CoilSystem:IntegratedHeatPump:AirSource object. 

--Load matching: the same as a regular variable-speed heat pump water heating coil with outdoor air source.

Combined Space Cooling and Water Heating with Full Condensing Mode (SCWH):

--Coil object: Coil:WaterHeating:AirToWaterHeatPump:VariableSpeed. The water heating coil uses indoor air as the heating source. 

--Loop object: 

--Air side: the same loop object as the SC mode, i.e., AirLoopHVAC:UnitarySystem, which refers to the CoilSystem:IntegratedHeatPump:AirSource object. 

--Water side: the same loop object as the DWH mode, i.e., WaterHeater:HeatPump: PumpedCondenser, which refers to the CoilSystem:IntegratedHeatPump:AirSource object. 

--Load matching: 

--If one chooses to match the space cooling load, iterate the AirLoopHVAC object, and the water heating capacity in the water tank object is resultant.

--If one chooses to match the water heating load, iterate the water tank object, and the space cooling capacity is resultant.

Combined Space Cooling and Water Heating with Desuperheating Mode (SCDWH):

--Coil object: use two coil objects, Coil:Cooling:DX:VariableSpeed and -- Coil:WaterHeating:AirToWaterHeatPump:VariableSpeed. The desuperheater heat is used for water heating, which changes with the compressor speed and operation conditions. This is a dual-function coil, which provides both space cooling and water heating, and so performance curves for the dual functions will be included in the coil objects, respectively. These should be different objects from the SCWH mode and SC mode. The water heating coil contains temperature correction curves as a function of the ambient air temperature and entering water temperature. 

It should be noted that the rated power and power correction curves are contained in the Coil:Cooling:DX:VariableSpeed object. Thus, the power values and curves in the Coil:WaterHeating:AirToWaterHeatPump:VariableSpeed are not used. That means the power consumption at each speed level of the SCDWH mode is accounted by the cooling coil part. 

--Loop object: 

--Air side: the same loop object as the SC mode, i.e., AirLoopHVAC:UnitarySystem.

--Water side:  the same loop object as the DWH mode, i.e., WaterHeater:HeatPump:PumpedCondenser.

--Load matching: 

Always match the space cooling load by iterating the AirLoopHVAC object, and the water heating amount in the water tank object is resultant.

Combined Space Heating and Water Heating with Desuperheating Mode (SHDWH):

--Coil object: use two coil objects, Coil:Heating:DX:VariableSpeed and Coil:WaterHeating: AirToWaterHeatPump:VariableSpeed, contained in CoilSystem:IntegratedHeatPump:AirSource. The desuperheater heat is used for water heating, which changes with the compressor speed and operation conditions. This is a dual-function coil, which provides both space heating and water heating, and so performance curves for the dual functions will be included in the coil objects, respectively. 

It should be noted that the rated power and power correction curves are contained in the Coil:Heating:DX:VariableSpeed object. Thus, the power values and curves in the Coil:WaterHeating:AirToWaterHeatPump:VariableSpeed are not used. That means the power consumption at each speed level of the SHDWH mode is accounted for by the heating coil part. 

The Coil:WaterHeating:AirToWaterHeatPump:VariableSpeed object contains rated water heating capacity and capacity correction curves to simulate water heating capacity as a function of the outdoor air temperature and the water entering temperature at each speed level. The Coil:Heating:DX:VariableSpeed object calculates the total heating capacity, added to indoor air flow. 

--Loop object: 

--Air side: share the same air side connections as the SH mode, i.e., AirLoopHVAC:UnitarySystem.

--Water side: the same loop object as the DWH mode, i.e., WaterHeater:HeatPump:PumpedCondenser.

--Load matching: 

Always match the space heating load by iterating the AirLoopHVAC object, and the water heating amount in the water tank object is resultant.

\subsubsection{Control and Mode Switch}\label{Control-and-Mode-Switch-ASIHP}

At the beginning of each time step, an CoilSystem:IntegratedHeatPump:AirSource object surveys calls from all of its connected parent objects and nodes, e.g.,  AirLoopHVAC:UnitarySystem, WaterHeater:HeatPump:PumpedCondenser. Upon analyzing the space conditioning and water heating calls, the ASIHP will operate in a selected mode for the following timestep, as shown below:

Case I: 
If there is only a space cooling call, – run SC mode.
 
Case II: 
If there is only a space heating call, – run SH mode.

Case III: 
If there is only a water heating call, and if ambient temperature and indoor temperature are larger than the temperature settings above which indoor overcooling is allowed, – run SCWH mode to match the water heating load above a minimum speed allowed.
Else – run DWH mode.

Case IV:
If there are simultaneous space cooling and water heating calls, and if the sum of heated water going through the ASIHP is less than the threshold, – run SCDWH mode by iterating the speed to match the space cooling load above a minimum speed specified.
Else – run SCWH mode to match either the space cooling load or the water heating load, as specified, above a minimum speed allowed.

Case V: 
If there are simultaneous space heating and water heating calls, and if the ambient temperature and indoor temperature are larger than temperature settings above which water heating has a higher priority and space heating call can be ignored – run DWH mode.
Otherwise, if running time of the water heating is less than a setting, – run SHDWH mode to match the space heating load by iterating the compressor speed above a minimum speed specified, with the WH electric element in the water tank disabled.
Otherwise, if running time of the water heating is bigger than the setting, – run SHDWH mode to match the space heating load by iterating the compressor speed above a minimum speed allowed, with the WH electric element enabled.




\subsection{Single-Speed Electric Heat Pump DX Water Heating Coil}\label{single-speed-electric-heat-pump-dx-water-heating-coil}

\subsubsection{Overview}\label{overview-11}

The input object Coil:WaterHeating:AirToWaterHeatPump:* provides a model used in a heat pump water heater (HPWH) consisting of a water heater tank (e.g., WaterHeater:Mixed or WaterHeater:Stratified), a direct expansion (DX) ``coil'' (i.e., an air-to-water DX compression system which includes a water heating coil, air coil, compressor, and water pump), and a fan to provide air flow across the air coil associated with the DX compression system. These objects work together to model a system which heats water using zone air, outdoor air, or a combination of zone and outdoor air as the primary heat source. The heat pump water heater (Ref. WaterHeater:HeatPump:*), water heater tank (Ref. WaterHeater:Mixed and WaterHeater:Stratified), and fan (Ref. Fan:*) objects are described elsewhere in this document.

\begin{figure}[hbtp] % fig 178
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4096.png}
\caption{Schematic of a Heat Pump Water Heater using Optional Mixer/Splitter Nodes \protect \label{fig:schematic-of-a-heat-pump-water-heater-using}}
\end{figure}

The heat pump water heater DX coil model described here determines the thermal performance and energy consumption of the DX compression system, which includes a water heating coil (condenser), a coil used to extract heat from air (evaporator), and the compressor. This model also simulates the performance of a condenser water pump that is assumed to cycle on and off with the compressor.

\begin{figure}[hbtp] % fig 179
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4097.png}
\caption{Schematic of the Heat Pump Water Heater DX Coil \protect \label{fig:schematic-of-the-heat-pump-water-heater-dx}}
\end{figure}

Virtually all of the inputs to this DX coil model relate to its water heating performance and energy consumption. Model inputs differ between the \lstinline!Coil:WaterHeating:AirToWaterHeatPump:Pumped! and \lstinline!Coil:WaterHeating:AirToWaterHeatPump:Wrapped! to include only the relevant inputs for \lstinline!WaterHeater:HeatPump:PumpedCondenser! and \lstinline!WaterHeater:HeatPump:WrappedCondenser!, respectively. The air-side cooling capacity of this DX system is derived from user inputs and some model assumptions. The sensible/latent cooling capacity split is defined by the user at rated conditions, and the model adjusts this split at off-rated conditions.

\subsubsection{Model Description}\label{model-description-8}

The user must input the heating capacity, coefficient of performance (COP), and the sensible heat ratio (SHR) of the evaporator coil at rated inlet fluid temperatures and flow rates that are also specified by the user. The evaporator SHR should be a ``gross'' value, excluding any thermal impacts due to the indoor supply air fan. The user may also input up to seven performance curves that describe the change in total water heating capacity and efficiency at off-rated and part-load conditions.

\begin{enumerate}
\item Heating capacity modifier curve (function of temperature)
\item Heating capacity modifier curve (function of air flow fraction)
\item Heating capacity modifier curve (function of water flow fraction, pumped condenser only)
\item Heating COP modifier curve (function of temperature)
\item Heating COP modifier curve (function of air flow fraction)
\item Heating COP modifier curve~ (function of water flow fraction, pumped condenser only)
\item Part load fraction correlation (function of part load ratio)
\end{enumerate}

Note: The air dry-bulb or wet-bulb temperature used in the following curve objects is the inlet air temperature to the HPWH evaporator coil/fan assembly. If the fan placement specified in the WaterHeater:HeatPump:* compound object is draw-through, then the inlet air temperature represents the temperature of the air entering the evaporator coil itself. If blow-through fan placement is specified, then the inlet air temperature represents air conditions entering the fan located immediately in front (upstream) of the evaporator coil.

The heating capacity as a function of temperature modifier curve defines the variation in DX coil heating capacity as a function of inlet fluid (air and water) temperatures. The curve object may use either a bi-quadratic or cubic form. The bi-quadratic curve uses inlet air temperature (dry-bulb or wet-bulb temperature based on the input field Evaporator Air Temperature Type for Curve Objects) and condenser inlet water temperature as the independent variables. The cubic curve uses inlet air (dry-bulb or wet-bulb) temperature as the independent variable. The curve should be normalized to have the value of 1.0 at the rating point temperatures specified by the user.

\begin{equation}
HCapFTemp = a + b\left( {{T_{evap,in}}} \right) + c{\left( {{T_{evap,in}}} \right)^2} + d\left( {{T_{cond,in}}} \right) + e{\left( {{T_{cond,in}}} \right)^2} + f\left( {{T_{evap,in}}} \right)\left( {{T_{cond,in}}} \right)
\end{equation}

or

\begin{equation}
HCapFTemp = a + b\left( {{T_{evap,in}}} \right) + c{\left( {{T_{evap,in}}} \right)^2} + d{\left( {{T_{evap,in}}} \right)^3}
\end{equation}

where:

\({T_{evap,in}}\) is the dry-bulb or wet-bulb temperature of the air entering the evaporator coil/fan assembly based on the Evaporator Air Temperature Type for Curve Objects specified by the user (\(^{\circ}\)C)

\({T_{cond,in}}\) is the temperature of the water entering the DX coil condenser (\(^{\circ}\)C).

The heating capacity as a function of air flow fraction modifier curve is a quadratic or cubic curve that defines the variation in DX coil heating capacity as a function of the ratio of actual air flow rate across the evaporator coil to the rated evaporator air flow rate (i.e., fraction of full load air flow rate). When used, the output of this curve should be normalized to have the value of 1.0~ at an air flow fraction of 1.

\begin{equation}
HCapFAirFlow = \,a + \,b\left( {f{f_{air}}} \right)\,\, + \,\,c{\left( {f{f_{air}}} \right)^2}
\end{equation}

or

\begin{equation}
HCapFAirFlow = a + b\left( {f{f_{air}}} \right) + c{\left( {f{f_{air}}} \right)^2} + d{\left( {f{f_{air}}} \right)^3}
\end{equation}

where:

\begin{equation}
f{f_{air}} = air~flow~fraction = \left( {\frac{{Actual~air~mass~flow~rate}}{{Rated~air~mass~flow~rate}}} \right)
\end{equation}

Note: The actual volumetric air flow rate through the evaporator coil/fan assembly for any simulation time step where the compressor is operating must be between 0.00002684 m\(^{3}\)/s and .00008056 m\(^{3}\)/s per watt of rated total heating capacity. The simulation will issue a warning message if this air flow range is exceeded, but the simulation will continue.

The heating capacity as a function of water flow fraction modifier curve is a quadratic or cubic curve that defines the variation in DX coil heating capacity as a function of the ratio of actual water flow rate through the condenser to the rated condenser water flow rate (i.e., fraction of full load water flow rate). \emph{It is only used for the pumped condenser configuration.} When used, the output of this curve should be normalized to have the value of 1.0 at a water flow fraction of 1.

\begin{equation}
HCapFWaterFlow = a + b\left( {f{f_{water}}} \right) + c{\left( {f{f_{water}}} \right)^2}
\end{equation}

or

\begin{equation}
HCapFWaterFlow = a + b\left( {f{f_{water}}} \right) + c{\left( {f{f_{water}}} \right)^2} + d{\left( {f{f_{water}}} \right)^3}
\end{equation}

where:

\begin{equation}
f{f_{water}} = water~flow~fraction = \left( {\frac{{Actual~water~mass~flow~rate}}{{Rated~water~mass~flow~rate}}} \right)
\end{equation}

The heating COP as a function of temperature modifier curve defines the variation in DX coil heating COP as a function of inlet fluid (air and water) temperatures. The curve object may use either a bi-quadratic or cubic form. The bi-quadratic curve uses inlet air temperature (dry-bulb or wet-bulb temperature based on the input field Evaporator Air Temperature Type for Curve Objects) and condenser inlet water temperature as the independent variables. The cubic curve uses inlet air (dry-bulb or wet-bulb) temperature as the independent variable. The curve should be normalized to have the value of 1.0 at the rating point temperatures specified by the user.

\begin{equation}
HCOPFTemp = a + b\left( {{T_{evap,in}}} \right) + c{\left( {{T_{evap,in}}} \right)^2} + d\left( {{T_{cond,in}}} \right) + e{\left( {{T_{cond,in}}} \right)^2} + f\left( {{T_{evap,in}}} \right)\left( {{T_{cond,in}}} \right)
\end{equation}

or

\begin{equation}
HCOPFTemp = a + b\left( {{T_{evap,in}}} \right) + c{\left( {{T_{evap,in}}} \right)^2} + d{\left( {{T_{evap,in}}} \right)^3}
\end{equation}

The heating COP as a function of air flow fraction modifier curve is a quadratic or cubic curve that defines the variation in DX coil heating COP as a function of the ratio of actual air flow rate across the evaporator coil to the rated evaporator air flow rate (i.e., fraction of full load air flow rate). When used, the output of this curve should be normalized to have the value of 1.0 at an air flow fraction of 1.

\begin{equation}
HCOPFAirFlow = a + b\left( {f{f_{air}}} \right) + c{\left( {f{f_{air}}} \right)^2}
\end{equation}

or

\begin{equation}
HCOPFAirFlow = a + b\left( {f{f_{air}}} \right) + c{\left( {f{f_{air}}} \right)^2} + d{\left( {f{f_{air}}} \right)^3}
\end{equation}

The heating COP as a function of water flow fraction modifier curve is a quadratic or cubic curve that defines the variation in DX coil heating COP as a function of the ratio of actual water flow rate through the condenser to the rated condenser water flow rate (i.e., fraction of full load water flow rate). \emph{It is only used for the pumped condenser configuration.} When used, the output of this curve should be normalized to have the value of 1.0 at a water flow fraction of 1.

\begin{equation}
HCOPFWaterFlow = a + b\left( {f{f_{water}}} \right) + c{\left( {f{f_{water}}} \right)^2}
\end{equation}

or

\begin{equation}
HCOPFWaterFlow = a + b\left( {f{f_{water}}} \right) + c{\left( {f{f_{water}}} \right)^2} + d{\left( {f{f_{water}}} \right)^3}
\end{equation}

The part load fraction as a function of part load ratio correlation curve parameterizes the variation of electrical power input to the heat pump DX coil as a function of the part load ratio (PLR, heating delivered/steady-state heating capacity). The part load ratio divided by the part load fraction yields the runtime fraction of the DX heating coil for a given simulation time step. The part load fraction correlation accounts for efficiency losses due to compressor cycling.

\begin{equation}
PartLoadFrac = PLF = a + b\left( {PLR} \right) + c{\left( {PLR} \right)^2}
\end{equation}

or

\begin{equation}
PartLoadFrac = a + b\left( {PLR} \right) + c{\left( {PLR} \right)^2} + d{\left( {PLR} \right)^3}
\end{equation}

where:

\begin{equation}
PLR = part~load~ratio = \left( {\frac{{water~heating~delivered}}{{steady{\rm{ - }}state~water~heating~capacity}}} \right)
\end{equation}

The part load fraction correlation should be normalized to a value of 1.0 when the part load ratio equals 1.0 (i.e., no efficiency losses when the compressor runs continuously for the simulation time step). For PLR values between 0 and 1 (0 \textless{} = PLR \textless{} 1), the following rules apply:  PLF \textgreater{} = 0.7 and PLF \textgreater{} = PLR.

If PLF \textless{} 0.7 a warning message is issued, the program resets the PLF value to 0.7, and the simulation proceeds. The runtime fraction of the coil is defined as PLR/PLF. If PLF \textless{} PLR, then a warning message is issued and the runtime fraction of the coil is limited to 1.0.

When the part load fraction correlation for a heat pump water heater DX coil is unknown, the typical part load fraction correlation for a conventional, single-speed DX cooling coil (e.g., residential or small commercial unit) may be used:

\begin{equation}
PLF = 0.85 + 0.15(PLR)
\end{equation}

All seven curves are accessed through EnergyPlus' built-in performance curve equation manager (curve:quadratic, curve:cubic and curve:biquadratic). It is not imperative that the user utilize all coefficients shown in the equations above if their performance equation has fewer terms (e.g., if the user's part load fraction correlation curve is linear instead of quadratic, simply enter the values for a and b, and set coefficient c equal to zero).

Note: If any of the above performance curves are not specified by the user, the output of that curve is assumed to be 1 for the entire simulation.

For any simulation time step, the heating capacity of the heat pump water heater DX coil is calculated as follows:

\begin{equation}
{\dot{Q}_{heating}} = {\dot{Q}_{heating,rated}}\left( {HCapFTemp} \right)\left( {HCapFAirFlow} \right)\left( {HCapFWaterFlow} \right)
\end{equation}

In a similar fashion, the coefficient of performance for the DX coil for any simulation time step is calculated using the following equation:

\begin{equation}
CO{P_{heating}} = CO{P_{heating,rated}}\left( {HCOPFTemp} \right)\left( {HCOPFAirFlow} \right)\left( {HCOPFWaterFlow} \right)
\end{equation}

The electric power for the heat pump water heater DX coil is then calculated using the water heating capacity and coefficient of performance calculated above.

\begin{equation}
{P_{heating}} = \left( {\frac{{{{\dot{Q}}_{heating}}}}{{CO{P_{heating}}}}} \right)
\end{equation}

where:

\({\dot{Q}_{heating}}\) is the water heating capacity at the current operating conditions (W)

\({\dot{Q}_{heating,rated}}\) is the water heating capacity at rated conditions, user input (W)

\(CO{P_{heating}}\) is the coefficient of performance at the current operating conditions (W/W)

\(CO{P_{heating,rated}}\) is the coefficient of performance at rated conditions, user input (W/W)

\({P_{heating}}\) is the DX heating coil power (electricity consumption rate) at the current operating conditions (W).

The heating capacity calculated above may or may not include the impact of pump heat. For this reason, the user input Condenser Pump Heat Included in Rated Heating Capacity and Rated COP is used to determine the total water heating capacity including pump heat.

If (Condenser Pump Heat Included In Rated Heating Capacity and Rated COP), then:

\begin{equation}
  \dot{Q}_{heating,total} = \dot{Q}_{heating}
\end{equation}

Else:

\begin{equation}
  \dot{Q}_{heating,total} = \dot{Q}_{heating} + P_{pump}Frac_{PumpToWater}
\end{equation}

where:

\({\dot{Q}_{heating,total}}\) is the total water heating capacity including condenser pump heat (W)

\({P_{pump}}\) is the condenser water pump power, user input (W)

\(Fra{c_{pumptowater}}\) is the fraction of condenser pump heat to water, user input.

Compressor power (electricity consumption rate) is then calculated based on two additional inputs provided by the user. The first input specifies if the condenser pump heat is included in the rated heating capacity and rated COP. If the condenser pump heat is included in the rated heating capacity and COP, then condenser pump power must be subtracted from the DX heating coil power calculated above to determine the compressor power.

The second of these inputs specifies if the evaporator fan power is included in the rated heating COP. If evaporator fan power is included in the rated COP, then fan power must also be subtracted from the DX heating coil power to determine the compressor power as follows:

If (Cond Pump Power in COP), then:

\begin{equation}
  P_{comp} = P_{heating}-P_{pump}-P_{fan}
\end{equation}

Else:

\begin{equation}
  P_{comp} = P_{heating}-P_{fan}
\end{equation}

where:

\({P_{comp}}\) is the compressor power (electric consumption rate) at the current operating conditions (W)

\({P_{fan}}\) is the fan power, specified in Fan:OnOff object (W).

If fan power is NOT included in the rated heating COP, then the calculation of compressor power only includes condenser pump power and does not involve the fan:

If (Cond Pump Power in COP), then:

\begin{equation}
  P_{comp} = P_{heating}-P_{pump}
\end{equation}

Else:

\begin{equation}
  P_{comp} = P_{heating}
\end{equation}

The model assumes that all compressor power is rejected as heat via the DX heating coil. Therefore, the evaporator total cooling capacity at the current operating conditions is determined depending on the user input for pump heat:

If (Condenser Pump Heat Included In Rated Heating Capacity and Rated COP), then:

\begin{equation}
  \dot{Q}_{Evap} = \dot{Q}_{heating} - P_{comp} - P_{pump}Frac_{pumptowater}
\end{equation}

Else:

\begin{equation}
  \dot{Q}_{Evap} = \dot{Q}_{heating} - P_{comp}
\end{equation}

where \({\dot{Q}_{Evap}}\) is the total evaporator cooling capacity at the current operating conditions (W).

This evaporator cooling capacity is used to calculate the air-side performance of the heat pump water heater DX coil. The sensible heat ratio of the cooling capacity at rated conditions is specified by the user in the input for this DX coil object. The calculation of sensible heat ratio at off-rated conditions uses the ADP/BF approach described for the DX cooling coil model (Ref. Coil Model -- DX Cooling Coil Model). The exiting air conditions for the HPWH DX coil are calculated the same way as they are for the DX cooling coil model (cycling fan, cycling coil). The crankcase heater power and consumption are also calculated using the same equations used for the DX cooling coil model.

The runtime fraction of the DX coil compressor is calculated as the ratio of the compressor part load ratio to the part load fraction correlation entered by the user. The part load ratio of the DX coil is determined by the heat pump water heater compound object (Ref. WaterHeater:HeatPump:*) and is used by the DX coil to determine the run time fraction of the compressor.

\begin{equation}
RTF = \left( \frac{PartLoadFrac}{PartLoadFrac} \right) = runtime~fraction~of~the~compressor
\end{equation}

Finally, the condenser water outlet temperature is calculated based on the total water heating capacity of the DX coil and the actual condenser water mass flow rate.

\begin{equation}
{T_{cond,out}} = {T_{cond,in}} + \left( {\frac{\dot{Q}_{heating,total}}{{\dot{m}_{cond}}{C_p}}} \right)
\end{equation}

where:

\({T_{cond,out}}\) is the condenser outlet water temperature when the DX coil is operating (\(^{\circ}\)C)

\({T_{cond,in}}\) is the condenser inlet water temperature (\(^{\circ}\)C)

\({C_p}\) is the specific heat of water entering the condenser coil (J/kg-\(^{\circ}\)C)

\(\dot{m}_{cond}\) is the actual condenser water mass flow rate when the coil is operating, defined in the WaterHeater:HeatPump:PumpedCondenser parent object (kg/s).

\subsubsection{Model Outputs}\label{model-outputs-1}

After completing the calculations for heating capacity and power and the final compressor part load ratio has been determined, the output (report) variables are calculated as follows:

\begin{equation}
DX~Coil~Total~Water~Heating~Rate~(W) = {\dot{Q}_{heating,total}}\left( {PLR} \right)
\end{equation}

\begin{equation}
DX~Coil~Total~Water~Heating~Energy~(J) = {\dot{Q}_{heating,total}}\left( {PLR} \right)\left( {3600} \right)\left( {{t_{sys}}} \right)
\end{equation}

\begin{equation}
DX~Coil~Water~Heating~Electric~Power~(W) = \left( {{P_{comp}} + {P_{pump}}} \right)\left( {RTF} \right)
\end{equation}

\begin{equation}
DX~Coil~Water~Heating~Electric~Consumption~(J) = \left( {{P_{comp}} + {P_{pump}}} \right)\left( {RTF} \right)\left( {3600} \right)\left( {{t_{sys}}} \right)
\end{equation}

\begin{equation}
DX~Coil~Total~Cooling~Rate~(W) = {\dot{Q}_{evap}}\left( {PLR} \right)
\end{equation}

\begin{equation}
DX~Coil~Total~Cooling~Energy~(J) = {\dot{Q}_{evap}}\left( {PLR} \right)\left( {3600} \right)\left( {{t_{sys}}} \right)
\end{equation}

\begin{equation}
DX~Coil~Sensible~Cooling~Rate~(W) = {\dot{Q}_{evap}}\left( {PLR} \right)\left( {SHR} \right)
\end{equation}

\begin{equation}
DX~Coil~Sensible~Cooling~Energy~(J) = {\dot{Q}_{evap}}\left( {PLR} \right)\left( {SHR} \right)\left( {3600} \right)\left( {{t_{sys}}} \right)
\end{equation}

\begin{equation}
DX~Coil~Latent~Cooling~Rate~(W) = {\dot{Q}_{evap}}\left( {PLR} \right)\left( {1.0 - SHR} \right)
\end{equation}

\begin{equation}
DX~Coil~Latent~Cooling~Energy~(J) = {\dot{Q}_{evap}}\left( {PLR} \right)\left( {1.0 - SHR} \right)\left( {3600} \right)\left( {{t_{sys}}} \right)
\end{equation}

\begin{equation}
DX~Coil~Runtime~Fraction = \left( \frac{PLR}{PartLoadFrac} \right)
\end{equation}

\begin{equation}
DX~Coil~Crankcase~Heater~Power~(W) = \left( {{P_{crankcase}}} \right)\left( {1.0 - RTF} \right)
\end{equation}

\begin{equation}
DX\,Coil\,Crankcase\,Heater\,Consumption\,(J) = \,\left( {{P_{crankcase}}} \right)\left( {1.0 - RTF} \right)\left( {3600} \right)\left( {{t_{sys}}} \right)
\end{equation}

where:

\emph{t\(_{sys}\)} is the HVAC system simulation time step (hr)

\emph{SHR} is the sensible heat ratio at the current inlet air conditions and air flow rate (Ref. Coil Model -- DX Cooling Coil Model, ADP/BF approach)

\emph{P\(_{crankcase}\)} is the crankcase heater capacity, user input (W).

\subsection{Water Source Electric DX Air Cooling Coil}\label{water-source-electric-dx-air-cooling-coil}

There are two objects for water-to-air heat pumps in cooling mode: \\ Coil:Cooling:WaterToAirHeatPump:EquationFit~and~\\
Coil:Cooling:WaterToAirHeatPump:ParameterEstimation.~ These are described elsewhere.

\subsection{Water Source Electric Heat Pump DX Air Heating Coil}\label{water-source-electric-heat-pump-dx-air-heating-coil}

There are two objects for water-to-air heat pumps in heating mode: \\ ~Coil:Heating:WaterToAirHeatPump:EquationFit~and~\\
Coil:Heating:WaterToAirHeatPump:ParameterEstimation.~ These are described elsewhere.

\subsection{Steam-Based Air Heating Coil}\label{steam-based-air-heating-coil}

The steam coils are included in the discussion on steam loops, see: Steam To Air Heat Exchanger.

\subsection{Variable Refrigerant Flow Cooling Coil}\label{variable-refrigerant-flow-cooling-coil}

\subsubsection{Overview}\label{overview-12}

The variable refrigerant flow (VRF) DX cooling coil model is identical to the single-speed DX cooling coil model (Ref. Coil:Cooling:DX:SingleSpeed) when the compressor operates at it's maximum speed. The calculations used when the VRF heat pump operates at part-load are slightly different than the single-speed DX cooling coil model. For this reason, an adaptation of the single-speed DX cooling coil model is used to model the variable-speed compression system used in the VRF model. The difference in model calculations occur when the VRF DX cooling coil's electronic expansion device reduces refrigerant flow through the cooling coil. When the refrigerant flow is reduced, the coil's apparatus dew point (ADP) temperature changes, as well as the coil's sensible heat ratio (SHR). Since the single-speed DX cooling coil model is able to determine the ADP and SHR of a cooling coil at various operating conditions, this same model concept will be used to determine the ADP and SHR of the variable refrigerant flow DX cooling coil.

\subsubsection{Model Description}\label{model-description-9}

The user must input the total cooling capacity and the volumetric air flow rate across the cooling coil at rated conditions. The capacity input should be ``gross'' values, excluding any thermal or energy impacts due to the indoor supply air fan. The rated volumetric air flow should be between 0.00004027 m\(^{3}\)/s and 0.00006041 m\(^{3}\)/s per watt of rated total cooling capacity (300 -- 450 cfm/ton).

The user is required to input a performance curve in the heat pump object (ref: AirConditioner: VariableRefrigerantFlow) that describes the change in total cooling capacity at various operating conditions (i.e.~at cooling coil inlet air wet-bulb and condenser entering air dry-bulb temperatures different than those used to define total capacity). Each DX cooling coil uses two Cooling Capacity Ratio Modifier curves to define the DX cooling coil performance. The first curve defines the full load performance solely as a function of indoor wet-bulb temperature or uses both indoor wet-bulb temperature and outdoor dry-bulb temperature as the independent variables. The specific performance curves are:

\begin{itemize}
\item Total cooling capacity modifier curve (function of temperature)
\item Total cooling capacity modifier curve (function of flow fraction)

\end{itemize}

The \emph{total cooling capacity modifier curve (function of temperature)} defines the performance of the DX cooling coil as a function of operating conditions. These operating conditions may be specified as either a linear, quadratic or cubic equation using coil entering air wet-bulb temperature as the independent variable or as a biquadratic equation using both coil entering air wet-bulb temperature and outdoor dry-bulb temperuate as the independent variables. Since the variable refrigerant flow system modulates the compressor speed to serve the individual cooling coils, the single independent variable equation is likely to be sufficient to define the DX cooling coil performance. However, if other more accurate information is available, a biquadratic curve using two independent variables may be used. The output of this curve is multiplied by the rated total cooling capacity to give the total cooling capacity at the specific entering air temperatures at which the DX coil unit is operating (i.e., at temperatures different from the rating point temperatures).

\begin{equation}
TotCapTempModFac = a + b\left( {{T_{wb,i}}} \right) + c{\left( {{T_{wb,i}}} \right)^2} + d{\left( {{T_{wb,i}}} \right)^3}
\end{equation}

or

\begin{equation}
TotCapTempModFac = a + b\left( {{T_{wb,i}}} \right) + c{\left( {{T_{wb,i}}} \right)^2} + d\left( {{T_{c,i}}} \right) + e{\left( {{T_{c,i}}} \right)^2} + f\left( {{T_{wb,i}}} \right)\left( {{T_{c,i}}} \right)
\end{equation}

where:

\({{T_{wb,i}}}\) is the wet-bulb temperature of the air entering the cooling coil (\(^{\circ}\)C

\({{T_{c,i}}}\) is the dry-bulb temperature of the air entering an air-cooled condenser or wet-bulb temperature of the air entering an evaporative-cooled condenser (\(^{\circ}\)C).

The total cooling capacity modifier curve (function of flow fraction) is a linear, quadratic, or cubic curve with the independent variable being the ratio of the actual air flow rate across the cooling coil to the rated air flow rate (i.e., fraction of full load flow). The output of this curve is multiplied by the operating (modulated) total cooling capacity and the total cooling capacity modifier curve (function of temperature) to give the total cooling capacity at the specific temperature and air flow conditions at which the DX unit is operating. The cubic form of the equation is:

\begin{equation}
TotCapFlowModFac = a + b\left( {ff} \right) + c{\left( {ff} \right)^2} + d{\left( {ff} \right)^3}
\end{equation}

where:

\begin{equation}
ff = flow~fraction = \left( {\frac{Actual~air~mass~flow~rate}{Rated~air~mass~flow~rate}} \right)
\end{equation}

\textbf{Note:}~ The actual volumetric air flow rate through the cooling coil for any simulation time step where the DX unit is operating must be between 0.00002684 m\(^{3}\)/s and .00006713 m\(^{3}\)/s per watt of rated total cooling capacity (200 - 500 cfm/ton). The simulation will issue a warning message if this air flow range is exceeded.

For any simulation time step, the total (gross) cooling capacity of the DX unit is calculated as follows:

\begin{equation}
{\dot{Q}_{total}} = {\dot{Q}_{reference}}\left( {TotCapTempModFac} \right)\left( {TotCapFlowModFac} \right)
\end{equation}

where:

\({\dot{Q}_{total}}\) = Total available cooling capacity (W)

\({\dot{Q}_{reference}}\) = Total reference (rated) cooling capacity (W).

In addition to calculating the total cooling capacity provided by the DX cooling coil, it is important to properly determine the break down of total cooling capacity into its sensible (temperature) and latent (dehumidification) components. The model computes the sensible/ latent split using the SHR and ADP/BF approach (Carrier et al. 1959). When the DX coil model is initially called during an EnergyPlus simulation, the rated total capacity and rated SHR are used to calculate the coil bypass factor (BF) at rated conditions. The rated total capacity and rated SHR are first used to determine the ratio of change in air humidity ratio to air dry-bulb temperature:

\begin{equation}
SlopeRated = {\left( {\frac{{{\omega_{in}} - {\omega_{out}}}}{{{T_{db,in}} - {T_{db,out}}}}} \right)_{rated}}
\end{equation}

where:

\emph{\(\omega_{in}\)} is the humidity ratio of the air entering the cooling coil at rated conditions (kg/kg)

\emph{\(\omega_{out}\)} is the humidity ratio of the air leaving the cooling coil at rated conditions (kg/kg)

\emph{T\(_{db,in}\)} is the dry-bulb temperature of the air entering the cooling coil at rated conditions (\(^{\circ}\)C)

\emph{T\(_{db,out}\)} is the dry-bulb temperature of the air leaving the cooling coil at rated conditions (\(^{\circ}\)C).

Along with the rated entering air conditions, the algorithm then searches along the saturation curve of the psychrometric chart until the slope of the line between the point on the saturation curve and the inlet air conditions matches \emph{SlopeRated}. Once this point, the apparatus dew point, is found on the saturation curve the coil bypass factor at rated conditions is calculated as follows:

\begin{equation}
B{F_{rated}} = \frac{{{h_{out,rated}} - {h_{ADP}}}}{{{h_{in,rated}} - {h_{ADP}}}}
\end{equation}

where:

\emph{h\(_{out,rated}\)} is the enthalpy of the air leaving the cooling coil at rated conditions (J/kg)

\emph{h\(_{in,rated}\)} is the enthalpy of the air entering the cooling coil at rated conditions (J/kg)

\emph{h\(_{ADP}\)} is the enthalpy of saturated air at the coil apparatus dew point (J/kg).

The coil bypass factor is analogous to the ``ineffectiveness'' (1-\(\varepsilon\)) of a heat exchanger, and can be described in terms of the number of transfer of unit (NTU).

\begin{equation}
BF = {e^{ - NTU}} = {e^{{{ - \left( {\frac{{UA}}{{{c_p}}}} \right)} \mathord{\left/ {\vphantom {{ - \left( {\frac{{UA}}{{{c_p}}}} \right)} {\dot m}}} \right. } {\dot m}}}} = {e^{ - Ao/\dot m}}
\end{equation}

For a given coil geometry, the bypass factor is only a function of air mass flow rate. The model calculates the parameter A\(_{o}\) in the equation above based on BF\(_{rated}\) and the rated air mass flow rate. With A\(_{o}\) known, the coil BF can be determined for non-rated air flow rates.

For each simulation time step when the DX cooling coil operates, the total cooling capacity and coil bypass factor at the actual operating conditions are calculated. The coil bypass factor is used to calculate the operating sensible heat ratio (SHR) of the cooling coil using the following equations. Here is where the differnce in models occur for the VRF DX cooling coil and single-speed DX cooling coil. The original coil model (ref: Coil:Cooling:DX:SingleSpeed) calculates the full load outlet air enthalpy and, considering the bypass factor, finds the coil surface temperture (h\(_{ADP}\)) at full load (i.e., PLR = 1). Conversely, the VRF coil model modulates refrigerant flow to the VRF DX cooling coil which is why this model uses the full load coil capacity multipled by the part-load ratio (the modulated refrigerant flow). The effectively finds the coil surface temperature for a variable refrigerant flow DX cooling coil and the operating sensible heat ratio (SHR) can be calculated.

\begin{equation}
{h_{ADP}} = {h_{in}} - \frac{{\left( {{\dot{Q}_{total}}/ \dot{m}} \right)}}{{1 - BF}} ~~for a single-speed DX coil model (h_{ADP1} in figure below)
\end{equation}

\begin{equation}
{h_{ADP}} = {h_{in}} - \frac{{\left( {{\dot{Q}_{total}} \times PLR} \right) / \dot{m}}}{{1 - BF}} ~~for a variable refrigerant flow DX coil model
\end{equation}

\begin{equation}
SHR = Minimum\left( {\left( {\frac{{{h_{T_{in},w,ADP}} - {h_{ADP}}}}{{{h_{in}} - {h_{ADP}}}}} \right),1} \right)
\end{equation}

where:

\({{h_{in}}}\) is the enthalpy of the air entering the cooling coil (J/kg)

\({{h_{ADP}}}\) is the enthalpy of air at the apparatus dew point condition (J/kg)

\({{h_{T_{in},w,ADP}}}\) is the enthalpy of air at the entering coil dry-bulb temperature and humidity ratio at ADP (J/kg)

\(\dot m\) is the air mass flow rate (kg/s).

With the SHR for the coil at the current operating conditions, the properties of the air leaving the cooling coil are calculated using the following equations:

\begin{equation}
h_{out} = h_{in} - \left( \left( \dot{Q}_{total} \times PLR \right) / \dot{m} \right)
\end{equation}

\begin{equation}
{h_{T_{in},\omega_{out}}} = {h_{in}} - \left( {1 - SHR} \right)\left( {{h_{in}} - {h_{out}}} \right)
\end{equation}

\begin{equation}
{\omega_{out}} = PsyWFnTdbH\left( {{T_{in}},{h_{T_{in},\omega_{out}}}} \right)
\end{equation}

\begin{equation}
{T_{db,out}} = PsyTdbFnHW\left( {{h_{out}},{\omega_{out}}} \right)
\end{equation}

where:

\({{h_{out}}}\) is the enthalpy of the air leaving the cooling coil (J/kg)

\({{h_{Tin,\omega out}}}\) is the enthalpy of air at the entering coil dry-bulb temperature and leaving air humidity ratio (J/kg)

\({{\omega_{out}}}\) is the leaving air humidity ratio (kg/kg)

\({T_{db,out}}\) is the leaving air dry-bulb temperature (\(^{\circ}\)C)

\emph{PsyWFnTdbH} is an EnergyPlus psychrometric function that returns humidity ratio given dry-bulb temperature and enthalpy

\emph{PsyTdbFnHW} is an EnergyPlus psychrometric function that returns dry-bulb temperature given enthalpy and humidity ratio.

The following figure shows this process on a psychrometric chart. This variable refrigerant flow DX cooling coil model follows the dotted process line from h\(_{in}\) towards the outlet air enthalpy (the clear circles, o) based on the modulated refrigerant flow (PLR). The coil surface temperature (ADP, apparatus dew point) is found by drawing a straight line through these points. The process line from h\(_{in}\) to h\(_{ADP1}\) represents the full load (PLR = 1). This would be what the original DX cooling coil model calculates. At this point the sensible heat ratio is at the design point (assuming h\(_{in}\) is the rating point and the coil operates at the rated air mass flow rate). As the coil load is reduced, the refrigerant flow rate is restricted and the outlet air condition rides up the dotted line. The outlet air condition and associated h\(_{ADP2}\) is shown for a PLR of 0.7 (for example purposes only). Here the sensible heat ratio is higher than that found at full load operation. As the load continues to reduce, the refrigerant flow rate continues to throttle back and there comes a point where the coil's ADP is equal to the inlet air dew point temperature (h\(_{ADP3}\)). At this point, and for all other PLR's less than this value, the coil surface becomes dry (at PLR = 0.4 in this example) and the coil's sensible heat ratio = 1. Between this PLR and PLR = 0, the coil outlet air condition follows the dotted line back towards h\(_{in}\).

\(\cdot\) ~\includegraphics{media/image4182.png}

Figure 180. Process on psychrometric chart

\subsubsection{Dry Coil Conditions}\label{dry-coil-conditions-1}

If the model determines that the cooling coil is dry (\(\omega_{in}\) \textless{} \(\omega_{ADP}\)), then the equation for total cooling capacity is invalid since it is a function of entering wet-bulb temperature. Under dry-coil conditions, coil performance is a function of dry-bulb temperature rather than wet-bulb temperature. In this case, the model recalculates the performance of the DX cooling unit using the calculation procedure described above but with \(\omega_{in}\) = \(\omega_{dry}\), where \(\omega_{dry}\) is the inlet air humidity ratio at the coil dry-out point (SHR = 1.0).

\subsubsection{Condenser Options:~ Air Cooled vs.~Evaporative Cooled}\label{condenser-options-air-cooled-vs.evaporative-cooled}

As described previously, this model can simulate the performance of air-cooled or evaporative-cooled DX air conditioners. The choice of condenser type impacts the air dry-bulb temperature entering the heat pump's condenser. Although the actual input for the selection is contained in the variable refrigerant flow air conditioner object, the calculations are repeated here to aid the user in understanding the condenser option choices. The following paragraphs describe three modeling options.

If the user wants to model an air-cooled condenser, they should simply specify AirCooled in the field Condenser Type. In this case, the Total Cooling Capacity Modifier Curve (function of temperature) and the Energy Input Ratio Modifier Curve (function of temperature) will utilize the outdoor dry-bulb temperature.

If the user wishes to model an evaporative-cooled condenser AND they have performance curves that are a function of the wet-bulb temperature of air entering the condenser coil, then the user should specify Condenser Type = EvapCooled and the evaporative condenser effectiveness value should be entered as 1.0. In this case, the Total Cooling Capacity Modifier Curve (function of temperature) will utilize the outdoor wet-bulb temperature.

If the user wishes to model an air-cooled condenser that has evaporative media placed in front of it to cool the air entering the condenser coil, then the user should specify Condenser Type = EvapCooled. The user must also enter the appropriate evaporative effectiveness for the media. In this case, the Total Cooling Capacity Modifier Curve (function of temperature) and the Energy Input Ratio Modifier Curve (function of temperature) will utilize the condenser inlet air temperature as calculated below:

\begin{equation}
{T_{c,i}} = \left( {{T_{wb,o}}} \right) + \left( {1 - EvapCondEffectiveness} \right)\left( {{T_{db,o}} - {T_{wb,o}}} \right)
\end{equation}

where:

\emph{T\(_{c,i}\)} is the temperature of the air entering the condenser coil (\(^{\circ}\)C)

\emph{T\(_{wb,o}\)} is the wet-bulb temperature of the outdoor air (\(^{\circ}\)C)

\emph{T\(_{db,o}\)} is the dry-bulb temperature of the outdoor air (\(^{\circ}\)C).

The Total Cooling Capacity Modifier Curve (function of temperature) and the Energy Input Ratio Modifier Curve (function of temperature) input fields for the variable refrigerant flow air conditioner object should reference performance curves that are a function of outdoor dry-bulb temperature. Be aware that the evaporative media will significantly reduce the dry-bulb temperature of the air entering the condenser coil, so the Total Cooling Capacity and EIR Modifier Curves must be valid for the expected range of dry-bulb temperatures that will be entering the condenser coil.

\subsubsection{Condenser Inlet Air Temperature}\label{condenser-inlet-air-temperature-2}

The air temperature entering the outdoor condenser is based on the weather data used during a simulation. This temperature is either taken directly from the weather data, or can be adjusted based on the height of the outdoor condenser. The input for Condenser Air Inlet Node Name can be used to control this optional feature. If this input is left blank, the air temperature entering the condenser is based solely on the weather data. If this input is not blank, then the node name specified must also be listed in an Outside Air Node or Outside Air Inlet Node List object. When the node name is listed in an Outside Air Inlet Node List object, the air temperature entering the condenser is based solely on the weather data. When the node name is listed in an Outside Air Node object, the height of the node determines the air temperature entering the outdoor condenser (see description of Local Outdoor Air Temperature Calculation in the Atmospheric Variation section of this document for further details).

\subsubsection{Supply Air Fan Control: Cycling vs.~Continuous}\label{supply-air-fan-control-cycling-vs.continuous-2}

One of the inputs to the variable refrigerant flow terminal unit model is the supply air fan operation mode: cycling fan, cycling compressor or continuous fan, cycling compressor. The mode specified in the terminal unit object is passed to the DX cooling coil for use in the model calculations. The first operation mode is frequently referred to as ``AUTO fan'', where the compressor(s) and supply air fan operate in unison to meet the zone cooling load, and cycle off together when the cooling load has been met. The second operation mode is often referred to as ``fan ON'', where the compressor(s) cycle on and off to meet the zone cooling load but the supply air fan operates continuously regardless of compressor operation.

The fan operation mode schedule value determines the fan operation mode for each time step throughout the simulation. A fan operation mode schedule value of 0 specifies AUTO fan mode operation while values other than 0 specify fan ON operation. The use of a schedule allows the fan operation mode to change based on time-of-day or with changes in season.

The EnergyPlus methodology for determining the impact that HVAC equipment has on an air stream is to calculate the mass flow rate and air properties (e.g., enthalpy, dry-bulb temperature, humidity ratio) exiting the equipment. These exiting conditions are passed along as inlet conditions to the next component model in the air stream. Eventually the flow rate and properties of the air being supplied to the conditioned zone are used in the zone energy balance to determine the resulting zone air temperature and humidity ratio.

With this methodology, the determination of the air mass flow rate and air properties for the two different supply air fan operation modes is slightly different. For the case of cycling fan/cycling compressor, the conditions of the air leaving the cooling coil are the steady-state values calculated using the equations described above. However the air mass flow rate passed along to the next component (and eventually to the conditioned zone) is the average air mass flow rate for the system simulation time step.

For the case of continuous fan/cycling compressor, the air mass flow rate is constant. However, the air properties leaving the cooling coil are calculated as the average conditions during the system simulation time step. The model assumes that the exiting air conditions are the steady-state values calculated using the equations described above when the heat pump operates.~ For the remainder of the system simulation time step, it is assumed that the air exiting the DX coil has the same properties as the air entering the coil. For this supply air fan operating strategy, the leaving air properties are calculated as follows:

\begin{equation}
{h_{out,\,ContFanCycComp}} = {h_{out}}\left( {CyclingRatio} \right) + {h_{in}}\left( {1 - CyclingRatio} \right)
\end{equation}

\begin{equation}
{\omega_{out,\,ContFanCycComp}} = {\omega_{out}}\left( {CyclingRatio} \right) + {\omega_{in}}\left( {1 - CyclingRatio} \right)
\end{equation}

\begin{equation}
{T_{db,out,ContFanCycComp}} = PsyTdbFnHW\left( {{h_{out,ContFanCycComp}},{\omega_{out,ContFanCycComp}}} \right)
\end{equation}

\subsubsection{Average Air Flow Calculations}\label{average-air-flow-calculations}

The variable refrigerant flow (VRF) terminal unit operates based on user-specified (or autosized) air flow rates. The VRF terminal unit's supply air flow rate during cooling operation may be different than the supply air flow rate during heating operation. In addition, the supply air flow rate when no cooling or heating is required but the supply air fan remains ON can be different than the air flow rates when cooling or heating is required. The outside air flow rates can likewise be different for cooling and heating operating modes. The model takes these different flow rates into account when modeling the heat pump, and the average air flow rate for each simulation time step is reported on the inlet/outlet air nodes of the various terminal unit components in proportion to the calculated cycling ratio of the coil.

The average supply air and outdoor air mass flow rates through the heat pump for the HVAC simulation time step are calculated based on the cycling ratio of the DX cooling coil or heating coil (whichever coil is operating) as follows:

\begin{equation}
\dot{m}_{SA,avg} = \dot{m}_{SA,coil~on} \left( {CyclingRatio} \right) + \dot{m}_{SA,coil~off} \left( {1 - CyclingRatio} \right)
\end{equation}

\begin{equation}
\dot{m}_{OA,avg} = \dot{m}_{OA,coil~on} \left( {CyclingRatio} \right) + \dot{m}_{OA,coil~off} \left( {1 - CyclingRatio} \right)
\end{equation}

where:

\(\dot{m}_{SA,avg}\) is the average supply air mass flow rate during the time step (kg/s)

\(\dot{m}_{SA,coil~on}\) is the supply air mass flow rate when the coil is ON (kg/s)

\emph{CyclingRatio} is the cycling ratio of the coil (heating or cooling)

\(\dot{m}_{SA,coil~off}\) is the supply air mass flow rate when the coil is OFF (kg/s)

\(\dot{m}_{OA,avg}\) is the average outside air mass flow rate during the time step (kg/s)

\(\dot{m}_{OA,coil~on}\) is the average outside air mass flow rate when the coil is ON (kg/s)

\(\dot{m}_{OA,coil~off}\) is the average outside air mass flow rate when the coil is OFF (kg/s).

The supply air and outside air flow rates when the DX cooling or DX heating coil is ON are specified by the user (e.g., supply air volumetric flow rate during cooling operation, supply air volumetric flow rate during heating operation, outside air volumetric air flow rate during cooling operation, and outside air volumetric air flow rate during heating operation) and are converted from volumetric to mass flow rate. If the user has specified cycling fan operation, then the supply air and outside air mass flow rates when the coil is OFF are zero. If the user has specified constant fan operation, then the user-defined air flow rates when no cooling or heating is needed are used when the coil is OFF.

There is one special case. If the user has specified constant fan operation and they specify that the supply air volumetric flow rate when no cooling or heating is needed is zero (or field is left blank), then the model assumes that the supply air and outside air mass flow rates when the coil is OFF are equal to the corresponding air mass flow rates when the coil was last operating (ON).

\subsection{Variable Refrigerant Flow Heating Coil}\label{variable-refrigerant-flow-heating-coil}

The variable refrigerant flow (VRF) DX heating coil model uses performance information at rated conditions along with performance curves for variations in total capacity, energy input ratio and part load fraction to determine performance at part-load conditions. The impacts of defrost operation is modeled based a combination of user inputs and empirical models taken from the air-to-air heat pump algorithms in DOE-2.1E. The VRF DX heating coil model is very similar to the DX heating coil model used in the single-speed heat pump. The only difference being that the energy performance curves were moved to the parent object (Ref. AirConditioner:VariableRefrigerantFlow). See the DX Heating Coil model description for further details.

\subsection{Variable Speed Water to Air Heat Pump (Heating \& Cooling)}\label{variable-speed-water-to-air-heat-pump-heating-cooling}

\subsubsection{Overview}\label{overview-13}

A Variable Speed Water Source Heat Pump (let's call it VS WSHP) has a system control which dictates the refrigerant flow rate, the design unit supply airflow and the required water flow rate at each compressor speed. The air and water flow rates are usually a function of the compressor speed. Refrigerant mass flow rate is a function of compressor speed as well as entering water temperature and indoor dry bulb or wet bulb. The control system adjusts the equipment capacity based on zone temperature measurements relative to the thermostat set point. The control logic determines what compressor speed is required to control to the zone temperature requirement in response to increased or decreased capacity (heating or cooling load). The compressor, fan and pump speeds are not discrete values and can be considered to vary infinitesimally between the minimum and maximum compressor speed. At the minimum compressor speed (which is different for heating and cooling), for a continuous fan, the supply airflow is fixed and the unit will have to cycle for reduced part loads below this point. For a cycling fan, the fan will cycle with the compressor.

Presently, EnergyPlus is capable of modeling multiple-speed DX air-to-air coils. The number of speed levels is up to four. In some cases, four sets of performance curves are not sufficient to include all the information for a variable speed equipment. There is a need to expand the space for containing more performance curves. Here, we expand the number of speed levels and the corresponding curve sets up to ten. The number of speed levels is selectable by the user. The user can provide speed levels at any number from 2 to 10. In any case, our model would just do linear interpolation between neighboring speeds. The more curves, the more accurate. Furthermore, using linear interpolation and inputting air and water flow rates at individual speed levels facilitates arbitrary relationships of flow rates as a function of the compressor speed level.

This model (object name Coil:Heating:WaterToAirHeatPump:VariableSpeedEquationFit) simulates the performance of a variable-speed water-to-air heat pump with heating capability. It fits in the parent objects of \emph{AirLoopHVAC:UnitaryHeatPump:WaterToAir} and \emph{ZoneHVAC:WaterToAirHeatPump}. The rated conditions for obtaining the Reference Unit total heating capacities and COPs are indoor dry-bulb temperature at 21.1\(^{\circ}\)C (70\(^{\circ}\)F) and the source side entering water temperature at 21.1\(^{\circ}\)C (70\(^{\circ}\)F).

\subsubsection{Model Description}\label{model-description-10}

The Coil:Heating:WaterToAirHeatPump:VariableSpeedEquationFit object is modeled in a manner similar to the multi-speed DX heating coil model (Ref. Coil:Heating:DX:MultiSpeed). Of course, rather than referencing an air source evaporator or defrost object, the new coil object references to the water loop, and has the entering water temperature in place of the indoor air entering dry bulb temperature.

It shall be noted for the capacity and flow rate inputs, three fields are autosizable, which are Rated Heating Capacity at the Selected Nominal Speed Level (Numeric Field 3), Rated Volumetric Air Flow Rate (Numeric Field 4) and Rated Volumetric Water Flow Rate (Numeric Field 5). They are used to scale the performances of a specific unit and correlate with the actual loop flows. Except these three fields, all other capacity and flow rate inputs at individual speed levels should be directly obtained from Reference Unit catalog data, specific to an actual unit.

The Rated Heating Capacity at Selected Nominal Speed Level contains the rated capacity to match the building heating load at the design day.~ The rated heating capacity is used to determine a capacity scaling factor, as compared to the Reference Unit capacity at the nominal speed level.

{\scriptsize
\begin{equation}
CapacityScaleFactor = \frac{{RatedTotalHeatingCapacity}}{{ReferenceUnitTotalHeatingCapacity@NominalSpeedLevel}}
\end{equation}}

Then, this scaling factor is used to determine capacities at rated conditions for other speed levels, as RatedTotalHeatingCapacity@SpeedLevel(x) = CapacityScaleFactor * ReferenceUnitTotalHeatingCapacity@SpeedLevel(x)

The Rated Volumetric Air Flow Rate is used to determine an internal scaling factor, and calculate the air flow rates in the parent objects, as follows:

{\scriptsize
\begin{equation}
AirFlowScaleFactor = \frac{{RatedVolumetricAirFlowRate}}{{ReferenceUnitVolAirFlowRate@NominalSpeedLevel \times CapacityScaleFactor}}
\end{equation}}

The loop volumetric air flow rates at various speed levels in the parent objects are calculated as LoopVolumetricAirFlowRate@SpeedLevel(x) = AirFlowScaleFactor * ReferenceUnitVolAirFlowRate@SpeedLevel(x) * CapacityScaleFactor

If the volumetric air flow rate at one speed level is higher than the flow rate allowed by the fan in the parent object, the flow rate will be set back to the fan flow rate.

This Rated Volumetric Water Flow Rate is used to determine an internal scaling factor, and calculate the loop water flow rates.

{\scriptsize
\begin{equation}
WaterFlowScaleFactor = \frac{{RatedVolumetricWaterFlowRate}}{{ReferenceUnitVolWaterFlowRate@NominalSpeedLevel \times CapacityScaleFactor}}
\end{equation}}

The required volumetric water flow rates in the parent objects are calculated as LoopVolumetricWaterFlowRate@SpeedLevel(x) = WaterFlowScaleFactor * ReferenceUnitWaterVolFlowRate@SpeedLevel(x) * CapacityScaleFactor

The required volumetric water flow rate as above should be restricted by the pump in the water loop.

If \(AirFlowScaleFactor\) and \(WaterFlowScaleFactor\) equal unity, the loop flow rates become the design flow rates of the Reference Unit (after scaled by the rated heating capacity). The Rated Volumetric Air Flow Rate and Rated Volumetric Water Flow Rate are introduced here to correlate with the actual flow rates in the air and water loops, in case that these differ from the design specification. Certainly, it is recommended that the Rated Volumetric Air Flow Rate and Rated Volumetric Water Flow Rate are selected in the way that \(AirFlowScaleFactor\) and \(WaterFlowScaleFactor\) are unity, so as to get more accurate results from the performance curves.

Performance curves:

This object includes 7 curve objects at each individual speed level.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item Total heating capacity modifier curve (function of temperature).
\item Total heating capacity modifier curve (function of air flow fraction).
\item Total heating capacity modifier curve (function of water flow fraction).
\item Energy input ratio (EIR) modifier curve (function of temperature).
\item Energy input ratio (EIR) modifier curve (function of air flow fraction).
\item Energy input ratio (EIR) modifier curve (function of water flow fraction).
\item Recoverable heat modifier as a function of indoor air dry-bulb and water entering temperatures.
\end{enumerate}

Curves for (3) and (6) above are new curves as compared to those used for Multi-Speed Electric DX Air Heating Coil, as to correlate the change in water flow rate at the speed. The flow fraction modifier curves are used as a placeholder, to account for off-design flow rates if needed. If the manufacturer doesn't provide off-design performances, we can simply use a default modification multiplier of 1.0.

At the lowest speed, there will be one additional performance curve to account for the part-load condition, i.e.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{7}
\item
  ~Part load fraction correlation (function of part load ratio)
\end{enumerate}

More details on the various curves listed above are provided in the following paragraphs.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item Total heating capacity modifier curve (function of temperature)
\end{enumerate}

The total heating capacity modifier as a function of temperature curve (CAP-FT) is a biquadratic curve with two independent variables: dry-bulb temperature of the air entering the heating coil and the VS WSHP's entering water temperature. The output of this curve is multiplied by the rated total heating capacity at the speed, to give the total heating capacity at the specific entering air and water temperatures at which the WSHP unit is operating (i.e., at temperatures different from the rating point temperatures).

\begin{equation}
TotCapTempModFac = a + b*D{B_i} + c*DB_i^2 + d*EWT + e*EW{T^2} + f*D{B_i}*EWT
\end{equation}

where:

DB\(_{i}\) is the dry-bulb temperature of the air entering the heating coil (\(^{\circ}\)C)

EWT is the entering water temperature (\(^{\circ}\)C)

a-f are regression curve-fit coefficients.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\tightlist
\item
  Total heating capacity modifier curve (function of air flow fraction)
\end{enumerate}

\begin{equation}
TotCapAirFlowModFac = a + b*f{f_a} + c*ff_a^2 + d*ff_a^3
\end{equation}

where:

ff\(_{a}\) is the actual air mass flow rate/design air mass flow rate, at one speed level

DesignAirMassFlowRate@SpeedLevel(x) = ReferenceUnitAirMassFlowRate@SpeedLevel(x) * CapacityScaleFactor

a-d are regression curve-fit coefficients.  If there is no data available for the correction, the user can simply set a = 1.0 and the other coefficients to 0.0.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\tightlist
\item
  Total heating capacity modifier curve (function of water flow fraction)
\end{enumerate}

\begin{equation}
TotCapWaterFlowModFac = a + b*f{f_w} + c*ff_w^2 + d*ff_w^3
\end{equation}

where:

ff\(_{w}\) is the actual water mass flow rate/design water mass flow rate, at one speed level

DesignWaterMassFlowRate@SpeedLevel(x) = ReferenceUnitWaterMassFlowRate@SpeedLevel(x) * CapacityScaleFactor

a-d are regression curve-fit coefficients.  If there is no data available for the correction, the user can simply set a = 1.0 and the other coefficients to 0.0.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{3}
\tightlist
\item
  Energy input ratio (EIR) modifier curve (function of temperature)
\end{enumerate}

The energy input ratio modifier curve as a function of temperature (EIR-FT) is a biquadratic curve with two independent variables: dry-bulb temperature of the air entering the heating coil and the WSHP's entering water temperature. The output of this curve is multiplied by the rated EIR at the speed (inverse of the rated COP), to give the EIR at the specific entering air and water temperatures at which the WSHP coil unit is operating (i.e., at temperatures different from the rating point temperatures).

\begin{equation}
EIRTempModFac = a + b*D{B_i} + c*DB_i^2 + d*EWT + e*EW{T^2} + f*D{B_i}*EWT
\end{equation}

where:

DB\(_{i}\) is the dry-bulb temperature of the air entering the heating coil (\(^{\circ}\)C)

EWT is the entering water temperature (\(^{\circ}\)C)

a-f are regression curve fit coefficients.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{4}
\tightlist
\item
  Energy input ratio (EIR) modifier curve (function of air flow fraction)
\end{enumerate}

\begin{equation}
EIRAirFlowModFac = a + b*f{f_a} + c*ff_a^2 + d*ff_a^3
\end{equation}

where a-d are regression curve-fit coefficients.  If there is no data available for the correction, the user can simply set a = 1.0 and the other coefficients to 0.0.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{5}
\tightlist
\item
  Energy input ratio (EIR) modifier curve (function of water flow fraction)
\end{enumerate}

\begin{equation}
EIRWaterFlowModFac = a + b*f{f_w} + c*ff_w^2 + d*ff_w^3
\end{equation}

where a-d are regression curve-fit coefficients.  If there is no data available for the correction, the user can simply set a = 1.0 and the other coefficients to 0.0.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{6}
\tightlist
\item
  Recoverable heat modifier as a function of indoor dry-bulb and water entering temperatures.
\end{enumerate}

Recoverable heat modifier function accounts for the recoverable waste heat at the condensing side, as a fraction to the input power. This part of heat doesn't added to the supply side.

\begin{equation}
WasteHeatTempModFac = a + b*D{B_i} + c*DB_i^2 + d*EWT + e*EW{T^2} + f*D{B_i}*EWT
\end{equation}

where a-f are regression curve-fit coefficients.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{7}
\tightlist
\item
  Part load fraction correlation (function of part load ratio)
\end{enumerate}

This field defines the name of a quadratic or cubic performance curve (Ref: Performance Curves) that parameterizes the variation of electrical power input to the unit as a function of the part load ratio (PLR, heating load/steady-state heating capacity for Speed 1):

\begin{equation}
PartLoadFrac = a + b*PLR + c*PL{R^2} + d*PL{R^3}
\end{equation}

and

\begin{equation}
RTF = (PLR/PartLoadFrac) = runtime~fraction~of~the~heating~coil
\end{equation}

The part load fraction (PLF) correlation accounts for efficiency losses due to compressor cycling. The part load fraction correlation should be normalized to a value of 1.0 when the part load ratio equals 1.0 (i.e., no efficiency losses when the compressor runs continuously for the simulation timestep). For PLR values between 0 and 1 (0 \textless{} = PLR \textless{} 1), the following rules apply PLF \textgreater{} = 0.7 and PLF \textgreater{} = PLR.

If PLF \textless{} 0.7, the program resets the PLF value to 0.7, and the simulation proceeds. The runtime fraction of the coil is defined as PLR/PLF. If PLF \textless{} PLR, the runtime fraction of the coil is limited to 1.0. A typical part load fraction correlation would be:

\begin{equation}
{\rm{PLF}} = 0.85 + 0.15 \times {\rm{PLR}}
\end{equation}

If the user wishes to model no efficiency degradation due to compressor cycling, the part load fraction correlation should be defined as follows:

\begin{equation}
{\rm{PLF}} = 0.85 + 0.0 \times {\rm{PLR}}
\end{equation}

Lowest Speed Operation:

The lowest speed operation of the VS WSHP is similar to the single speed DX heating coil. The total (gross) heating capacity of the WSHP unit is calculated as follows:

\begin{equation}
\begin{array}{rl}
{Q_{total,1}} =& RatedTotalHeatingCapacity@SpeedLevel\left( 1 \right) \\
               &*TotCapTemModFa{c_1} \\
               &*TotCapAirFlowModFa{c_1} \\
               &*TotCapWaterFlowModFa{c_1}
\end{array}
\end{equation}

The EIR is calculated as:

\begin{equation}
  \begin{array}{rl}
    EIR_1 =& \frac{1.0}{\rm{ReferenceUnitCOP@Speed(1)}} * EIRTempModFac_1 \\
          &* EIRAirFlowModFac_1 \\
          &* EIRWaterFlowModFac_1
  \end{array}
\end{equation}

The power consumption including the compressor and accessories (not including pump and indoor fan powers) is:

\begin{equation}
Powe{r_1} = {Q_{total,1}}*EI{R_1}*RTF
\end{equation}

The waste heat generated by this coil object is calculated as:

\begin{equation}
  \begin{array}{rl}
    Q_{RecoverHeat,1} =& \rm{ReferenceUnitWasteHeatFractionofEnergyInput@SpeedLevel(1)} \\
                       &* Power_1 * WasteHeatTempModFac_1
  \end{array}
\end{equation}

where:

\(ReferenceUnitWasteHeatFractionofEnergyInput@SpeedLevel\left( 1 \right)\) is the waste heat fraction of the energy input at Speed 1, from the Reference Unit data.

The total amount of heat absorbed by the evaporator is calculated as:

\begin{equation}
{{Q}_{evap,1}} = {Q_{total,1}} + {{Q}_{RecoverHeat,1}} - Powe{r_1}
\end{equation}

The fraction of the actual air mass flow to the design air mass flow rate is calculated:

\begin{equation}
\begin{array}{rl}
  ff_{a,1} =& actual~air~mass~flow~rate/ \\
  &*(ReferenceUnitAirMassFlowRate@SpeedLevel(1) \\
  &*CapacityScaleFactor)
\end{array}
\end{equation}

The fraction of the actual water mass flow to the design water mass flow rate is calculated:

\begin{equation}
\begin{array}{rl}
  ff_{w,1} =& actual~water~mass~flow~rate/ \\
  &(ReferenceUnitWaterMassFlowRate@SpeedLevel(1) \\
  &*CapacityScaleFactor)
\end{array}
\end{equation}

Higher Speed Operation:

At the speed level between the lowest and the highest, there is no part-load loss. A parameter of speed ratio (SpeedRatio) is used to define the capacity partition between Speed x-1 and Speed x.

The design air and water flow rate at the speed ratio are given as following:

\begin{equation}
  \begin{array}{rl}
  DesignAirFlowRateSpeedRatio =& ReferenceUnitAirMassFlowRate@SpeedLevel\left( {x - 1} \right) \\
                              &* CapacityScaleFactor * \left(1-SpeedRatio\right) \\
                              &+ ReferenceUnitAirMassFlowRate@SpeedLevel\left( x \right) \\
                              &* CapacityScaleFactor * SpeedRatio
  \end{array}
\end{equation}

\begin{equation}
  \begin{array}{rl}
    DesignWaterFlowRateSpeedRatio =& ReferenceUnitWaterMassFlowRate@SpeedLevel\left( {x - 1} \right) \\
                                  &* CapacityScaleFactor * \left(1-SpeedRatio\right) \\
                                  &+ ReferenceUnitWaterMassFlowRate@SpeedLevel\left( x \right) \\
                                  &* CapacityScaleFactor * SpeedRatio
  \end{array}
\end{equation}

The fractions of air flow and water flow are given by:

\begin{equation}
ff_{a,x-1} = ff_{a,x} = actual~air~mass~flow~rate/DesignAirFlowRateSpeedRatio
\end{equation}

\begin{equation}
ff_{w,x-1} = ff_{w,x} = actual~water~mass~flow~rate/DesignWaterFlowRateSpeedRatio
\end{equation}

The total heating capacities and EIRs at Speed x-1 and Speed x are given by:

\begin{equation}
  \begin{array}{rl}
    Q_{total,x - 1} =& RatedTotalHeatingCapacity@SpeedLevel\left( {x - 1} \right) \\
                    &* TotCapTempModFac_{x - 1} \\
                    &* TotCapAirFlowModFac_{x - 1} \\
                    &* TotCapWaterFlowModFac_{x - 1}
  \end{array}
\end{equation}

\begin{equation}
  \begin{array}{rl}
    Q_{total,x} =& RatedTotalHeatingCapacity@SpeedLevel\left( x \right) \\
                &* TotCapTempModFac_x \\
                &* TotCapAirFlowModFac_x \\
                &* TotCapWaterFlowModFac_x 
 \end{array}
\end{equation}

\begin{equation}
  \begin{array}{rl}
    EIR_{x - 1} =& \frac{1.0}{ReferenceUnitCOP@Speed(x - 1)} \\
                &* EIRTempModFac_{x - 1} \\
                &* EIRAirFlowModFac_{x - 1} \\
                &* EIRWaterFlowModFac_{x - 1}
  \end{array}
\end{equation}

\begin{equation}
  \begin{array}{rl}
    EIR_x =& \frac{1.0}{ReferenceUnitCOP@Speed(x)} \\
                &* EIRTempModFac_{x} \\
                &* EIRAirFlowModFac_{x} \\
                &* EIRWaterFlowModFac_{x}
  \end{array}
\end{equation}

The total heating capacity at the corresponding speed ratio is:

\begin{equation}
{Q_{total,SpeedRatio}} = \left( {1.0 - SpeedRatio} \right)*{Q_{total,x - 1}} + SpeedRatio*{Q_{total,x}}
\end{equation}

and the power consumption is:

\begin{equation}
Powe{r_{SpeedRatio}} = \left( {1.0 - SpeedRatio} \right)*{Q_{total,x - 1}}*EI{R_{x - 1}} + SpeedRatio*{Q_{total,x}}*EI{R_x}
\end{equation}

The waste heat generated by this coil object is calculated as:

\begin{equation}
  \begin{array}{rl}
    Q_{RecoverHeat,SpeedRatio} =& \left( 1.0 - SpeedRatio \right) \\
                               &* ReferenceUnitWasteHeatFractionofEnergyInput@SpeedLevel\left( {x - 1} \right) \\
                               &* WasteHeatTempModFac_{x - 1} * Q_{total,x - 1} * EIR_{x - 1} \\
                               &+ SpeedRatio \\
                               &* ReferenceUnitWasteHeatFractionofEnergyInput@SpeedLevel\left( x \right) \\
                               &* WasteHeatTempModFac_x \\
                               &* Q_{total,x} * EIR_x
  \end{array}
\end{equation}

The total amount of heat absorbed by the evaporator is calculated as:

\begin{equation}
{Q_{evap,SpeedRatio}} = {Q_{total,SpeedRatio}} + {\rm{}}{Q_{RecoverHeat,SpeedRatio}} - Powe{r_{SpeedRatio}}
\end{equation}

Finally:

\begin{equation}
{Q_{total,SpeedRatio}} = HeatingLoad
\end{equation}

If the speed reaches the highest level, the speed ratio becomes 1.0, and Speed x represents the highest speed.

\subsubsection{Coil:Cooling:WaterToAirHeatPump:VariableSpeedEquationFit}\label{coilcoolingwatertoairheatpumpvariablespeedequationfit}

\subsubsection{Overview}\label{overview-14}

This model (object name Coil:Cooling:WaterToAirHeatPump:VariableSpeedEquationFit) simulates the performance of an variable-speed water-to-air heat pump with cooling capability. It fits in the parent objects of \emph{AirLoopHVAC:UnitaryHeatPump:WaterToAir} and \emph{ZoneHVAC:WaterToAirHeatPump}. It has the same logic for varying the compressor, indoor fan and pump speeds as the \emph{Coil:Heating:WaterToAirHeatPump:VariableSpeedEquationFit} object. The rated conditions for obtaining the capacities, COPs and SHR are indoor dry-bulb temperature at 26.67\(^{\circ}\)C (80\(^{\circ}\)F), wet bulb temperature at 19.44\(^{\circ}\)C (67\(^{\circ}\)F), and the source side entering water temperature at 29.4\(^{\circ}\)C (85 \(^{\circ}\)F).

Variable-speed cooling coils lead to varied dehumidification behaviors, that the Bypass Factor (BF) is not only dependent on the indoor air flow rate, but also on the refrigerant mass flow rate, i.e.~the compressor speed. It is necessary to assess the BF approach for single-speed DX coil, to be used for the variable-speed systems.

TheDOE/ORNL Heat Pump Design Model(HPDM) is a steady-state vapor compression equipment simulation model, which is able to simulate the performance of a VS WSHP system. We rana calibrated HPDM model to produce performance data of a 2.5-ton, VS WSHPunit in space cooling mode. We ran the model to get the total cooling capacities and SHRs, by specifying the EWT at 65\(^{\circ}\)F, indoor air DB at 80\(^{\circ}\)F and relative humidity at 0.5, and then varying the indoor air flow rate from 400 scfm to 1000 scfm, the compressor speed from 30 Hz to 90 Hz in a 7×7 matrix. Based on the performance results, we used EES (Engineering Equation Solver) to back-calculate the corresponding BF factors and the A\(_{o}\) (effective coil surface area) parameters,using the BF equations for the single speed DX cooling coil in EnergyPlus Engineering Reference.

And then, we plotted the resultant A\(_{o}\) as a function of indoor air flow rate and compressor speed, as below:

\begin{figure}[hbtp] % fig 181
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4240.svg.png}
\caption{Effective Surface Area (Ao) Changing with Compressor Speed and Indoor SCFM \protect \label{fig:effective-surface-area-ao-changing-with}}
\end{figure}

\begin{figure}[hbtp] % fig 182
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4241.svg.png}
\caption{Bypass Factor (BF) Changing with Compressor Speed and Indoor SCFM \protect \label{fig:bypass-factor-bf-changing-with-compressor}}
\end{figure}

As indicated in the two figures above, the compressor speed is a significant factor impacting the A\(_{o}\) parameter and the BF factor. So, the current BF factor approach should be upgraded to accommodate variable-speed cooling coils.

As shown in the A\(_{o}\) figure, we can almost assume that the A\(_{o}\) parameter mainly depends on the compressor speed. And thus, for enhancing the VS WSHP model, in the IDF file, we need to input SHRs at individual compressor speeds (this is similar to the current multi-speed DX cooling coil). And then, within the VS WSHP module, we calculate the A\(_{o}\) parameter specific to each compressor speed at the design air flow rates, and then do linear interpolation of A\(_{o}\) between neighboring compressor speeds. For calculating SHRs in energy simulations, we first calculate the A\(_{o}\) parameter related to the actual compressor speed, and then use the simulated A\(_{o}\) parameter in the original BF correlation to correlate effect of the varied indoor air flow rate.

\subsubsection{Model Description}\label{model-description-11}

The Coil:Cooling:WaterToAirHeatPump:VariableSpeedEquationFit object is modeled in a manner similar to the multiple-speed DX cooling coil model (Ref. Coil:Cooling:DX:MultiSpeed). Of course, rather than referencing an air-cooled condenser, the new coil object references the water loop, and have the water entering temperature in place of the condenser air entering dry bulb temperature.

It shall be noted for the total cooling capacity and flow rate inputs, three fields are autosizable, which are Rated Total Cooling Capacity (Numeric Field 3) at Selected Nominal Speed Level, Rated Volumetric Air Flow Rate (Numeric Field 4) ~and Rated Volumetric Water Flow Rate (Numeric Field 5). They are used to scale the performances of an actual unit and correlate with the actual loop flows. Except the three fields, all other total cooling capacity and flow rate inputs at individual speed levels should be directly obtained from Reference Unit catalog data, specific to an actual unit.

The Rated Total Cooling Capacity at Selected Nominal Speed Level contains the rated total cooling capacity to match the building sensible or latent cooling load.~ The rated cooling capacity is used to determine a capacity scaling factor, as compared to the Reference Unit catalog capacity at the nominal speed level.

\begin{equation}
CapacityScaleFactor = \frac{{RatedTotalCoolingCapacity}}{{ReferenceUnitTotalCoolingCapacity@NominalSpeedLevel}}
\end{equation}

And then, this scaling factor is used to determine capacities at rated condition for other speed levels, as below,

\begin{equation}
\begin{split}
  RatedTotalCoolingCapacity@SpeedLevel(x) = CapacityScaleFactor \\
  * ReferenceUnitTotalCoolingCapacity@SpeedLevel(x)
\end{split}
\end{equation}

The Rated Volumetric Air Flow Rate is used to determine an internal scaling factor, and calculate the air flow rates in the parent objects, as follows:

{\scriptsize
\begin{equation}
  AirFlowScaleFactor = \frac{RatedVolumetricAirFlowRate}{ReferenceUnitVolAirFlowRate@NominalSpeedLevel * CapacityScaleFactor}
\end{equation}}

And the loop volumetric air flow rates in the parent objects are calculated as below,

\begin{equation}
\begin{split}
  LoopVolumetricAirFlowRate@SpeedLevel\left( x \right) = AirFlowScaleFactor \\
  * ReferenceUnitVolAirFlowRate@SpeedLevel(x) * CapacityScaleFactor
\end{split}
\end{equation}

If the volumetric air flow rate at one speed level is higher than the flow rate allowed by the fan in the parent object, the flow rate will be set back to the fan flow rate.

This Rated Volumetric Water Flow Rate is used to determine an internal scaling factor, and calculate the loop water flow rates.

{\scriptsize
\begin{equation}
  WaterFlowScaleFactor = \frac{{RatedVolumetricWaterFlowRate}}{{ReferenceUnitVolWaterFlowRate@NominalSpeedLevel \times CapacityScaleFactor}}
\end{equation}}

And the required volumetric water flow rates in the parent objects are calculated as below,

\begin{equation}
\begin{split}
  LoopVolumetricWaterFlowRate@SpeedLevel\left( x \right) = WaterFlowScaleFactor \\
  * ReferenceUnitVolWaterFlowRate@SpeedLevel(x) * CapacityScaleFactor
\end{split}
\end{equation}

The required volumetric water flow rate as above is restricted by the pump in the parent object.

If \(AirFlowScaleFactor\) and \(WaterFlowScaleFactor\) are equal to unity, the loop flow rates become the design flow rates of the original unit (after scaled by the rated total cooling capacity). The Rated Volumetric Air Flow Rate and Rated Volumetric Water Flow Rate are introduced here to correlate with the actual flow rates in the air and water loops, in case that these differ from the design specifications. Certainly, it is recommended that the Rated Volumetric Air Flow Rate and Rated Volumetric Water Flow Rate are selected in the way that \(AirFlowScaleFactor\) and \(WaterFlowScaleFactor\) are unity, so as to get more accurate results from the performance curves.

Performance Curves:

This object includes 7 curve objects at each individual speed level.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item
  Total cooling capacity modifier curve (function of temperature)
\item
  Total cooling capacity modifier curve (function of air flow fraction)
\item
  Total cooling capacity modifier curve (function of water flow fraction)
\item
  Energy input ratio (EIR) modifier curve (function of temperature)
\item
  Energy input ratio (EIR) modifier curve (function of air flow fraction)
\item
  Energy input ratio (EIR) modifier curve (function of water flow fraction)
\item
  Recoverable heat modifier as a function of indoor air wet-bulb and water entering temperatures.
\end{enumerate}

Curves (3) and (6) above are new curves as compared to those used for Multi-Speed Electric DX Air Cooling Coil, to correlate the change in water flow rate at the speed. The flow fraction modifier curves are used as a placeholder, to account for off-design flow rates if needed. If the manufacturer doesn't provide the off-design performances, we can simply use a default modification multiplier of 1.0.

At the lowest speed, there will be one additional performance curve to correlate the part-load condition, i.e.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{7}
\item Part load fraction correlation (function of part load ratio)
\end{enumerate}

More details on the above curves are provided in the following paragraphs.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\item Total cooling capacity modifier curve (function of temperature)
\end{enumerate}

The total cooling capacity modifier as a function of temperature curve (CAP-FT) is a biquadratic curve with two independent variables: wet-bulb temperature of the air entering the cooling coil and the WSHP's entering water temperature. The output of this curve is multiplied by the rated total cooling capacity at the speed, to give the total cooling capacity at the specific entering air WB and water temperatures at which the WSHP unit is operating (i.e., at temperatures different from the rating point temperatures).

Note: The data used to develop the total cooling capacity modifier curve (function of temperature) should represent performance when the cooling coil is `wet' (i.e., coil providing sensible cooling and at least some dehumidification). Performance data when the cooling coil is `dry' (i.e., not providing any dehumidification) should not be included when developing this modifier curve. This model automatically detects and adjusts for `dry coil' conditions.

\begin{equation}
TotCapTempModFac = a + b*W{B_i} + c*WB_i^2 + d*EWT + e*EW{T^2} + f*W{B_i}*EWT
\end{equation}

where:

WB\(_{i}\) is the wet-bulb temperature of the air entering the heating coil (\(^{\circ}\)C)

EWT is the entering water temperature (\(^{\circ}\)C)

a-f are regression curve-fit coefficients.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{1}
\item Total cooling capacity modifier curve (function of air flow fraction)
\end{enumerate}

The total cooling capacity modifier curve (function of air flow fraction) is a cubic curve with the independent variable being the ratio of the actual air flow rate across the cooling coil to the design air flow rate (i.e., fraction of design flow at the speed).

\begin{equation}
TotCapAirFlowModFac = a + b*f{f_a} + c*ff_a^2 + d*ff_a^3
\end{equation}

where:

ff\(_{a}\) is the actual air mass flow rate/design air mass flow rate, at one speed level

\begin{equation}
\begin{split}
  DesignAirMassFlowRate@SpeedLevel(x) = ReferenceUnitAirMassFlowRate@SpeedLevel(x) \\
  * CapacityScaleFactor
\end{split}
\end{equation}

a-d are regression curve fit coefficients.  If there is no data for correction, the user can simply set a = 1.0, and the other coefficients to 0.0.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{2}
\item Total cooling capacity modifier curve (function of water flow fraction)
\end{enumerate}

The total cooling capacity modifier curve (function of water flow fraction) is a cubic curve with the independent variable being the ratio of the actual water flow rate across the water-to-refrigerant heat exchanger to the design water flow rate (i.e., fraction of design flow at the speed).

\begin{equation}
TotCapWaterFlowModFac = a + b*f{f_w} + c*ff_w^2 + d*ff_w^3
\end{equation}

where:

ff\(_{w}\) is the actual water mass flow rate/design water mass flow rate, at one speed level

\begin{equation}
\begin{split}
  DesignWaterMassFlowRate@SpeedLevel(x) = ReferenceUnitWaterMassFlowRate@SpeedLevel(x) \\
  * CapacityScaleFactor
\end{split}
\end{equation}

a-d are regression curve-fit coefficients.  If there is no data available for the correction, the user can simply set a = 1.0 and the other coefficients to 0.0.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{3}
\tightlist
\item
  Energy input ratio (EIR) modifier curve (function of temperature)
\end{enumerate}

The energy input ratio modifier curve as a function of temperature (EIR-FT) is a biquadratic curve with two independent variables: wet-bulb temperature of the air entering the cooling coil and the WSHP's entering water temperature. The output of this curve is multiplied by the rated EIR (inverse of the rated COP) at the speed level, to give the EIR at the specific entering air and water temperatures at which the WSHP unit is operating (i.e., at temperatures different from the rating point temperatures).

\begin{equation}
EIRTempModFac = a + b*W{B_i} + c*WB_i^2 + d*EWT + e*EW{T^2} + f*W{B_i}*EWT
\end{equation}

where:

WB\(_{i}\) is the wet-bulb temperature of the air entering the cooling coil (\(^{\circ}\)C)

EWT is the entering water temperature (\(^{\circ}\)C)

a-f are regression curve fit coefficients.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{4}
\tightlist
\item
  Energy input ratio (EIR) modifier curve (function of air flow fraction)
\end{enumerate}

\begin{equation}
EIRAirFlowModFac = a + b*f{f_a} + c*ff_a^2 + d*ff_a^3
\end{equation}

where a-d are regression curve fit coefficients.  If there is no data available for the correction, the user can simply set a = 1.0 and the other coefficients to 0.0.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{5}
\tightlist
\item
  Energy input ratio (EIR) modifier curve (function of water flow fraction)
\end{enumerate}

\begin{equation}
EIRWaterFlowModFac = a + b*f{f_w} + c*ff_w^2 + d*ff_w^3
\end{equation}

where a-d are regression curve fit coefficients.  If there is no data available for the correction, the user can simply set a = 1.0 and the other coefficients to 0.0.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{6}
\tightlist
\item
  Recoverable heat modifier as a function of indoor wet-bulb and water entering temperatures.
\end{enumerate}

Recoverable heat modifier function is to account for the recoverable heat at the condensing side, as a fraction to the power input, which doesn't discharged to the water side.

\begin{equation}
WasteHeatTempModFac = a + b*W{B_i} + c*WB_i^2 + d*EWT + e*EW{T^2} + f*W{B_i}*EWT
\end{equation}

where a-f are regression curve fit coefficients.

\begin{enumerate}
\def\labelenumi{\arabic{enumi})}
\setcounter{enumi}{7}
\tightlist
\item
  Part load fraction correlation (function of part load ratio)
\end{enumerate}

This field defines the name of a quadratic or cubic performance curve (Ref: Performance Curves) that parameterizes the variation of electrical power input to the unit as a function of the part load ratio (PLR, Sensible or Latent Load/Steady-State Sensible or Latent Capacity~ for Speed 1). The description of the part load fraction correlation for the VS WSHP cooling coil is similar to the VS WSHP heating coil.

Lowest Speed Operation:

The lowest speed operation of the VS WSHP is similar to the single speed DX cooling coil. The total (gross) cooling capacity of the WSHP unit is calculated as follows:

\begin{equation}
 \begin{array}{rl}
  Q_{total,1} =& RatedTotalCoolingCapacity@SpeedLevel\left( 1 \right) \\
              &* TotCapTempModFac_1 \\
              &* TotCapAirFlowModFac_1 \\
              &* TotCapWaterFlowModFac_1
 \end{array}
\end{equation}

The EIR is calculated as:

\begin{equation}
  \begin{array}{rl}
    EIR_1 =& \frac{1.0}{ReferenceUnitCOP@Speed(1)} EIRTempModFac_1 \\
          &* EIRAirFlowModFac_1 \\
          &* EIRWaterFlowModWaterFac_1 
  \end{array}
\end{equation}

The power consumption excluding the indoor fan and the water pump is,

\begin{equation}
Powe{r_1} = {Q_{total,1}}*EI{R_1}*RTF
\end{equation}

where RTF is the run-time fraction.

The recoverable waste heat is:

\begin{equation}
  \begin{array}{rl}
    Q_{RecoverHeat,1} =& ReferenceUnitWasteHeatFractionofEnergyInput@SpeedLevel\left( 1 \right) \\
                      &* Power_1 \\
                      &* WasteHeatTempModFac_1
  \end{array}
\end{equation}

and the net heat discharged to the water loop is calculated as following:

\begin{equation}
{Q_{cond,1}} = Powe{r_1} + {Q_{total,1}} - {Q_{RecoverHeat,1}}
\end{equation}

At the lowest speed, the dehumidification calculation is exactly the same as the single speed DX coil. That is to use the rated SHR and the design air flow rate at the lowest speed to calculate rated bypass factor of BF\(_{rated,1}\), and the corresponding effective surface area of A\(_{o,1}\). Wh A\(_{o,1}\) known, the coil BF can be adjusted for non-rated air flow rates. It shall be noted if choosing to add hot gas reheating to the supply side,~ \({Q_{RecoverHeat,1}}\) ~should be subtracted from bh the total cooling capacity and the sensible cooling capacity.

The part load ratio for sensible cooling is:

\begin{equation}
PLR = SensibleCoolingLoad/({Q_{total,1}}*SH{R_1})
\end{equation}

For latent cooling:

\begin{equation}
PLR = LatentCoolingLoad/[{Q_{total,1}}*(1.0 - SH{R_1})]
\end{equation}

Higher Speed Operation:

At the speed level between the lowest and the highest, there is no part-load loss. A parameter of speed ratio (SpeedRatio) is used to define the capacity partition between Speed x-1 and Speed x.

The design air and water flow rate at the speed ratio are given as following:

\begin{equation}
  \begin{array}{rl}
    {\rm{DesignAirFlowRateSpeedRatio}} =& ReferenceUnitAirMassFlowRate@SpeedLevel\left( {x - 1} \right) \\
                                       &* CapacityScaleFactor * \left( {1-\rm{SpeedRatio}} \right) \\
                                       &+ ReferenceUnitAirMassFlowRate@SpeedLevel\left( x \right) \\
                                       &* CapacityScaleFactor * SpeedRatio
  \end{array}
\end{equation}

\begin{equation}
  \begin{array}{rl}
    \rm{DesignWaterFlowRateSpeedRatio} =& ReferenceUnitWaterMassFlowRate@SpeedLevel\left( {x - 1} \right) \\
                                        &* CapacityScaleFactor * \left( {1-\rm{SpeedRatio}} \right) \\
                                        &+ ReferenceUnitWaterMassFlowRate@SpeedLevel\left( x \right) \\
                                        &* CapacityScaleFactor * SpeedRatio
  \end{array}
\end{equation}

And the fractions of air flow and water flow are given:

\begin{equation}
ff_{a,x-1} = ff_{a,x} = actual~air~mass~flow~rate/DesignAirFlowRateSpeedRatio
\end{equation}

\begin{equation}
ff_{w,x-1} = ff_{w,x} = actual~water~mass~flow~rate/DesignWaterFlowRateSpeedRatio
\end{equation}

The total cooling capacities and EIRs at Speed x-1 and Speed x are calculated:

\begin{equation}
  \begin{array}{rl}
    {Q_{total,x - 1}} =& RatedTotalCoolingCapacity@SpeedLevel\left( {x - 1} \right) \\
                      &* TotCapTempModFac_{x - 1} \\
                      &* TotCapAirFlowModFac_{x - 1} \\
                      &* TotCapWaterFlowModFac_{x - 1}
  \end{array}
\end{equation}

\begin{equation}
  \begin{array}{rl}
    {Q_{total,x}} =& RatedTotalCoolingCapacity@SpeedLevel\left( x \right) \\
                  &* TotCapTempModFac_x \\
                  &* TotCapAirFlowModFac_x \\
                  &* TotCapWaterFlowModFac_x
  \end{array}
\end{equation}

\begin{equation}
  \begin{array}{rl}
    EIR_{x - 1} =& \frac{{1.0}}{{ReferenceUnitCOP@Speed(x - 1)}}EIRTempModFac_{x - 1} \\
                &* EIRAirFlowModFac_{x - 1} \\
                &* EIRWaterFlowModFac_{x - 1}
  \end{array}
\end{equation}

The total heating capacity at the corresponding speed ratio is:

\begin{equation}
{Q_{total,SpeedRatio}} = \left( {1.0 - SpeedRatio} \right)*{Q_{total,x - 1}} + SpeedRatio*{Q_{total,x}}
\end{equation}

and the power consumption, excluding the fan and pump power consumptions, is:

\begin{equation}
Powe{r_{SpeedRatio}} = \left( {1.0 - SpeedRatio} \right)*{Q_{total,x - 1}}*EI{R_{x - 1}} + SpeedRatio*{Q_{total,x}}*EI{R_x}
\end{equation}

The recoverable waste heat is:

\begin{equation}
  \begin{array}{rl}
    Q_{RecoverHeat,SpeedRatio} =& \left( {1.0 - SpeedRatio} \right) \\
                               &* ReferenceUnitWasteHeatFractionofEnergyInput@SpeedLevel\left( {x - 1} \right) \\
                               &* \rm{WasteHeatTempModFac}_{x - 1} * {Q_{total,x - 1}} * EIR_{x - 1} \\
                               &+ SpeedRatio \\
                               &* ReferenceUnitWasteHeatFractionofEnergyInput@SpeedLevel\left( x \right) \\
                               &* \rm{WasteHeatTempModFac}_x \\
                               &* Q_{total,x} * EIR_x
  \end{array}
\end{equation}

and the net heat discharged to the water loop is calculated as following:

\begin{equation}
{Q_{cond,SpeedRatio}} = Powe{r_{SpeedRatio}} + {Q_{total,SpeedRatio}} - {Q_{RecoverHeat,SpeedRatio}}
\end{equation}

The effective surface area in the correlations of BF factor is calculated as:

\begin{equation}
{A_{o,SpeedRatio}} = \left( {1 - SpeedRatio} \right)*{A_{o,x - 1}} + SpeedRatio*{A_{o,x}}
\end{equation}

Using A\(_{o,SpeedRatio}\) in the same BF and SHR calculation procedure as the single speed DX cooling coil, we can get BF\(_{SpeedRatio}\), and SHR\(_{SpeedRatio}\).  The sensible cooling capacity is calculated:

\begin{equation}
{Q_{sensible,SpeedRatio}} = {Q_{total,SpeedRatio}}*SH{R_{SpeedRatio}}
\end{equation}

It should be noted if choosing to add hot gas reheating to the supply side, \({Q_{RecoverHeat,SpeedRatio}}\) should be subtracted from both the total cooling capacity and the sensible cooling capacity.

At last, if the VS WSHP is used to match the sensible cooling load:

\begin{equation}
{Q_{sensible,SpeedRatio}} = SensibleLoad
\end{equation}

If it intends to match the latent cooling load:

\begin{equation}
{Q_{total,SpeedRatio}}*\left( {1.0 - SH{R_{SpeedRatio}}} \right) = LatentLoad
\end{equation}

If the speed reaches the highest level, the speed ratio becomes 1.0, and Speed n represents the highest speed.

\subsubsection{References}\label{references-9}

Keith C. Rice, 2011, DOE/ORNL Heat Pump Design Model.

S.A. Klein 2011, User Manual of Engineering Equation Solver V8.

\subsection{Secondary Coils of DX Systems and Heat Pumps}\label{secondary-coils-of-dx-systems-and-heat-pumps}

\subsubsection{Overview}\label{overview-15}

Secondary coils reject to or remove heat from a secondary zone. Secondary coil refers to a condenser of a DX system or a heat pump in cooling operating mode or an evaporator of a heat pump in heating mode. The secondary coil (e.g.~condenser) of DX system or heat pumps is commonly installed outdoor but when installed indoor either heat is dumped to or extracted from the secondary zone. A secondary zone is a conditioned or unconditioned zone where the secondary coil is installed. Secondary coils are not standalone DX coil objects but they are add-on features on existing DX coil objects. A secondary DX coil is modelled by specifying additional inputs in single speed and multi speed DX coil objects: The additional inputs allow us to model the heat rejected or extracted by the secondary coil while the primary coil serves another controlled zone as shown in Figure~\ref{fig:schematic-of-dx-system-in-cooling-operating-mode}. A secondary coil is not controlled directly but responds to the requirements of the primary DX coil. The operating mode of a secondary DX coil is determined by the primary DX coil serving the conditioned zone. If the primary DX coil is in cooling mode, then the secondary coil is rejecting heat (heating mode) to the secondary zone, or else if the primary DX coil is in heating mode, then the secondary coil is extracting heat (cooling mode) from the secondary zone. Heat rejected to a secondary zone by a condenser of a DX system or a heat pump is considered as sensible only. Whereas energy extracted from a secondary zone may contain sensible and latent components. The condenser type of the primary DX coils should be AirCooled. There is no need to specify the condenser air inlet node. The model uses zone air node as the secondary coil air inlet node. Air drawn by the secondary coil fan passes through the secondary coil and dumped back into the secondary zone. The previous time step zone condition is used as an inlet condition to the current time for the secondary DX coil model.

\begin{figure}[hbtp]
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image8002.png}
\caption{Schematic of DX System in cooling operating mode \protect \label{fig:schematic-of-dx-system-in-cooling-operating-mode}}
\end{figure}

Applications of this technology include: inter-zone heat pump in NTED (Dixon, 2010), and PTAC or PTHP serving Offices attached to a Warehouse, where the office partially or fully enclosed by the warehouse and the condenser is placed inside the Warehouse. The heat rejected or extracted by the secondary DX coil is estimated from the delivered capacity and electric power input of the primary DX coils. And the rejected or extracted heat is treated as internal gain of the secondary zone. Currently secondary DX coil are allowed in single speed, two speed and multi speed DX coil objects: \emph{Coil:Cooling:DX:SingleSpeed}, \emph{Coil:Heating:DX:SingleSpeed}, \emph{Coil:Cooling:DX:TwoSpeed}, \emph{Coil:Cooling:DX:MultiSpeed}, and \emph{Coil:Heating:DX:MultiSpeed}.

\subsubsection{Model Description:}\label{model-description-12}

The secondary coil performance calculation is invoked using inputs in the DX coil objects. The input required for cooling and heating operation of the primary DX coils are different. In the DX cooling coils the only required input is the zone name where the secondary coil is installed. In heating DX coils six inputs are required for single speed coils and a minimum of 11 input fields are required for multispeed DX heating coils. And five more inputs are required for every additional compressor speed. The extensible five input fields are used for splitting the total heat extraction rate into sensible and latent components. These five input fields are: rated sensible heat ratio, secondary air flow rates, scaling factor for auto-sizing secondary air flow rates, sensible heat ratio modifier curves as a function of temperature and sensible heat ratio modifier curves as a function of secondary air flow fraction. The secondary coil model assumes that liquid water from defrosting operation is drained to the outdoor and has no impact on the zone air heat balance.

\textbf{Cooling Operating Mode:} the primary DX cooling coil of a DX system serving a primary zone is on and heat is rejected by the secondary coil (condenser) into a secondary zone. The secondary zone name is specified in DX cooling coil objects. This operating mode applies to a DX cooling system and cooling operating mode of air-to-air single and multi-speed heat pumps. The heat rejected by the secondary coil (condenser) of a DX system or heat pump operating in cooling mode is given by:

\begin{equation}
  Q_{Cond} = Q_{Evap}+P_{CompCondFan}
\end{equation}

where:

\(Q_{Evap}\) is the cooling load delivered by the primary DX cooling coil system (W)

\(P_{CompCondFan}\) is the compressor and evaporator fan electric power input of a heat pump in heating mode (W)

\(Q_{Cond}\) is the heat rejected by the secondary coil (condenser) of a DX system or heat pump (W).

Heat rejected by a secondary coil (condenser) calculated at each time step becomes internal gain of the secondary zone as shown in Figure~\ref{fig:schematic-of-dx-system-and-secondary-coil}. Whenever a secondary zone name is specified in DX cooling coil objects, the secondary DX coil model calculation is invoked. New input field required as add-on to the DX cooling coil objects is ``\emph{Zone Name for Secondary Coil (condenser) Placement}''.

\begin{figure}[hbtp]
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image8003.png}
\caption{Schematic of DX system and secondary coil (condenser) \protect \label{fig:schematic-of-dx-system-and-secondary-coil}}
\end{figure}

\textbf{Heating Operating Mode:} When a heat pump operates in heating mode then energy is extracted from the secondary zone. The total energy extracted is estimated by rearranging the equation above as follows:

\begin{equation}
Q_{Evap} = Q_{Cond} - P_{CompCondFan}
\end{equation}

where:

\(Q_{Cond}\) is the heat delivered by the primary heating DX coil to the primary zone (W)

\(P_{CompCondFan}\) is the compressor and condenser fan electric power input of a DX system or heat pump in cooling mode (W)

\(Q_{Evap}\) is the energy extracted by secondary coil (evaporator) from the secondary zone (W).

The total energy extracted from a secondary zone may contain sensible and latent components. The secondary coil model checks for the coil inlet and full load outlet air condition to determine whether dehumidification will occur. The sensible and latent split of the energy extracted is done using a user specified rated sensible heat ratio (SHR) and SHR modifier curves for temperature and the secondary air flow fraction. If the secondary coil operation is dry, then the SHR is set to 1.0. In addition, the model assumes that defrosting operation is on, then the defrosting melts the frost and the liquid water from the collecting pan is drained to outside. Thus defrosting energy is not included in the zone energy balance. The heat extracted from the secondary zone may contain sensible and latent components and the secondary coil model does the sensible/latent heat split calculation.

\subsubsection{Sensible Heat Ratio Calculation}\label{sensible-heat-ratio-calculation}

The SHR calculation method uses user specified SHR modifying curves for temperature and flow fraction. The modifying curves correct the rated SHR value for a given secondary DX coil (evaporator) entering air temperatures and air mass flow fraction for a given speed. If these SHR modifying curves are not specified a constant SHR will be assumed. These two curves are a biquadratic SHR modifier curve for temperature (SHRFT), and a quadratic SHR correction curve for flow fraction (SHRFFF). The SHR is given by:

\begin{equation}
SHR = SHR_{rated}\cdot SHRFT\left(T_{wb,secondaryZone},T_{db,primaryCoil}\right)\cdot SHRFFF(FF)
\end{equation}

where:

\(SHRFT\) is the sensible heat ratio modifier normalized biquadratic curve as a function of secondary DX coil entering air wet-bulb and primary DX coil entering air dry-bulb temperature. The secondary DX coil (evaporator) entering air wet-bulb temperature is the secondary zone air wet-bulb temperature.

\(SHRFFF\) is the sensible heat ratio modifier normalized quadratic curve as a function of air mass flow fraction. 

\(FF\), flow fraction,  is the ratio of actual to rated mass flow rate of air through the secondary DX coil.

\(SHR_{rated}\) is the sensible heat ratio at rated conditions.

For multispeed secondary DX coils when the system is cycling between two speeds of \emph{n} and \emph{n}-1 the operating SHR is weighted using \emph{SpeedRatio} as follows:

\begin{equation}
SHR = SHR_n \cdot SpeedRatio +  SHR_{n-1} (1 - SpeedRatio)
\end{equation}

where:

\(SHR_n\) is the sensible heat ratio at speed n determined from user specified rated SHR, and SHR modifier curves at speed \emph{n},

\(SHR_{n-1}\) is the sensible heat ratio at speed \emph{n}-1 determined from user specified rated SHR, and \emph{SHR} modifier curves at speed \emph{n}-1,

\(SpeedRatio\) is a parameter that relates performance between successive compressor speeds,

\subsubsection{Sensible and Latent Split}\label{sensible-and-latent-split}

The air enthalpy difference across the secondary DX coil (evaporator) at full load is given by:

\begin{equation}
  h_{Delta} = \frac{\left(Q_{Evap}/PLR\right)}{\dot{m}_{Cond}}
\end{equation}

The coil outlet enthalpy is calculated as follows:

\begin{equation}
  h_{Outlet} = h_{Inlet}-h_{Delta}
\end{equation}

Using the SHR calculated above, the secondary DX coil outlet humidity ratio and dry-bulb temperature are given by:

\begin{equation}
  h_{T_{in},\omega_{out}} = h_{Inlet} - \left(1.0 - SHR\right) \cdot \frac{\left(Q_{Evap}/PLR\right)\cdot SHR}{\dot{m}_{Cond}\cdot c_p}
\end{equation}

\begin{equation}
  \omega_{Outlet} = \omega( T_{Inlet}, h_{T_{in},\omega_{out}} )
\end{equation}

\begin{equation}
  T_{Outlet} = T( h_{Outlet}, \omega_{Outlet} )
\end{equation}

Calculate the saturated outlet temperature at the outlet enthalpy and check the secondary outlet air condition if super-saturation has occurred:

\begin{equation}
  T_{Outlet, Sat} = T_{SAT}\left(h_{Outlet}, P_{Tot}\right)
\end{equation}

If \(T_{Outlet} \leq T_{Outlet, Sat}\), then

\begin{equation}
  T_{Outlet} = T_{Outlet, Sat}
\end{equation}

\begin{equation}
  \omega_{Outlet} = \omega\left(T_{Outlet,Sat},h_{Outlet}\right)
\end{equation}

where:

\(h_{Inlet}\) is the enthalpy of air entering the passive coil (J/kg)

\(h_{Outlet}\) is the enthalpy of air leaving the passive coil (J/kg) 

\(h_{T_{in},\omega_{out}}\) is the enthalpy of air at the leaving humidity ratio and the entering dry bulb temerature

\(\dot{m}_{sec}\) is the secondary DX coil mass flow rate (kg/s) 

PLR is the primary DX cooling coil compressor part-load ratio

\(P_{Tot}\) is the total pressure at the inlet of secondary DX coil (Pa)

\(T_{Outlet}\) is the secondary coil outlet air temperature (\(^{\circ}\)C) 

\(T_{Outlet,Sat}\) is the secondary coil saturated air temperature at the outlet enthalpy (\(^{\circ}\)C)

\(\omega_{Inlet}\) is the secondary coil inlet node air humidity ratio (kgH2O/kgDryair) 

\(\omega_{Outlet}\) is the secondary coil outlet node air humidity ratio (kgH2O/kgDryair).

Reference: Dixon, Erin Elizabeth, ``Energy Model Development and Heating Energy Investigation of the Nested Thermal Envelope Design (NTED (tm))'' (2010). Theses and dissertations. Paper 974.

\subsection{Packaged Thermal Storage Cooling Coil}\label{packaged-thermal-storage-cooling-coil}

The DX cooling coil model for Coil:Cooling:DX:SingleSpeed:ThermalStorage is described in this section. The following diagram shows the main aspects of the model for packaged thermal energy storage cooling coil. This model allows charging and discharging to shift cooling energy use. The dashed line shows the boundary of the empirical ``black box'' model. The main parts are the Condenser, Evaporator, Compressor, and Thermal Energy Storage (TES) tank. The model interacts with the surroundings via a condenser inlet and outlet nodes, evaporator inlet and outlet nodes, heat transfer between TES tank and surrounding ambient environment, and optional added plant connection to the TES tank.

\begin{figure}[hbtp] % fig 183
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4287.png}
\caption{Highlights of Packaged Thermal Storage Cooling Coil \protect \label{fig:highlights-of-packaged-thermal-storage}}
\end{figure}

Depending on the operating mode, different parts are active.~ There are six modes to consider.

\textbf{Off Mode} is when the unit is not running but the TES tank still interacts with ambient and the model needs to track the state of charge in the tank.

\begin{figure}[hbtp] % fig 184
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4288.png}
\caption{Thermal Storage Cooling Coil Off Mode \protect \label{fig:thermal-storage-cooling-coil-off-mode}}
\end{figure}

Governing equations for Off Mode include:

\begin{equation}
-M{c_p}\frac{{DT}}{{Dt}} + {\dot Q_{Amb}} + {\dot Q_{Plant}} = 0 ~~~~ (water~tank)
\end{equation}

\begin{equation}
-M{h_{fs}}\frac{{DF}}{{Dt}} + {\dot Q_{Amb}} + {\dot Q_{Plant}} = 0 ~~~~ (ice~tank)
\end{equation}

\begin{equation}
{\dot Q_{Amb}} = {\left( {UA} \right)_{Tank}}\left( {{T_{TES}} - {T_{Amb}}} \right)
\end{equation}

\begin{equation}
{\dot Q_{Plant}} = \dot m\varepsilon \left( {{T_{TES}} - {T_{w,in}}} \right)
\end{equation}

\textbf{Cooling Only Mode} is when the unit is running but since it is neither charging nor discharging the TES tank, the model is essentially the same as a normal single speed DX cooling coil.~ The latent degradation model is not available.~ The model uses SHR curves~ from user input.

\begin{figure}[hbtp] % fig 185
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4293.png}
\caption{Thermal Storage Coil Cooling Only Modee \protect \label{fig:thermal-storage-coil-cooling-only-modee}}
\end{figure}

The governing equations for Cooling Only Mode include:

\begin{equation}
-M{c_p}\frac{{DT}}{{Dt}} + {\dot Q_{Amb}} + {\dot Q_{Plant}} = 0 ~~~~ (water~tank)
\end{equation}

\begin{equation}
-M{h_{fs}}\frac{{DF}}{{Dt}} + {\dot Q_{Amb}} + {\dot Q_{Plant}} = 0 ~~~~ (ice~tank)
\end{equation}

\begin{equation}
\dot W + {\dot Q_{Evap}} + {\dot Q_{Cond}} = 0
\end{equation}

\begin{equation}
{\dot Q_{Amb}} = {\left( {UA} \right)_{Tank}}\left( {{T_{TES}} - {T_{Amb}}} \right)
\end{equation}

\begin{equation}
{\dot Q_{Plant}} = \dot m{c_p}\varepsilon \left( {{T_{TES}} - {T_{w,in}}} \right)
\end{equation}

The input correlations are used in the following manner to determine cooling capacity and energy consumption for a given set of operationg conditions.

One total evaporator cooling capacity modifier curve is a function of evaporator inlet wetbulb temperature and condenser inlet drybulb temperature.

\begin{equation}
EvapCapTempModFac = {f_{}}\left( {{T_{evap,wb}},{\rm{}}{T_{cond,db}}} \right)
\end{equation}

Another total evaporator cooling capacity modifier curve is a function of air flow fraction through the evaporator section where air flow fraction is the ratio of current air mass flow rate to the rated air mass flow rate.

\begin{equation}
  EvapCapFlowModFac = f\PB{\frac{\dot{m}_{evap,air}}{\dot{m}_{evap,air,rated}}}
\end{equation}

One energy input ratio modifier curve is a function of evaporator inlet wetbulb temperature and condenser inlet drybulb temperature.

\begin{equation}
EIRTempModFac = f\left( {{T_{evap,wb}},{\rm{}}{T_{cond,db}}} \right)
\end{equation}

Another energy input ratio modifier curve is a function of flow fraction.

\begin{equation}
  EIRFlowModFac = f\PB{\frac{\dot{m}_{evap,air}}{\dot{m}_{evap,air,rated}}}
\end{equation}

Part load degradation curve is a function of part load ratio.

\begin{equation}
EvapPartLoadFac = f\left( {PLR} \right)
\end{equation}

The results of the performance curves are applied as follows to determine cooling capacity and energy performance:

\begin{equation}
{\dot Q_{Evap}} = {\dot Q_{Evap,RatedCoolOnly}}\left( {EvapCapTempModFac} \right)\left( {EvapCapFlowModFac} \right)
\end{equation}

\begin{equation}
{\dot W_{elec}} = \frac{{{{\dot Q}_{evap}}\left( {EIRTempModFac} \right)\left( {EIRFlowModFac} \right)\left( {PLR} \right)}}{{\left( {CO{P_{Rated,{\rm{}}CoolOnly}}} \right)\left( {EvapPartLoadFac} \right)}}
\end{equation}

The sensible heat ratio (SHR) is determined by a rated SHR and two performance curves. The SHR temperature modifying factor is a function of evaporator entering wetbulb and evaporator entering drybulb temperature.

\begin{equation}
SHRTempModFac = f\left( {{T_{evap,wb}},{T_{evap,db}}} \right)
\end{equation}

The SHR flow fraction modifying factor is a function of air flow fraction through the evaporator section where air flow fraction is the ratio of current air mass flow rate to the rated air mass flow rate.

\begin{equation}
  SHRFlowModFac = f\PB{\frac{\dot{m}_{evap,air}}{\dot{m}_{evap,air,rated}}}
\end{equation}

The results of the performance curves are applied as follows to determine SHR:

\begin{equation}
SHR = SH{R_{rated}}*SHRTempModFac*SHRFlowModFac
\end{equation}

Cool and Charge Mode is when the unit is both cooling and charging the TES, then all the parts are active. The electric power into the compressor is split into two terms to accommodate devices that actually have dual compressors.

\begin{figure}[hbtp] % fig 186
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4309.png}
\caption{Thermal Storage Coil Cool and Charge Modes \protect \label{fig:thermal-storage-coil-cool-and-charge-modes}}
\end{figure}

Governing Equations for ``Cool and Charge Mode''

\begin{equation}
-M{c_p}\frac{{DT}}{{Dt}} + {\dot Q_{Amb}} + {\dot Q_{Plant}} + {\dot Q_{TES}} = 0 ~~~~ (water~tank)
\end{equation}

\begin{equation}
-M{h_{fs}}\frac{{DF}}{{Dt}} + {\dot Q_{Amb}} + {\dot Q_{Plant}} + {\dot Q_{TES}} = 0 ~~~~ (ice~tank)
\end{equation}

\begin{equation}
{\dot W_{Evap}} + {\dot W_{TES}} + {\dot Q_{Evap}} + {\dot Q_{Cond}} + {\dot Q_{TES}} = 0
\end{equation}

\begin{equation}
{\dot Q_{Amb}} = {\left( {UA} \right)_{Tank}}\left( {{T_{TES}} - {T_{Amb}}} \right)
\end{equation}

\begin{equation}
  {\dot Q_{Plant}} = \dot m{c_p}\varepsilon \left( {{T_{TES}} - {T_{w,in}}} \right)
\end{equation}

The input correlations are used in the following manner to determine cooling capacity, chargine capacity, and energy consumption for a given set of operationg conditions.

One total evaporator cooling capacity modifier curve is a function of evaporator inlet wetbulb and condenser inlet drybulb temperatures and state of TES, \({S_{TES}}\) ~(temperature of water or fraction of ice).

\begin{equation}
EvapCapTempModFac = f\left( {{T_{evap,wb}},{T_{cond,db}},{S_{TES}}} \right)
\end{equation}

Another total evaporator cooling capacity modifier curve is a function of flow fraction.

\begin{equation}
EvapCapFlowModFac = f\PB{\frac{\dot{m}_{evap,air}}{\dot{m}_{evap,air,rated}}}
\end{equation}

One evaporator energy input ratio modifier curve, function of evaporator inlet wetbulb and condenser inlet drybulb temperatures and state of TES.

\begin{equation}
EIREvapTempModFac = f\left( {{T_{evap,wb}},{T_{cond,db}},{S_{TES}}} \right)
\end{equation}

Another energy input ratio modifier curve is a function of flow fraction.

\begin{equation}
EIREvapFlowModFac = f\PB{\frac{\dot{m}_{evap,air}}{\dot{m}_{evap,air,rated}}}
\end{equation}

Part load degradation curve is a function of evaporator part load ratio.

\begin{equation}
EvapPartLoadFac = f\left( {PLR} \right)
\end{equation}

One storage charge capacity modifier curve is a function of evaporator inlet wetbulb and condenser inlet drybulb temperatures and state of TES.

\begin{equation}
TESCapTempModFac = f\left( {{T_{evap,wb}},{T_{cond,db}},{S_{TES}}} \right)
\end{equation}

Another storage charge capacity modifier curve is a function of evaporator part load ratio.

\begin{equation}
TESCapPartLoadFac = f\left( {PLR} \right)
\end{equation}

The results of the performance curves are applied as follows to determine cooling capacity and energy performance:

\begin{equation}
{\dot Q_{Evap}} = {\dot Q_{Evap,RatedCoolAndCharge}}\left( {EvapCapTempModFac} \right)\left( {EvapCapFlowModFac} \right)
\end{equation}

\begin{equation}
{\dot Q_{TES}} = {\dot Q_{Charge,Rated}}\left( {TESCapTempModFac} \right)\left( {TESCapPartLoadFac} \right)
\end{equation}

\begin{equation}
{\dot W_{Evap,elec}} = \frac{{\left( {{{\dot Q}_{Evap}}} \right)\left( {EIRTempModFac} \right)\left( {EIRFlowModFac} \right)\left( {EvapPLR} \right)}}{{\left( {CO{P_{Rated,Cooling}}} \right)\left( {EvapPartLoadFac} \right)}}
\end{equation}

\begin{equation}
{\dot W_{TES,elec}} = \frac{{\left( {{{\dot Q}_{TES}}} \right)\left( {EIRStorTempModFac} \right)\left( {EIRStorFlowModFac} \right)\left( {StorPLR} \right)}}{{\left( {CO{P_{Rated,Charging}}} \right)\left( {StorPartLoadFac} \right)}}
\end{equation}

The sensible heat ratio (SHR) is determined by a rated SHR and two performance curves. There are two options for the SHR temperature modifying factor, it can either be a function of evaporator entering wetbulb and evaporator entering drybulb temperature or it can add a third independent variable for the state of charge of TES.

\begin{equation}
  SHRTempModFac = \left\{
    \begin{array}{l}
      f\PB{T_{evap,wb},T_{evap,db}} \\
      f\PB{T_{evap,wb},T_{evap,db},S_{TES}}
    \end{array}
  \right.
\end{equation}

The SHR flow fraction modifying factor is a function of air flow fraction through the evaporator section where air flow fraction is the ratio of current air mass flow rate to the rated air mass flow rate.

\begin{equation}
SHRFlowModFac = f\PB{\frac{\dot{m}_{evap,air}}{\dot{m}_{evap,air,rated}}}
\end{equation}

The results of the performance curves are applied as follows to determine SHR:

\begin{equation}
SHR = SH{R_{rated}}*SHRTempModFac*SHRFlowModFac
\end{equation}

\textbf{Cool and Discharge Mode} is when the unit is both cooling and discharging the TES, then all the parts are active. The electric power into the compressor is split into two terms to accommodate devices that actually have dual compressors.

\begin{figure}[hbtp] % fig 187
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4331.png}
\caption{Thermal Storage Coil Cool and Discharge Modes \protect \label{fig:thermal-storage-coil-cool-and-discharge-modes}}
\end{figure}

Governing Equations for ``Cool and Discharge Mode''

\begin{equation}
-M{c_p}\frac{{DT}}{{Dt}} + {\dot Q_{Amb}} + {\dot Q_{Plant}} + {\dot Q_{TES}} = 0 ~~~~ (water~tank)
\end{equation}

\begin{equation}
-M{h_{fs}}\frac{{DF}}{{Dt}} + {\dot Q_{Amb}} + {\dot Q_{Plant}} + {\dot Q_{TES}} = 0 ~~~~ (ice~tank)
\end{equation}

\begin{equation}
{\dot W_{Evap}} + {\dot W_{TES}} + {\dot Q_{Evap}} + {\dot Q_{Cond}} + {\dot Q_{TES}} = 0
\end{equation}

\begin{equation}
{\dot Q_{Amb}} = {\left( {UA} \right)_{Tank}}\left( {{T_{TES}} - {T_{Amb}}} \right)
\end{equation}

\begin{equation}
  {\dot Q_{Plant}} = \dot m{c_p}\varepsilon \left( {{T_{TES}} - {T_{w,in}}} \right)
\end{equation}

The input correlations are used in the following manner.

One total evaporator cooling capacity modifier curve is a function of evaporator inlet wetbulb and condenser inlet drybulb temperatures and state of TES.

\begin{equation}
EvapCapTempModFac = f\left( {{T_{evap,wb}},{T_{cond,db}},{S_{TES}}} \right)
\end{equation}

Another total evaporator cooling capacity modifier curve is a function of flow fraction.

\begin{equation}
EvapCapFlowModFac = f\PB{\frac{\dot{m}_{evap,air}}{\dot{m}_{evap,air,rated}}}
\end{equation}

One evaporator energy input ratio modifier curve is a function of of evaporator inlet wetbulb and condenser inlet drybulb temperatures and state of TES.

\begin{equation}
EIREvapTempModFac = f\left( {{T_{evap,wb}},{T_{cond,db}},{S_{TES}}} \right)
\end{equation}

Another evaporator energy input ratio modifier curve is a function of flow fraction.

\begin{equation}
EIREvapFlowModFac = f\PB{\frac{\dot{m}_{evap,air}}{\dot{m}_{evap,air,rated}}}
\end{equation}

Evaporator part load degradation curve is a function of evaporator part load ratio.

\begin{equation}
EvapPartLoadFac = f\left( {EvapPLR} \right)
\end{equation}

One storage discharge capacity modifier curve is a function of evaporator inlet wetbulb and condenser inlet drybulb temperatures and state of TES.

\begin{equation}
TESCapTempModFac = f\left( {{T_{evap,wb}},{T_{cond,db}},{S_{TES}}} \right)
\end{equation}

Another storage discharge capacity modifier curve is a function of evaporator part load ratio.

\begin{equation}
TESCapPartLoadFac = f\left( {EvapPLR} \right)
\end{equation}

One storage energy input ratio modifier curve is a function of evaporator inlet wetbulb and condenser inlet drybulb temperatures and state of TES.

\begin{equation}
EIRStorTempModFac = {f_{triquadratic}}\left( {{T_{evap,wb}},{T_{cond,db}},{S_{TES}}} \right)
\end{equation}

Another storage energy input ratio modifier curve is a function of flow fraction.

\begin{equation}
  EIRStorFlowModFac = f\PB{\frac{\dot{m}_{evap,air}}{\dot{m}_{evap,air,rated}}}
\end{equation}

Storage part load degradation curve is a function of storage discharge part load ratio.

\begin{equation}
StorPartLoadFac = f\left( {StorPLR} \right)
\end{equation}

The results of the performance curves are applied as follows to determine cooling capacity and energy performance:

\begin{equation}
{\dot Q_{Evap}} = {\dot Q_{Evap,RatedCoolAndDischarge}}\left( {EvapCapTempModFac} \right)\left( {EvapCapFlowModFac} \right)
\end{equation}

\begin{equation}
{\dot Q_{TES}} =  - {\dot Q_{Discharge,Rated}}\left( {TESCapTempModFac} \right)\left( {TESCapPartLoadFac} \right)
\end{equation}

\begin{equation}
{\dot W_{Evap,elec}} = \frac{{\left( {{{\dot Q}_{Evap}}} \right)\left( {EIREvapTempModFac} \right)\left( {EIREvapFlowModFac} \right)\left( {EvapPLR} \right)}}{{\left( {CO{P_{Rated,Cooling}}} \right)\left( {EvapPartLoadFac} \right)}}
\end{equation}

\begin{equation}
{\dot W_{TES,elec}} = \frac{{\left( {{{\dot Q}_{TES}}} \right)\left( {EIRStorTempModFac} \right)\left( {EIRStorFlowModFac} \right)\left( {StorPLR} \right)}}{{\left( {CO{P_{Rated,Discharging}}} \right)\left( {StorPartLoadFac} \right)}}
\end{equation}

The sensible heat ratio (SHR) is determined by a rated SHR and two performance curves. There are two options for the SHR temperature modifying factor, it can either be a function of evaporator entering wetbulb and evaporator entering drybulb temperature or it can add a third independent variable for the state of charge of TES.

\begin{equation}
  SHRTempModFac = \left\{
    \begin{array}{l}
      f\PB{T_{evap,wb},T_{evap,db}} \\
      f\PB{T_{evap,wb},T_{evap,db},S_{TES}}
    \end{array}
  \right.
\end{equation}

The SHR flow fraction modifying factor is a function of air flow fraction through the evaporator section where air flow fraction is the ratio of current air mass flow rate to the rated air mass flow rate.

\begin{equation}
SHRFlowModFac = f\PB{\frac{\dot{m}_{evap,air}}{\dot{m}_{evap,air,rated}}}
\end{equation}

The results of the performance curves are applied as follows to determine SHR:

\begin{equation}
SHR = SH{R_{rated}}*SHRTempModFac*SHRFlowModFac
\end{equation}

\textbf{Charge Only Mode} is when the unit is only charging, there is no heat flow at the evaporator. ~There is no modulation or part loading, when charging the unit charges at its nominal design rate (adjusted for conditions).

\begin{figure}[hbtp] % fig 188
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4355.png}
\caption{Thermal Storage Coil Charge Only Mode \protect \label{fig:thermal-storage-coil-charge-only-mode}}
\end{figure}

The governing equations for ``Charge Only Mode''

\begin{equation}
-M{c_p}\frac{{DT}}{{Dt}} + {\dot Q_{Amb}} + {\dot Q_{Plant}} + {\dot Q_{TES}} = 0 ~~~~ (water~tank)
\end{equation}

\begin{equation}
-M{h_{fs}}\frac{{DF}}{{Dt}} + {\dot Q_{Amb}} + {\dot Q_{Plant}} + {\dot Q_{TES}} = 0 ~~~~ (ice~tank)
\end{equation}

\begin{equation}
\dot W + {\dot Q_{Cond}} + {\dot Q_{TES}} = 0
\end{equation}

\begin{equation}
{\dot Q_{Amb}} = {\left( {UA} \right)_{Tank}}\left( {{T_{TES}} - {T_{Amb}}} \right)
\end{equation}

\begin{equation}
  {\dot Q_{Plant}} = \dot m{c_p}\varepsilon \left( {{T_{TES}} - {T_{w,in}}} \right)
\end{equation}

The input correlations are used in the following manner.

Storage charge capacity modifier factor is a function of evaporator inlet wetbulb and condenser inlet drybulb temperatures and state of TES.

\begin{equation}
TESCapTempModFac = f\left( {{T_{evap,wb}},{T_{cond,db}},{S_{TES}}} \right)
\end{equation}

Energy input ratio modifier factor is a function of evaporator inlet wetbulb and condenser inlet drybulb temperatures and state of TES.

\begin{equation}
EIRTempModFac = f\left( {{T_{evap,wb}},{T_{cond,db}},{S_{TES}}} \right)
\end{equation}

\begin{equation}
{\dot Q_{TES}} = \left( {{{\dot Q}_{Charge,Rated}}} \right)\left( {TESCapTempModFac} \right)
\end{equation}

\begin{equation}
{\dot W_{elec}} = \left( {{{\dot Q}_{TES}}} \right)\left( {\frac{1}{{CO{P_{Rated,ChargeOnly}}}}} \right)\left( {EIRTempModFac} \right)
\end{equation}

\textbf{Discharge Only Mode} is when the unit is only discharging, there is no heat flow at the condenser. The rate of discharge will modulate to meet part loading at the evaporator.

\begin{figure}[hbtp] % fig 189
\centering
\includegraphics[width=0.9\textwidth, height=0.9\textheight, keepaspectratio=true]{media/image4366.png}
\caption{Thermal Storage Coil Discharge Only Mode \protect \label{fig:thermal-storage-coil-discharge-only-mode}}
\end{figure}

The governing equations for ``Discharge Only Mode''

\begin{equation}
-M{c_p}\frac{{DT}}{{Dt}} + {\dot Q_{Amb}} + {\dot Q_{Plant}} + {\dot Q_{TES}} = 0 ~~~~ (water~tank)
\end{equation}

\begin{equation}
-M{h_{fs}}\frac{{DF}}{{Dt}} + {\dot Q_{Amb}} + {\dot Q_{Plant}} + {\dot Q_{TES}} = 0 ~~~~ (ice~tank)
\end{equation}

\begin{equation}
\dot W + {\dot Q_{Evap}} + {\dot Q_{TES}} = 0
\end{equation}

\begin{equation}
{\dot Q_{Amb}} = {\left( {UA} \right)_{Tank}}\left( {{T_{TES}} - {T_{Amb}}} \right)
\end{equation}

\begin{equation}
{\dot Q_{Plant}} = \dot m{c_p}\varepsilon \left( {{T_{TES}} - {T_{w,in}}} \right)
\end{equation}

The input correlations are used in the following manner.

One total evaporator cooling capacity modifier factor is a function of evaporator inlet wetbulb temperature and state of TES.

\begin{equation}
EvapCapTempModFac = f\left( {{T_{evap,wb}},{S_{TES}}} \right)
\end{equation}

Another total evaporator cooling capacity modifier factor is a function of flow fraction.

\begin{equation}
EvapCapFlowModFac = f\PB{\frac{\dot{m}_{evap,air}}{\dot{m}_{evap,air,rated}}}
\end{equation}

One energy input ratio modifier factor is a function of evaporator inlet wetbulb temperature and state of TES.

\begin{equation}
EIRTempModFac = f\left( {{T_{evap,wb}},{S_{TES}}} \right)
\end{equation}

Another energy input ratio modifier factor is a function of flow fraction.

\begin{equation}
EIRFlowModFac = f\PB{\frac{\dot{m}_{evap,air}}{\dot{m}_{evap,air,rated}}}
\end{equation}

Part load degradation curve is a function of evaporator part load ratio.

\begin{equation}
EvapPartLoadFac = f\left( {EvapPLR} \right)
\end{equation}

\begin{equation}
{\dot Q_{Evap}} = \left( {{{\dot Q}_{Evap,RatedDischargeOnly}}} \right)\left( {EvapCapTempModFac} \right)\left( {EvapCapFlowModFac} \right)
\end{equation}

\begin{equation}
{\dot W_{elec}} = \frac{{\left( {{{\dot Q}_{evap}}} \right)\left( {EIRStorTempModFac} \right)\left( {EIRStorFlowModFac} \right)\left( {EvapPLR} \right)}}{{\left( {CO{P_{Rated,DischargeOnly}}} \right)\left( {EvapPartLoadFac} \right)}}
\end{equation}

\begin{equation}
{\dot Q_{TES}} = {\dot Q_{Evap}} + {\dot W_{elec}}
\end{equation}

The sensible heat ratio (SHR) is determined by a rated SHR and two performance curves. There are two options for the SHR temperature modifying factor, it can either be a function of evaporator entering wetbulb and evaporator entering drybulb temperature or it can add a third independent variable for the state of charge of TES.

\begin{equation}
  SHRTempModFac = \left\{
    \begin{array}{l}
      f\PB{T_{evap,wb},T_{evap,db}} \\
      f\PB{T_{evap,wb},T_{evap,db},S_{TES}}
    \end{array}
  \right.
\end{equation}

The SHR flow fraction modifying factor is a function of air flow fraction through the evaporator section where air flow fraction is the ratio of current air mass flow rate to the rated air mass flow rate.

\begin{equation}
SHRFlowModFac = f\PB{\frac{\dot{m}_{evap,air}}{\dot{m}_{evap,air,rated}}}
\end{equation}

The results of the performance curves are applied as follows to determine SHR:

\begin{equation}
SHR = SH{R_{rated}}*SHRTempModFac*SHRFlowModFac
\end{equation}
