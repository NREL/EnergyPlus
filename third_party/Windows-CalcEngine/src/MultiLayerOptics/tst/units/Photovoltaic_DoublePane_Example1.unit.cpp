#include <memory>
#include <gtest/gtest.h>

#include "WCESpectralAveraging.hpp"
#include "WCEMultiLayerOptics.hpp"
#include "WCESingleLayerOptics.hpp"
#include "WCECommon.hpp"

using FenestrationCommon::CSeries;
using FenestrationCommon::Property;
using FenestrationCommon::PropertySimple;
using FenestrationCommon::Side;
using FenestrationCommon::Scattering;
using SpectralAveraging::CSpectralSampleData;
using SingleLayerOptics::Material;
using MultiLayerOptics::CMultiPanePhotovoltaic;

class Photovoltaic_DoublePane_Example1 : public testing::Test
{
private:
    std::unique_ptr<CMultiPanePhotovoltaic> m_Layer;

    static CSeries loadSolarRadiationFile()
    {
        // Full ASTM E891-87 Table 1 (Solar radiation)
        CSeries aSolarRadiation(
          {{0.3000, 0.0},    {0.3050, 3.4},    {0.3100, 15.6},   {0.3150, 41.1},   {0.3200, 71.2},
           {0.3250, 100.2},  {0.3300, 152.4},  {0.3350, 155.6},  {0.3400, 179.4},  {0.3450, 186.7},
           {0.3500, 212.0},  {0.3600, 240.5},  {0.3700, 324.0},  {0.3800, 362.4},  {0.3900, 381.7},
           {0.4000, 556.0},  {0.4100, 656.3},  {0.4200, 690.8},  {0.4300, 641.9},  {0.4400, 798.5},
           {0.4500, 956.6},  {0.4600, 990.0},  {0.4700, 998.0},  {0.4800, 1046.1}, {0.4900, 1005.1},
           {0.5000, 1026.7}, {0.5100, 1066.7}, {0.5200, 1011.5}, {0.5300, 1084.9}, {0.5400, 1082.4},
           {0.5500, 1102.2}, {0.5700, 1087.4}, {0.5900, 1024.3}, {0.6100, 1088.8}, {0.6300, 1062.1},
           {0.6500, 1061.7}, {0.6700, 1046.2}, {0.6900, 859.2},  {0.7100, 1002.4}, {0.7180, 816.9},
           {0.7244, 842.8},  {0.7400, 971.0},  {0.7525, 956.3},  {0.7575, 942.2},  {0.7625, 524.8},
           {0.7675, 830.7},  {0.7800, 908.9},  {0.8000, 873.4},  {0.8160, 712.0},  {0.8237, 660.2},
           {0.8315, 765.5},  {0.8400, 799.8},  {0.8600, 815.2},  {0.8800, 778.3},  {0.9050, 630.4},
           {0.9150, 565.2},  {0.9250, 586.4},  {0.9300, 348.1},  {0.9370, 224.2},  {0.9480, 271.4},
           {0.9650, 451.2},  {0.9800, 549.7},  {0.9935, 630.1},  {1.0400, 582.9},  {1.0700, 539.7},
           {1.1000, 366.2},  {1.1200, 98.1},   {1.1300, 169.5},  {1.1370, 118.7},  {1.1610, 301.9},
           {1.1800, 406.8},  {1.2000, 375.2},  {1.2350, 423.6},  {1.2900, 365.7},  {1.3200, 223.4},
           {1.3500, 30.1},   {1.3950, 1.4},    {1.4425, 51.6},   {1.4625, 97.0},   {1.4770, 97.3},
           {1.4970, 167.1},  {1.5200, 239.3},  {1.5390, 248.8},  {1.5580, 249.3},  {1.5780, 222.3},
           {1.5920, 227.3},  {1.6100, 210.5},  {1.6300, 224.7},  {1.6460, 215.9},  {1.6780, 202.8},
           {1.7400, 158.2},  {1.8000, 28.6},   {1.8600, 1.8},    {1.9200, 1.1},    {1.9600, 19.7},
           {1.9850, 84.9},   {2.0050, 25.0},   {2.0350, 92.5},   {2.0650, 56.3},   {2.1000, 82.7},
           {2.1480, 76.2},   {2.1980, 66.4},   {2.2700, 65.0},   {2.3600, 57.6},   {2.4500, 19.8},
           {2.4940, 17.0},   {2.5370, 3.0},    {2.9410, 4.0},    {2.9730, 7.0},    {3.0050, 6.0},
           {3.0560, 3.0},    {3.1320, 5.0},    {3.1560, 18.0},   {3.2040, 1.2},    {3.2450, 3.0},
           {3.3170, 12.0},   {3.3440, 3.0},    {3.4500, 12.2},   {3.5730, 11.0},   {3.7650, 9.0},
           {4.0450, 6.9}

          });

        return aSolarRadiation;
    }

    [[nodiscard]] std::shared_ptr<CSpectralSampleData> loadSampleData_1() const
    {
        return CSpectralSampleData::create(
          {{0.300, 0.0064, 0.0478, 0.1521}, {0.305, 0.0138, 0.0479, 0.1462},
           {0.310, 0.0243, 0.0487, 0.1536}, {0.315, 0.0373, 0.0546, 0.1713},
           {0.320, 0.0475, 0.0617, 0.1883}, {0.325, 0.0554, 0.0709, 0.2067},
           {0.330, 0.061, 0.0827, 0.2249},  {0.335, 0.0664, 0.0982, 0.2419},
           {0.340, 0.0703, 0.1189, 0.2539}, {0.345, 0.0786, 0.1435, 0.2815},
           {0.350, 0.0961, 0.166, 0.3007},  {0.355, 0.1192, 0.1841, 0.3183},
           {0.360, 0.1531, 0.1922, 0.3328}, {0.365, 0.1931, 0.189, 0.3284},
           {0.370, 0.2369, 0.1803, 0.3201}, {0.375, 0.2885, 0.1639, 0.2998},
           {0.380, 0.3397, 0.1438, 0.2694}, {0.385, 0.3873, 0.123, 0.2349},
           {0.390, 0.4283, 0.1032, 0.2021}, {0.395, 0.4637, 0.0858, 0.1725},
           {0.400, 0.494, 0.0718, 0.1473},  {0.405, 0.5183, 0.0614, 0.1271},
           {0.410, 0.5371, 0.0543, 0.1119}, {0.415, 0.5518, 0.0498, 0.1005},
           {0.420, 0.5618, 0.0475, 0.0921}, {0.425, 0.5677, 0.0467, 0.086},
           {0.430, 0.5711, 0.0469, 0.0814}, {0.435, 0.5744, 0.048, 0.0777},
           {0.440, 0.5775, 0.0494, 0.0746}, {0.445, 0.5797, 0.051, 0.0718},
           {0.450, 0.5834, 0.0527, 0.0693}, {0.455, 0.5875, 0.0547, 0.0673},
           {0.460, 0.5922, 0.0565, 0.0657}, {0.465, 0.5955, 0.0582, 0.0641},
           {0.470, 0.5997, 0.06, 0.063},    {0.475, 0.604, 0.0619, 0.0624},
           {0.480, 0.6072, 0.0636, 0.0621}, {0.485, 0.6107, 0.0652, 0.0622},
           {0.490, 0.6133, 0.0669, 0.0629}, {0.495, 0.6159, 0.0686, 0.0639},
           {0.500, 0.6173, 0.07, 0.0653},   {0.505, 0.6179, 0.0714, 0.0669},
           {0.510, 0.6191, 0.0726, 0.0692}, {0.515, 0.6193, 0.0736, 0.0717},
           {0.520, 0.6191, 0.0744, 0.0746}, {0.525, 0.6177, 0.0748, 0.0779},
           {0.530, 0.6154, 0.075, 0.0817},  {0.535, 0.6129, 0.0748, 0.0858},
           {0.540, 0.6102, 0.0741, 0.0902}, {0.545, 0.6071, 0.0733, 0.0948},
           {0.550, 0.6045, 0.0721, 0.0995}, {0.555, 0.6028, 0.071, 0.1044},
           {0.560, 0.6012, 0.0698, 0.1093}, {0.565, 0.6001, 0.069, 0.1144},
           {0.570, 0.5993, 0.0684, 0.1197}, {0.575, 0.598, 0.0681, 0.1252},
           {0.580, 0.5963, 0.0678, 0.1308}, {0.585, 0.5949, 0.0677, 0.1364},
           {0.590, 0.5931, 0.0679, 0.1422}, {0.595, 0.5911, 0.068, 0.1478},
           {0.600, 0.5894, 0.0682, 0.1532}, {0.605, 0.5883, 0.0685, 0.1585},
           {0.610, 0.5873, 0.0692, 0.1637}, {0.615, 0.5868, 0.0702, 0.1687},
           {0.620, 0.5868, 0.0719, 0.1739}, {0.625, 0.5863, 0.0736, 0.1788},
           {0.630, 0.5848, 0.0752, 0.1836}, {0.635, 0.5824, 0.0768, 0.1887},
           {0.640, 0.5795, 0.0782, 0.194},  {0.645, 0.5763, 0.0793, 0.1993},
           {0.650, 0.5721, 0.0801, 0.2045}, {0.655, 0.5675, 0.0806, 0.2095},
           {0.660, 0.5629, 0.0809, 0.2146}, {0.665, 0.5575, 0.081, 0.2197},
           {0.670, 0.5529, 0.081, 0.2246},  {0.675, 0.5479, 0.0813, 0.2295},
           {0.680, 0.5434, 0.0815, 0.2346}, {0.685, 0.5386, 0.0818, 0.2398},
           {0.690, 0.5337, 0.0819, 0.2449}, {0.695, 0.5282, 0.0822, 0.2504},
           {0.700, 0.5227, 0.0822, 0.2559}, {0.705, 0.5169, 0.0821, 0.2616},
           {0.710, 0.5102, 0.0816, 0.2677}, {0.715, 0.503, 0.0809, 0.2735},
           {0.720, 0.4957, 0.0799, 0.2796}, {0.725, 0.4881, 0.0789, 0.2863},
           {0.730, 0.4803, 0.0776, 0.2929}, {0.735, 0.4719, 0.0761, 0.2992},
           {0.740, 0.4635, 0.0747, 0.3055}, {0.745, 0.456, 0.0734, 0.3122},
           {0.750, 0.4491, 0.0726, 0.3182}, {0.755, 0.4431, 0.0722, 0.3242},
           {0.760, 0.4381, 0.0724, 0.3295}, {0.765, 0.4344, 0.0733, 0.3341},
           {0.770, 0.4325, 0.075, 0.3379},  {0.775, 0.4329, 0.0778, 0.3411},
           {0.780, 0.4353, 0.0817, 0.343},  {0.785, 0.4406, 0.0869, 0.3437},
           {0.790, 0.4479, 0.0931, 0.3429}, {0.795, 0.4579, 0.1008, 0.3414},
           {0.800, 0.4698, 0.1096, 0.3386}, {0.805, 0.4837, 0.119, 0.3343},
           {0.810, 0.4981, 0.129, 0.3295},  {0.815, 0.5135, 0.1389, 0.3246},
           {0.820, 0.5278, 0.1486, 0.3193}, {0.825, 0.5405, 0.1573, 0.314},
           {0.830, 0.5518, 0.1652, 0.31},   {0.835, 0.5609, 0.1722, 0.3069},
           {0.840, 0.5687, 0.178, 0.3043},  {0.845, 0.5734, 0.1825, 0.3024},
           {0.850, 0.5773, 0.1863, 0.3017}, {0.855, 0.5779, 0.1902, 0.3018},
           {0.860, 0.5787, 0.1938, 0.3045}, {0.865, 0.5726, 0.199, 0.3084},
           {0.870, 0.5742, 0.2072, 0.3147}, {0.875, 0.5749, 0.1988, 0.3127},
           {0.880, 0.5727, 0.2017, 0.315},  {0.885, 0.5688, 0.2074, 0.3166},
           {0.890, 0.564, 0.2116, 0.3181},  {0.895, 0.561, 0.2101, 0.3227},
           {0.900, 0.5562, 0.2091, 0.3256}, {0.905, 0.5549, 0.2165, 0.3291},
           {0.910, 0.5455, 0.2166, 0.3354}, {0.915, 0.5423, 0.2178, 0.3365},
           {0.920, 0.5391, 0.2228, 0.3415}, {0.925, 0.5325, 0.2229, 0.3475},
           {0.930, 0.5261, 0.2285, 0.3521}, {0.935, 0.5216, 0.2288, 0.3562},
           {0.940, 0.515, 0.2332, 0.3608},  {0.945, 0.5108, 0.2389, 0.3685},
           {0.950, 0.5044, 0.2406, 0.373},  {0.955, 0.4983, 0.2437, 0.3757},
           {0.960, 0.492, 0.2496, 0.3839},  {0.965, 0.4872, 0.2529, 0.3894},
           {0.970, 0.4789, 0.257, 0.3955},  {0.975, 0.474, 0.262, 0.4013},
           {0.980, 0.4664, 0.2655, 0.4074}, {0.985, 0.4621, 0.2711, 0.4143},
           {0.990, 0.4555, 0.2745, 0.4196}, {0.995, 0.4484, 0.2804, 0.4268},
           {1.000, 0.4425, 0.2849, 0.4331}, {1.005, 0.4374, 0.2928, 0.4421},
           {1.010, 0.4289, 0.2954, 0.4454}, {1.015, 0.4223, 0.3013, 0.4529},
           {1.020, 0.4156, 0.3057, 0.4589}, {1.025, 0.4097, 0.3131, 0.4667},
           {1.030, 0.403, 0.3175, 0.4736},  {1.035, 0.3963, 0.3224, 0.4796},
           {1.040, 0.3909, 0.3288, 0.4862}, {1.045, 0.3854, 0.3352, 0.4936},
           {1.050, 0.3777, 0.3401, 0.4989}, {1.055, 0.3705, 0.3443, 0.5054},
           {1.060, 0.364, 0.3498, 0.5114},  {1.065, 0.3591, 0.3564, 0.5192},
           {1.070, 0.3536, 0.3628, 0.5257}, {1.075, 0.3472, 0.3675, 0.5314},
           {1.080, 0.3399, 0.3731, 0.5376}, {1.085, 0.3355, 0.3797, 0.5454},
           {1.090, 0.3292, 0.3848, 0.5513}, {1.095, 0.3233, 0.3906, 0.5568},
           {1.100, 0.3172, 0.3957, 0.5643}, {1.105, 0.311, 0.4012, 0.5696},
           {1.110, 0.3063, 0.4063, 0.576},  {1.115, 0.301, 0.4121, 0.5817},
           {1.120, 0.2944, 0.4169, 0.5881}, {1.125, 0.2895, 0.4234, 0.5939},
           {1.130, 0.2856, 0.4286, 0.6002}, {1.135, 0.2795, 0.4338, 0.6057},
           {1.140, 0.2748, 0.4386, 0.6112}, {1.145, 0.269, 0.4432, 0.6167},
           {1.150, 0.2648, 0.4488, 0.6227}, {1.155, 0.2596, 0.4541, 0.6285},
           {1.160, 0.2538, 0.4574, 0.6328}, {1.165, 0.2502, 0.4625, 0.6383},
           {1.170, 0.2461, 0.468, 0.6436},  {1.175, 0.2414, 0.4714, 0.6478},
           {1.180, 0.2369, 0.4761, 0.6535}, {1.185, 0.233, 0.4806, 0.658},
           {1.190, 0.2281, 0.4847, 0.6625}, {1.195, 0.2239, 0.4884, 0.6672},
           {1.200, 0.2193, 0.4917, 0.6711}, {1.205, 0.2161, 0.4964, 0.6755},
           {1.210, 0.2126, 0.5, 0.6798},    {1.215, 0.2077, 0.5036, 0.6844},
           {1.220, 0.205, 0.5078, 0.6888},  {1.225, 0.2012, 0.5123, 0.6933},
           {1.230, 0.1967, 0.5151, 0.697},  {1.235, 0.1941, 0.5192, 0.7013},
           {1.240, 0.1898, 0.5223, 0.7054}, {1.245, 0.1873, 0.5269, 0.7096},
           {1.250, 0.183, 0.5293, 0.7132},  {1.255, 0.1806, 0.5329, 0.7171},
           {1.260, 0.1776, 0.5375, 0.7209}, {1.265, 0.1745, 0.5413, 0.7243},
           {1.270, 0.1716, 0.5447, 0.728},  {1.275, 0.1685, 0.5485, 0.7321},
           {1.280, 0.1669, 0.5532, 0.7364}, {1.285, 0.1631, 0.5555, 0.7388},
           {1.290, 0.1601, 0.5593, 0.7414}, {1.295, 0.1577, 0.5631, 0.7454},
           {1.300, 0.1551, 0.5662, 0.7482}, {1.305, 0.1533, 0.5703, 0.752},
           {1.310, 0.1498, 0.5725, 0.7538}, {1.315, 0.1477, 0.5762, 0.7575},
           {1.320, 0.1459, 0.5801, 0.7608}, {1.325, 0.1432, 0.5832, 0.7635},
           {1.330, 0.1411, 0.5854, 0.7653}, {1.335, 0.1383, 0.5883, 0.7676},
           {1.340, 0.1367, 0.5924, 0.7715}, {1.345, 0.1353, 0.5948, 0.773},
           {1.350, 0.1326, 0.5979, 0.7754}, {1.355, 0.131, 0.6016, 0.7786},
           {1.360, 0.1289, 0.6039, 0.7803}, {1.365, 0.1263, 0.6076, 0.7825},
           {1.370, 0.1243, 0.6102, 0.7844}, {1.375, 0.1231, 0.6133, 0.7871},
           {1.380, 0.1233, 0.6171, 0.7902}, {1.385, 0.1201, 0.62, 0.7923},
           {1.390, 0.1166, 0.623, 0.7954},  {1.395, 0.1159, 0.6257, 0.7967},
           {1.400, 0.1146, 0.6282, 0.7993}, {1.405, 0.1135, 0.6316, 0.8016},
           {1.410, 0.1104, 0.6333, 0.8033}, {1.415, 0.11, 0.6356, 0.8048},
           {1.420, 0.1088, 0.6384, 0.8063}, {1.425, 0.1075, 0.6413, 0.8088},
           {1.430, 0.1057, 0.6436, 0.8106}, {1.435, 0.1033, 0.6458, 0.8123},
           {1.440, 0.1023, 0.6483, 0.8133}, {1.445, 0.1019, 0.651, 0.8154},
           {1.450, 0.0989, 0.6526, 0.8166}, {1.455, 0.0982, 0.6557, 0.8185},
           {1.460, 0.0982, 0.6593, 0.8215}, {1.465, 0.0957, 0.6611, 0.8229},
           {1.470, 0.0941, 0.6633, 0.8246}, {1.475, 0.0932, 0.6654, 0.8262},
           {1.480, 0.0915, 0.667, 0.8274},  {1.485, 0.0904, 0.6694, 0.8284},
           {1.490, 0.0901, 0.6722, 0.8299}, {1.495, 0.0891, 0.6745, 0.8319},
           {1.500, 0.0867, 0.6767, 0.8331}, {1.505, 0.0868, 0.6796, 0.835},
           {1.510, 0.0854, 0.6815, 0.836},  {1.515, 0.0834, 0.6822, 0.8367},
           {1.520, 0.083, 0.6837, 0.8376},  {1.525, 0.0818, 0.6862, 0.8396},
           {1.530, 0.0801, 0.6882, 0.8409}, {1.535, 0.0802, 0.6892, 0.8411},
           {1.540, 0.0788, 0.6916, 0.8428}, {1.545, 0.0777, 0.6938, 0.8449},
           {1.550, 0.0774, 0.6949, 0.8458}, {1.555, 0.076, 0.6968, 0.847},
           {1.560, 0.0754, 0.6986, 0.8477}, {1.565, 0.0739, 0.6999, 0.848},
           {1.570, 0.0736, 0.7023, 0.8494}, {1.575, 0.0725, 0.7038, 0.8509},
           {1.580, 0.0723, 0.7057, 0.8522}, {1.585, 0.0714, 0.7076, 0.854},
           {1.590, 0.0684, 0.7077, 0.8544}, {1.595, 0.069, 0.7099, 0.8564},
           {1.600, 0.0692, 0.7129, 0.8586}, {1.605, 0.0671, 0.7134, 0.8594},
           {1.610, 0.0659, 0.7152, 0.8594}, {1.615, 0.0652, 0.7155, 0.8598},
           {1.620, 0.0648, 0.7171, 0.8613}, {1.625, 0.0652, 0.7201, 0.8626},
           {1.630, 0.0631, 0.7206, 0.863},  {1.635, 0.0614, 0.7208, 0.8634},
           {1.640, 0.0639, 0.7225, 0.8646}, {1.645, 0.064, 0.7243, 0.8651},
           {1.650, 0.0618, 0.7259, 0.8657}, {1.655, 0.0598, 0.7267, 0.8673},
           {1.660, 0.0593, 0.7281, 0.8697}, {1.665, 0.0574, 0.7289, 0.8701},
           {1.670, 0.0585, 0.7311, 0.8711}, {1.675, 0.0593, 0.7322, 0.8715},
           {1.680, 0.0563, 0.7312, 0.8711}, {1.685, 0.0562, 0.7325, 0.8722},
           {1.690, 0.0569, 0.7348, 0.8739}, {1.695, 0.0568, 0.7372, 0.8758},
           {1.700, 0.0542, 0.7376, 0.8762}, {1.705, 0.0515, 0.7358, 0.8746},
           {1.710, 0.0532, 0.7375, 0.8758}, {1.715, 0.0533, 0.7395, 0.877},
           {1.720, 0.0516, 0.7405, 0.8779}, {1.725, 0.0514, 0.7416, 0.8803},
           {1.730, 0.0508, 0.7414, 0.881},  {1.735, 0.0509, 0.7432, 0.8811},
           {1.740, 0.0507, 0.7444, 0.8815}, {1.745, 0.0478, 0.7435, 0.8817},
           {1.750, 0.0487, 0.7448, 0.882},  {1.755, 0.0497, 0.7465, 0.8812},
           {1.760, 0.0499, 0.7475, 0.8821}, {1.765, 0.0486, 0.7475, 0.8835},
           {1.770, 0.0459, 0.7491, 0.8855}, {1.775, 0.0453, 0.7524, 0.8879},
           {1.780, 0.0453, 0.7512, 0.8856}, {1.785, 0.0449, 0.7518, 0.8853},
           {1.790, 0.0455, 0.7533, 0.8879}, {1.795, 0.0458, 0.7527, 0.8878},
           {1.800, 0.0444, 0.7535, 0.8884}, {1.805, 0.0435, 0.7551, 0.8893},
           {1.810, 0.0452, 0.7557, 0.8896}, {1.815, 0.0435, 0.756, 0.89},
           {1.820, 0.0408, 0.7567, 0.8907}, {1.825, 0.0416, 0.7564, 0.8899},
           {1.830, 0.0416, 0.7582, 0.8918}, {1.835, 0.0421, 0.7594, 0.893},
           {1.840, 0.0421, 0.7597, 0.8927}, {1.845, 0.0412, 0.7595, 0.8919},
           {1.850, 0.0397, 0.7615, 0.8935}, {1.855, 0.038, 0.7618, 0.8942},
           {1.860, 0.0407, 0.7634, 0.8968}, {1.865, 0.0417, 0.7639, 0.8974},
           {1.870, 0.0403, 0.7639, 0.8978}, {1.875, 0.0388, 0.7647, 0.8986},
           {1.880, 0.0371, 0.7638, 0.8964}, {1.885, 0.0386, 0.7661, 0.8974},
           {1.890, 0.0372, 0.7672, 0.8989}, {1.895, 0.0393, 0.7679, 0.8977},
           {1.900, 0.0364, 0.7682, 0.8988}, {1.905, 0.0375, 0.769, 0.9004},
           {1.910, 0.0387, 0.7693, 0.9001}, {1.915, 0.0351, 0.7707, 0.9},
           {1.920, 0.0348, 0.772, 0.9007},  {1.925, 0.0337, 0.7714, 0.901},
           {1.930, 0.0345, 0.7721, 0.9026}, {1.935, 0.0369, 0.7728, 0.9028},
           {1.940, 0.0358, 0.7715, 0.9011}, {1.945, 0.0321, 0.7719, 0.9019},
           {1.950, 0.0321, 0.7735, 0.9031}, {1.955, 0.034, 0.7751, 0.9048},
           {1.960, 0.0332, 0.7743, 0.9041}, {1.965, 0.0304, 0.7742, 0.9025},
           {1.970, 0.0334, 0.7756, 0.9044}, {1.975, 0.0341, 0.7778, 0.9075},
           {1.980, 0.0328, 0.7792, 0.9068}, {1.985, 0.0317, 0.7769, 0.9054},
           {1.990, 0.0321, 0.7799, 0.9076}, {1.995, 0.0325, 0.7807, 0.909},
           {2.000, 0.0309, 0.779, 0.9077},  {2.005, 0.029, 0.7781, 0.9064},
           {2.010, 0.0301, 0.7783, 0.9038}, {2.015, 0.0319, 0.7788, 0.9049},
           {2.020, 0.0326, 0.7798, 0.9069}, {2.025, 0.0305, 0.7802, 0.9086},
           {2.030, 0.0311, 0.783, 0.9097},  {2.035, 0.029, 0.7865, 0.9112},
           {2.040, 0.0267, 0.7862, 0.9118}, {2.045, 0.0282, 0.7846, 0.9109},
           {2.050, 0.0269, 0.7844, 0.9128}, {2.055, 0.0341, 0.7853, 0.9128},
           {2.060, 0.0327, 0.7865, 0.9127}, {2.065, 0.0238, 0.7859, 0.9106},
           {2.070, 0.0253, 0.7832, 0.9068}, {2.075, 0.0307, 0.7878, 0.9135},
           {2.080, 0.0284, 0.7877, 0.9119}, {2.085, 0.0259, 0.7855, 0.9086},
           {2.090, 0.0251, 0.7875, 0.909},  {2.095, 0.0269, 0.7917, 0.9156},
           {2.100, 0.03, 0.7939, 0.9205},   {2.105, 0.0249, 0.7907, 0.9137},
           {2.110, 0.0215, 0.7883, 0.9128}, {2.115, 0.0268, 0.7929, 0.9158},
           {2.120, 0.0278, 0.7953, 0.9203}, {2.125, 0.023, 0.7921, 0.9103},
           {2.130, 0.0133, 0.7847, 0.9095}, {2.135, 0.0238, 0.7872, 0.9144},
           {2.140, 0.0293, 0.7926, 0.9165}, {2.145, 0.0304, 0.7891, 0.9142},
           {2.150, 0.0228, 0.795, 0.9188},  {2.155, 0.0259, 0.7911, 0.9129},
           {2.160, 0.0231, 0.7894, 0.9151}, {2.165, 0.0256, 0.7898, 0.912},
           {2.170, 0.0197, 0.7933, 0.9196}, {2.175, 0.026, 0.7902, 0.9191},
           {2.180, 0.0303, 0.7936, 0.9193}, {2.185, 0.0279, 0.7907, 0.914},
           {2.190, 0.0223, 0.7904, 0.9165}, {2.195, 0.019, 0.7965, 0.9228},
           {2.200, 0.0254, 0.7929, 0.9182}, {2.205, 0.0184, 0.794, 0.9178},
           {2.210, 0.0237, 0.7999, 0.925},  {2.215, 0.022, 0.7921, 0.9202},
           {2.220, 0.0237, 0.7941, 0.9195}, {2.225, 0.0244, 0.7942, 0.9205},
           {2.230, 0.0241, 0.7913, 0.9189}, {2.235, 0.0151, 0.7905, 0.9218},
           {2.240, 0.0234, 0.7968, 0.9222}, {2.245, 0.0233, 0.8001, 0.9258},
           {2.250, 0.0155, 0.793, 0.9191},  {2.255, 0.0214, 0.7962, 0.9179},
           {2.260, 0.0253, 0.8006, 0.9205}, {2.265, 0.0159, 0.7991, 0.9199},
           {2.270, 0.0254, 0.7994, 0.9218}, {2.275, 0.0155, 0.7948, 0.9187},
           {2.280, 0.0179, 0.7955, 0.9197}, {2.285, 0.0287, 0.7916, 0.9165},
           {2.290, 0.0145, 0.7991, 0.9257}, {2.295, 0.0194, 0.8068, 0.932},
           {2.300, 0.0208, 0.8043, 0.923},  {2.305, 0.0232, 0.8005, 0.9232},
           {2.310, 0.0149, 0.7987, 0.9179}, {2.315, 0.0212, 0.8089, 0.9272},
           {2.320, 0.0192, 0.8114, 0.9279}, {2.325, 0.012, 0.8056, 0.9236},
           {2.330, 0.0221, 0.8038, 0.9246}, {2.335, 0.0088, 0.8018, 0.9209},
           {2.340, 0.0207, 0.8054, 0.9198}, {2.345, 0.0104, 0.7986, 0.9161},
           {2.350, 0.0197, 0.8127, 0.9346}, {2.355, 0.0261, 0.8044, 0.9294},
           {2.360, 0.016, 0.8057, 0.9325},  {2.365, 0.0047, 0.8038, 0.9231},
           {2.370, 0.0261, 0.8114, 0.9251}, {2.375, 0.0134, 0.8022, 0.92},
           {2.380, 0.0145, 0.8063, 0.9289}, {2.385, 0.0184, 0.8153, 0.9303},
           {2.390, 0.0236, 0.8156, 0.9326}, {2.395, 0.0038, 0.8096, 0.9427},
           {2.400, 0.0288, 0.8113, 0.9283}, {2.405, 0.014, 0.8152, 0.937},
           {2.410, 0.0152, 0.8057, 0.9282}, {2.415, 0.0244, 0.8115, 0.9353},
           {2.420, 0.0197, 0.8104, 0.9297}, {2.425, 0.0141, 0.8077, 0.9199},
           {2.430, 0.0001, 0.7872, 0.9047}, {2.435, 0.0184, 0.8157, 0.9433},
           {2.440, 0.0266, 0.8107, 0.938},  {2.445, 0.0102, 0.7984, 0.9213},
           {2.450, 0, 0.8105, 0.9336},      {2.455, 0.0141, 0.8001, 0.9306},
           {2.460, 0.0223, 0.8143, 0.9288}, {2.465, 0, 0.811, 0.9457},
           {2.470, 0.0109, 0.8167, 0.9401}, {2.475, 0.0158, 0.8213, 0.9488},
           {2.480, 0.0192, 0.8051, 0.9282}, {2.485, 0.0288, 0.791, 0.9238},
           {2.490, 0, 0.8001, 0.9172},      {2.495, 0.0259, 0.7961, 0.9389},
           {2.500, 0, 0.8108, 0.9309}});
    }

    [[nodiscard]] std::shared_ptr<CSpectralSampleData> loadSampleData_2() const
    {
        return CSpectralSampleData::create(
          {{0.3, 0.002, 0.047, 0.048},   {0.305, 0.003, 0.047, 0.048}, {0.31, 0.009, 0.047, 0.048},
           {0.315, 0.035, 0.047, 0.048}, {0.32, 0.1, 0.047, 0.048},    {0.325, 0.218, 0.049, 0.05},
           {0.33, 0.356, 0.053, 0.054},  {0.335, 0.498, 0.06, 0.061},  {0.34, 0.616, 0.067, 0.067},
           {0.345, 0.709, 0.073, 0.074}, {0.35, 0.774, 0.078, 0.079},  {0.355, 0.818, 0.082, 0.082},
           {0.36, 0.847, 0.084, 0.084},  {0.365, 0.863, 0.085, 0.085}, {0.37, 0.869, 0.085, 0.086},
           {0.375, 0.861, 0.085, 0.085}, {0.38, 0.856, 0.084, 0.084},  {0.385, 0.866, 0.085, 0.085},
           {0.39, 0.881, 0.086, 0.086},  {0.395, 0.889, 0.086, 0.086}, {0.4, 0.893, 0.086, 0.086},
           {0.41, 0.893, 0.086, 0.086},  {0.42, 0.892, 0.086, 0.086},  {0.43, 0.892, 0.085, 0.085},
           {0.44, 0.892, 0.085, 0.085},  {0.45, 0.896, 0.085, 0.085},  {0.46, 0.9, 0.085, 0.085},
           {0.47, 0.902, 0.084, 0.084},  {0.48, 0.903, 0.084, 0.084},  {0.49, 0.904, 0.085, 0.085},
           {0.5, 0.905, 0.084, 0.084},   {0.51, 0.905, 0.084, 0.084},  {0.52, 0.905, 0.084, 0.084},
           {0.53, 0.904, 0.084, 0.084},  {0.54, 0.904, 0.083, 0.083},  {0.55, 0.903, 0.083, 0.083},
           {0.56, 0.902, 0.083, 0.083},  {0.57, 0.9, 0.082, 0.082},    {0.58, 0.898, 0.082, 0.082},
           {0.59, 0.896, 0.081, 0.081},  {0.6, 0.893, 0.081, 0.081},   {0.61, 0.89, 0.081, 0.081},
           {0.62, 0.886, 0.08, 0.08},    {0.63, 0.883, 0.08, 0.08},    {0.64, 0.879, 0.079, 0.079},
           {0.65, 0.875, 0.079, 0.079},  {0.66, 0.872, 0.079, 0.079},  {0.67, 0.868, 0.078, 0.078},
           {0.68, 0.863, 0.078, 0.078},  {0.69, 0.859, 0.077, 0.077},  {0.7, 0.854, 0.076, 0.077},
           {0.71, 0.85, 0.076, 0.076},   {0.72, 0.845, 0.075, 0.076},  {0.73, 0.84, 0.075, 0.075},
           {0.74, 0.835, 0.075, 0.075},  {0.75, 0.831, 0.074, 0.074},  {0.76, 0.826, 0.074, 0.074},
           {0.77, 0.821, 0.074, 0.074},  {0.78, 0.816, 0.073, 0.073},  {0.79, 0.812, 0.073, 0.073},
           {0.8, 0.808, 0.072, 0.072},   {0.81, 0.803, 0.072, 0.072},  {0.82, 0.8, 0.072, 0.072},
           {0.83, 0.796, 0.071, 0.071},  {0.84, 0.793, 0.07, 0.071},   {0.85, 0.788, 0.07, 0.071},
           {0.86, 0.786, 0.07, 0.07},    {0.87, 0.782, 0.074, 0.074},  {0.88, 0.78, 0.072, 0.072},
           {0.89, 0.777, 0.073, 0.074},  {0.9, 0.776, 0.072, 0.072},   {0.91, 0.773, 0.072, 0.072},
           {0.92, 0.771, 0.071, 0.071},  {0.93, 0.77, 0.07, 0.07},     {0.94, 0.768, 0.069, 0.069},
           {0.95, 0.766, 0.068, 0.068},  {0.96, 0.766, 0.067, 0.068},  {0.97, 0.764, 0.068, 0.068},
           {0.98, 0.763, 0.068, 0.068},  {0.99, 0.762, 0.067, 0.067},  {1, 0.762, 0.066, 0.067},
           {1.05, 0.76, 0.066, 0.066},   {1.1, 0.759, 0.066, 0.066},   {1.15, 0.761, 0.066, 0.066},
           {1.2, 0.765, 0.066, 0.066},   {1.25, 0.77, 0.065, 0.065},   {1.3, 0.777, 0.067, 0.067},
           {1.35, 0.786, 0.066, 0.067},  {1.4, 0.795, 0.067, 0.068},   {1.45, 0.808, 0.067, 0.067},
           {1.5, 0.819, 0.069, 0.069},   {1.55, 0.829, 0.069, 0.069},  {1.6, 0.836, 0.07, 0.07},
           {1.65, 0.84, 0.07, 0.07},     {1.7, 0.842, 0.069, 0.07},    {1.75, 0.842, 0.069, 0.07},
           {1.8, 0.841, 0.07, 0.07},     {1.85, 0.84, 0.069, 0.069},   {1.9, 0.839, 0.068, 0.068},
           {1.95, 0.839, 0.071, 0.071},  {2, 0.839, 0.069, 0.069},     {2.05, 0.84, 0.068, 0.068},
           {2.1, 0.841, 0.068, 0.068},   {2.15, 0.839, 0.069, 0.069},  {2.2, 0.83, 0.07, 0.07},
           {2.25, 0.83, 0.07, 0.07},     {2.3, 0.832, 0.069, 0.069},   {2.35, 0.832, 0.069, 0.07},
           {2.4, 0.832, 0.07, 0.07},     {2.45, 0.826, 0.069, 0.069},  {2.5, 0.822, 0.068, 0.068}});
    }

    static CSeries eqeFront()
    {
        CSeries eqe({{0.300, 0.00569},  {0.305, 0.036081}, {0.310, 0.098415}, {0.315, 0.140809},
                     {0.320, 0.175428}, {0.325, 0.22063},  {0.330, 0.271745}, {0.335, 0.324105},
                     {0.340, 0.364687}, {0.345, 0.387123}, {0.350, 0.393164}, {0.355, 0.381717},
                     {0.360, 0.378066}, {0.365, 0.368147}, {0.370, 0.343396}, {0.375, 0.326597},
                     {0.380, 0.295813}, {0.385, 0.278894}, {0.390, 0.267678}, {0.395, 0.254845},
                     {0.400, 0.247495}, {0.405, 0.245735}, {0.410, 0.24205},  {0.415, 0.237753},
                     {0.420, 0.233943}, {0.425, 0.232813}, {0.430, 0.231604}, {0.435, 0.228474},
                     {0.440, 0.222221}, {0.445, 0.218546}, {0.450, 0.20864},  {0.455, 0.203837},
                     {0.460, 0.193092}, {0.465, 0.183282}, {0.470, 0.173378}, {0.475, 0.164734},
                     {0.480, 0.153668}, {0.485, 0.143934}, {0.490, 0.133364}, {0.495, 0.122443},
                     {0.500, 0.111509}, {0.505, 0.101311}, {0.510, 0.072048}, {0.515, 0.081689},
                     {0.520, 0.073833}, {0.525, 0.066798}, {0.530, 0.061911}, {0.535, 0.057746},
                     {0.540, 0.055444}, {0.545, 0.053358}, {0.550, 0.052742}, {0.555, 0.05196},
                     {0.560, 0.051268}, {0.565, 0.050969}, {0.570, 0.051342}, {0.575, 0.051644},
                     {0.580, 0.052066}, {0.585, 0.05306},  {0.590, 0.053879}, {0.595, 0.054867},
                     {0.600, 0.056239}, {0.605, 0.05857},  {0.610, 0.061447}, {0.615, 0.063297},
                     {0.620, 0.064221}, {0.625, 0.066032}, {0.630, 0.068444}, {0.635, 0.071138},
                     {0.640, 0.074686}, {0.645, 0.078706}, {0.650, 0.082899}, {0.655, 0.089178},
                     {0.660, 0.09577},  {0.665, 0.103082}, {0.670, 0.112038}, {0.675, 0.119977},
                     {0.680, 0.129053}, {0.685, 0.136601}, {0.690, 0.145948}, {0.695, 0.165281},
                     {0.700, 0.174518}, {0.705, 0.185099}, {0.710, 0.193299}, {0.715, 0.202065},
                     {0.720, 0.213326}, {0.725, 0.223407}, {0.730, 0.231185}, {0.735, 0.240227},
                     {0.740, 0.249194}, {0.745, 0.256674}, {0.750, 0.262732}, {0.755, 0.268445},
                     {0.760, 0.270325}, {0.765, 0.26647},  {0.770, 0.268659}, {0.775, 0.262065},
                     {0.780, 0.253562}, {0.785, 0.240409}, {0.790, 0.224249}, {0.795, 0.206873},
                     {0.800, 0.184883}, {0.805, 0.163541}, {0.810, 0.140102}, {0.815, 0.121169},
                     {0.820, 0.104982}, {0.825, 0.081561}, {0.830, 0.065268}, {0.835, 0.05001},
                     {0.840, 0.038557}, {0.845, 0.028609}, {0.850, 0.021159}, {0.855, 0.015577},
                     {0.860, 0.011237}, {0.865, 0.006077}, {0.870, 0.006142}, {0.875, 0.005064},
                     {0.880, 0.004842}, {0.885, 0.002383}, {0.890, 0.001794}, {0.895, 0.001129},
                     {0.900, 0.000768}, {0.905, 0.000219}, {0.910, 0.000001}, {0.915, 0.000259},
                     {0.920, 0},        {0.925, 0},        {0.930, 0},        {0.935, 0},
                     {0.940, 0},        {0.945, 0},        {0.950, 0},        {0.955, 0},
                     {0.960, 0},        {0.965, 0},        {0.970, 0},        {0.975, 0},
                     {0.980, 0},        {0.985, 0},        {0.990, 0},        {0.995, 0},
                     {1.000, 0},        {1.005, 0},        {1.010, 0},        {1.015, 0},
                     {1.020, 0},        {1.025, 0},        {1.030, 0},        {1.035, 0},
                     {1.040, 0},        {1.045, 0},        {1.050, 0},        {1.055, 0},
                     {1.060, 0},        {1.065, 0},        {1.070, 0},        {1.075, 0},
                     {1.080, 0},        {1.085, 0},        {1.090, 0},        {1.095, 0},
                     {1.100, 0},        {1.105, 0},        {1.110, 0},        {1.115, 0},
                     {1.120, 0},        {1.125, 0},        {1.130, 0},        {1.135, 0},
                     {1.140, 0},        {1.145, 0},        {1.150, 0},        {1.155, 0},
                     {1.160, 0},        {1.165, 0},        {1.170, 0},        {1.175, 0},
                     {1.180, 0},        {1.185, 0},        {1.190, 0},        {1.195, 0},
                     {1.200, 0},        {1.205, 0},        {1.210, 0},        {1.215, 0},
                     {1.220, 0},        {1.225, 0},        {1.230, 0},        {1.235, 0},
                     {1.240, 0},        {1.245, 0},        {1.250, 0},        {1.255, 0},
                     {1.260, 0},        {1.265, 0},        {1.270, 0},        {1.275, 0},
                     {1.280, 0},        {1.285, 0},        {1.290, 0},        {1.295, 0},
                     {1.300, 0},        {1.305, 0},        {1.310, 0},        {1.315, 0},
                     {1.320, 0},        {1.325, 0},        {1.330, 0},        {1.335, 0},
                     {1.340, 0},        {1.345, 0},        {1.350, 0},        {1.355, 0},
                     {1.360, 0},        {1.365, 0},        {1.370, 0},        {1.375, 0},
                     {1.380, 0},        {1.385, 0},        {1.390, 0},        {1.395, 0},
                     {1.400, 0},        {1.405, 0},        {1.410, 0},        {1.415, 0},
                     {1.420, 0},        {1.425, 0},        {1.430, 0},        {1.435, 0},
                     {1.440, 0},        {1.445, 0},        {1.450, 0},        {1.455, 0},
                     {1.460, 0},        {1.465, 0},        {1.470, 0},        {1.475, 0},
                     {1.480, 0},        {1.485, 0},        {1.490, 0},        {1.495, 0},
                     {1.500, 0},        {1.505, 0},        {1.510, 0},        {1.515, 0},
                     {1.520, 0},        {1.525, 0},        {1.530, 0},        {1.535, 0},
                     {1.540, 0},        {1.545, 0},        {1.550, 0},        {1.555, 0},
                     {1.560, 0},        {1.565, 0},        {1.570, 0},        {1.575, 0},
                     {1.580, 0},        {1.585, 0},        {1.590, 0},        {1.595, 0},
                     {1.600, 0},        {1.605, 0},        {1.610, 0},        {1.615, 0},
                     {1.620, 0},        {1.625, 0},        {1.630, 0},        {1.635, 0},
                     {1.640, 0},        {1.645, 0},        {1.650, 0},        {1.655, 0},
                     {1.660, 0},        {1.665, 0},        {1.670, 0},        {1.675, 0},
                     {1.680, 0},        {1.685, 0},        {1.690, 0},        {1.695, 0},
                     {1.700, 0},        {1.705, 0},        {1.710, 0},        {1.715, 0},
                     {1.720, 0},        {1.725, 0},        {1.730, 0},        {1.735, 0},
                     {1.740, 0},        {1.745, 0},        {1.750, 0},        {1.755, 0},
                     {1.760, 0},        {1.765, 0},        {1.770, 0},        {1.775, 0},
                     {1.780, 0},        {1.785, 0},        {1.790, 0},        {1.795, 0},
                     {1.800, 0},        {1.805, 0},        {1.810, 0},        {1.815, 0},
                     {1.820, 0},        {1.825, 0},        {1.830, 0},        {1.835, 0},
                     {1.840, 0},        {1.845, 0},        {1.850, 0},        {1.855, 0},
                     {1.860, 0},        {1.865, 0},        {1.870, 0},        {1.875, 0},
                     {1.880, 0},        {1.885, 0},        {1.890, 0},        {1.895, 0},
                     {1.900, 0},        {1.905, 0},        {1.910, 0},        {1.915, 0},
                     {1.920, 0},        {1.925, 0},        {1.930, 0},        {1.935, 0},
                     {1.940, 0},        {1.945, 0},        {1.950, 0},        {1.955, 0},
                     {1.960, 0},        {1.965, 0},        {1.970, 0},        {1.975, 0},
                     {1.980, 0},        {1.985, 0},        {1.990, 0},        {1.995, 0},
                     {2.000, 0},        {2.005, 0},        {2.010, 0},        {2.015, 0},
                     {2.020, 0},        {2.025, 0},        {2.030, 0},        {2.035, 0},
                     {2.040, 0},        {2.045, 0},        {2.050, 0},        {2.055, 0},
                     {2.060, 0},        {2.065, 0},        {2.070, 0},        {2.075, 0},
                     {2.080, 0},        {2.085, 0},        {2.090, 0},        {2.095, 0},
                     {2.100, 0},        {2.105, 0},        {2.110, 0},        {2.115, 0},
                     {2.120, 0},        {2.125, 0},        {2.130, 0},        {2.135, 0},
                     {2.140, 0},        {2.145, 0},        {2.150, 0},        {2.155, 0},
                     {2.160, 0},        {2.165, 0},        {2.170, 0},        {2.175, 0},
                     {2.180, 0},        {2.185, 0},        {2.190, 0},        {2.195, 0},
                     {2.200, 0},        {2.205, 0},        {2.210, 0},        {2.215, 0},
                     {2.220, 0},        {2.225, 0},        {2.230, 0},        {2.235, 0},
                     {2.240, 0},        {2.245, 0},        {2.250, 0},        {2.255, 0},
                     {2.260, 0},        {2.265, 0},        {2.270, 0},        {2.275, 0},
                     {2.280, 0},        {2.285, 0},        {2.290, 0},        {2.295, 0},
                     {2.300, 0},        {2.305, 0},        {2.310, 0},        {2.315, 0},
                     {2.320, 0},        {2.325, 0},        {2.330, 0},        {2.335, 0},
                     {2.340, 0},        {2.345, 0},        {2.350, 0},        {2.355, 0},
                     {2.360, 0},        {2.365, 0},        {2.370, 0},        {2.375, 0},
                     {2.380, 0},        {2.385, 0},        {2.390, 0},        {2.395, 0},
                     {2.400, 0},        {2.405, 0},        {2.410, 0},        {2.415, 0},
                     {2.420, 0},        {2.425, 0},        {2.430, 0},        {2.435, 0},
                     {2.440, 0},        {2.445, 0},        {2.450, 0},        {2.455, 0},
                     {2.460, 0},        {2.465, 0},        {2.470, 0},        {2.475, 0},
                     {2.480, 0},        {2.485, 0},        {2.490, 0},        {2.495, 0},
                     {2.500, 0}});

        return eqe;
    }

    static CSeries eqeBack()
    {
        CSeries eqe({{0.300, 0},        {0.305, 0.024239}, {0.310, 0.031977}, {0.315, 0.033776},
                     {0.320, 0.036737}, {0.325, 0.042653}, {0.330, 0.053813}, {0.335, 0.071542},
                     {0.340, 0.086217}, {0.345, 0.093003}, {0.350, 0.105437}, {0.355, 0.108406},
                     {0.360, 0.114849}, {0.365, 0.123612}, {0.370, 0.1249},   {0.375, 0.130118},
                     {0.380, 0.129037}, {0.385, 0.128101}, {0.390, 0.127431}, {0.395, 0.125782},
                     {0.400, 0.125978}, {0.405, 0.127636}, {0.410, 0.129033}, {0.415, 0.129343},
                     {0.420, 0.129282}, {0.425, 0.129525}, {0.430, 0.129609}, {0.435, 0.128684},
                     {0.440, 0.125438}, {0.445, 0.122702}, {0.450, 0.118307}, {0.455, 0.11366},
                     {0.460, 0.108154}, {0.465, 0.102145}, {0.470, 0.095649}, {0.475, 0.089853},
                     {0.480, 0.082677}, {0.485, 0.076285}, {0.490, 0.069561}, {0.495, 0.062973},
                     {0.500, 0.056184}, {0.505, 0.050292}, {0.510, 0.044185}, {0.515, 0.039039},
                     {0.520, 0.034569}, {0.525, 0.030699}, {0.530, 0.027805}, {0.535, 0.025371},
                     {0.540, 0.02371},  {0.545, 0.022557}, {0.550, 0.021568}, {0.555, 0.020917},
                     {0.560, 0.020408}, {0.565, 0.019905}, {0.570, 0.019515}, {0.575, 0.01924},
                     {0.580, 0.019041}, {0.585, 0.018912}, {0.590, 0.018806}, {0.595, 0.018705},
                     {0.600, 0.018744}, {0.605, 0.019002}, {0.610, 0.019537}, {0.615, 0.020154},
                     {0.620, 0.02048},  {0.625, 0.020791}, {0.630, 0.020979}, {0.635, 0.021576},
                     {0.640, 0.022463}, {0.645, 0.023581}, {0.650, 0.024931}, {0.655, 0.026389},
                     {0.660, 0.028217}, {0.665, 0.030662}, {0.670, 0.033304}, {0.675, 0.035774},
                     {0.680, 0.03838},  {0.685, 0.041247}, {0.690, 0.044093}, {0.695, 0.048326},
                     {0.700, 0.051128}, {0.705, 0.054585}, {0.710, 0.057618}, {0.715, 0.059728},
                     {0.720, 0.062509}, {0.725, 0.06568},  {0.730, 0.068463}, {0.735, 0.070402},
                     {0.740, 0.072764}, {0.745, 0.074345}, {0.750, 0.075874}, {0.755, 0.077219},
                     {0.760, 0.079576}, {0.765, 0.075944}, {0.770, 0.075258}, {0.775, 0.07274},
                     {0.780, 0.069951}, {0.785, 0.066372}, {0.790, 0.061666}, {0.795, 0.056324},
                     {0.800, 0.049797}, {0.805, 0.043384}, {0.810, 0.036672}, {0.815, 0.031249},
                     {0.820, 0.028539}, {0.825, 0.022973}, {0.830, 0.016857}, {0.835, 0.013271},
                     {0.840, 0.008998}, {0.845, 0.003847}, {0.850, 0.001537}, {0.855, 0.000402},
                     {0.860, 0},        {0.865, 0},        {0.870, 0},        {0.875, 0.000152},
                     {0.880, 0.001018}, {0.885, 0},        {0.890, 0},        {0.895, 0},
                     {0.900, 0},        {0.905, 0},        {0.910, 0},        {0.915, 0},
                     {0.920, 0},        {0.925, 0},        {0.930, 0},        {0.935, 0},
                     {0.940, 0},        {0.945, 0},        {0.950, 0},        {0.955, 0},
                     {0.960, 0},        {0.965, 0},        {0.970, 0},        {0.975, 0},
                     {0.980, 0},        {0.985, 0},        {0.990, 0},        {0.995, 0},
                     {1.000, 0},        {1.005, 0},        {1.010, 0},        {1.015, 0},
                     {1.020, 0},        {1.025, 0},        {1.030, 0},        {1.035, 0},
                     {1.040, 0},        {1.045, 0},        {1.050, 0},        {1.055, 0},
                     {1.060, 0},        {1.065, 0},        {1.070, 0},        {1.075, 0},
                     {1.080, 0},        {1.085, 0},        {1.090, 0},        {1.095, 0},
                     {1.100, 0},        {1.105, 0},        {1.110, 0},        {1.115, 0},
                     {1.120, 0},        {1.125, 0},        {1.130, 0},        {1.135, 0},
                     {1.140, 0},        {1.145, 0},        {1.150, 0},        {1.155, 0},
                     {1.160, 0},        {1.165, 0},        {1.170, 0},        {1.175, 0},
                     {1.180, 0},        {1.185, 0},        {1.190, 0},        {1.195, 0},
                     {1.200, 0},        {1.205, 0},        {1.210, 0},        {1.215, 0},
                     {1.220, 0},        {1.225, 0},        {1.230, 0},        {1.235, 0},
                     {1.240, 0},        {1.245, 0},        {1.250, 0},        {1.255, 0},
                     {1.260, 0},        {1.265, 0},        {1.270, 0},        {1.275, 0},
                     {1.280, 0},        {1.285, 0},        {1.290, 0},        {1.295, 0},
                     {1.300, 0},        {1.305, 0},        {1.310, 0},        {1.315, 0},
                     {1.320, 0},        {1.325, 0},        {1.330, 0},        {1.335, 0},
                     {1.340, 0},        {1.345, 0},        {1.350, 0},        {1.355, 0},
                     {1.360, 0},        {1.365, 0},        {1.370, 0},        {1.375, 0},
                     {1.380, 0},        {1.385, 0},        {1.390, 0},        {1.395, 0},
                     {1.400, 0},        {1.405, 0},        {1.410, 0},        {1.415, 0},
                     {1.420, 0},        {1.425, 0},        {1.430, 0},        {1.435, 0},
                     {1.440, 0},        {1.445, 0},        {1.450, 0},        {1.455, 0},
                     {1.460, 0},        {1.465, 0},        {1.470, 0},        {1.475, 0},
                     {1.480, 0},        {1.485, 0},        {1.490, 0},        {1.495, 0},
                     {1.500, 0},        {1.505, 0},        {1.510, 0},        {1.515, 0},
                     {1.520, 0},        {1.525, 0},        {1.530, 0},        {1.535, 0},
                     {1.540, 0},        {1.545, 0},        {1.550, 0},        {1.555, 0},
                     {1.560, 0},        {1.565, 0},        {1.570, 0},        {1.575, 0},
                     {1.580, 0},        {1.585, 0},        {1.590, 0},        {1.595, 0},
                     {1.600, 0},        {1.605, 0},        {1.610, 0},        {1.615, 0},
                     {1.620, 0},        {1.625, 0},        {1.630, 0},        {1.635, 0},
                     {1.640, 0},        {1.645, 0},        {1.650, 0},        {1.655, 0},
                     {1.660, 0},        {1.665, 0},        {1.670, 0},        {1.675, 0},
                     {1.680, 0},        {1.685, 0},        {1.690, 0},        {1.695, 0},
                     {1.700, 0},        {1.705, 0},        {1.710, 0},        {1.715, 0},
                     {1.720, 0},        {1.725, 0},        {1.730, 0},        {1.735, 0},
                     {1.740, 0},        {1.745, 0},        {1.750, 0},        {1.755, 0},
                     {1.760, 0},        {1.765, 0},        {1.770, 0},        {1.775, 0},
                     {1.780, 0},        {1.785, 0},        {1.790, 0},        {1.795, 0},
                     {1.800, 0},        {1.805, 0},        {1.810, 0},        {1.815, 0},
                     {1.820, 0},        {1.825, 0},        {1.830, 0},        {1.835, 0},
                     {1.840, 0},        {1.845, 0},        {1.850, 0},        {1.855, 0},
                     {1.860, 0},        {1.865, 0},        {1.870, 0},        {1.875, 0},
                     {1.880, 0},        {1.885, 0},        {1.890, 0},        {1.895, 0},
                     {1.900, 0},        {1.905, 0},        {1.910, 0},        {1.915, 0},
                     {1.920, 0},        {1.925, 0},        {1.930, 0},        {1.935, 0},
                     {1.940, 0},        {1.945, 0},        {1.950, 0},        {1.955, 0},
                     {1.960, 0},        {1.965, 0},        {1.970, 0},        {1.975, 0},
                     {1.980, 0},        {1.985, 0},        {1.990, 0},        {1.995, 0},
                     {2.000, 0},        {2.005, 0},        {2.010, 0},        {2.015, 0},
                     {2.020, 0},        {2.025, 0},        {2.030, 0},        {2.035, 0},
                     {2.040, 0},        {2.045, 0},        {2.050, 0},        {2.055, 0},
                     {2.060, 0},        {2.065, 0},        {2.070, 0},        {2.075, 0},
                     {2.080, 0},        {2.085, 0},        {2.090, 0},        {2.095, 0},
                     {2.100, 0},        {2.105, 0},        {2.110, 0},        {2.115, 0},
                     {2.120, 0},        {2.125, 0},        {2.130, 0},        {2.135, 0},
                     {2.140, 0},        {2.145, 0},        {2.150, 0},        {2.155, 0},
                     {2.160, 0},        {2.165, 0},        {2.170, 0},        {2.175, 0},
                     {2.180, 0},        {2.185, 0},        {2.190, 0},        {2.195, 0},
                     {2.200, 0},        {2.205, 0},        {2.210, 0},        {2.215, 0},
                     {2.220, 0},        {2.225, 0},        {2.230, 0},        {2.235, 0},
                     {2.240, 0},        {2.245, 0},        {2.250, 0},        {2.255, 0},
                     {2.260, 0},        {2.265, 0},        {2.270, 0},        {2.275, 0},
                     {2.280, 0},        {2.285, 0},        {2.290, 0},        {2.295, 0},
                     {2.300, 0},        {2.305, 0},        {2.310, 0},        {2.315, 0},
                     {2.320, 0},        {2.325, 0},        {2.330, 0},        {2.335, 0},
                     {2.340, 0},        {2.345, 0},        {2.350, 0},        {2.355, 0},
                     {2.360, 0},        {2.365, 0},        {2.370, 0},        {2.375, 0},
                     {2.380, 0},        {2.385, 0},        {2.390, 0},        {2.395, 0},
                     {2.400, 0},        {2.405, 0},        {2.410, 0},        {2.415, 0},
                     {2.420, 0},        {2.425, 0},        {2.430, 0},        {2.435, 0},
                     {2.440, 0},        {2.445, 0},        {2.450, 0},        {2.455, 0},
                     {2.460, 0},        {2.465, 0},        {2.470, 0},        {2.475, 0},
                     {2.480, 0},        {2.485, 0},        {2.490, 0},        {2.495, 0},
                     {2.500, 0}});

        return eqe;
    }

    static SingleLayerOptics::PVPowerPropertiesTable table()
    {
        return {{{0.002478752, 0.550933333, 0.5467},
                 {0.002605841, 0.552778333, 0.5467415},
                 {0.002739445, 0.554623333, 0.546772667},
                 {0.002879899, 0.556468333, 0.5467935},
                 {0.003027555, 0.558313333, 0.546804},
                 {0.003182781, 0.560158333, 0.546804167},
                 {0.003345965, 0.562003333, 0.546794},
                 {0.003517517, 0.563848333, 0.5467735},
                 {0.003697864, 0.565693333, 0.546742667},
                 {0.003887457, 0.567538333, 0.5467015},
                 {0.004086771, 0.569383333, 0.54665},
                 {0.004296305, 0.571228333, 0.546588167},
                 {0.004516581, 0.573073333, 0.546516},
                 {0.004748151, 0.574918333, 0.5464335},
                 {0.004991594, 0.576763333, 0.546340667},
                 {0.005247518, 0.578608333, 0.5462375},
                 {0.005516564, 0.580453333, 0.546124},
                 {0.005799405, 0.582298333, 0.546000167},
                 {0.006096747, 0.584143333, 0.545866},
                 {0.006409333, 0.585988333, 0.5457215},
                 {0.006737947, 0.587833333, 0.545566667},
                 {0.007083409, 0.589678333, 0.5454015},
                 {0.007446583, 0.591523333, 0.545226},
                 {0.007828378, 0.593368333, 0.545040167},
                 {0.008229747, 0.595213333, 0.544844},
                 {0.008651695, 0.597058333, 0.5446375},
                 {0.009095277, 0.598903333, 0.544420667},
                 {0.009561602, 0.600748333, 0.5441935},
                 {0.010051836, 0.602593333, 0.543956},
                 {0.010567204, 0.604438333, 0.543708167},
                 {0.011108997, 0.606283333, 0.54345},
                 {0.011678567, 0.608128333, 0.5431815},
                 {0.01227734, 0.609973333, 0.542902667},
                 {0.012906813, 0.611818333, 0.5426135},
                 {0.013568559, 0.613663333, 0.542314},
                 {0.014264234, 0.615508333, 0.542004167},
                 {0.014995577, 0.617353333, 0.541684},
                 {0.015764416, 0.619198333, 0.5413535},
                 {0.016572675, 0.621043333, 0.541012667},
                 {0.017422375, 0.622888333, 0.5406615},
                 {0.018315639, 0.624733333, 0.5403},
                 {0.019254702, 0.626578333, 0.539928167},
                 {0.020241911, 0.628423333, 0.539546},
                 {0.021279736, 0.630268333, 0.5391535},
                 {0.022370772, 0.632113333, 0.538750667},
                 {0.023517746, 0.633958333, 0.5383375},
                 {0.024723526, 0.635803333, 0.537914},
                 {0.025991129, 0.637648333, 0.537480167},
                 {0.027323722, 0.639493333, 0.537036},
                 {0.02872464, 0.641338333, 0.5365815},
                 {0.030197383, 0.643183333, 0.536116667},
                 {0.031745636, 0.645028333, 0.5356415},
                 {0.03337327, 0.646873333, 0.535156},
                 {0.035084354, 0.648718333, 0.534660167},
                 {0.036883167, 0.650563333, 0.534154},
                 {0.038774208, 0.652408333, 0.5336375},
                 {0.040762204, 0.654253333, 0.533110667},
                 {0.042852127, 0.656098333, 0.5325735},
                 {0.045049202, 0.657943333, 0.532026},
                 {0.047358924, 0.659788333, 0.531468167},
                 {0.049787068, 0.661633333, 0.5309},
                 {0.052339706, 0.663478333, 0.5303215},
                 {0.05502322, 0.665323333, 0.529732667},
                 {0.057844321, 0.667168333, 0.5291335},
                 {0.060810063, 0.669013333, 0.528524},
                 {0.063927861, 0.670858333, 0.527904167},
                 {0.067205513, 0.672703333, 0.527274},
                 {0.070651213, 0.674548333, 0.5266335},
                 {0.074273578, 0.676393333, 0.525982667},
                 {0.078081666, 0.678238333, 0.5253215},
                 {0.082084999, 0.680083333, 0.52465},
                 {0.086293586, 0.681928333, 0.523968167},
                 {0.090717953, 0.683773333, 0.523276},
                 {0.095369162, 0.685618333, 0.5225735},
                 {0.100258844, 0.687463333, 0.521860667},
                 {0.105399225, 0.689308333, 0.5211375},
                 {0.110803158, 0.691153333, 0.520404},
                 {0.116484158, 0.692998333, 0.519660167},
                 {0.122456428, 0.694843333, 0.518906},
                 {0.128734904, 0.696688333, 0.5181415},
                 {0.135335283, 0.698533333, 0.517366667},
                 {0.142274072, 0.700378333, 0.5165815},
                 {0.149568619, 0.702223333, 0.515786},
                 {0.157237166, 0.704068333, 0.514980167},
                 {0.165298888, 0.705913333, 0.514164},
                 {0.173773943, 0.707758333, 0.5133375},
                 {0.182683524, 0.709603333, 0.512500667},
                 {0.192049909, 0.711448333, 0.5116535},
                 {0.201896518, 0.713293333, 0.510796},
                 {0.212247974, 0.715138333, 0.509928167},
                 {0.22313016, 0.716983333, 0.50905},
                 {0.234570288, 0.718828333, 0.5081615},
                 {0.246596964, 0.720673333, 0.507262667},
                 {0.259240261, 0.722518333, 0.5063535},
                 {0.272531793, 0.724363333, 0.505434},
                 {0.286504797, 0.726208333, 0.504504167},
                 {0.301194212, 0.728053333, 0.503564},
                 {0.316636769, 0.729898333, 0.5026135},
                 {0.332871084, 0.731743333, 0.501652667},
                 {0.349937749, 0.733588333, 0.5006815},
                 {0.367879441, 0.735433333, 0.4997},
                 {0.386741023, 0.737278333, 0.498708167},
                 {0.40656966, 0.739123333, 0.497706},
                 {0.427414932, 0.740968333, 0.4966935},
                 {0.449328964, 0.742813333, 0.495670667},
                 {0.472366553, 0.744658333, 0.4946375},
                 {0.496585304, 0.746503333, 0.493594},
                 {0.522045777, 0.748348333, 0.492540167},
                 {0.548811636, 0.750193333, 0.491476},
                 {0.57694981, 0.752038333, 0.4904015},
                 {0.60653066, 0.753883333, 0.489316667},
                 {0.637628152, 0.755728333, 0.4882215},
                 {0.670320046, 0.757573333, 0.487116},
                 {0.70468809, 0.759418333, 0.486000167},
                 {0.740818221, 0.761263333, 0.484874},
                 {0.778800783, 0.763108333, 0.4837375},
                 {0.818730753, 0.764953333, 0.482590667},
                 {0.860707976, 0.766798333, 0.4814335},
                 {0.904837418, 0.768643333, 0.480266},
                 {0.951229425, 0.770488333, 0.479088167},
                 {1, 0.772333333, 0.4779},
                 {1.051271096, 0.774178333, 0.4767015},
                 {1.105170918, 0.776023333, 0.475492667},
                 {1.161834243, 0.777868333, 0.4742735},
                 {1.221402758, 0.779713333, 0.473044},
                 {1.284025417, 0.781558333, 0.471804167},
                 {1.349858808, 0.783403333, 0.470554},
                 {1.419067549, 0.785248333, 0.4692935},
                 {1.491824698, 0.787093333, 0.468022667},
                 {1.568312185, 0.788938333, 0.4667415},
                 {1.648721271, 0.790783333, 0.46545},
                 {1.733253018, 0.792628333, 0.464148167},
                 {1.8221188, 0.794473333, 0.462836},
                 {1.915540829, 0.796318333, 0.4615135},
                 {2.013752707, 0.798163333, 0.460180667},
                 {2.117000017, 0.800008333, 0.4588375},
                 {2.225540928, 0.801853333, 0.457484},
                 {2.339646852, 0.803698333, 0.456120167},
                 {2.459603111, 0.805543333, 0.454746},
                 {2.585709659, 0.807388333, 0.4533615},
                 {2.718281828, 0.809233333, 0.451966667},
                 {2.857651118, 0.811078333, 0.4505615},
                 {3.004166024, 0.812923333, 0.449146},
                 {3.15819291, 0.814768333, 0.447720167},
                 {3.320116923, 0.816613333, 0.446284},
                 {3.490342957, 0.818458333, 0.4448375},
                 {3.669296668, 0.820303333, 0.443380667},
                 {3.857425531, 0.822148333, 0.4419135},
                 {4.055199967, 0.823993333, 0.440436},
                 {4.263114515, 0.825838333, 0.438948167},
                 {4.48168907, 0.827683333, 0.43745},
                 {4.711470183, 0.829528333, 0.4359415},
                 {4.953032424, 0.831373333, 0.434422667},
                 {5.206979827, 0.833218333, 0.4328935},
                 {5.473947392, 0.835063333, 0.431354},
                 {5.754602676, 0.836908333, 0.429804167},
                 {6.049647464, 0.838753333, 0.428244},
                 {6.359819523, 0.840598333, 0.4266735},
                 {6.685894442, 0.842443333, 0.425092667},
                 {7.028687581, 0.844288333, 0.4235015},
                 {7.389056099, 0.846133333, 0.4219}}};
    }


protected:
    virtual void SetUp()
    {
        const auto aSolarRadiation = loadSolarRadiationFile();
        auto pvSample = std::make_shared<SpectralAveraging::PhotovoltaicSampleData>(
          *loadSampleData_1(), eqeFront(), eqeBack());

        double thickness = 3.048e-3;   // [m]
        const auto aMaterial_1 =
          Material::nBandPhotovoltaicMaterial(pvSample,
                                              thickness,
                                              FenestrationCommon::MaterialType::Monolithic,
                                              FenestrationCommon::WavelengthRange::Solar);

        thickness = 5.715e-3;   // [m]
        const auto aMaterial_2 =
          Material::nBandMaterial(loadSampleData_2(),
                                  thickness,
                                  FenestrationCommon::MaterialType::Monolithic,
                                  FenestrationCommon::WavelengthRange::Solar);

        const auto layer1 = SingleLayerOptics::PhotovoltaicLayer::createLayer(aMaterial_1, table());
        const auto layer2 = SingleLayerOptics::SpecularLayer::createLayer(aMaterial_2);

        m_Layer = CMultiPanePhotovoltaic::create({layer1, layer2}, loadSolarRadiationFile());
    }

public:
    [[nodiscard]] CMultiPanePhotovoltaic & getLayer() const
    {
        return *m_Layer;
    }
};

TEST_F(Photovoltaic_DoublePane_Example1, Test1)
{
    SCOPED_TRACE("Begin Test: Double pane photovoltaic - Example 1.");

    const double angle{0.0};
    const double minLambda{0.3};
    const double maxLambda{2.5};

    auto aLayer = getLayer();

    const double T =
      aLayer.getPropertySimple(PropertySimple::T, Side::Front, Scattering::DirectDirect, angle, 0);
    EXPECT_NEAR(0.373665, T, 1e-6);

    const double absHeat = aLayer.AbsHeat(1, angle, minLambda, maxLambda);
    EXPECT_NEAR(0.317712, absHeat, 1e-6);

    const double absEl1 = aLayer.AbsElectricity(1, angle, minLambda, maxLambda);
    EXPECT_NEAR(0.013734, absEl1, 1e-6);

    const double absEl2 = aLayer.AbsElectricity(2, angle, minLambda, maxLambda);
    EXPECT_NEAR(0, absEl2, 1e-6);
}