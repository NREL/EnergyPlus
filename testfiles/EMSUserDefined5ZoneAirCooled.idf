! EMSUserDefined5ZoneAirCooled.idf
! Basic file description:  1 story building divided into 4 exterior and one interior conditioned zones and return plenum.
!
! Highlights:              User Defined component models using Energy Management System
!                          PlantComponent:UserDefined example of a constant COP chiller
!                          Coil:UserDefined examples with chilled water and hot water coil systems that meet setpoint on leaving air node
!                          AirTerminal:SingleDuct:UserDefined with VAV reheat air terminals that operate at full stop during heating (for zone mixing).
!
! Simulation Location/Run: CHICAGO_IL_USA TMY2-94846, 2 design days, 2 run periods,
!                          Run Control executes the run periods using the weather file
!
! Location:                Chicago, IL
!
! Design Days:             CHICAGO_IL_USA Annual Heating 99% Design Conditions DB, MaxDB= -17.3째C
!                          CHICAGO_IL_USA Annual Cooling 1% Design Conditions, MaxDB=  31.5째C MCWB=  23.0째C
!
! Run Period (Weather File): 1/1 through 12/31, CHICAGO_IL_USA TMY2-94846
!
! Run Control:             Zone and System sizing with weather file run control (no design days run)
!
! Building: Single floor rectangular building 100 ft x 50 ft. 5 zones - 4 exterior, 1 interior, zone height 8 feet.
!           Exterior zone depth is 12 feet. There is a 2 foot high return plenum: the overall building height is
!           10 feet. There are windows on all 4 facades; the south and north facades have glass doors.
!           The south facing glass is shaded by overhangs. The walls are woodshingle over plywood, R11 insulation,
!           and gypboard. The roof is a gravel built up roof with R-3 mineral board insulation and plywood sheathing.
!           The windows are of various single and double pane construction with 3mm and 6mm glass and either 6mm or
!           13mm argon or air gap.  The window to wall ratio is approximately 0.29.
!           The south wall and door have overhangs.
!
!           The building is oriented 30 degrees east of north.
!
! Floor Area:        463.6 m2 (5000 ft2)
! Number of Stories: 1
!
! Zone Description Details:
!
!      (0,15.2,0)                      (30.5,15.2,0)
!           _____   ________                ____
!         |\     ***        ****************   /|
!         | \                                 / |
!         |  \                 (26.8,11.6,0) /  |
!         *   \_____________________________/   *
!         *    |(3.7,11.6,0)               |    *
!         *    |                           |    *
!         *    |                           |    *
!         *    |               (26.8,3.7,0)|    *
!         *    |___________________________|    *
!         *   / (3.7,3.7,0)                 \   *
!         |  /                               \  |
!         | /                                 \ |
!         |/___******************___***________\|
!          |       Overhang        |   |
!          |_______________________|   |   window/door = *
!                                  |___|
!
!      (0,0,0)                            (30.5,0,0)
!
! Internal gains description:     lighting is 1.5 watts/ft2, office equip is 1.0 watts/ft2. There is 1 occupant
!                                 per 100 ft2 of floor area. The infiltration is 0.25 air changes per hour.
!
! Interzone Surfaces:             6 interzone surfaces (see diagram)
! Internal Mass:                  None
! People:                         50
! Lights:                         7500 W
! Windows:                        4 ea.: 1) Double pane clear, 3mm glass, 13mm air gap
!                                        2) Double pane clear, 3mm glass, 13mm argon gap
!                                        3) Double pane clear, 6mm glass, 6mm air gap
!                                        4) Double pane lowE,  6mm lowE glass outside, 6mm air gap, 6mm clear glass
!
! Doors:                          2 ea.:    Single pane grey,  3mm glass
!
! Detached Shading:               None
! Daylight:                       None
! Natural Ventilation:            None
! Compact Schedules:              Yes
!
! HVAC:                           Standard VAV system with outside air, hot water reheat coils,
!                                 central chilled water cooling coil. Central Plant is single hot water
!                                 boiler, electric compression chiller with air cooled condenser.
!                                 All equipment is autosized. HW and ChW coils are used in the outside air
!                                 stream to precondition the outside air.
!
! Zonal Equipment:                AirTerminal:SingleDuct:UserDefined
! Central Air Handling Equipment: Yes
! System Equipment Autosize:      Yes
! Purchased Cooling:              None
! Purchased Heating:              None
! Coils:                          Coil:UserDefined, for both heating and cooling coils
! Pumps:                          Pump:VariableSpeed
! Boilers:                        Boiler:HotWater
! Chillers:                       PlantComponent:UserDefined used for a constant COP chiller
!
! Results:
! Standard Reports:               None
! Timestep or Hourly Variables:   Hourly
! Time bins Report:               None
! HTML Report:                    None
! Environmental Emissions:        None
! Utility Tariffs:                None

  Version,9.3;

  Building,
    Building,                !- Name
    30.,                     !- North Axis {deg}
    City,                    !- Terrain
    0.04,                    !- Loads Convergence Tolerance Value {W}
    0.4,                     !- Temperature Convergence Tolerance Value {deltaC}
    FullExterior,            !- Solar Distribution
    25,                      !- Maximum Number of Warmup Days
    6;                       !- Minimum Number of Warmup Days

  Timestep,4;

  SurfaceConvectionAlgorithm:Inside,Simple;

  SurfaceConvectionAlgorithm:Outside,SimpleCombined;

  HeatBalanceAlgorithm,ConductionTransferFunction;

  GlobalGeometryRules,
    UpperLeftCorner,         !- Starting Vertex Position
    CounterClockWise,        !- Vertex Entry Direction
    Relative;                !- Coordinate System

  ScheduleTypeLimits,
    Any Number;              !- Name

  ScheduleTypeLimits,
    Fraction,                !- Name
    0.0,                     !- Lower Limit Value
    1.0,                     !- Upper Limit Value
    CONTINUOUS;              !- Numeric Type

  ScheduleTypeLimits,
    Temperature,             !- Name
    -60,                     !- Lower Limit Value
    200,                     !- Upper Limit Value
    CONTINUOUS,              !- Numeric Type
    Temperature;             !- Unit Type

  ScheduleTypeLimits,
    Control Type,            !- Name
    0,                       !- Lower Limit Value
    4,                       !- Upper Limit Value
    DISCRETE;                !- Numeric Type

  ScheduleTypeLimits,
    On/Off,                  !- Name
    0,                       !- Lower Limit Value
    1,                       !- Upper Limit Value
    DISCRETE;                !- Numeric Type

  ScheduleTypeLimits,
    FlowRate,                !- Name
    0.0,                     !- Lower Limit Value
    10,                      !- Upper Limit Value
    CONTINUOUS;              !- Numeric Type

  Output:SQLite,
    simple;                  !- Option Type

  RunPeriod,
    Jan14,                   !- Name
    1,                       !- Begin Month
    14,                      !- Begin Day of Month
    ,                        !- Begin Year
    1,                       !- End Month
    14,                      !- End Day of Month
    ,                        !- End Year
    Tuesday,                 !- Day of Week for Start Day
    Yes,                     !- Use Weather File Holidays and Special Days
    Yes,                     !- Use Weather File Daylight Saving Period
    No,                      !- Apply Weekend Holiday Rule
    Yes,                     !- Use Weather File Rain Indicators
    Yes;                     !- Use Weather File Snow Indicators

  RunPeriod,
    Jul7,                    !- Name
    7,                       !- Begin Month
    7,                       !- Begin Day of Month
    ,                        !- Begin Year
    7,                       !- End Month
    7,                       !- End Day of Month
    ,                        !- End Year
    Tuesday,                 !- Day of Week for Start Day
    Yes,                     !- Use Weather File Holidays and Special Days
    Yes,                     !- Use Weather File Daylight Saving Period
    No,                      !- Apply Weekend Holiday Rule
    Yes,                     !- Use Weather File Rain Indicators
    Yes;                     !- Use Weather File Snow Indicators

  Site:Location,
    CHICAGO_IL_USA TMY2-94846,  !- Name
    41.78,                   !- Latitude {deg}
    -87.75,                  !- Longitude {deg}
    -6.00,                   !- Time Zone {hr}
    190.00;                  !- Elevation {m}

  SimulationControl,
    Yes,                     !- Do Zone Sizing Calculation
    Yes,                     !- Do System Sizing Calculation
    Yes,                     !- Do Plant Sizing Calculation
    No,                      !- Run Simulation for Sizing Periods
    Yes;                     !- Run Simulation for Weather File Run Periods

! CHICAGO_IL_USA Annual Heating 99% Design Conditions DB, MaxDB= -17.3째C

  SizingPeriod:DesignDay,
    CHICAGO_IL_USA Annual Heating 99% Design Conditions DB,  !- Name
    1,                       !- Month
    21,                      !- Day of Month
    WinterDesignDay,         !- Day Type
    -17.3,                   !- Maximum Dry-Bulb Temperature {C}
    0.0,                     !- Daily Dry-Bulb Temperature Range {deltaC}
    ,                        !- Dry-Bulb Temperature Range Modifier Type
    ,                        !- Dry-Bulb Temperature Range Modifier Day Schedule Name
    Wetbulb,                 !- Humidity Condition Type
    -17.3,                   !- Wetbulb or DewPoint at Maximum Dry-Bulb {C}
    ,                        !- Humidity Condition Day Schedule Name
    ,                        !- Humidity Ratio at Maximum Dry-Bulb {kgWater/kgDryAir}
    ,                        !- Enthalpy at Maximum Dry-Bulb {J/kg}
    ,                        !- Daily Wet-Bulb Temperature Range {deltaC}
    99063.,                  !- Barometric Pressure {Pa}
    4.9,                     !- Wind Speed {m/s}
    270,                     !- Wind Direction {deg}
    No,                      !- Rain Indicator
    No,                      !- Snow Indicator
    No,                      !- Daylight Saving Time Indicator
    ASHRAEClearSky,          !- Solar Model Indicator
    ,                        !- Beam Solar Day Schedule Name
    ,                        !- Diffuse Solar Day Schedule Name
    ,                        !- ASHRAE Clear Sky Optical Depth for Beam Irradiance (taub) {dimensionless}
    ,                        !- ASHRAE Clear Sky Optical Depth for Diffuse Irradiance (taud) {dimensionless}
    0.0;                     !- Sky Clearness

! CHICAGO_IL_USA Annual Cooling 1% Design Conditions, MaxDB=  31.5째C MCWB=  23.0째C

  SizingPeriod:DesignDay,
    CHICAGO_IL_USA Annual Cooling 1% Design Conditions DB/MCWB,  !- Name
    7,                       !- Month
    21,                      !- Day of Month
    SummerDesignDay,         !- Day Type
    31.5,                    !- Maximum Dry-Bulb Temperature {C}
    10.7,                    !- Daily Dry-Bulb Temperature Range {deltaC}
    ,                        !- Dry-Bulb Temperature Range Modifier Type
    ,                        !- Dry-Bulb Temperature Range Modifier Day Schedule Name
    Wetbulb,                 !- Humidity Condition Type
    23.0,                    !- Wetbulb or DewPoint at Maximum Dry-Bulb {C}
    ,                        !- Humidity Condition Day Schedule Name
    ,                        !- Humidity Ratio at Maximum Dry-Bulb {kgWater/kgDryAir}
    ,                        !- Enthalpy at Maximum Dry-Bulb {J/kg}
    ,                        !- Daily Wet-Bulb Temperature Range {deltaC}
    99063.,                  !- Barometric Pressure {Pa}
    5.3,                     !- Wind Speed {m/s}
    230,                     !- Wind Direction {deg}
    No,                      !- Rain Indicator
    No,                      !- Snow Indicator
    No,                      !- Daylight Saving Time Indicator
    ASHRAEClearSky,          !- Solar Model Indicator
    ,                        !- Beam Solar Day Schedule Name
    ,                        !- Diffuse Solar Day Schedule Name
    ,                        !- ASHRAE Clear Sky Optical Depth for Beam Irradiance (taub) {dimensionless}
    ,                        !- ASHRAE Clear Sky Optical Depth for Diffuse Irradiance (taud) {dimensionless}
    1.0;                     !- Sky Clearness

  Site:GroundTemperature:BuildingSurface,20.03,20.03,20.13,20.30,20.43,20.52,20.62,20.77,20.78,20.55,20.44,20.20;

  Material,
    WD10,                    !- Name
    MediumSmooth,            !- Roughness
    0.667,                   !- Thickness {m}
    0.115,                   !- Conductivity {W/m-K}
    513,                     !- Density {kg/m3}
    1381,                    !- Specific Heat {J/kg-K}
    0.9,                     !- Thermal Absorptance
    0.78,                    !- Solar Absorptance
    0.78;                    !- Visible Absorptance

  Material,
    RG01,                    !- Name
    Rough,                   !- Roughness
    1.2700000E-02,           !- Thickness {m}
    1.442000,                !- Conductivity {W/m-K}
    881.0000,                !- Density {kg/m3}
    1674.000,                !- Specific Heat {J/kg-K}
    0.9000000,               !- Thermal Absorptance
    0.6500000,               !- Solar Absorptance
    0.6500000;               !- Visible Absorptance

  Material,
    BR01,                    !- Name
    VeryRough,               !- Roughness
    9.4999997E-03,           !- Thickness {m}
    0.1620000,               !- Conductivity {W/m-K}
    1121.000,                !- Density {kg/m3}
    1464.000,                !- Specific Heat {J/kg-K}
    0.9000000,               !- Thermal Absorptance
    0.7000000,               !- Solar Absorptance
    0.7000000;               !- Visible Absorptance

  Material,
    IN46,                    !- Name
    VeryRough,               !- Roughness
    7.6200001E-02,           !- Thickness {m}
    2.3000000E-02,           !- Conductivity {W/m-K}
    24.00000,                !- Density {kg/m3}
    1590.000,                !- Specific Heat {J/kg-K}
    0.9000000,               !- Thermal Absorptance
    0.5000000,               !- Solar Absorptance
    0.5000000;               !- Visible Absorptance

  Material,
    WD01,                    !- Name
    MediumSmooth,            !- Roughness
    1.9099999E-02,           !- Thickness {m}
    0.1150000,               !- Conductivity {W/m-K}
    513.0000,                !- Density {kg/m3}
    1381.000,                !- Specific Heat {J/kg-K}
    0.9000000,               !- Thermal Absorptance
    0.7800000,               !- Solar Absorptance
    0.7800000;               !- Visible Absorptance

  Material,
    PW03,                    !- Name
    MediumSmooth,            !- Roughness
    1.2700000E-02,           !- Thickness {m}
    0.1150000,               !- Conductivity {W/m-K}
    545.0000,                !- Density {kg/m3}
    1213.000,                !- Specific Heat {J/kg-K}
    0.9000000,               !- Thermal Absorptance
    0.7800000,               !- Solar Absorptance
    0.7800000;               !- Visible Absorptance

  Material,
    IN02,                    !- Name
    Rough,                   !- Roughness
    9.0099998E-02,           !- Thickness {m}
    4.3000001E-02,           !- Conductivity {W/m-K}
    10.00000,                !- Density {kg/m3}
    837.0000,                !- Specific Heat {J/kg-K}
    0.9000000,               !- Thermal Absorptance
    0.7500000,               !- Solar Absorptance
    0.7500000;               !- Visible Absorptance

  Material,
    GP01,                    !- Name
    MediumSmooth,            !- Roughness
    1.2700000E-02,           !- Thickness {m}
    0.1600000,               !- Conductivity {W/m-K}
    801.0000,                !- Density {kg/m3}
    837.0000,                !- Specific Heat {J/kg-K}
    0.9000000,               !- Thermal Absorptance
    0.7500000,               !- Solar Absorptance
    0.7500000;               !- Visible Absorptance

  Material,
    GP02,                    !- Name
    MediumSmooth,            !- Roughness
    1.5900001E-02,           !- Thickness {m}
    0.1600000,               !- Conductivity {W/m-K}
    801.0000,                !- Density {kg/m3}
    837.0000,                !- Specific Heat {J/kg-K}
    0.9000000,               !- Thermal Absorptance
    0.7500000,               !- Solar Absorptance
    0.7500000;               !- Visible Absorptance

  Material,
    CC03,                    !- Name
    MediumRough,             !- Roughness
    0.1016000,               !- Thickness {m}
    1.310000,                !- Conductivity {W/m-K}
    2243.000,                !- Density {kg/m3}
    837.0000,                !- Specific Heat {J/kg-K}
    0.9000000,               !- Thermal Absorptance
    0.6500000,               !- Solar Absorptance
    0.6500000;               !- Visible Absorptance

  Material:NoMass,
    CP01,                    !- Name
    Rough,                   !- Roughness
    0.3670000,               !- Thermal Resistance {m2-K/W}
    0.9000000,               !- Thermal Absorptance
    0.7500000,               !- Solar Absorptance
    0.7500000;               !- Visible Absorptance

  Material:NoMass,
    MAT-SB-U,                !- Name
    Rough,                   !- Roughness
    0.117406666,             !- Thermal Resistance {m2-K/W}
    0.65,                    !- Thermal Absorptance
    0.65,                    !- Solar Absorptance
    0.65;                    !- Visible Absorptance

  Material:NoMass,
    MAT-CLNG-1,              !- Name
    Rough,                   !- Roughness
    0.652259290,             !- Thermal Resistance {m2-K/W}
    0.65,                    !- Thermal Absorptance
    0.65,                    !- Solar Absorptance
    0.65;                    !- Visible Absorptance

  Material:NoMass,
    MAT-FLOOR-1,             !- Name
    Rough,                   !- Roughness
    3.522199631,             !- Thermal Resistance {m2-K/W}
    0.65,                    !- Thermal Absorptance
    0.65,                    !- Solar Absorptance
    0.65;                    !- Visible Absorptance

  Material:AirGap,
    AL21,                    !- Name
    0.1570000;               !- Thermal Resistance {m2-K/W}

  Material:AirGap,
    AL23,                    !- Name
    0.1530000;               !- Thermal Resistance {m2-K/W}

  Construction,
    ROOF-1,                  !- Name
    RG01,                    !- Outside Layer
    BR01,                    !- Layer 2
    IN46,                    !- Layer 3
    WD01;                    !- Layer 4

  Construction,
    WALL-1,                  !- Name
    WD01,                    !- Outside Layer
    PW03,                    !- Layer 2
    IN02,                    !- Layer 3
    GP01;                    !- Layer 4

  Construction,
    CLNG-1,                  !- Name
    MAT-CLNG-1;              !- Outside Layer

  Construction,
    FLOOR-SLAB-1,            !- Name
    CC03;                    !- Outside Layer

  Construction,
    INT-WALL-1,              !- Name
    GP02,                    !- Outside Layer
    AL21,                    !- Layer 2
    GP02;                    !- Layer 3

  WindowMaterial:Gas,
    AIR 6MM,                 !- Name
    Air,                     !- Gas Type
    0.0063;                  !- Thickness {m}

  WindowMaterial:Gas,
    AIR 13MM,                !- Name
    Air,                     !- Gas Type
    0.0127;                  !- Thickness {m}

  WindowMaterial:Gas,
    ARGON 13MM,              !- Name
    Argon,                   !- Gas Type
    0.0127;                  !- Thickness {m}

  WindowMaterial:Glazing,
    CLEAR 3MM,               !- Name
    SpectralAverage,         !- Optical Data Type
    ,                        !- Window Glass Spectral Data Set Name
    0.003,                   !- Thickness {m}
    0.837,                   !- Solar Transmittance at Normal Incidence
    0.075,                   !- Front Side Solar Reflectance at Normal Incidence
    0.075,                   !- Back Side Solar Reflectance at Normal Incidence
    0.898,                   !- Visible Transmittance at Normal Incidence
    0.081,                   !- Front Side Visible Reflectance at Normal Incidence
    0.081,                   !- Back Side Visible Reflectance at Normal Incidence
    0.0,                     !- Infrared Transmittance at Normal Incidence
    0.84,                    !- Front Side Infrared Hemispherical Emissivity
    0.84,                    !- Back Side Infrared Hemispherical Emissivity
    0.9;                     !- Conductivity {W/m-K}

  WindowMaterial:Glazing,
    GREY 3MM,                !- Name
    SpectralAverage,         !- Optical Data Type
    ,                        !- Window Glass Spectral Data Set Name
    0.003,                   !- Thickness {m}
    0.626,                   !- Solar Transmittance at Normal Incidence
    0.061,                   !- Front Side Solar Reflectance at Normal Incidence
    0.061,                   !- Back Side Solar Reflectance at Normal Incidence
    0.611,                   !- Visible Transmittance at Normal Incidence
    0.061,                   !- Front Side Visible Reflectance at Normal Incidence
    0.061,                   !- Back Side Visible Reflectance at Normal Incidence
    0.0,                     !- Infrared Transmittance at Normal Incidence
    0.84,                    !- Front Side Infrared Hemispherical Emissivity
    0.84,                    !- Back Side Infrared Hemispherical Emissivity
    0.9;                     !- Conductivity {W/m-K}

  WindowMaterial:Glazing,
    CLEAR 6MM,               !- Name
    SpectralAverage,         !- Optical Data Type
    ,                        !- Window Glass Spectral Data Set Name
    0.006,                   !- Thickness {m}
    0.775,                   !- Solar Transmittance at Normal Incidence
    0.071,                   !- Front Side Solar Reflectance at Normal Incidence
    0.071,                   !- Back Side Solar Reflectance at Normal Incidence
    0.881,                   !- Visible Transmittance at Normal Incidence
    0.080,                   !- Front Side Visible Reflectance at Normal Incidence
    0.080,                   !- Back Side Visible Reflectance at Normal Incidence
    0.0,                     !- Infrared Transmittance at Normal Incidence
    0.84,                    !- Front Side Infrared Hemispherical Emissivity
    0.84,                    !- Back Side Infrared Hemispherical Emissivity
    0.9;                     !- Conductivity {W/m-K}

  WindowMaterial:Glazing,
    LoE CLEAR 6MM,           !- Name
    SpectralAverage,         !- Optical Data Type
    ,                        !- Window Glass Spectral Data Set Name
    0.006,                   !- Thickness {m}
    0.600,                   !- Solar Transmittance at Normal Incidence
    0.170,                   !- Front Side Solar Reflectance at Normal Incidence
    0.220,                   !- Back Side Solar Reflectance at Normal Incidence
    0.840,                   !- Visible Transmittance at Normal Incidence
    0.055,                   !- Front Side Visible Reflectance at Normal Incidence
    0.078,                   !- Back Side Visible Reflectance at Normal Incidence
    0.0,                     !- Infrared Transmittance at Normal Incidence
    0.84,                    !- Front Side Infrared Hemispherical Emissivity
    0.10,                    !- Back Side Infrared Hemispherical Emissivity
    0.9;                     !- Conductivity {W/m-K}

  Construction,
    Dbl Clr 3mm/13mm Air,    !- Name
    CLEAR 3MM,               !- Outside Layer
    AIR 13MM,                !- Layer 2
    CLEAR 3MM;               !- Layer 3

  Construction,
    Sgl Grey 3mm,            !- Name
    GREY 3MM;                !- Outside Layer

  Schedule:Compact,
    OCCUPY-1,                !- Name
    Fraction,                !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: WeekDays SummerDesignDay CustomDay1 CustomDay2, !- Field 2
    Until: 8:00,0.0,         !- Field 3
    Until: 11:00,1.00,       !- Field 5
    Until: 12:00,0.80,       !- Field 7
    Until: 13:00,0.40,       !- Field 9
    Until: 14:00,0.80,       !- Field 11
    Until: 18:00,1.00,       !- Field 13
    Until: 19:00,0.50,       !- Field 15
    Until: 24:00,0.0,        !- Field 17
    For: Weekends WinterDesignDay Holiday, !- Field 19
    Until: 24:00,0.0;        !- Field 20

  Schedule:Compact,
    LIGHTS-1,                !- Name
    Fraction,                !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: WeekDays SummerDesignDay CustomDay1 CustomDay2, !- Field 2
    Until: 8:00,0.05,        !- Field 3
    Until: 9:00,0.9,         !- Field 5
    Until: 10:00,0.95,       !- Field 7
    Until: 11:00,1.00,       !- Field 9
    Until: 12:00,0.95,       !- Field 11
    Until: 13:00,0.8,        !- Field 13
    Until: 14:00,0.9,        !- Field 15
    Until: 18:00,1.00,       !- Field 17
    Until: 19:00,0.60,       !- Field 19
    Until: 21:00,0.20,       !- Field 21
    Until: 24:00,0.05,       !- Field 23
    For: Weekends WinterDesignDay Holiday, !- Field 25
    Until: 24:00,0.05;       !- Field 26

  Schedule:Compact,
    EQUIP-1,                 !- Name
    Fraction,                !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: WeekDays SummerDesignDay CustomDay1 CustomDay2, !- Field 2
    Until: 8:00,0.02,        !- Field 3
    Until: 9:00,0.4,         !- Field 5
    Until: 14:00,0.9,        !- Field 7
    Until: 15:00,0.8,        !- Field 9
    Until: 16:00,0.7,        !- Field 11
    Until: 18:00,0.5,        !- Field 13
    Until: 20:00,0.3,        !- Field 15
    Until: 24:00,0.02,       !- Field 17
    For: Weekends WinterDesignDay Holiday, !- Field 19
    Until: 24:00,0.2;        !- Field 20

  Schedule:Compact,
    INFIL-SCH,               !- Name
    Fraction,                !- Schedule Type Limits Name
    Through: 3/31,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,1.0,        !- Field 3
    Through: 10/31,          !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,0.0,        !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,1.0;        !- Field 11

  Schedule:Compact,
    ActSchd,                 !- Name
    Any Number,              !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,117.239997864; !- Field 3

                             !- Field 4

  Schedule:Compact,
    ShadeTransSch,           !- Name
    Fraction,                !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,0.0;        !- Field 3

  Zone,
    PLENUM-1,                !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    0.609600067,             !- Ceiling Height {m}
    283.2;                   !- Volume {m3}

  BuildingSurface:Detailed,
    WALL-1PF,                !- Name
    WALL,                    !- Surface Type
    WALL-1,                  !- Construction Name
    PLENUM-1,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    0.50000,                 !- View Factor to Ground
    4,                       !- Number of Vertices
    0.0,0.0,3.0,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,0.0,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    30.5,0.0,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    30.5,0.0,3.0;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    WALL-1PR,                !- Name
    WALL,                    !- Surface Type
    WALL-1,                  !- Construction Name
    PLENUM-1,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    0.50000,                 !- View Factor to Ground
    4,                       !- Number of Vertices
    30.5,0.0,3.0,  !- X,Y,Z ==> Vertex 1 {m}
    30.5,0.0,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    30.5,15.2,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    30.5,15.2,3.0;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    WALL-1PB,                !- Name
    WALL,                    !- Surface Type
    WALL-1,                  !- Construction Name
    PLENUM-1,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    0.50000,                 !- View Factor to Ground
    4,                       !- Number of Vertices
    30.5,15.2,3.0,  !- X,Y,Z ==> Vertex 1 {m}
    30.5,15.2,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,15.2,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    0.0,15.2,3.0;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    WALL-1PL,                !- Name
    WALL,                    !- Surface Type
    WALL-1,                  !- Construction Name
    PLENUM-1,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    0.50000,                 !- View Factor to Ground
    4,                       !- Number of Vertices
    0.0,15.2,3.0,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,15.2,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,0.0,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    0.0,0.0,3.0;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    TOP-1,                   !- Name
    ROOF,                    !- Surface Type
    ROOF-1,                  !- Construction Name
    PLENUM-1,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    0.00000,                 !- View Factor to Ground
    4,                       !- Number of Vertices
    0.0,15.2,3.0,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,0.0,3.0,  !- X,Y,Z ==> Vertex 2 {m}
    30.5,0.0,3.0,  !- X,Y,Z ==> Vertex 3 {m}
    30.5,15.2,3.0;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    C1-1P,                   !- Name
    FLOOR,                   !- Surface Type
    CLNG-1,                  !- Construction Name
    PLENUM-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    C1-1,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,3.7,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    30.5,0.0,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,0.0,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    3.7,3.7,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    C2-1P,                   !- Name
    FLOOR,                   !- Surface Type
    CLNG-1,                  !- Construction Name
    PLENUM-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    C2-1,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,11.6,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    30.5,15.2,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    30.5,0.0,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    26.8,3.7,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    C3-1P,                   !- Name
    FLOOR,                   !- Surface Type
    CLNG-1,                  !- Construction Name
    PLENUM-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    C3-1,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,11.6,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    3.7,11.6,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,15.2,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    30.5,15.2,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    C4-1P,                   !- Name
    FLOOR,                   !- Surface Type
    CLNG-1,                  !- Construction Name
    PLENUM-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    C4-1,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    3.7,3.7,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,0.0,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,15.2,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    3.7,11.6,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    C5-1P,                   !- Name
    FLOOR,                   !- Surface Type
    CLNG-1,                  !- Construction Name
    PLENUM-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    C5-1,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,11.6,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    26.8,3.7,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    3.7,3.7,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    3.7,11.6,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  Zone,
    SPACE1-1,                !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    2.438400269,             !- Ceiling Height {m}
    239.247360229;           !- Volume {m3}

  ZoneInfiltration:DesignFlowRate,
    SPACE1-1 Infil 1,        !- Name
    SPACE1-1,                !- Zone or ZoneList Name
    INFIL-SCH,               !- Schedule Name
    flow/zone,               !- Design Flow Rate Calculation Method
    0.032,                   !- Design Flow Rate {m3/s}
    ,                        !- Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Flow per Exterior Surface Area {m3/s-m2}
    ,                        !- Air Changes per Hour {1/hr}
    0,                       !- Constant Term Coefficient
    0,                       !- Temperature Term Coefficient
    0.2237,                  !- Velocity Term Coefficient
    0;                       !- Velocity Squared Term Coefficient

  People,
    SPACE1-1 People 1,       !- Name
    SPACE1-1,                !- Zone or ZoneList Name
    OCCUPY-1,                !- Number of People Schedule Name
    people,                  !- Number of People Calculation Method
    11,                      !- Number of People
    ,                        !- People per Zone Floor Area {person/m2}
    ,                        !- Zone Floor Area per Person {m2/person}
    0.3,                     !- Fraction Radiant
    ,                        !- Sensible Heat Fraction
    ActSchd;                 !- Activity Level Schedule Name

  Lights,
    SPACE1-1 Lights 1,       !- Name
    SPACE1-1,                !- Zone or ZoneList Name
    LIGHTS-1,                !- Schedule Name
    LightingLevel,           !- Design Level Calculation Method
    1584,                    !- Lighting Level {W}
    ,                        !- Watts per Zone Floor Area {W/m2}
    ,                        !- Watts per Person {W/person}
    0.2,                     !- Return Air Fraction
    0.59,                    !- Fraction Radiant
    0.2,                     !- Fraction Visible
    0,                       !- Fraction Replaceable
    GeneralLights;           !- End-Use Subcategory

  ElectricEquipment,
    SPACE1-1 ElecEq 1,       !- Name
    SPACE1-1,                !- Zone or ZoneList Name
    EQUIP-1,                 !- Schedule Name
    EquipmentLevel,          !- Design Level Calculation Method
    1056,                    !- Design Level {W}
    ,                        !- Watts per Zone Floor Area {W/m2}
    ,                        !- Watts per Person {W/person}
    0,                       !- Fraction Latent
    0.3,                     !- Fraction Radiant
    0;                       !- Fraction Lost

  BuildingSurface:Detailed,
    FRONT-1,                 !- Name
    WALL,                    !- Surface Type
    WALL-1,                  !- Construction Name
    SPACE1-1,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    0.50000,                 !- View Factor to Ground
    4,                       !- Number of Vertices
    0.0,0.0,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,0.0,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    30.5,0.0,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    30.5,0.0,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    WF-1,                    !- Name
    WINDOW,                  !- Surface Type
    Dbl Clr 3mm/13mm Air,    !- Construction Name
    FRONT-1,                 !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    0.50000,                 !- View Factor to Ground
    ,                        !- Frame and Divider Name
    1,                       !- Multiplier
    4,                       !- Number of Vertices
    3.0,0.0,2.1,  !- X,Y,Z ==> Vertex 1 {m}
    3.0,0.0,0.9,  !- X,Y,Z ==> Vertex 2 {m}
    16.8,0.0,0.9,  !- X,Y,Z ==> Vertex 3 {m}
    16.8,0.0,2.1;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DF-1,                    !- Name
    GLASSDOOR,               !- Surface Type
    Sgl Grey 3mm,            !- Construction Name
    FRONT-1,                 !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    0.50000,                 !- View Factor to Ground
    ,                        !- Frame and Divider Name
    1,                       !- Multiplier
    4,                       !- Number of Vertices
    21.3,0.0,2.1,  !- X,Y,Z ==> Vertex 1 {m}
    21.3,0.0,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    23.8,0.0,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    23.8,0.0,2.1;  !- X,Y,Z ==> Vertex 4 {m}

  Shading:Zone:Detailed,
    Main South Overhang,     !- Name
    FRONT-1,                 !- Base Surface Name
    ShadeTransSch,           !- Transmittance Schedule Name
    4,                       !- Number of Vertices
    0.0,-1.3,2.2,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,0.0,2.2,  !- X,Y,Z ==> Vertex 2 {m}
    19.8,0.0,2.2,  !- X,Y,Z ==> Vertex 3 {m}
    19.8,-1.3,2.2;  !- X,Y,Z ==> Vertex 4 {m}

  Shading:Zone:Detailed,
    South Door Overhang,     !- Name
    FRONT-1,                 !- Base Surface Name
    ShadeTransSch,           !- Transmittance Schedule Name
    4,                       !- Number of Vertices
    21.0,-2.0,2.6,  !- X,Y,Z ==> Vertex 1 {m}
    21.0,0.0,2.6,  !- X,Y,Z ==> Vertex 2 {m}
    24.1,0.0,2.6,  !- X,Y,Z ==> Vertex 3 {m}
    24.1,-2.0,2.6;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    C1-1,                    !- Name
    CEILING,                 !- Surface Type
    CLNG-1,                  !- Construction Name
    SPACE1-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    C1-1P,                   !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    3.7,3.7,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,0.0,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    30.5,0.0,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    26.8,3.7,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    F1-1,                    !- Name
    FLOOR,                   !- Surface Type
    FLOOR-SLAB-1,            !- Construction Name
    SPACE1-1,                !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,3.7,0.0,  !- X,Y,Z ==> Vertex 1 {m}
    30.5,0.0,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,0.0,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    3.7,3.7,0.0;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB12,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE1-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB21,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    30.5,0.0,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    30.5,0.0,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    26.8,3.7,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    26.8,3.7,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB14,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE1-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB41,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    3.7,3.7,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    3.7,3.7,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,0.0,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    0.0,0.0,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB15,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE1-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB51,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,3.7,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    26.8,3.7,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    3.7,3.7,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    3.7,3.7,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  Zone,
    SPACE2-1,                !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    2.438400269,             !- Ceiling Height {m}
    103.311355591;           !- Volume {m3}

  ZoneInfiltration:DesignFlowRate,
    SPACE2-1 Infil 1,        !- Name
    SPACE2-1,                !- Zone or ZoneList Name
    INFIL-SCH,               !- Schedule Name
    flow/zone,               !- Design Flow Rate Calculation Method
    0.014,                   !- Design Flow Rate {m3/s}
    ,                        !- Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Flow per Exterior Surface Area {m3/s-m2}
    ,                        !- Air Changes per Hour {1/hr}
    0,                       !- Constant Term Coefficient
    0,                       !- Temperature Term Coefficient
    0.2237,                  !- Velocity Term Coefficient
    0;                       !- Velocity Squared Term Coefficient

  People,
    SPACE2-1 People 1,       !- Name
    SPACE2-1,                !- Zone or ZoneList Name
    OCCUPY-1,                !- Number of People Schedule Name
    people,                  !- Number of People Calculation Method
    5,                       !- Number of People
    ,                        !- People per Zone Floor Area {person/m2}
    ,                        !- Zone Floor Area per Person {m2/person}
    0.3,                     !- Fraction Radiant
    ,                        !- Sensible Heat Fraction
    ActSchd;                 !- Activity Level Schedule Name

  Lights,
    SPACE2-1 Lights 1,       !- Name
    SPACE2-1,                !- Zone or ZoneList Name
    LIGHTS-1,                !- Schedule Name
    LightingLevel,           !- Design Level Calculation Method
    684,                     !- Lighting Level {W}
    ,                        !- Watts per Zone Floor Area {W/m2}
    ,                        !- Watts per Person {W/person}
    0.2,                     !- Return Air Fraction
    0.59,                    !- Fraction Radiant
    0.2,                     !- Fraction Visible
    0,                       !- Fraction Replaceable
    GeneralLights;           !- End-Use Subcategory

  ElectricEquipment,
    SPACE2-1 ElecEq 1,       !- Name
    SPACE2-1,                !- Zone or ZoneList Name
    EQUIP-1,                 !- Schedule Name
    EquipmentLevel,          !- Design Level Calculation Method
    456,                     !- Design Level {W}
    ,                        !- Watts per Zone Floor Area {W/m2}
    ,                        !- Watts per Person {W/person}
    0,                       !- Fraction Latent
    0.3,                     !- Fraction Radiant
    0;                       !- Fraction Lost

  BuildingSurface:Detailed,
    RIGHT-1,                 !- Name
    WALL,                    !- Surface Type
    WALL-1,                  !- Construction Name
    SPACE2-1,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    0.50000,                 !- View Factor to Ground
    4,                       !- Number of Vertices
    30.5,0.0,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    30.5,0.0,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    30.5,15.2,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    30.5,15.2,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    WR-1,                    !- Name
    WINDOW,                  !- Surface Type
    Dbl Clr 3mm/13mm Air,    !- Construction Name
    RIGHT-1,                 !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    0.50000,                 !- View Factor to Ground
    ,                        !- Frame and Divider Name
    1,                       !- Multiplier
    4,                       !- Number of Vertices
    30.5,3.8,2.1,  !- X,Y,Z ==> Vertex 1 {m}
    30.5,3.8,0.9,  !- X,Y,Z ==> Vertex 2 {m}
    30.5,11.4,0.9,  !- X,Y,Z ==> Vertex 3 {m}
    30.5,11.4,2.1;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    C2-1,                    !- Name
    CEILING,                 !- Surface Type
    CLNG-1,                  !- Construction Name
    SPACE2-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    C2-1P,                   !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,3.7,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    30.5,0.0,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    30.5,15.2,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    26.8,11.6,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    F2-1,                    !- Name
    FLOOR,                   !- Surface Type
    FLOOR-SLAB-1,            !- Construction Name
    SPACE2-1,                !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,11.6,0.0,  !- X,Y,Z ==> Vertex 1 {m}
    30.5,15.2,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    30.5,0.0,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    26.8,3.7,0.0;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB21,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE2-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB12,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,3.7,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    26.8,3.7,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    30.5,0.0,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    30.5,0.0,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB23,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE2-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB32,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    30.5,15.2,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    30.5,15.2,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    26.8,11.6,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    26.8,11.6,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB25,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE2-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB52,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,11.6,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    26.8,11.6,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    26.8,3.7,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    26.8,3.7,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  Zone,
    SPACE3-1,                !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    2.438400269,             !- Ceiling Height {m}
    239.247360229;           !- Volume {m3}

  ZoneInfiltration:DesignFlowRate,
    SPACE3-1 Infil 1,        !- Name
    SPACE3-1,                !- Zone or ZoneList Name
    INFIL-SCH,               !- Schedule Name
    flow/zone,               !- Design Flow Rate Calculation Method
    0.032,                   !- Design Flow Rate {m3/s}
    ,                        !- Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Flow per Exterior Surface Area {m3/s-m2}
    ,                        !- Air Changes per Hour {1/hr}
    0,                       !- Constant Term Coefficient
    0,                       !- Temperature Term Coefficient
    0.2237,                  !- Velocity Term Coefficient
    0;                       !- Velocity Squared Term Coefficient

  People,
    SPACE3-1 People 1,       !- Name
    SPACE3-1,                !- Zone or ZoneList Name
    OCCUPY-1,                !- Number of People Schedule Name
    people,                  !- Number of People Calculation Method
    11,                      !- Number of People
    ,                        !- People per Zone Floor Area {person/m2}
    ,                        !- Zone Floor Area per Person {m2/person}
    0.3,                     !- Fraction Radiant
    ,                        !- Sensible Heat Fraction
    ActSchd;                 !- Activity Level Schedule Name

  Lights,
    SPACE3-1 Lights 1,       !- Name
    SPACE3-1,                !- Zone or ZoneList Name
    LIGHTS-1,                !- Schedule Name
    LightingLevel,           !- Design Level Calculation Method
    1584,                    !- Lighting Level {W}
    ,                        !- Watts per Zone Floor Area {W/m2}
    ,                        !- Watts per Person {W/person}
    0.2,                     !- Return Air Fraction
    0.59,                    !- Fraction Radiant
    0.2,                     !- Fraction Visible
    0,                       !- Fraction Replaceable
    GeneralLights;           !- End-Use Subcategory

  ElectricEquipment,
    SPACE3-1 ElecEq 1,       !- Name
    SPACE3-1,                !- Zone or ZoneList Name
    EQUIP-1,                 !- Schedule Name
    EquipmentLevel,          !- Design Level Calculation Method
    1056,                    !- Design Level {W}
    ,                        !- Watts per Zone Floor Area {W/m2}
    ,                        !- Watts per Person {W/person}
    0,                       !- Fraction Latent
    0.3,                     !- Fraction Radiant
    0;                       !- Fraction Lost

  BuildingSurface:Detailed,
    BACK-1,                  !- Name
    WALL,                    !- Surface Type
    WALL-1,                  !- Construction Name
    SPACE3-1,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    0.50000,                 !- View Factor to Ground
    4,                       !- Number of Vertices
    30.5,15.2,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    30.5,15.2,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,15.2,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    0.0,15.2,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    WB-1,                    !- Name
    WINDOW,                  !- Surface Type
    Dbl Clr 3mm/13mm Air,    !- Construction Name
    BACK-1,                  !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    0.50000,                 !- View Factor to Ground
    ,                        !- Frame and Divider Name
    1,                       !- Multiplier
    4,                       !- Number of Vertices
    27.4,15.2,2.1,  !- X,Y,Z ==> Vertex 1 {m}
    27.4,15.2,0.9,  !- X,Y,Z ==> Vertex 2 {m}
    13.7,15.2,0.9,  !- X,Y,Z ==> Vertex 3 {m}
    13.7,15.2,2.1;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    DB-1,                    !- Name
    GLASSDOOR,               !- Surface Type
    Sgl Grey 3mm,            !- Construction Name
    BACK-1,                  !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    0.50000,                 !- View Factor to Ground
    ,                        !- Frame and Divider Name
    1,                       !- Multiplier
    4,                       !- Number of Vertices
    9.1,15.2,2.1,  !- X,Y,Z ==> Vertex 1 {m}
    9.1,15.2,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    7.0,15.2,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    7.0,15.2,2.1;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    C3-1,                    !- Name
    CEILING,                 !- Surface Type
    CLNG-1,                  !- Construction Name
    SPACE3-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    C3-1P,                   !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    30.5,15.2,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,15.2,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    3.7,11.6,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    26.8,11.6,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    F3-1,                    !- Name
    FLOOR,                   !- Surface Type
    FLOOR-SLAB-1,            !- Construction Name
    SPACE3-1,                !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,11.6,0.0,  !- X,Y,Z ==> Vertex 1 {m}
    3.7,11.6,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,15.2,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    30.5,15.2,0.0;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB32,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE3-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB23,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,11.6,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    26.8,11.6,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    30.5,15.2,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    30.5,15.2,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB34,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE3-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB43,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    0.0,15.2,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,15.2,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    3.7,11.6,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    3.7,11.6,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB35,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE3-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB53,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    3.7,11.6,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    3.7,11.6,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    26.8,11.6,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    26.8,11.6,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  Zone,
    SPACE4-1,                !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    2.438400269,             !- Ceiling Height {m}
    103.311355591;           !- Volume {m3}

  ZoneInfiltration:DesignFlowRate,
    SPACE4-1 Infil 1,        !- Name
    SPACE4-1,                !- Zone or ZoneList Name
    INFIL-SCH,               !- Schedule Name
    flow/zone,               !- Design Flow Rate Calculation Method
    0.014,                   !- Design Flow Rate {m3/s}
    ,                        !- Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Flow per Exterior Surface Area {m3/s-m2}
    ,                        !- Air Changes per Hour {1/hr}
    0,                       !- Constant Term Coefficient
    0,                       !- Temperature Term Coefficient
    0.2237,                  !- Velocity Term Coefficient
    0;                       !- Velocity Squared Term Coefficient

  People,
    SPACE4-1 People 1,       !- Name
    SPACE4-1,                !- Zone or ZoneList Name
    OCCUPY-1,                !- Number of People Schedule Name
    people,                  !- Number of People Calculation Method
    5,                       !- Number of People
    ,                        !- People per Zone Floor Area {person/m2}
    ,                        !- Zone Floor Area per Person {m2/person}
    0.3,                     !- Fraction Radiant
    ,                        !- Sensible Heat Fraction
    ActSchd;                 !- Activity Level Schedule Name

  Lights,
    SPACE4-1 Lights 1,       !- Name
    SPACE4-1,                !- Zone or ZoneList Name
    LIGHTS-1,                !- Schedule Name
    LightingLevel,           !- Design Level Calculation Method
    684,                     !- Lighting Level {W}
    ,                        !- Watts per Zone Floor Area {W/m2}
    ,                        !- Watts per Person {W/person}
    0.2,                     !- Return Air Fraction
    0.59,                    !- Fraction Radiant
    0.2,                     !- Fraction Visible
    0,                       !- Fraction Replaceable
    GeneralLights;           !- End-Use Subcategory

  ElectricEquipment,
    SPACE4-1 ElecEq 1,       !- Name
    SPACE4-1,                !- Zone or ZoneList Name
    EQUIP-1,                 !- Schedule Name
    EquipmentLevel,          !- Design Level Calculation Method
    456,                     !- Design Level {W}
    ,                        !- Watts per Zone Floor Area {W/m2}
    ,                        !- Watts per Person {W/person}
    0,                       !- Fraction Latent
    0.3,                     !- Fraction Radiant
    0;                       !- Fraction Lost

  BuildingSurface:Detailed,
    LEFT-1,                  !- Name
    WALL,                    !- Surface Type
    WALL-1,                  !- Construction Name
    SPACE4-1,                !- Zone Name
    Outdoors,                !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    SunExposed,              !- Sun Exposure
    WindExposed,             !- Wind Exposure
    0.50000,                 !- View Factor to Ground
    4,                       !- Number of Vertices
    0.0,15.2,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,15.2,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,0.0,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    0.0,0.0,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  FenestrationSurface:Detailed,
    WL-1,                    !- Name
    WINDOW,                  !- Surface Type
    Dbl Clr 3mm/13mm Air,    !- Construction Name
    LEFT-1,                  !- Building Surface Name
    ,                        !- Outside Boundary Condition Object
    0.50000,                 !- View Factor to Ground
    ,                        !- Frame and Divider Name
    1,                       !- Multiplier
    4,                       !- Number of Vertices
    0.0,11.4,2.1,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,11.4,0.9,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,3.8,0.9,  !- X,Y,Z ==> Vertex 3 {m}
    0.0,3.8,2.1;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    C4-1,                    !- Name
    CEILING,                 !- Surface Type
    CLNG-1,                  !- Construction Name
    SPACE4-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    C4-1P,                   !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    3.7,11.6,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,15.2,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,0.0,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    3.7,3.7,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    F4-1,                    !- Name
    FLOOR,                   !- Surface Type
    FLOOR-SLAB-1,            !- Construction Name
    SPACE4-1,                !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    3.7,3.7,0.0,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,0.0,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,15.2,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    3.7,11.6,0.0;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB41,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE4-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB14,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    0.0,0.0,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    0.0,0.0,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    3.7,3.7,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    3.7,3.7,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB43,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE4-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB34,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    3.7,11.6,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    3.7,11.6,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    0.0,15.2,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    0.0,15.2,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB45,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE4-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB54,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    3.7,3.7,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    3.7,3.7,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    3.7,11.6,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    3.7,11.6,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  Zone,
    SPACE5-1,                !- Name
    0,                       !- Direction of Relative North {deg}
    0,                       !- X Origin {m}
    0,                       !- Y Origin {m}
    0,                       !- Z Origin {m}
    1,                       !- Type
    1,                       !- Multiplier
    2.438400269,             !- Ceiling Height {m}
    447.682556152;           !- Volume {m3}

  ZoneInfiltration:DesignFlowRate,
    SPACE5-1 Infil 1,        !- Name
    SPACE5-1,                !- Zone or ZoneList Name
    INFIL-SCH,               !- Schedule Name
    flow/zone,               !- Design Flow Rate Calculation Method
    0.062,                   !- Design Flow Rate {m3/s}
    ,                        !- Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Flow per Exterior Surface Area {m3/s-m2}
    ,                        !- Air Changes per Hour {1/hr}
    0,                       !- Constant Term Coefficient
    0,                       !- Temperature Term Coefficient
    0.2237,                  !- Velocity Term Coefficient
    0;                       !- Velocity Squared Term Coefficient

  People,
    SPACE5-1 People 1,       !- Name
    SPACE5-1,                !- Zone or ZoneList Name
    OCCUPY-1,                !- Number of People Schedule Name
    people,                  !- Number of People Calculation Method
    20,                      !- Number of People
    ,                        !- People per Zone Floor Area {person/m2}
    ,                        !- Zone Floor Area per Person {m2/person}
    0.3,                     !- Fraction Radiant
    ,                        !- Sensible Heat Fraction
    ActSchd;                 !- Activity Level Schedule Name

  Lights,
    SPACE5-1 Lights 1,       !- Name
    SPACE5-1,                !- Zone or ZoneList Name
    LIGHTS-1,                !- Schedule Name
    LightingLevel,           !- Design Level Calculation Method
    2964,                    !- Lighting Level {W}
    ,                        !- Watts per Zone Floor Area {W/m2}
    ,                        !- Watts per Person {W/person}
    0.2,                     !- Return Air Fraction
    0.59,                    !- Fraction Radiant
    0.2,                     !- Fraction Visible
    0,                       !- Fraction Replaceable
    GeneralLights;           !- End-Use Subcategory

  ElectricEquipment,
    SPACE5-1 ElecEq 1,       !- Name
    SPACE5-1,                !- Zone or ZoneList Name
    EQUIP-1,                 !- Schedule Name
    EquipmentLevel,          !- Design Level Calculation Method
    1976,                    !- Design Level {W}
    ,                        !- Watts per Zone Floor Area {W/m2}
    ,                        !- Watts per Person {W/person}
    0,                       !- Fraction Latent
    0.3,                     !- Fraction Radiant
    0;                       !- Fraction Lost

  BuildingSurface:Detailed,
    C5-1,                    !- Name
    CEILING,                 !- Surface Type
    CLNG-1,                  !- Construction Name
    SPACE5-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    C5-1P,                   !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    3.7,11.6,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    3.7,3.7,2.4,  !- X,Y,Z ==> Vertex 2 {m}
    26.8,3.7,2.4,  !- X,Y,Z ==> Vertex 3 {m}
    26.8,11.6,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    F5-1,                    !- Name
    FLOOR,                   !- Surface Type
    FLOOR-SLAB-1,            !- Construction Name
    SPACE5-1,                !- Zone Name
    Ground,                  !- Outside Boundary Condition
    ,                        !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,11.6,0.0,  !- X,Y,Z ==> Vertex 1 {m}
    26.8,3.7,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    3.7,3.7,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    3.7,11.6,0.0;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB51,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE5-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB15,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    3.7,3.7,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    3.7,3.7,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    26.8,3.7,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    26.8,3.7,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB52,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE5-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB25,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,3.7,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    26.8,3.7,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    26.8,11.6,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    26.8,11.6,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB53,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE5-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB35,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    26.8,11.6,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    26.8,11.6,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    3.7,11.6,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    3.7,11.6,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  BuildingSurface:Detailed,
    SB54,                    !- Name
    WALL,                    !- Surface Type
    INT-WALL-1,              !- Construction Name
    SPACE5-1,                !- Zone Name
    Surface,                 !- Outside Boundary Condition
    SB45,                    !- Outside Boundary Condition Object
    NoSun,                   !- Sun Exposure
    NoWind,                  !- Wind Exposure
    0.0,                     !- View Factor to Ground
    4,                       !- Number of Vertices
    3.7,11.6,2.4,  !- X,Y,Z ==> Vertex 1 {m}
    3.7,11.6,0.0,  !- X,Y,Z ==> Vertex 2 {m}
    3.7,3.7,0.0,  !- X,Y,Z ==> Vertex 3 {m}
    3.7,3.7,2.4;  !- X,Y,Z ==> Vertex 4 {m}

  Sizing:Parameters,
    1.0,                     !- Heating Sizing Factor
    1.0,                     !- Cooling Sizing Factor
    ;                        !- Timesteps in Averaging Window

  Sizing:Zone,
    SPACE1-1,                !- Zone or ZoneList Name
    SupplyAirTemperature,    !- Zone Cooling Design Supply Air Temperature Input Method
    14.,                     !- Zone Cooling Design Supply Air Temperature {C}
    ,                        !- Zone Cooling Design Supply Air Temperature Difference {deltaC}
    SupplyAirTemperature,    !- Zone Heating Design Supply Air Temperature Input Method
    50.,                     !- Zone Heating Design Supply Air Temperature {C}
    ,                        !- Zone Heating Design Supply Air Temperature Difference {deltaC}
    0.009,                   !- Zone Cooling Design Supply Air Humidity Ratio {kgWater/kgDryAir}
    0.004,                   !- Zone Heating Design Supply Air Humidity Ratio {kgWater/kgDryAir}
    SZ DSOA SPACE1-1,        !- Design Specification Outdoor Air Object Name
    0.0,                     !- Zone Heating Sizing Factor
    0.0,                     !- Zone Cooling Sizing Factor
    DesignDayWithLimit,      !- Cooling Design Air Flow Method
    ,                        !- Cooling Design Air Flow Rate {m3/s}
    ,                        !- Cooling Minimum Air Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Cooling Minimum Air Flow {m3/s}
    ,                        !- Cooling Minimum Air Flow Fraction
    DesignDay,               !- Heating Design Air Flow Method
    ,                        !- Heating Design Air Flow Rate {m3/s}
    ,                        !- Heating Maximum Air Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Heating Maximum Air Flow {m3/s}
    ,                        !- Heating Maximum Air Flow Fraction
    ,                        !- Design Specification Zone Air Distribution Object Name
    No,                      !- Account for Dedicated Outdoor Air System
    NeutralSupplyAir,        !- Dedicated Outdoor Air System Control Strategy
    autosize,                !- Dedicated Outdoor Air Low Setpoint Temperature for Design {C}
    autosize;                !- Dedicated Outdoor Air High Setpoint Temperature for Design {C}

  DesignSpecification:OutdoorAir,
    SZ DSOA SPACE1-1,        !- Name
    sum,                     !- Outdoor Air Method
    0.00236,                 !- Outdoor Air Flow per Person {m3/s-person}
    0.000305,                !- Outdoor Air Flow per Zone Floor Area {m3/s-m2}
    0.0;                     !- Outdoor Air Flow per Zone {m3/s}

  Sizing:Zone,
    SPACE2-1,                !- Zone or ZoneList Name
    SupplyAirTemperature,    !- Zone Cooling Design Supply Air Temperature Input Method
    14.,                     !- Zone Cooling Design Supply Air Temperature {C}
    ,                        !- Zone Cooling Design Supply Air Temperature Difference {deltaC}
    SupplyAirTemperature,    !- Zone Heating Design Supply Air Temperature Input Method
    50.,                     !- Zone Heating Design Supply Air Temperature {C}
    ,                        !- Zone Heating Design Supply Air Temperature Difference {deltaC}
    0.009,                   !- Zone Cooling Design Supply Air Humidity Ratio {kgWater/kgDryAir}
    0.004,                   !- Zone Heating Design Supply Air Humidity Ratio {kgWater/kgDryAir}
    SZ DSOA SPACE2-1,        !- Design Specification Outdoor Air Object Name
    0.0,                     !- Zone Heating Sizing Factor
    0.0,                     !- Zone Cooling Sizing Factor
    DesignDayWithLimit,      !- Cooling Design Air Flow Method
    ,                        !- Cooling Design Air Flow Rate {m3/s}
    ,                        !- Cooling Minimum Air Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Cooling Minimum Air Flow {m3/s}
    ,                        !- Cooling Minimum Air Flow Fraction
    DesignDay,               !- Heating Design Air Flow Method
    ,                        !- Heating Design Air Flow Rate {m3/s}
    ,                        !- Heating Maximum Air Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Heating Maximum Air Flow {m3/s}
    ,                        !- Heating Maximum Air Flow Fraction
    ,                        !- Design Specification Zone Air Distribution Object Name
    No,                      !- Account for Dedicated Outdoor Air System
    NeutralSupplyAir,        !- Dedicated Outdoor Air System Control Strategy
    autosize,                !- Dedicated Outdoor Air Low Setpoint Temperature for Design {C}
    autosize;                !- Dedicated Outdoor Air High Setpoint Temperature for Design {C}

  DesignSpecification:OutdoorAir,
    SZ DSOA SPACE2-1,        !- Name
    sum,                     !- Outdoor Air Method
    0.00236,                 !- Outdoor Air Flow per Person {m3/s-person}
    0.000305,                !- Outdoor Air Flow per Zone Floor Area {m3/s-m2}
    0.0;                     !- Outdoor Air Flow per Zone {m3/s}

  Sizing:Zone,
    SPACE3-1,                !- Zone or ZoneList Name
    SupplyAirTemperature,    !- Zone Cooling Design Supply Air Temperature Input Method
    14.,                     !- Zone Cooling Design Supply Air Temperature {C}
    ,                        !- Zone Cooling Design Supply Air Temperature Difference {deltaC}
    SupplyAirTemperature,    !- Zone Heating Design Supply Air Temperature Input Method
    50.,                     !- Zone Heating Design Supply Air Temperature {C}
    ,                        !- Zone Heating Design Supply Air Temperature Difference {deltaC}
    0.009,                   !- Zone Cooling Design Supply Air Humidity Ratio {kgWater/kgDryAir}
    0.004,                   !- Zone Heating Design Supply Air Humidity Ratio {kgWater/kgDryAir}
    SZ DSOA SPACE3-1,        !- Design Specification Outdoor Air Object Name
    0.0,                     !- Zone Heating Sizing Factor
    0.0,                     !- Zone Cooling Sizing Factor
    DesignDayWithLimit,      !- Cooling Design Air Flow Method
    ,                        !- Cooling Design Air Flow Rate {m3/s}
    ,                        !- Cooling Minimum Air Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Cooling Minimum Air Flow {m3/s}
    ,                        !- Cooling Minimum Air Flow Fraction
    DesignDay,               !- Heating Design Air Flow Method
    ,                        !- Heating Design Air Flow Rate {m3/s}
    ,                        !- Heating Maximum Air Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Heating Maximum Air Flow {m3/s}
    ,                        !- Heating Maximum Air Flow Fraction
    ,                        !- Design Specification Zone Air Distribution Object Name
    No,                      !- Account for Dedicated Outdoor Air System
    NeutralSupplyAir,        !- Dedicated Outdoor Air System Control Strategy
    autosize,                !- Dedicated Outdoor Air Low Setpoint Temperature for Design {C}
    autosize;                !- Dedicated Outdoor Air High Setpoint Temperature for Design {C}

  DesignSpecification:OutdoorAir,
    SZ DSOA SPACE3-1,        !- Name
    sum,                     !- Outdoor Air Method
    0.00236,                 !- Outdoor Air Flow per Person {m3/s-person}
    0.000305,                !- Outdoor Air Flow per Zone Floor Area {m3/s-m2}
    0.0;                     !- Outdoor Air Flow per Zone {m3/s}

  Sizing:Zone,
    SPACE4-1,                !- Zone or ZoneList Name
    SupplyAirTemperature,    !- Zone Cooling Design Supply Air Temperature Input Method
    14.,                     !- Zone Cooling Design Supply Air Temperature {C}
    ,                        !- Zone Cooling Design Supply Air Temperature Difference {deltaC}
    SupplyAirTemperature,    !- Zone Heating Design Supply Air Temperature Input Method
    50.,                     !- Zone Heating Design Supply Air Temperature {C}
    ,                        !- Zone Heating Design Supply Air Temperature Difference {deltaC}
    0.009,                   !- Zone Cooling Design Supply Air Humidity Ratio {kgWater/kgDryAir}
    0.004,                   !- Zone Heating Design Supply Air Humidity Ratio {kgWater/kgDryAir}
    SZ DSOA SPACE4-1,        !- Design Specification Outdoor Air Object Name
    0.0,                     !- Zone Heating Sizing Factor
    0.0,                     !- Zone Cooling Sizing Factor
    DesignDayWithLimit,      !- Cooling Design Air Flow Method
    ,                        !- Cooling Design Air Flow Rate {m3/s}
    ,                        !- Cooling Minimum Air Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Cooling Minimum Air Flow {m3/s}
    ,                        !- Cooling Minimum Air Flow Fraction
    DesignDay,               !- Heating Design Air Flow Method
    ,                        !- Heating Design Air Flow Rate {m3/s}
    ,                        !- Heating Maximum Air Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Heating Maximum Air Flow {m3/s}
    ,                        !- Heating Maximum Air Flow Fraction
    ,                        !- Design Specification Zone Air Distribution Object Name
    No,                      !- Account for Dedicated Outdoor Air System
    NeutralSupplyAir,        !- Dedicated Outdoor Air System Control Strategy
    autosize,                !- Dedicated Outdoor Air Low Setpoint Temperature for Design {C}
    autosize;                !- Dedicated Outdoor Air High Setpoint Temperature for Design {C}

  DesignSpecification:OutdoorAir,
    SZ DSOA SPACE4-1,        !- Name
    sum,                     !- Outdoor Air Method
    0.00236,                 !- Outdoor Air Flow per Person {m3/s-person}
    0.000305,                !- Outdoor Air Flow per Zone Floor Area {m3/s-m2}
    0.0;                     !- Outdoor Air Flow per Zone {m3/s}

  Sizing:Zone,
    SPACE5-1,                !- Zone or ZoneList Name
    SupplyAirTemperature,    !- Zone Cooling Design Supply Air Temperature Input Method
    14.,                     !- Zone Cooling Design Supply Air Temperature {C}
    ,                        !- Zone Cooling Design Supply Air Temperature Difference {deltaC}
    SupplyAirTemperature,    !- Zone Heating Design Supply Air Temperature Input Method
    50.,                     !- Zone Heating Design Supply Air Temperature {C}
    ,                        !- Zone Heating Design Supply Air Temperature Difference {deltaC}
    0.009,                   !- Zone Cooling Design Supply Air Humidity Ratio {kgWater/kgDryAir}
    0.004,                   !- Zone Heating Design Supply Air Humidity Ratio {kgWater/kgDryAir}
    SZ DSOA SPACE5-1,        !- Design Specification Outdoor Air Object Name
    0.0,                     !- Zone Heating Sizing Factor
    0.0,                     !- Zone Cooling Sizing Factor
    DesignDayWithLimit,      !- Cooling Design Air Flow Method
    ,                        !- Cooling Design Air Flow Rate {m3/s}
    ,                        !- Cooling Minimum Air Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Cooling Minimum Air Flow {m3/s}
    ,                        !- Cooling Minimum Air Flow Fraction
    DesignDay,               !- Heating Design Air Flow Method
    ,                        !- Heating Design Air Flow Rate {m3/s}
    ,                        !- Heating Maximum Air Flow per Zone Floor Area {m3/s-m2}
    ,                        !- Heating Maximum Air Flow {m3/s}
    ,                        !- Heating Maximum Air Flow Fraction
    ,                        !- Design Specification Zone Air Distribution Object Name
    No,                      !- Account for Dedicated Outdoor Air System
    NeutralSupplyAir,        !- Dedicated Outdoor Air System Control Strategy
    autosize,                !- Dedicated Outdoor Air Low Setpoint Temperature for Design {C}
    autosize;                !- Dedicated Outdoor Air High Setpoint Temperature for Design {C}

  DesignSpecification:OutdoorAir,
    SZ DSOA SPACE5-1,        !- Name
    sum,                     !- Outdoor Air Method
    0.00236,                 !- Outdoor Air Flow per Person {m3/s-person}
    0.000305,                !- Outdoor Air Flow per Zone Floor Area {m3/s-m2}
    0.0;                     !- Outdoor Air Flow per Zone {m3/s}

  Sizing:System,
    VAV Sys 1,               !- AirLoop Name
    sensible,                !- Type of Load to Size On
    autosize,                !- Design Outdoor Air Flow Rate {m3/s}
    0.3,                     !- Central Heating Maximum System Air Flow Ratio
    4.5,                     !- Preheat Design Temperature {C}
    0.008,                   !- Preheat Design Humidity Ratio {kgWater/kgDryAir}
    11.0,                    !- Precool Design Temperature {C}
    0.008,                   !- Precool Design Humidity Ratio {kgWater/kgDryAir}
    12.8,                    !- Central Cooling Design Supply Air Temperature {C}
    16.7,                    !- Central Heating Design Supply Air Temperature {C}
    noncoincident,           !- Type of Zone Sum to Use
    no,                      !- 100% Outdoor Air in Cooling
    no,                      !- 100% Outdoor Air in Heating
    0.008,                   !- Central Cooling Design Supply Air Humidity Ratio {kgWater/kgDryAir}
    0.008,                   !- Central Heating Design Supply Air Humidity Ratio {kgWater/kgDryAir}
    DesignDay,               !- Cooling Supply Air Flow Rate Method
    0,                       !- Cooling Supply Air Flow Rate {m3/s}
    ,                        !- Cooling Supply Air Flow Rate Per Floor Area {m3/s-m2}
    ,                        !- Cooling Fraction of Autosized Cooling Supply Air Flow Rate
    ,                        !- Cooling Supply Air Flow Rate Per Unit Cooling Capacity {m3/s-W}
    DesignDay,               !- Heating Supply Air Flow Rate Method
    0,                       !- Heating Supply Air Flow Rate {m3/s}
    ,                        !- Heating Supply Air Flow Rate Per Floor Area {m3/s-m2}
    ,                        !- Heating Fraction of Autosized Heating Supply Air Flow Rate
    ,                        !- Heating Fraction of Autosized Cooling Supply Air Flow Rate
    ,                        !- Heating Supply Air Flow Rate Per Unit Heating Capacity {m3/s-W}
    ,                        !- System Outdoor Air Method
    1.0,                     !- Zone Maximum Outdoor Air Fraction {dimensionless}
    CoolingDesignCapacity,   !- Cooling Design Capacity Method
    autosize,                !- Cooling Design Capacity {W}
    ,                        !- Cooling Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Cooling Design Capacity
    HeatingDesignCapacity,   !- Heating Design Capacity Method
    autosize,                !- Heating Design Capacity {W}
    ,                        !- Heating Design Capacity Per Floor Area {W/m2}
    ,                        !- Fraction of Autosized Heating Design Capacity
    VAV;                     !- Central Cooling Capacity Control Method

  Sizing:Plant,
    Hot Water Loop,          !- Plant or Condenser Loop Name
    heating,                 !- Loop Type
    82.,                     !- Design Loop Exit Temperature {C}
    11;                      !- Loop Design Temperature Difference {deltaC}

  Sizing:Plant,
    Chilled Water Loop,      !- Plant or Condenser Loop Name
    cooling,                 !- Loop Type
    7.00,                    !- Design Loop Exit Temperature {C}
    4.00;                    !- Loop Design Temperature Difference {deltaC}

  Schedule:Compact,
    Htg-SetP-Sch,            !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: SummerDesignDay,    !- Field 2
    Until: 24:00,16.7,       !- Field 3
    For: WinterDesignDay,    !- Field 5
    Until: 24:00,22.2,       !- Field 6
    For: WeekDays,           !- Field 8
    Until: 6:00,16.7,        !- Field 9
    Until: 20:00,22.2,       !- Field 11
    Until: 24:00,16.7,       !- Field 13
    For: WeekEnds Holiday,   !- Field 15
    Until: 24:00,16.7,       !- Field 16
    For: AllOtherDays,       !- Field 18
    Until: 24:00,16.7;       !- Field 19

  Schedule:Compact,
    PlenumHtg-SetP-Sch,      !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,12.8;       !- Field 3

  Schedule:Compact,
    Clg-SetP-Sch,            !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: SummerDesignDay,    !- Field 2
    Until: 24:00,23.9,       !- Field 3
    For: WinterDesignDay,    !- Field 5
    Until: 24:00,29.4,       !- Field 6
    For: WeekDays,           !- Field 8
    Until: 6:00,29.4,        !- Field 9
    Until: 20:00,23.9,       !- Field 11
    Until: 24:00,29.4,       !- Field 13
    For: WeekEnds Holiday,   !- Field 15
    Until: 24:00,29.4,       !- Field 16
    For: AllOtherDays,       !- Field 18
    Until: 24:00,29.4;       !- Field 19

  Schedule:Compact,
    PlenumClg-SetP-Sch,      !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,40.0;       !- Field 3

  Schedule:Compact,
    Zone Control Type Sched, !- Name
    Control Type,            !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: SummerDesignDay,    !- Field 2
    Until: 24:00,2,          !- Field 3
    For: WinterDesignDay,    !- Field 5
    Until: 24:00,1,          !- Field 6
    For: AllOtherDays,       !- Field 8
    Until: 24:00,4;          !- Field 9

  Schedule:Compact,
    Min OA Sched,            !- Name
    Fraction,                !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: Weekdays,           !- Field 2
    Until: 6:00,0.02,        !- Field 3
    Until: 20:00,1.0,        !- Field 5
    Until: 24:00,0.02,       !- Field 7
    For: AllOtherDays,       !- Field 9
    Until: 24:00,0.02;       !- Field 10

  Schedule:Compact,
    FanAvailSched,           !- Name
    Fraction,                !- Schedule Type Limits Name
    Through: 3/31,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,1.0,        !- Field 3
    Through: 9/30,           !- Field 5
    For: WeekDays,           !- Field 6
    Until: 6:00,0.0,         !- Field 7
    Until: 20:00,1.0,        !- Field 9
    Until: 24:00,0.0,        !- Field 11
    For: SummerDesignDay WinterDesignDay, !- Field 13
    Until: 24:00,1.0,        !- Field 14
    For: AllOtherDays,       !- Field 16
    Until: 24:00,0.0,        !- Field 17
    Through: 12/31,          !- Field 19
    For: AllDays,            !- Field 20
    Until: 24:00,1.0;        !- Field 21

  Schedule:Compact,
    CoolingCoilAvailSched,   !- Name
    Fraction,                !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: WeekDays,           !- Field 2
    Until: 6:00,0.0,         !- Field 3
    Until: 20:00,1.0,        !- Field 5
    Until: 24:00,0.0,        !- Field 7
    For: SummerDesignDay WinterDesignDay, !- Field 9
    Until: 24:00,1.0,        !- Field 10
    For: AllOtherDays,       !- Field 12
    Until: 24:00,0.0;        !- Field 13

  Schedule:Compact,
    CoolingPumpAvailSched,   !- Name
    Fraction,                !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,1.0;        !- Field 3

  Schedule:Compact,
    ReheatCoilAvailSched,    !- Name
    Fraction,                !- Schedule Type Limits Name
    Through: 3/31,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,1.0,        !- Field 3
    Through: 9/30,           !- Field 5
    For: WeekDays,           !- Field 6
    Until: 6:00,0.0,         !- Field 7
    Until: 20:00,1.0,        !- Field 9
    Until: 24:00,0.0,        !- Field 11
    For: SummerDesignDay WinterDesignDay, !- Field 13
    Until: 24:00,1.0,        !- Field 14
    For: AllOtherDays,       !- Field 16
    Until: 24:00,0.0,        !- Field 17
    Through: 12/31,          !- Field 19
    For: AllDays,            !- Field 20
    Until: 24:00,1.0;        !- Field 21

  Schedule:Compact,
    CW Loop Temp Schedule,   !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,7.22;       !- Field 3

  Schedule:Compact,
    HW Loop Temp Schedule,   !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,82;         !- Field 3

  Schedule:Compact,
    PlantOnSched,            !- Name
    Fraction,                !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,1.0;        !- Field 3

  Schedule:Compact,
    Seasonal Reset Supply Air Temp Sch,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 3/31,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,16.0,       !- Field 3
    Through: 9/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,13.0,       !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,16.0;       !- Field 11

  Schedule:Compact,
    Seasonal Reset Supply Air heating Temp Sch,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 3/31,           !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,15.5,       !- Field 3
    Through: 9/30,           !- Field 5
    For: AllDays,            !- Field 6
    Until: 24:00,12.5,       !- Field 7
    Through: 12/31,          !- Field 9
    For: AllDays,            !- Field 10
    Until: 24:00,15.5;       !- Field 11

  Schedule:Compact,
    OA Cooling Supply Air Temp Sch,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,11.5;       !- Field 3

  Schedule:Compact,
    OA Heating Supply Air Temp Sch,  !- Name
    Temperature,             !- Schedule Type Limits Name
    Through: 12/31,          !- Field 1
    For: AllDays,            !- Field 2
    Until: 24:00,4.5;        !- Field 3

  OutdoorAir:NodeList,
    OutsideAirInletNodes;    !- Node or NodeList Name 1

  NodeList,
    OutsideAirInletNodes,    !- Name
    Outside Air Inlet Node 1;!- Node 1 Name

  ZoneHVAC:EquipmentConnections,
    SPACE1-1,                !- Zone Name
    SPACE1-1 Eq,             !- Zone Conditioning Equipment List Name
    SPACE1-1 In Node,        !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    SPACE1-1 Node,           !- Zone Air Node Name
    SPACE1-1 Out Node;       !- Zone Return Air Node or NodeList Name

  ZoneHVAC:EquipmentConnections,
    SPACE2-1,                !- Zone Name
    SPACE2-1 Eq,             !- Zone Conditioning Equipment List Name
    SPACE2-1 In Node,        !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    SPACE2-1 Node,           !- Zone Air Node Name
    SPACE2-1 Out Node;       !- Zone Return Air Node or NodeList Name

  ZoneHVAC:EquipmentConnections,
    SPACE3-1,                !- Zone Name
    SPACE3-1 Eq,             !- Zone Conditioning Equipment List Name
    SPACE3-1 In Node,        !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    SPACE3-1 Node,           !- Zone Air Node Name
    SPACE3-1 Out Node;       !- Zone Return Air Node or NodeList Name

  ZoneHVAC:EquipmentConnections,
    SPACE4-1,                !- Zone Name
    SPACE4-1 Eq,             !- Zone Conditioning Equipment List Name
    SPACE4-1 In Node,        !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    SPACE4-1 Node,           !- Zone Air Node Name
    SPACE4-1 Out Node;       !- Zone Return Air Node or NodeList Name

  ZoneHVAC:EquipmentConnections,
    SPACE5-1,                !- Zone Name
    SPACE5-1 Eq,             !- Zone Conditioning Equipment List Name
    SPACE5-1 In Node,        !- Zone Air Inlet Node or NodeList Name
    ,                        !- Zone Air Exhaust Node or NodeList Name
    SPACE5-1 Node,           !- Zone Air Node Name
    SPACE5-1 Out Node;       !- Zone Return Air Node or NodeList Name

  ZoneControl:Thermostat,
    SPACE1-1 Control,        !- Name
    SPACE1-1,                !- Zone or ZoneList Name
    Zone Control Type Sched, !- Control Type Schedule Name
    ThermostatSetpoint:SingleCooling,  !- Control 1 Object Type
    CoolingSetPoint,         !- Control 1 Name
    ThermostatSetpoint:SingleHeating,  !- Control 2 Object Type
    HeatingSetpoint,         !- Control 2 Name
    ThermostatSetpoint:DualSetpoint,  !- Control 3 Object Type
    DualSetPoint;            !- Control 3 Name

  ZoneControl:Thermostat,
    SPACE2-1 Control,        !- Name
    SPACE2-1,                !- Zone or ZoneList Name
    Zone Control Type Sched, !- Control Type Schedule Name
    ThermostatSetpoint:SingleCooling,  !- Control 1 Object Type
    CoolingSetPoint,         !- Control 1 Name
    ThermostatSetpoint:SingleHeating,  !- Control 2 Object Type
    HeatingSetpoint,         !- Control 2 Name
    ThermostatSetpoint:DualSetpoint,  !- Control 3 Object Type
    DualSetPoint;            !- Control 3 Name

  ZoneControl:Thermostat,
    SPACE3-1 Control,        !- Name
    SPACE3-1,                !- Zone or ZoneList Name
    Zone Control Type Sched, !- Control Type Schedule Name
    ThermostatSetpoint:SingleCooling,  !- Control 1 Object Type
    CoolingSetPoint,         !- Control 1 Name
    ThermostatSetpoint:SingleHeating,  !- Control 2 Object Type
    HeatingSetpoint,         !- Control 2 Name
    ThermostatSetpoint:DualSetpoint,  !- Control 3 Object Type
    DualSetPoint;            !- Control 3 Name

  ZoneControl:Thermostat,
    SPACE4-1 Control,        !- Name
    SPACE4-1,                !- Zone or ZoneList Name
    Zone Control Type Sched, !- Control Type Schedule Name
    ThermostatSetpoint:SingleCooling,  !- Control 1 Object Type
    CoolingSetPoint,         !- Control 1 Name
    ThermostatSetpoint:SingleHeating,  !- Control 2 Object Type
    HeatingSetpoint,         !- Control 2 Name
    ThermostatSetpoint:DualSetpoint,  !- Control 3 Object Type
    DualSetPoint;            !- Control 3 Name

  ZoneControl:Thermostat,
    SPACE5-1 Control,        !- Name
    SPACE5-1,                !- Zone or ZoneList Name
    Zone Control Type Sched, !- Control Type Schedule Name
    ThermostatSetpoint:SingleCooling,  !- Control 1 Object Type
    CoolingSetPoint,         !- Control 1 Name
    ThermostatSetpoint:SingleHeating,  !- Control 2 Object Type
    HeatingSetpoint,         !- Control 2 Name
    ThermostatSetpoint:DualSetpoint,  !- Control 3 Object Type
    DualSetPoint;            !- Control 3 Name

  ThermostatSetpoint:SingleHeating,
    HeatingSetpoint,         !- Name
    Htg-SetP-Sch;            !- Setpoint Temperature Schedule Name

  ThermostatSetpoint:SingleCooling,
    CoolingSetpoint,         !- Name
    Clg-SetP-Sch;            !- Setpoint Temperature Schedule Name

  ThermostatSetpoint:SingleHeating,
    PlenumHeatingSetpoint,   !- Name
    PlenumHtg-SetP-Sch;      !- Setpoint Temperature Schedule Name

  ThermostatSetpoint:SingleCooling,
    PlenumCoolingSetpoint,   !- Name
    PlenumClg-SetP-Sch;      !- Setpoint Temperature Schedule Name

  ThermostatSetpoint:DualSetpoint,
    DualSetPoint,            !- Name
    Htg-SetP-Sch,            !- Heating Setpoint Temperature Schedule Name
    Clg-SetP-Sch;            !- Cooling Setpoint Temperature Schedule Name

  ZoneHVAC:EquipmentList,
    SPACE1-1 Eq,             !- Name
    SequentialLoad,          !- Load Distribution Scheme
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    SPACE1-1 ATU,            !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ,                        !- Zone Equipment 1 Sequential Cooling Fraction Schedule Name
    ;                        !- Zone Equipment 1 Sequential Heating Fraction Schedule Name

  ZoneHVAC:EquipmentList,
    SPACE2-1 Eq,             !- Name
    SequentialLoad,          !- Load Distribution Scheme
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    SPACE2-1 ATU,            !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ,                        !- Zone Equipment 1 Sequential Cooling Fraction Schedule Name
    ;                        !- Zone Equipment 1 Sequential Heating Fraction Schedule Name

  ZoneHVAC:EquipmentList,
    SPACE3-1 Eq,             !- Name
    SequentialLoad,          !- Load Distribution Scheme
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    SPACE3-1 ATU,            !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ,                        !- Zone Equipment 1 Sequential Cooling Fraction Schedule Name
    ;                        !- Zone Equipment 1 Sequential Heating Fraction Schedule Name

  ZoneHVAC:EquipmentList,
    SPACE4-1 Eq,             !- Name
    SequentialLoad,          !- Load Distribution Scheme
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    SPACE4-1 ATU,            !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ,                        !- Zone Equipment 1 Sequential Cooling Fraction Schedule Name
    ;                        !- Zone Equipment 1 Sequential Heating Fraction Schedule Name

  ZoneHVAC:EquipmentList,
    SPACE5-1 Eq,             !- Name
    SequentialLoad,          !- Load Distribution Scheme
    ZoneHVAC:AirDistributionUnit,  !- Zone Equipment 1 Object Type
    SPACE5-1 ATU,            !- Zone Equipment 1 Name
    1,                       !- Zone Equipment 1 Cooling Sequence
    1,                       !- Zone Equipment 1 Heating or No-Load Sequence
    ,                        !- Zone Equipment 1 Sequential Cooling Fraction Schedule Name
    ;                        !- Zone Equipment 1 Sequential Heating Fraction Schedule Name

  ZoneHVAC:AirDistributionUnit,
    SPACE1-1 ATU,            !- Name
    SPACE1-1 In Node,        !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:UserDefined,  !- Air Terminal Object Type
    SPACE1-1 VAV Reheat;     !- Air Terminal Name

  ZoneHVAC:AirDistributionUnit,
    SPACE2-1 ATU,            !- Name
    SPACE2-1 In Node,        !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:UserDefined,  !- Air Terminal Object Type
    SPACE2-1 VAV Reheat;     !- Air Terminal Name

  ZoneHVAC:AirDistributionUnit,
    SPACE3-1 ATU,            !- Name
    SPACE3-1 In Node,        !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:UserDefined,  !- Air Terminal Object Type
    SPACE3-1 VAV Reheat;     !- Air Terminal Name

  ZoneHVAC:AirDistributionUnit,
    SPACE4-1 ATU,            !- Name
    SPACE4-1 In Node,        !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:UserDefined,  !- Air Terminal Object Type
    SPACE4-1 VAV Reheat;     !- Air Terminal Name

  ZoneHVAC:AirDistributionUnit,
    SPACE5-1 ATU,            !- Name
    SPACE5-1 In Node,        !- Air Distribution Unit Outlet Node Name
    AirTerminal:SingleDuct:UserDefined,  !- Air Terminal Object Type
    SPACE5-1 VAV Reheat;     !- Air Terminal Name

  AirTerminal:SingleDuct:UserDefined,
    SPACE1-1 VAV Reheat,     !- Name
    Space1 ATU Sim Programs, !- Overall Model Simulation Program Calling Manager Name
    Space1 ATU Init Programs,!- Model Setup and Sizing Program Calling Manager Name
    SPACE1-1 ATU In Node,    !- Primary Air Inlet Node Name
    SPACE1-1 In Node,        !- Primary Air Outlet Node Name
    ,                        !- Secondary Air Inlet Node Name
    ,                        !- Secondary Air Outlet Node Name
    1,                       !- Number of Plant Loop Connections
    SPACE1-1 Zone Coil Water In Node,  !- Plant Connection 1 Inlet Node Name
    SPACE1-1 Zone Coil Water Out Node;  !- Plant Connection 1 Outlet Node Name

  AirTerminal:SingleDuct:UserDefined,
    SPACE2-1 VAV Reheat,     !- Name
    Space2 ATU Sim Programs, !- Overall Model Simulation Program Calling Manager Name
    Space2 ATU Init Programs,!- Model Setup and Sizing Program Calling Manager Name
    SPACE2-1 ATU In Node,    !- Primary Air Inlet Node Name
    SPACE2-1 In Node,        !- Primary Air Outlet Node Name
    ,                        !- Secondary Air Inlet Node Name
    ,                        !- Secondary Air Outlet Node Name
    1,                       !- Number of Plant Loop Connections
    SPACE2-1 Zone Coil Water In Node,  !- Plant Connection 1 Inlet Node Name
    SPACE2-1 Zone Coil Water Out Node;  !- Plant Connection 1 Outlet Node Name

  AirTerminal:SingleDuct:UserDefined,
    SPACE3-1 VAV Reheat,     !- Name
    Space3 ATU Sim Programs, !- Overall Model Simulation Program Calling Manager Name
    Space3 ATU Init Programs,!- Model Setup and Sizing Program Calling Manager Name
    SPACE3-1 ATU In Node,    !- Primary Air Inlet Node Name
    SPACE3-1 In Node,        !- Primary Air Outlet Node Name
    ,                        !- Secondary Air Inlet Node Name
    ,                        !- Secondary Air Outlet Node Name
    1,                       !- Number of Plant Loop Connections
    SPACE3-1 Zone Coil Water In Node,  !- Plant Connection 1 Inlet Node Name
    SPACE3-1 Zone Coil Water Out Node;  !- Plant Connection 1 Outlet Node Name

  AirTerminal:SingleDuct:UserDefined,
    SPACE4-1 VAV Reheat,     !- Name
    Space4 ATU Sim Programs, !- Overall Model Simulation Program Calling Manager Name
    Space4 ATU Init Programs,!- Model Setup and Sizing Program Calling Manager Name
    SPACE4-1 ATU In Node,    !- Primary Air Inlet Node Name
    SPACE4-1 In Node,        !- Primary Air Outlet Node Name
    ,                        !- Secondary Air Inlet Node Name
    ,                        !- Secondary Air Outlet Node Name
    1,                       !- Number of Plant Loop Connections
    SPACE4-1 Zone Coil Water In Node,  !- Plant Connection 1 Inlet Node Name
    SPACE4-1 Zone Coil Water Out Node;  !- Plant Connection 1 Outlet Node Name

  AirTerminal:SingleDuct:UserDefined,
    SPACE5-1 VAV Reheat,     !- Name
    Space5 ATU Sim Programs, !- Overall Model Simulation Program Calling Manager Name
    Space5 ATU Init Programs,!- Model Setup and Sizing Program Calling Manager Name
    SPACE5-1 ATU In Node,    !- Primary Air Inlet Node Name
    SPACE5-1 In Node,        !- Primary Air Outlet Node Name
    ,                        !- Secondary Air Inlet Node Name
    ,                        !- Secondary Air Outlet Node Name
    1,                       !- Number of Plant Loop Connections
    SPACE5-1 Zone Coil Water In Node,  !- Plant Connection 1 Inlet Node Name
    SPACE5-1 Zone Coil Water Out Node;  !- Plant Connection 1 Outlet Node Name

  AirLoopHVAC:ReturnPath,
    ReturnAirPath1,          !- Name
    PLENUM-1 Out Node,       !- Return Air Path Outlet Node Name
    AirLoopHVAC:ReturnPlenum,!- Component 1 Object Type
    Return-Plenum-1;         !- Component 1 Name

  AirLoopHVAC:ReturnPlenum,
    Return-Plenum-1,         !- Name
    PLENUM-1,                !- Zone Name
    PLENUM-1 Node,           !- Zone Node Name
    PLENUM-1 Out Node,       !- Outlet Node Name
    ,                        !- Induced Air Outlet Node or NodeList Name
    SPACE1-1 Out Node,       !- Inlet 1 Node Name
    SPACE2-1 Out Node,       !- Inlet 2 Node Name
    SPACE3-1 Out Node,       !- Inlet 3 Node Name
    SPACE4-1 Out Node,       !- Inlet 4 Node Name
    SPACE5-1 Out Node;       !- Inlet 5 Node Name

  AirLoopHVAC:SupplyPath,
    Zone Supply Air Path 1,  !- Name
    Zone Eq In Node,         !- Supply Air Path Inlet Node Name
    AirLoopHVAC:ZoneSplitter,!- Component 1 Object Type
    Zone Supply Air Splitter 1;  !- Component 1 Name

  AirLoopHVAC:ZoneSplitter,
    Zone Supply Air Splitter 1,  !- Name
    Zone Eq In Node,         !- Inlet Node Name
    SPACE1-1 ATU In Node,    !- Outlet 1 Node Name
    SPACE2-1 ATU In Node,    !- Outlet 2 Node Name
    SPACE3-1 ATU In Node,    !- Outlet 3 Node Name
    SPACE4-1 ATU In Node,    !- Outlet 4 Node Name
    SPACE5-1 ATU In Node;    !- Outlet 5 Node Name

  AirLoopHVAC,
    VAV Sys 1,               !- Name
    ,                        !- Controller List Name
    VAV Sys 1 Avail List,    !- Availability Manager List Name
    autosize,                !- Design Supply Air Flow Rate {m3/s}
    VAV Sys 1 Branches,      !- Branch List Name
    ,                        !- Connector List Name
    VAV Sys 1 Inlet Node,    !- Supply Side Inlet Node Name
    PLENUM-1 Out Node,       !- Demand Side Outlet Node Name
    Zone Eq In Node,         !- Demand Side Inlet Node Names
    VAV Sys 1 Outlet Node;   !- Supply Side Outlet Node Names

  AvailabilityManagerAssignmentList,
    VAV Sys 1 Avail List,    !- Name
    AvailabilityManager:Scheduled,  !- Availability Manager 1 Object Type
    VAV Sys 1 Avail;         !- Availability Manager 1 Name

  AvailabilityManager:Scheduled,
    VAV Sys 1 Avail,         !- Name
    FanAvailSched;           !- Schedule Name

  BranchList,
    VAV Sys 1 Branches,      !- Name
    VAV Sys 1 Main Branch;   !- Branch 1 Name

  Branch,
    VAV Sys 1 Main Branch,   !- Name
    ,                        !- Pressure Drop Curve Name
    AirLoopHVAC:OutdoorAirSystem,  !- Component 1 Object Type
    OA Sys 1,                !- Component 1 Name
    VAV Sys 1 Inlet Node,    !- Component 1 Inlet Node Name
    Mixed Air Node 1,        !- Component 1 Outlet Node Name
    Coil:UserDefined,        !- Component 2 Object Type
    Main Cooling Coil 1,     !- Component 2 Name
    Mixed Air Node 1,        !- Component 2 Inlet Node Name
    Main Cooling Coil 1 Outlet Node,  !- Component 2 Outlet Node Name
    Coil:UserDefined,        !- Component 3 Object Type
    Main Heating Coil 1,     !- Component 3 Name
    Main Cooling Coil 1 Outlet Node,  !- Component 3 Inlet Node Name
    Main Heating Coil 1 Outlet Node,  !- Component 3 Outlet Node Name
    Fan:VariableVolume,      !- Component 4 Object Type
    Supply Fan 1,            !- Component 4 Name
    Main Heating Coil 1 Outlet Node,  !- Component 4 Inlet Node Name
    VAV Sys 1 Outlet Node;   !- Component 4 Outlet Node Name

  AirLoopHVAC:OutdoorAirSystem,
    OA Sys 1,                !- Name
    OA Sys 1 Controllers,    !- Controller List Name
    OA Sys 1 Equipment,      !- Outdoor Air Equipment List Name
    VAV Sys 1 Avail List;    !- Availability Manager List Name

  AirLoopHVAC:ControllerList,
    OA Sys 1 Controllers,    !- Name
    Controller:OutdoorAir,   !- Controller 1 Object Type
    OA Controller 1,         !- Controller 1 Name
    Controller:WaterCoil,    !- Controller 2 Object Type
    OA HC Controller 1;      !- Controller 2 Name

  AirLoopHVAC:OutdoorAirSystem:EquipmentList,
    OA Sys 1 Equipment,      !- Name
    Coil:Heating:Water,      !- Component 1 Object Type
    OA Heating Coil 1,       !- Component 1 Name
    Coil:UserDefined,        !- Component 2 Object Type
    OA Cooling Coil 1,       !- Component 2 Name
    OutdoorAir:Mixer,        !- Component 3 Object Type
    OA Mixing Box 1;         !- Component 3 Name

  Coil:Heating:Water,
    OA Heating Coil 1,       !- Name
    CoolingCoilAvailSched,   !- Availability Schedule Name
    autosize,                !- U-Factor Times Area Value {W/K}
    autosize,                !- Maximum Water Flow Rate {m3/s}
    OA Heating Coil 1 Water Inlet Node,  !- Water Inlet Node Name
    OA Heating Coil 1 Water Outlet Node,  !- Water Outlet Node Name
    Outside Air Inlet Node 1,!- Air Inlet Node Name
    OA Heating Coil 1 Air Outlet Node,  !- Air Outlet Node Name
    UFactorTimesAreaAndDesignWaterFlowRate,  !- Performance Input Method
    autosize,                !- Rated Capacity {W}
    82.2,                    !- Rated Inlet Water Temperature {C}
    16.6,                    !- Rated Inlet Air Temperature {C}
    71.1,                    !- Rated Outlet Water Temperature {C}
    32.2,                    !- Rated Outlet Air Temperature {C}
    ;                        !- Rated Ratio for Air and Water Convection

  Coil:UserDefined,
    OA Cooling Coil 1,       !- Name
    OA Cooling Coil Model Program Manager,  !- Overall Model Simulation Program Calling Manager Name
    OA Cooling Coil Init Program Manager,  !- Model Setup and Sizing Program Calling Manager Name
    1,                       !- Number of Air Connections
    OA Heating Coil 1 Air Outlet Node,  !- Air Connection 1 Inlet Node Name
    OA Mixing Box 1 Inlet Node,  !- Air Connection 1 Outlet Node Name
    ,                        !- Air Connection 2 Inlet Node Name
    ,                        !- Air Connection 2 Outlet Node Name
    Yes,                     !- Plant Connection is Used
    OA Cooling Coil 1 Water Inlet Node,  !- Plant Connection Inlet Node Name
    OA Cooling Coil 1 Water Outlet Node;  !- Plant Connection Outlet Node Name

  EnergyManagementSystem:ProgramCallingManager,
    OA Cooling Coil Model Program Manager,  !- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    OA_CWCoil_ModelInput,    !- Program Name 1
    CW_Coil_Sim_Model,       !- Program Name 2
    OA_CWCoil_ModelOuput;    !- Program Name 3

  EnergyManagementSystem:Program,
    OA_CWCoil_ModelInput,    !- Name
    Set Air_Mdot       = OACoil_Air_Mdot,  !- Program Line 1
    Set Air_Tsp        = OACoil_Air_Tsp,  !- Program Line 2
    Set Water_Mdot     = OACoil_Water_Mdot,  !- <none>
    Set Water_cp       = OACoil_Water_cp,  !- <none>
    Set Air_Tinlet     = OACoil_Air_Tinlet,  !- <none>
    Set Water_Tinlet   = OACoil_Water_Tinlet,  !- <none>
    Set Air_Winlet     = OACoil_Air_Winlet,  !- <none>
    Set Water_Mdot_Max = OACoil_Mdot_Max,  !- <none>
    Set Coil_Eff       = 0.68;  !- <none>

  EnergyManagementSystem:Program,
    OA_CWCoil_ModelOuput,    !- Name
    Set OACoil_Water_MdotRequest = Water_MdotRequest,  !- Program Line 1
    Set OACoil_Air_Tout          = Air_Tout,  !- Program Line 2
    Set OACoil_Air_Wout          = Air_Wout,  !- <none>
    Set OACoil_tot_cool_Power    = Tot_Cool_Power,  !- <none>
    Set OACoil_tot_cool_Energy   = Tot_Cool_Power * SystemTimestep * 3600,  !- <none>
    Set OACoil_Air_MdotOut       = Air_Mdot,  !- <none>
    Set OACoil_Water_Tout        = Water_Tout;  !- <none>

  EnergyManagementSystem:ProgramCallingManager,
    OA Cooling Coil Init Program Manager,  !- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    InitOASimpleCoilModel;   !- Program Name 1

  EnergyManagementSystem:Program,
    InitOASimpleCoilModel,   !- Name
    Set CWLoopExitTemp = 7.0,!- Program Line 1
    Set CWLoopDeltaTemp = 0.5 * 4.0,  !- Program Line 2
    Set CW_CP = @CPCW CWLoopExitTemp,  !- <none>
    Set CW_rho = @RhoH2O CWLoopExitTemp,  !- <none>
    Set Dummy = OA_Design_Tdb,  !- <none>
    Set Dummy = OA_Design_W, !- <none>
    Set Dummy = OA_Design_Vdot,  !- <none>
    Set Houtdoor = @HFnTdbW OA_Design_Tdb OA_Design_W,  !- <none>
    Set OA_rho = @RhoAirFnPbTdbW OA_Press OA_Design_Tdb OA_Design_W,  !- <none>
    Set OA_mdot = OA_Design_Vdot * OA_rho,  !- <none>
    Set Hleaving = @HFnTdbW 11.0 0.008,  !- <none>
    Set OACoil_CoolDes_Qdot = OA_mdot * ( Houtdoor - Hleaving),  !- <none>
    Set OACoil_Water_DesignVdot = OACoil_CoolDes_Qdot / (( CW_rho * CW_CP) * CWLoopDeltaTemp),  !- <none>
    Set OACoil_Mdot_Min = 0.0,  !- <none>
    Set OACoil_Mdot_Max = OACoil_Water_DesignVdot * CW_rho;  !- <none>

  EnergyManagementSystem:OutputVariable,
    OA CW Coil Total Cooling Rate,  !- Name
    OACoil_tot_cool_Power,   !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimestep,          !- Update Frequency
    Oa_CWCoil_ModelOuput,    !- EMS Program or Subroutine Name
    W;                       !- Units

  EnergyManagementSystem:Actuator,
    OACoil_Mdot_Min,         !- Name
    OA Cooling Coil 1,       !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Minimum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    OACoil_Mdot_Max,         !- Name
    OA Cooling Coil 1,       !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Maximum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    OACoil_Water_Tout,       !- Name
    OA Cooling Coil 1,       !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    OACoil_Water_MdotRequest,!- Name
    OA Cooling Coil 1,       !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Mass Flow Rate;          !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    OACoil_Water_DesignVdot, !- Name
    OA Cooling Coil 1,       !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Design Volume Flow Rate; !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    OACoil_Air_Tout,         !- Name
    OA Cooling Coil 1,       !- Actuated Component Unique Name
    Air Connection 1,        !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    OACoil_Air_Wout,         !- Name
    OA Cooling Coil 1,       !- Actuated Component Unique Name
    Air Connection 1,        !- Actuated Component Type
    Outlet Humidity Ratio;   !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    OACoil_Air_MdotOut,      !- Name
    OA Cooling Coil 1,       !- Actuated Component Unique Name
    Air Connection 1,        !- Actuated Component Type
    Mass Flow Rate;          !- Actuated Component Control Type

  EnergyManagementSystem:Sensor,
    OACoil_Air_Tsp,          !- Name
    OA Mixing Box 1 Inlet Node,  !- Output:Variable or Output:Meter Index Key Name
    System Node Setpoint Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:InternalVariable,
    OACoil_Air_Tinlet,       !- Name
    OA Cooling Coil 1,       !- Internal Data Index Key Name
    Inlet Temperature for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    OACoil_Air_Mdot,         !- Name
    OA Cooling Coil 1,       !- Internal Data Index Key Name
    Inlet Mass Flow Rate for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    OACoil_Air_Winlet,       !- Name
    OA Cooling Coil 1,       !- Internal Data Index Key Name
    Inlet Humidity Ratio for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    OACoil_Air_rho,          !- Name
    OA Cooling Coil 1,       !- Internal Data Index Key Name
    Inlet Density for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    OACoil_Air_cp,           !- Name
    OA Cooling Coil 1,       !- Internal Data Index Key Name
    Inlet Specific Heat for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    OACoil_Water_Tinlet,     !- Name
    OA Cooling Coil 1,       !- Internal Data Index Key Name
    Inlet Temperature for Plant Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    OACoil_Water_Mdot,       !- Name
    OA Cooling Coil 1,       !- Internal Data Index Key Name
    Inlet Mass Flow Rate for Plant Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    OACoil_Water_rho,        !- Name
    OA Cooling Coil 1,       !- Internal Data Index Key Name
    Inlet Density for Plant Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    OACoil_Water_cp,         !- Name
    OA Cooling Coil 1,       !- Internal Data Index Key Name
    Inlet Specific Heat for Plant Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    OA_Design_Vdot,          !- Name
    VAV SYS 1,               !- Internal Data Index Key Name
    Air System Outdoor Air Design Volume Flow Rate;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    OA_Design_Tdb,           !- Name
    VAV SYS 1,               !- Internal Data Index Key Name
    Air System Cooling Design Outdoor Air Temperature;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    OA_Design_W,             !- Name
    VAV SYS 1,               !- Internal Data Index Key Name
    Air System Cooling Design Outdoor Air Humidity Ratio;  !- Internal Data Type

  OutdoorAir:Mixer,
    OA Mixing Box 1,         !- Name
    Mixed Air Node 1,        !- Mixed Air Node Name
    OA Mixing Box 1 Inlet Node,  !- Outdoor Air Stream Node Name
    Relief Air Outlet Node 1,!- Relief Air Stream Node Name
    VAV Sys 1 Inlet Node;    !- Return Air Stream Node Name

  SetpointManager:MixedAir,
    Mixed Air Temp Manager 2,!- Name
    Temperature,             !- Control Variable
    VAV Sys 1 Outlet Node,   !- Reference Setpoint Node Name
    Main Heating Coil 1 Outlet Node,  !- Fan Inlet Node Name
    VAV Sys 1 Outlet Node,   !- Fan Outlet Node Name
    Main Cooling Coil 1 Outlet Node;  !- Setpoint Node or NodeList Name

  Coil:UserDefined,
    Main Cooling Coil 1,     !- Name
    Main Cooling Coil Model Program Manager,  !- Overall Model Simulation Program Calling Manager Name
    Main Cooling Coil Init Program Manager,  !- Model Setup and Sizing Program Calling Manager Name
    1,                       !- Number of Air Connections
    Mixed Air Node 1,        !- Air Connection 1 Inlet Node Name
    Main Cooling Coil 1 Outlet Node,  !- Air Connection 1 Outlet Node Name
    ,                        !- Air Connection 2 Inlet Node Name
    ,                        !- Air Connection 2 Outlet Node Name
    Yes,                     !- Plant Connection is Used
    Main Cooling Coil 1 Water Inlet Node,  !- Plant Connection Inlet Node Name
    Main Cooling Coil 1 Water Outlet Node;  !- Plant Connection Outlet Node Name

  EnergyManagementSystem:ProgramCallingManager,
    Main Cooling Coil Model Program Manager,  !- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    MainCWCoil1_ModelInput,  !- Program Name 1
    CW_Coil_Sim_Model,       !- Program Name 2
    MainCWCoil1_ModelOuput;  !- Program Name 3

  EnergyManagementSystem:Program,
    MainCWCoil1_ModelInput,  !- Name
    Set Air_Mdot       = CWcoil1_Air_Mdot,  !- Program Line 1
    Set Air_Tsp        = CWcoil1_Air_Tsp,  !- Program Line 2
    Set Water_Mdot     = CWcoil1_Water_Mdot,  !- <none>
    Set Water_cp       = CWcoil1_Water_cp,  !- <none>
    SEt Air_Tinlet     = CWcoil1_Air_Tinlet,  !- <none>
    Set Water_Tinlet   = CWcoil1_Water_Tinlet,  !- <none>
    SEt Air_Winlet     = CWcoil1_Air_Winlet,  !- <none>
    Set Water_Mdot_Max = CWcoil1_Mdot_Max,  !- <none>
    Set Coil_Eff       = 0.7;!- <none>

  EnergyManagementSystem:Program,
    MainCWCoil1_ModelOuput,  !- Name
    Set CWcoil1_Water_MdotRequest = Water_MdotRequest,  !- Program Line 1
    Set CWcoil1_Air_Tout          = Air_Tout,  !- Program Line 2
    Set CWcoil1_Air_Wout          = Air_Wout,  !- <none>
    Set CWcoil1_tot_cool_Power    = Tot_Cool_Power,  !- <none>
    Set CWcoil1_tot_cool_Energy   = Tot_Cool_Power * SystemTimestep * 3600,  !- <none>
    Set CWcoil1_Air_MdotOut       = Air_Mdot,  !- <none>
    Set CWcoil1_Water_Tout        = Water_Tout;  !- <none>

  EnergyManagementSystem:GlobalVariable,
    Air_Mdot,                !- Erl Variable 1 Name
    Air_Tsp,                 !- Erl Variable 2 Name
    Water_Mdot,              !- Erl Variable 3 Name
    Water_cp,                !- <none>
    Air_Tinlet,              !- <none>
    Water_Tinlet,            !- <none>
    Air_Winlet,              !- <none>
    Water_Mdot_Max,          !- <none>
    Coil_Eff,                !- <none>
    Water_MdotRequest,       !- <none>
    Air_Tout,                !- <none>
    Tot_Cool_Power,          !- <none>
    Air_Wout,                !- <none>
    Water_Tout;              !- <none>

  EnergyManagementSystem:Program,
    CW_Coil_Sim_Model,       !- Name
    IF Air_Mdot == 0.0,      !- Program Line 1
    SET Air_Tout = Air_Tinlet,  !- Program Line 2
    SET Air_Wout = Air_Winlet,  !- <none>
    Set Air_MdotOut = Air_Mdot,  !- <none>
    Set tot_cool_Power = 0.0,!- <none>
    Set Water_Tout = Water_Tinlet,  !- <none>
    Set Water_MdotRequest = 0.0,  !- <none>
    RETURN,                  !- <none>
    ENDIF,                   !- <none>
    Set AirIn_Enth     = @HFnTdbW Air_Tinlet Air_Winlet,  !- <none>
    Set Air_Wout_Limit = @WFnTdbRhPb Water_Tinlet 1 OA_Press,  !- <none>
    Set AirOut_Enth_Limit = @HFnTdbW Water_Tinlet Air_Wout_Limit,  !- <none>
    Set MaxQdot      = Coil_Eff * Air_Mdot * (AirIn_Enth - AirOut_Enth_Limit),  !- <none>
    IF MaxQdot <= 0.0,       !- <none>
    SET Air_Tout          = Air_Tinlet,  !- <none>
    SET Air_Wout          = Air_Winlet,  !- <none>
    Set Air_MdotOut       = Air_Mdot,  !- <none>
    Set tot_cool_Power    = 0.0,  !- <none>
    Set Water_Tout        = Water_Tinlet,  !- <none>
    Set Water_MdotRequest = 0.0,  !- <none>
    RETURN,                  !- <none>
    ENDIF,                   !- <none>
    Set AirIn_dewpoint = @TdpFnWpb Air_Winlet OA_Press,  !- <none>
    IF  AirIn_dewpoint < Air_Tsp,  !- <none>
    Set Air_Wout = Air_Winlet,  !- <none>
    Set Air_HoutSP = @HFnTdbW Air_Tsp Air_Wout,  !- <none>
    Set Qdot_SP    = Air_Mdot * (AirIn_Enth - Air_HoutSP),  !- <none>
    IF Qdot_SP > MaxQdot,    !- <none>
    Set Air_Hout = AirIn_Enth - (MaxQdot/Air_Mdot),  !- <none>
    ELSE,                    !- <none>
    Set Air_Hout = Air_HoutSP,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF AirIn_dewpoint > Air_Tsp,  !- <none>
    Set Air_WoutSP = @WFnTdbRhPb Air_Tsp 1 OA_Press,  !- <none>
    Set Air_HoutSP = @HFnTdbW Air_Tsp Air_WoutSP,  !- <none>
    Set Qdot_SP    = Air_Mdot * (AirIn_Enth - Air_HoutSP),  !- <none>
    IF Qdot_SP > MaxQdot,    !- <none>
    set Air_Hout = AirIn_Enth - (MaxQdot/Air_Mdot),  !- <none>
    set Air_Tsat = @TsatFnHPb Air_Hout OA_Press,  !- <none>
    SEt Air_Wout = @WFnTdbRhPb Air_Tsat 1 OA_Press,  !- <none>
    ELSE,                    !- <none>
    set Air_Hout = Air_HoutSP,  !- <none>
    SEt Air_Wout = Air_WoutSP,  !- <none>
    ENDIF,                   !- <none>
    ENDIF,                   !- <none>
    Set Air_Tout = @TdbFnHW Air_Hout Air_Wout,  !- <none>
    Set ActualQdot  = Air_Mdot * (AirIn_Enth   - Air_Hout),  !- <none>
    Set Water_partLoad = ActualQdot / MaxQdot,  !- <none>
    Set Water_MdotRequest = Water_Mdot_Max * Water_PartLoad,  !- <none>
    IF (Water_Mdot > 0.0),   !- <none>
    Set CW_tempRise = ActualQdot/(Water_Mdot * Water_cp),  !- <none>
    ELSE,                    !- <none>
    Set CW_tempRise = ActualQdot/(Water_MdotRequest * Water_cp),  !- <none>
    ENDIF,                   !- <none>
    Set Water_Tout = Water_Tinlet + CW_tempRise,  !- <none>
    Set tot_cool_Power = ActualQdot;  !- <none>

  EnergyManagementSystem:ProgramCallingManager,
    Main Cooling Coil Init Program Manager,  !- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    InitMainSimpleCoilModel; !- Program Name 1

  EnergyManagementSystem:Program,
    InitMainSimpleCoilModel, !- Name
    Set CWLoopExitTemp = 7.0,!- Program Line 1
    Set CWLoopDeltaTemp = 4.0,  !- Program Line 2
    Set CW_CP = @CPCW CWLoopExitTemp,  !- <none>
    Set CW_rho = @RhoH2O CWLoopExitTemp,  !- <none>
    Set CWcoil1_Water_DesignVdot = Sys1_CoolDes_Qdot / (( CW_rho * CW_CP) * CWLoopDeltaTemp),  !- <none>
    Set CWcoil1_Mdot_Min = 0.0,  !- <none>
    Set CWcoil1_Mdot_Max = CWcoil1_Water_DesignVdot * CW_rho;  !- <none>

  EnergyManagementSystem:OutputVariable,
    Main CW Coil Total Cooling Rate,  !- Name
    CWcoil1_tot_cool_Power,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimestep,          !- Update Frequency
    MainCWCoil1_ModelOuput,  !- EMS Program or Subroutine Name
    W;                       !- Units

  EnergyManagementSystem:Actuator,
    CWcoil1_Mdot_Min,        !- Name
    Main Cooling Coil 1,     !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Minimum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    CWcoil1_Mdot_Max,        !- Name
    Main Cooling Coil 1,     !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Maximum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    CWcoil1_Water_Tout,      !- Name
    Main Cooling Coil 1,     !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    CWcoil1_Water_MdotRequest,  !- Name
    Main Cooling Coil 1,     !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Mass Flow Rate;          !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    CWcoil1_Water_DesignVdot,!- Name
    Main Cooling Coil 1,     !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Design Volume Flow Rate; !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    CWcoil1_Air_Tout,        !- Name
    MAIN COOLING COIL 1,     !- Actuated Component Unique Name
    Air Connection 1,        !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    CWcoil1_Air_Wout,        !- Name
    MAIN COOLING COIL 1,     !- Actuated Component Unique Name
    Air Connection 1,        !- Actuated Component Type
    Outlet Humidity Ratio;   !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    CWcoil1_Air_MdotOut,     !- Name
    MAIN COOLING COIL 1,     !- Actuated Component Unique Name
    Air Connection 1,        !- Actuated Component Type
    Mass Flow Rate;          !- Actuated Component Control Type

  EnergyManagementSystem:Sensor,
    CWcoil1_Air_Tsp,         !- Name
    Main Cooling Coil 1 Outlet Node,  !- Output:Variable or Output:Meter Index Key Name
    System Node Setpoint Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    OA_Press,                !- Name
    Environment,             !- Output:Variable or Output:Meter Index Key Name
    Site Outdoor Air Barometric Pressure;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:InternalVariable,
    CWcoil1_Air_Tinlet,      !- Name
    MAIN COOLING COIL 1,     !- Internal Data Index Key Name
    Inlet Temperature for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    CWcoil1_Air_Mdot,        !- Name
    MAIN COOLING COIL 1,     !- Internal Data Index Key Name
    Inlet Mass Flow Rate for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    CWcoil1_Air_Winlet,      !- Name
    MAIN COOLING COIL 1,     !- Internal Data Index Key Name
    Inlet Humidity Ratio for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    CWcoil1_Air_rho,         !- Name
    MAIN COOLING COIL 1,     !- Internal Data Index Key Name
    Inlet Density for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    CWcoil1_Air_cp,          !- Name
    MAIN COOLING COIL 1,     !- Internal Data Index Key Name
    Inlet Specific Heat for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    CWcoil1_Water_Tinlet,    !- Name
    MAIN COOLING COIL 1,     !- Internal Data Index Key Name
    Inlet Temperature for Plant Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    CWcoil1_Water_Mdot,      !- Name
    MAIN COOLING COIL 1,     !- Internal Data Index Key Name
    Inlet Mass Flow Rate for Plant Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    CWcoil1_Water_rho,       !- Name
    MAIN COOLING COIL 1,     !- Internal Data Index Key Name
    Inlet Density for Plant Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    CWcoil1_Water_cp,        !- Name
    MAIN COOLING COIL 1,     !- Internal Data Index Key Name
    Inlet Specific Heat for Plant Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Sys1_Design_Vdot,        !- Name
    VAV SYS 1,               !- Internal Data Index Key Name
    Intermediate Air System Main Supply Volume Flow Rate;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Sys1_CoolDes_Qdot,       !- Name
    VAV SYS 1,               !- Internal Data Index Key Name
    Air System Cooling Design Sensible Capacity;  !- Internal Data Type

  Coil:UserDefined,
    Main Heating Coil 1,     !- Name
    Main Heating Coil Model Program Manager,  !- Overall Model Simulation Program Calling Manager Name
    Main Heating Coil Init Program Manager,  !- Model Setup and Sizing Program Calling Manager Name
    1,                       !- Number of Air Connections
    Main Cooling Coil 1 Outlet Node,  !- Air Connection 1 Inlet Node Name
    Main Heating Coil 1 Outlet Node,  !- Air Connection 1 Outlet Node Name
    ,                        !- Air Connection 2 Inlet Node Name
    ,                        !- Air Connection 2 Outlet Node Name
    Yes,                     !- Plant Connection is Used
    Main Heating Coil 1 Water Inlet Node,  !- Plant Connection Inlet Node Name
    Main Heating Coil 1 Water Outlet Node;  !- Plant Connection Outlet Node Name

  EnergyManagementSystem:ProgramCallingManager,
    Main Heating Coil Model Program Manager,  !- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    MainHWCoil1_ModelInput,  !- Program Name 1
    HW_Coil_Sim_Model,       !- Program Name 2
    MainHWCoil1_ModelOuput;  !- Program Name 3

  EnergyManagementSystem:Program,
    MainHWCoil1_ModelInput,  !- Name
    Set Air_Mdot       = HWcoil1_Air_Mdot,  !- Program Line 1
    Set Air_Tsp        = HWcoil1_Air_Tsp - 0.5,  !- Program Line 2
    Set Water_Mdot     = HWcoil1_Water_Mdot,  !- <none>
    Set Water_cp       = HWcoil1_Water_cp,  !- <none>
    SEt Air_Tinlet     = HWcoil1_Air_Tinlet,  !- <none>
    Set Water_Tinlet   = HWcoil1_Water_Tinlet,  !- <none>
    SEt Air_Winlet     = HWcoil1_Air_Winlet,  !- <none>
    Set Water_Mdot_Max = HWcoil1_Mdot_Max,  !- <none>
    Set Coil_Eff       = 0.7;!- <none>

  EnergyManagementSystem:Program,
    MainHWCoil1_ModelOuput,  !- Name
    Set HWcoil1_Water_MdotRequest = Water_MdotRequest,  !- Program Line 1
    Set HWcoil1_Air_Tout          = Air_Tout,  !- Program Line 2
    Set HWcoil1_Air_Wout          = Air_Wout,  !- <none>
    Set HWcoil1_tot_heat_Power    = Tot_heat_Power,  !- <none>
    Set HWcoil1_tot_heat_Energy   = Tot_heat_Power * SystemTimestep * 3600,  !- <none>
    Set HWcoil1_Air_MdotOut       = Air_Mdot,  !- <none>
    Set HWcoil1_Water_Tout        = Water_Tout;  !- <none>

  EnergyManagementSystem:ProgramCallingManager,
    Main Heating Coil Init Program Manager,  !- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    InitMainSimpleHWCoilModel;  !- Program Name 1

  EnergyManagementSystem:Program,
    InitMainSimpleHWCoilModel,  !- Name
    Set HWLoopExitTemp = 82.0,  !- Program Line 1
    Set HWLoopDeltaTemp = 11.0,  !- Program Line 2
    Set HW_CP = @CPCW HWLoopExitTemp,  !- <none>
    Set HW_rho = @RhoH2O HWLoopExitTemp,  !- <none>
    Set HWcoil1_Water_DesignVdot = Sys1_HeatDes_Qdot / (( HW_rho * HW_CP) * HWLoopDeltaTemp),  !- <none>
    Set HWcoil1_Mdot_Min = 0.0,  !- <none>
    Set HWcoil1_Mdot_Max = HWcoil1_Water_DesignVdot * HW_rho;  !- <none>

  EnergyManagementSystem:OutputVariable,
    Main HW Coil Total Heating Rate,  !- Name
    HWcoil1_tot_heat_Power,  !- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimestep,          !- Update Frequency
    MainHWCoil1_ModelOuput,  !- EMS Program or Subroutine Name
    W;                       !- Units

  EnergyManagementSystem:Actuator,
    HWcoil1_Mdot_Min,        !- Name
    Main Heating Coil 1,     !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Minimum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    HWcoil1_Mdot_Max,        !- Name
    Main Heating Coil 1,     !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Maximum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    HWcoil1_Water_Tout,      !- Name
    Main Heating Coil 1,     !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    HWcoil1_Water_MdotRequest,  !- Name
    Main Heating Coil 1,     !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Mass Flow Rate;          !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    HWcoil1_Water_DesignVdot,!- Name
    Main Heating Coil 1,     !- Actuated Component Unique Name
    Plant Connection,        !- Actuated Component Type
    Design Volume Flow Rate; !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    HWcoil1_Air_Tout,        !- Name
    MAIN Heating COIL 1,     !- Actuated Component Unique Name
    Air Connection 1,        !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    HWcoil1_Air_Wout,        !- Name
    MAIN Heating COIL 1,     !- Actuated Component Unique Name
    Air Connection 1,        !- Actuated Component Type
    Outlet Humidity Ratio;   !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    HWcoil1_Air_MdotOut,     !- Name
    MAIN Heating COIL 1,     !- Actuated Component Unique Name
    Air Connection 1,        !- Actuated Component Type
    Mass Flow Rate;          !- Actuated Component Control Type

  EnergyManagementSystem:Sensor,
    HWcoil1_Air_Tsp,         !- Name
    Main Heating Coil 1 Outlet Node,  !- Output:Variable or Output:Meter Index Key Name
    System Node Setpoint Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:InternalVariable,
    HWcoil1_Air_Tinlet,      !- Name
    MAIN Heating COIL 1,     !- Internal Data Index Key Name
    Inlet Temperature for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    HWcoil1_Air_Mdot,        !- Name
    MAIN Heating COIL 1,     !- Internal Data Index Key Name
    Inlet Mass Flow Rate for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    HWcoil1_Air_Winlet,      !- Name
    MAIN Heating COIL 1,     !- Internal Data Index Key Name
    Inlet Humidity Ratio for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    HWcoil1_Air_rho,         !- Name
    MAIN Heating COIL 1,     !- Internal Data Index Key Name
    Inlet Density for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    HWcoil1_Air_cp,          !- Name
    MAIN Heating COIL 1,     !- Internal Data Index Key Name
    Inlet Specific Heat for Air Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    HWcoil1_Water_Tinlet,    !- Name
    MAIN Heating COIL 1,     !- Internal Data Index Key Name
    Inlet Temperature for Plant Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    HWcoil1_Water_Mdot,      !- Name
    MAIN Heating COIL 1,     !- Internal Data Index Key Name
    Inlet Mass Flow Rate for Plant Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    HWcoil1_Water_rho,       !- Name
    MAIN Heating COIL 1,     !- Internal Data Index Key Name
    Inlet Density for Plant Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    HWcoil1_Water_cp,        !- Name
    MAIN Heating COIL 1,     !- Internal Data Index Key Name
    Inlet Specific Heat for Plant Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Sys1_HeatDes_Qdot,       !- Name
    VAV SYS 1,               !- Internal Data Index Key Name
    Air System Heating Design Sensible Capacity;  !- Internal Data Type

  Fan:VariableVolume,
    Supply Fan 1,            !- Name
    FanAvailSched,           !- Availability Schedule Name
    0.7,                     !- Fan Total Efficiency
    600.0,                   !- Pressure Rise {Pa}
    autosize,                !- Maximum Flow Rate {m3/s}
    Fraction,                !- Fan Power Minimum Flow Rate Input Method
    0.25,                    !- Fan Power Minimum Flow Fraction
    ,                        !- Fan Power Minimum Air Flow Rate {m3/s}
    0.9,                     !- Motor Efficiency
    1.0,                     !- Motor In Airstream Fraction
    0.35071223,              !- Fan Power Coefficient 1
    0.30850535,              !- Fan Power Coefficient 2
    -0.54137364,             !- Fan Power Coefficient 3
    0.87198823,              !- Fan Power Coefficient 4
    0.000,                   !- Fan Power Coefficient 5
    Main Heating Coil 1 Outlet Node,  !- Air Inlet Node Name
    VAV Sys 1 Outlet Node;   !- Air Outlet Node Name

  Controller:WaterCoil,
    OA HC Controller 1,      !- Name
    Temperature,             !- Control Variable
    Normal,                  !- Action
    FLOW,                    !- Actuator Variable
    OA Heating Coil 1 Air Outlet Node,  !- Sensor Node Name
    OA Heating Coil 1 Water Inlet Node,  !- Actuator Node Name
    0.002,                   !- Controller Convergence Tolerance {deltaC}
    autosize,                !- Maximum Actuated Flow {m3/s}
    0.0;                     !- Minimum Actuated Flow {m3/s}

 ! Controller:WaterCoil,
 !   OA CC Controller 1,      !- Name
 !   Temperature,             !- Control Variable
 !   Reverse,                 !- Action
 !   FLOW,                    !- Actuator Variable
 !   OA Mixing Box 1 Inlet Node,  !- Sensor Node Name
 !   OA Cooling Coil 1 Water Inlet Node,  !- Actuator Node Name
 !   0.002,                   !- Controller Convergence Tolerance {deltaC}
 !   autosize,                !- Maximum Actuated Flow {m3/s}
 !   0.0;                     !- Minimum Actuated Flow {m3/s}

  Controller:OutdoorAir,
    OA Controller 1,         !- Name
    Relief Air Outlet Node 1,!- Relief Air Outlet Node Name
    VAV Sys 1 Inlet Node,    !- Return Air Node Name
    Mixed Air Node 1,        !- Mixed Air Node Name
    Outside Air Inlet Node 1,!- Actuator Node Name
    autosize,                !- Minimum Outdoor Air Flow Rate {m3/s}
    autosize,                !- Maximum Outdoor Air Flow Rate {m3/s}
    NoEconomizer,            !- Economizer Control Type
    ModulateFlow,            !- Economizer Control Action Type
    19.,                     !- Economizer Maximum Limit Dry-Bulb Temperature {C}
    ,                        !- Economizer Maximum Limit Enthalpy {J/kg}
    ,                        !- Economizer Maximum Limit Dewpoint Temperature {C}
    ,                        !- Electronic Enthalpy Limit Curve Name
    4.6,                     !- Economizer Minimum Limit Dry-Bulb Temperature {C}
    NoLockout,               !- Lockout Type
    FixedMinimum,            !- Minimum Limit Type
    Min OA Sched;            !- Minimum Outdoor Air Schedule Name

  SetpointManager:Scheduled,
    Supply Air Temp Manager heating,  !- Name
    Temperature,             !- Control Variable
    Seasonal Reset Supply Air heating Temp Sch,  !- Schedule Name
    Zone Eq In Node;         !- Setpoint Node or NodeList Name

  SetpointManager:MixedAir,
    Mixed Air Temp Manager Heating,  !- Name
    Temperature,             !- Control Variable
    Zone Eq In Node,         !- Reference Setpoint Node Name
    Main Heating Coil 1 Outlet Node,  !- Fan Inlet Node Name
    VAV Sys 1 Outlet Node,   !- Fan Outlet Node Name
    Main Heating Coil 1 Outlet Node;  !- Setpoint Node or NodeList Name

  SetpointManager:Scheduled,
    Supply Air Temp Manager 1,  !- Name
    Temperature,             !- Control Variable
    Seasonal Reset Supply Air Temp Sch,  !- Schedule Name
    VAV Sys 1 Outlet Node;   !- Setpoint Node or NodeList Name

  SetpointManager:Scheduled,
    OA Air Temp Manager 1,   !- Name
    Temperature,             !- Control Variable
    OA Cooling Supply Air Temp Sch,  !- Schedule Name
    OA Mixing Box 1 Inlet Node;  !- Setpoint Node or NodeList Name

  SetpointManager:Scheduled,
    OA Air Temp Manager 2,   !- Name
    Temperature,             !- Control Variable
    OA Heating Supply Air Temp Sch,  !- Schedule Name
    OA Heating Coil 1 Air Outlet Node;  !- Setpoint Node or NodeList Name

  SetpointManager:MixedAir,
    Mixed Air Temp Manager 1,!- Name
    Temperature,             !- Control Variable
    VAV Sys 1 Outlet Node,   !- Reference Setpoint Node Name
    Main Heating Coil 1 Outlet Node,  !- Fan Inlet Node Name
    VAV Sys 1 Outlet Node,   !- Fan Outlet Node Name
    Mixed Air Node 1;        !- Setpoint Node or NodeList Name

  PlantLoop,
    Hot Water Loop,          !- Name
    Water,                   !- Fluid Type
    ,                        !- User Defined Fluid Type
    Hot Loop Operation,      !- Plant Equipment Operation Scheme Name
    HW Supply Outlet Node,   !- Loop Temperature Setpoint Node Name
    100,                     !- Maximum Loop Temperature {C}
    10,                      !- Minimum Loop Temperature {C}
    autosize,                !- Maximum Loop Flow Rate {m3/s}
    0.0,                     !- Minimum Loop Flow Rate {m3/s}
    ,                        !- Plant Loop Volume {m3}
    HW Supply Inlet Node,    !- Plant Side Inlet Node Name
    HW Supply Outlet Node,   !- Plant Side Outlet Node Name
    Heating Supply Side Branches,  !- Plant Side Branch List Name
    Heating Supply Side Connectors,  !- Plant Side Connector List Name
    HW Demand Inlet Node,    !- Demand Side Inlet Node Name
    HW Demand Outlet Node,   !- Demand Side Outlet Node Name
    Heating Demand Side Branches,  !- Demand Side Branch List Name
    Heating Demand Side Connectors,  !- Demand Side Connector List Name
    SequentialLoad;          !- Load Distribution Scheme

  SetpointManager:Scheduled,
    Hot Water Loop Setpoint Manager,  !- Name
    Temperature,             !- Control Variable
    HW Loop Temp Schedule,   !- Schedule Name
    HW Supply Outlet Node;   !- Setpoint Node or NodeList Name

  BranchList,
    Heating Supply Side Branches,  !- Name
    Heating Supply Inlet Branch,  !- Branch 1 Name
    Central Boiler Branch,   !- Branch 2 Name
    Heating Supply Bypass Branch,  !- Branch 3 Name
    Heating Supply Outlet Branch;  !- Branch 4 Name

  ConnectorList,
    Heating Supply Side Connectors,  !- Name
    Connector:Splitter,      !- Connector 1 Object Type
    Heating Supply Splitter, !- Connector 1 Name
    Connector:Mixer,         !- Connector 2 Object Type
    Heating Supply Mixer;    !- Connector 2 Name

  Branch,
    Heating Supply Inlet Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    Pump:VariableSpeed,      !- Component 1 Object Type
    HW Circ Pump,            !- Component 1 Name
    HW Supply Inlet Node,    !- Component 1 Inlet Node Name
    HW Pump Outlet Node;     !- Component 1 Outlet Node Name

  Branch,
    Central Boiler Branch,   !- Name
    ,                        !- Pressure Drop Curve Name
    Boiler:HotWater,         !- Component 1 Object Type
    Central Boiler,          !- Component 1 Name
    Central Boiler Inlet Node,  !- Component 1 Inlet Node Name
    Central Boiler Outlet Node;  !- Component 1 Outlet Node Name

  Branch,
    Heating Supply Bypass Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Heating Supply Side Bypass,  !- Component 1 Name
    Heating Supply Bypass Inlet Node,  !- Component 1 Inlet Node Name
    Heating Supply Bypass Outlet Node;  !- Component 1 Outlet Node Name

  Pipe:Adiabatic,
    Heating Supply Side Bypass,  !- Name
    Heating Supply Bypass Inlet Node,  !- Inlet Node Name
    Heating Supply Bypass Outlet Node;  !- Outlet Node Name

  Branch,
    Heating Supply Outlet Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Heating Supply Outlet,   !- Component 1 Name
    Heating Supply Exit Pipe Inlet Node,  !- Component 1 Inlet Node Name
    HW Supply Outlet Node;   !- Component 1 Outlet Node Name

  Pipe:Adiabatic,
    Heating Supply Outlet,   !- Name
    Heating Supply Exit Pipe Inlet Node,  !- Inlet Node Name
    HW Supply Outlet Node;   !- Outlet Node Name

  BranchList,
    Heating Demand Side Branches,  !- Name
    Heating Demand Inlet Branch,  !- Branch 1 Name
    SPACE1-1 Reheat Branch,  !- Branch 2 Name
    SPACE2-1 Reheat Branch,  !- Branch 3 Name
    SPACE3-1 Reheat Branch,  !- Branch 4 Name
    SPACE4-1 Reheat Branch,  !- Branch 5 Name
    SPACE5-1 Reheat Branch,  !- Branch 6 Name
    OA Heating Coil Branch,  !- Branch 7 Name
    Main Heating Coil 1 Branch,  !- Branch 8 Name
    Heating Demand Bypass Branch,  !- Branch 9 Name
    Heating Demand Outlet Branch;  !- Branch 10 Name

  ConnectorList,
    Heating Demand Side Connectors,  !- Name
    Connector:Splitter,      !- Connector 1 Object Type
    Heating Demand Splitter, !- Connector 1 Name
    Connector:Mixer,         !- Connector 2 Object Type
    Heating Demand Mixer;    !- Connector 2 Name

  Branch,
    Heating Demand Inlet Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Heating Demand Inlet Pipe,  !- Component 1 Name
    HW Demand Inlet Node,    !- Component 1 Inlet Node Name
    HW Demand Entrance Pipe Outlet Node;  !- Component 1 Outlet Node Name

  Pipe:Adiabatic,
    Heating Demand Inlet Pipe,  !- Name
    HW Demand Inlet Node,    !- Inlet Node Name
    HW Demand Entrance Pipe Outlet Node;  !- Outlet Node Name

  Branch,
    Heating Demand Outlet Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Heating Demand Outlet Pipe,  !- Component 1 Name
    HW Demand Exit Pipe Inlet Node,  !- Component 1 Inlet Node Name
    HW Demand Outlet Node;   !- Component 1 Outlet Node Name

  Pipe:Adiabatic,
    Heating Demand Outlet Pipe,  !- Name
    HW Demand Exit Pipe Inlet Node,  !- Inlet Node Name
    HW Demand Outlet Node;   !- Outlet Node Name

  Branch,
    SPACE1-1 Reheat Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    AirTerminal:SingleDuct:UserDefined,  !- Component 1 Object Type
    SPACE1-1 VAV Reheat,     !- Component 1 Name
    SPACE1-1 Zone Coil Water In Node,  !- Component 1 Inlet Node Name
    SPACE1-1 Zone Coil Water Out Node;  !- Component 1 Outlet Node Name

  Branch,
    SPACE2-1 Reheat Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    AirTerminal:SingleDuct:UserDefined,  !- Component 1 Object Type
    SPACE2-1 VAV Reheat,     !- Component 1 Name
    SPACE2-1 Zone Coil Water In Node,  !- Component 1 Inlet Node Name
    SPACE2-1 Zone Coil Water Out Node;  !- Component 1 Outlet Node Name

  Branch,
    SPACE3-1 Reheat Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    AirTerminal:SingleDuct:UserDefined,  !- Component 1 Object Type
    SPACE3-1 VAV Reheat,     !- Component 1 Name
    SPACE3-1 Zone Coil Water In Node,  !- Component 1 Inlet Node Name
    SPACE3-1 Zone Coil Water Out Node;  !- Component 1 Outlet Node Name

  Branch,
    SPACE4-1 Reheat Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    AirTerminal:SingleDuct:UserDefined,  !- Component 1 Object Type
    SPACE4-1 VAV Reheat,     !- Component 1 Name
    SPACE4-1 Zone Coil Water In Node,  !- Component 1 Inlet Node Name
    SPACE4-1 Zone Coil Water Out Node;  !- Component 1 Outlet Node Name

  Branch,
    SPACE5-1 Reheat Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    AirTerminal:SingleDuct:UserDefined,  !- Component 1 Object Type
    SPACE5-1 VAV Reheat,     !- Component 1 Name
    SPACE5-1 Zone Coil Water In Node,  !- Component 1 Inlet Node Name
    SPACE5-1 Zone Coil Water Out Node;  !- Component 1 Outlet Node Name

  Branch,
    OA Heating Coil Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    Coil:Heating:Water,      !- Component 1 Object Type
    OA Heating Coil 1,       !- Component 1 Name
    OA Heating Coil 1 Water Inlet Node,  !- Component 1 Inlet Node Name
    OA Heating Coil 1 Water Outlet Node;  !- Component 1 Outlet Node Name

  Branch,
    Main Heating Coil 1 Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    Coil:UserDefined,        !- Component 1 Object Type
    Main Heating Coil 1,     !- Component 1 Name
    Main Heating Coil 1 Water Inlet Node,  !- Component 1 Inlet Node Name
    Main Heating Coil 1 Water Outlet Node;  !- Component 1 Outlet Node Name

  Branch,
    Heating Demand Bypass Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Heating Demand Bypass,   !- Component 1 Name
    Heating Demand Bypass Inlet Node,  !- Component 1 Inlet Node Name
    Heating Demand Bypass Outlet Node;  !- Component 1 Outlet Node Name

  Pipe:Adiabatic,
    Heating Demand Bypass,   !- Name
    Heating Demand Bypass Inlet Node,  !- Inlet Node Name
    Heating Demand Bypass Outlet Node;  !- Outlet Node Name

  Connector:Splitter,
    Heating Demand Splitter, !- Name
    Heating Demand Inlet Branch,  !- Inlet Branch Name
    SPACE1-1 Reheat Branch,  !- Outlet Branch 1 Name
    SPACE2-1 Reheat Branch,  !- Outlet Branch 2 Name
    SPACE3-1 Reheat Branch,  !- Outlet Branch 3 Name
    SPACE4-1 Reheat Branch,  !- Outlet Branch 4 Name
    SPACE5-1 Reheat Branch,  !- Outlet Branch 5 Name
    OA Heating Coil Branch,  !- Outlet Branch 6 Name
    Main Heating Coil 1 Branch,  !- Outlet Branch 7 Name
    Heating Demand Bypass Branch;  !- Outlet Branch 8 Name

  Connector:Mixer,
    Heating Demand Mixer,    !- Name
    Heating Demand Outlet Branch,  !- Outlet Branch Name
    SPACE1-1 Reheat Branch,  !- Inlet Branch 1 Name
    SPACE2-1 Reheat Branch,  !- Inlet Branch 2 Name
    SPACE3-1 Reheat Branch,  !- Inlet Branch 3 Name
    SPACE4-1 Reheat Branch,  !- Inlet Branch 4 Name
    SPACE5-1 Reheat Branch,  !- Inlet Branch 5 Name
    OA Heating Coil Branch,  !- Inlet Branch 6 Name
    Main Heating Coil 1 Branch,  !- Inlet Branch 7 Name
    Heating Demand Bypass Branch;  !- Inlet Branch 8 Name

  Connector:Splitter,
    Heating Supply Splitter, !- Name
    Heating Supply Inlet Branch,  !- Inlet Branch Name
    Central Boiler Branch,   !- Outlet Branch 1 Name
    Heating Supply Bypass Branch;  !- Outlet Branch 2 Name

  Connector:Mixer,
    Heating Supply Mixer,    !- Name
    Heating Supply Outlet Branch,  !- Outlet Branch Name
    Central Boiler Branch,   !- Inlet Branch 1 Name
    Heating Supply Bypass Branch;  !- Inlet Branch 2 Name

  PlantEquipmentOperationSchemes,
    Hot Loop Operation,      !- Name
    PlantEquipmentOperation:HeatingLoad,  !- Control Scheme 1 Object Type
    Central Boiler Only,     !- Control Scheme 1 Name
    PlantOnSched;            !- Control Scheme 1 Schedule Name

  PlantEquipmentOperation:HeatingLoad,
    Central Boiler Only,     !- Name
    0,                       !- Load Range 1 Lower Limit {W}
    1000000,                 !- Load Range 1 Upper Limit {W}
    heating plant;           !- Range 1 Equipment List Name

  PlantEquipmentList,
    heating plant,           !- Name
    Boiler:HotWater,         !- Equipment 1 Object Type
    Central Boiler;          !- Equipment 1 Name

  Boiler:HotWater,
    Central Boiler,          !- Name
    NaturalGas,              !- Fuel Type
    autosize,                !- Nominal Capacity {W}
    0.8,                     !- Nominal Thermal Efficiency
    LeavingBoiler,           !- Efficiency Curve Temperature Evaluation Variable
    BoilerEfficiency,        !- Normalized Boiler Efficiency Curve Name
    autosize,                !- Design Water Flow Rate {m3/s}
    0.0,                     !- Minimum Part Load Ratio
    1.2,                     !- Maximum Part Load Ratio
    1.0,                     !- Optimum Part Load Ratio
    Central Boiler Inlet Node,  !- Boiler Water Inlet Node Name
    Central Boiler Outlet Node,  !- Boiler Water Outlet Node Name
    100.,                    !- Water Outlet Upper Temperature Limit {C}
    LeavingSetpointModulated;!- Boiler Flow Mode

  SetpointManager:Scheduled,
    Central Boiler Setpoint Manager,  !- Name
    Temperature,             !- Control Variable
    HW Loop Temp Schedule,   !- Schedule Name
    Central Boiler Outlet Node;  !- Setpoint Node or NodeList Name

  Curve:Quadratic,
    BoilerEfficiency,        !- Name
    1.0,                     !- Coefficient1 Constant
    0.0,                     !- Coefficient2 x
    0.0,                     !- Coefficient3 x**2
    0,                       !- Minimum Value of x
    1;                       !- Maximum Value of x

  Pump:VariableSpeed,
    HW Circ Pump,            !- Name
    HW Supply Inlet Node,    !- Inlet Node Name
    HW Pump Outlet Node,     !- Outlet Node Name
    autosize,                !- Design Maximum Flow Rate {m3/s}
    179352,                  !- Design Pump Head {Pa}
    autosize,                !- Design Power Consumption {W}
    0.9,                     !- Motor Efficiency
    0.0,                     !- Fraction of Motor Inefficiencies to Fluid Stream
    0,                       !- Coefficient 1 of the Part Load Performance Curve
    1,                       !- Coefficient 2 of the Part Load Performance Curve
    0,                       !- Coefficient 3 of the Part Load Performance Curve
    0,                       !- Coefficient 4 of the Part Load Performance Curve
    0,                       !- Design Minimum Flow Rate {m3/s}
    INTERMITTENT;            !- Pump Control Type

  PlantLoop,
    Chilled Water Loop,      !- Name
    Water,                   !- Fluid Type
    ,                        !- User Defined Fluid Type
    CW Loop Operation,       !- Plant Equipment Operation Scheme Name
    CW Supply Outlet Node,   !- Loop Temperature Setpoint Node Name
    98,                      !- Maximum Loop Temperature {C}
    1,                       !- Minimum Loop Temperature {C}
    autosize,                !- Maximum Loop Flow Rate {m3/s}
    0.0,                     !- Minimum Loop Flow Rate {m3/s}
    ,                        !- Plant Loop Volume {m3}
    CW Supply Inlet Node,    !- Plant Side Inlet Node Name
    CW Supply Outlet Node,   !- Plant Side Outlet Node Name
    Cooling Supply Side Branches,  !- Plant Side Branch List Name
    Cooling Supply Side Connectors,  !- Plant Side Connector List Name
    CW Demand Inlet Node,    !- Demand Side Inlet Node Name
    CW Demand Outlet Node,   !- Demand Side Outlet Node Name
    Cooling Demand Side Branches,  !- Demand Side Branch List Name
    Cooling Demand Side Connectors,  !- Demand Side Connector List Name
    SequentialLoad,          !- Load Distribution Scheme
    CW Avail List;           !- Availability Manager List Name

  AvailabilityManagerAssignmentList,
    CW Avail List,           !- Name
    AvailabilityManager:LowTemperatureTurnOff,  !- Availability Manager 1 Object Type
    CW Low Temp Limit;       !- Availability Manager 1 Name

  AvailabilityManager:LowTemperatureTurnOff,
    CW Low Temp Limit,       !- Name
    Outside Air Inlet Node 1,!- Sensor Node Name
    2.0,                     !- Temperature {C}
    CoolingPumpAvailSched;   !- Applicability Schedule Name

  SetpointManager:Scheduled,
    Chilled Water Loop Setpoint Manager,  !- Name
    Temperature,             !- Control Variable
    CW Loop Temp Schedule,   !- Schedule Name
    CW Supply Outlet Node;   !- Setpoint Node or NodeList Name

  BranchList,
    Cooling Supply Side Branches,  !- Name
    CW Pump Branch,          !- Branch 1 Name
    Central Chiller Branch,  !- Branch 2 Name
    Cooling Supply Bypass Branch,  !- Branch 3 Name
    Cooling Supply Outlet;   !- Branch 4 Name

  BranchList,
    Cooling Demand Side Branches,  !- Name
    Cooling Demand Inlet,    !- Branch 1 Name
    Cooling Coil Branch,     !- Branch 2 Name
    OA Cooling Coil Branch,  !- Branch 3 Name
    Cooling Demand Bypass Branch,  !- Branch 4 Name
    Cooling Demand Outlet;   !- Branch 5 Name

  ConnectorList,
    Cooling Supply Side Connectors,  !- Name
    Connector:Splitter,      !- Connector 1 Object Type
    CW Loop Splitter,        !- Connector 1 Name
    Connector:Mixer,         !- Connector 2 Object Type
    CW Loop Mixer;           !- Connector 2 Name

  ConnectorList,
    Cooling Demand Side Connectors,  !- Name
    Connector:Splitter,      !- Connector 1 Object Type
    CW Demand Splitter,      !- Connector 1 Name
    Connector:Mixer,         !- Connector 2 Object Type
    CW Demand Mixer;         !- Connector 2 Name

  Branch,
    Cooling Demand Inlet,    !- Name
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Cooling Demand Side Inlet Pipe,  !- Component 1 Name
    CW Demand Inlet Node,    !- Component 1 Inlet Node Name
    CW Demand Entrance Pipe Outlet Node;  !- Component 1 Outlet Node Name

  Pipe:Adiabatic,
    Cooling Demand Side Inlet Pipe,  !- Name
    CW Demand Inlet Node,    !- Inlet Node Name
    CW Demand Entrance Pipe Outlet Node;  !- Outlet Node Name

  Branch,
    Cooling Coil Branch,     !- Name
    ,                        !- Pressure Drop Curve Name
    Coil:UserDefined,        !- Component 1 Object Type
    Main Cooling Coil 1,     !- Component 1 Name
    Main Cooling Coil 1 Water Inlet Node,  !- Component 1 Inlet Node Name
    Main Cooling Coil 1 Water Outlet Node;  !- Component 1 Outlet Node Name

  Branch,
    OA Cooling Coil Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    Coil:UserDefined,        !- Component 1 Object Type
    OA Cooling Coil 1,       !- Component 1 Name
    OA Cooling Coil 1 Water Inlet Node,  !- Component 1 Inlet Node Name
    OA Cooling Coil 1 Water Outlet Node;  !- Component 1 Outlet Node Name

  Branch,
    Cooling Demand Bypass Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Cooling Demand Side Bypass,  !- Component 1 Name
    CW Demand Bypass Inlet Node,  !- Component 1 Inlet Node Name
    CW Demand Bypass Outlet Node;  !- Component 1 Outlet Node Name

  Pipe:Adiabatic,
    Cooling Demand Side Bypass,  !- Name
    CW Demand Bypass Inlet Node,  !- Inlet Node Name
    CW Demand Bypass Outlet Node;  !- Outlet Node Name

  Branch,
    Cooling Demand Outlet,   !- Name
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    CW Demand Side Outlet Pipe,  !- Component 1 Name
    CW Demand Exit Pipe Inlet Node,  !- Component 1 Inlet Node Name
    CW Demand Outlet Node;   !- Component 1 Outlet Node Name

  Pipe:Adiabatic,
    CW Demand Side Outlet Pipe,  !- Name
    CW Demand Exit Pipe Inlet Node,  !- Inlet Node Name
    CW Demand Outlet Node;   !- Outlet Node Name

  Branch,
    Cooling Supply Outlet,   !- Name
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Supply Side Outlet Pipe, !- Component 1 Name
    Supply Side Exit Pipe Inlet Node,  !- Component 1 Inlet Node Name
    CW Supply Outlet Node;   !- Component 1 Outlet Node Name

  Pipe:Adiabatic,
    Supply Side Outlet Pipe, !- Name
    Supply Side Exit Pipe Inlet Node,  !- Inlet Node Name
    CW Supply Outlet Node;   !- Outlet Node Name

  Branch,
    CW Pump Branch,          !- Name
    ,                        !- Pressure Drop Curve Name
    Pump:VariableSpeed,      !- Component 1 Object Type
    CW Circ Pump,            !- Component 1 Name
    CW Supply Inlet Node,    !- Component 1 Inlet Node Name
    CW Pump Outlet Node;     !- Component 1 Outlet Node Name

  Branch,
    Central Chiller Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    PlantComponent:UserDefined,  !- Component 1 Object Type
    Central Chiller,         !- Component 1 Name
    Central Chiller Inlet Node,  !- Component 1 Inlet Node Name
    Central Chiller Outlet Node;  !- Component 1 Outlet Node Name

  Branch,
    Cooling Supply Bypass Branch,  !- Name
    ,                        !- Pressure Drop Curve Name
    Pipe:Adiabatic,          !- Component 1 Object Type
    Supply Side Bypass,      !- Component 1 Name
    CW Supply Bypass Inlet Node,  !- Component 1 Inlet Node Name
    CW Supply Bypass Outlet Node;  !- Component 1 Outlet Node Name

  Pipe:Adiabatic,
    Supply Side Bypass,      !- Name
    CW Supply Bypass Inlet Node,  !- Inlet Node Name
    CW Supply Bypass Outlet Node;  !- Outlet Node Name

  Connector:Splitter,
    CW Loop Splitter,        !- Name
    CW Pump Branch,          !- Inlet Branch Name
    Central Chiller Branch,  !- Outlet Branch 1 Name
    Cooling Supply Bypass Branch;  !- Outlet Branch 2 Name

  Connector:Mixer,
    CW Loop Mixer,           !- Name
    Cooling Supply Outlet,   !- Outlet Branch Name
    Central Chiller Branch,  !- Inlet Branch 1 Name
    Cooling Supply Bypass Branch;  !- Inlet Branch 2 Name

  Connector:Splitter,
    CW Demand Splitter,      !- Name
    Cooling Demand Inlet,    !- Inlet Branch Name
    Cooling Coil Branch,     !- Outlet Branch 1 Name
    OA Cooling Coil Branch,  !- Outlet Branch 2 Name
    Cooling Demand Bypass Branch;  !- Outlet Branch 3 Name

  Connector:Mixer,
    CW Demand Mixer,         !- Name
    Cooling Demand Outlet,   !- Outlet Branch Name
    Cooling Coil Branch,     !- Inlet Branch 1 Name
    OA Cooling Coil Branch,  !- Inlet Branch 2 Name
    Cooling Demand Bypass Branch;  !- Inlet Branch 3 Name

  PlantEquipmentOperationSchemes,
    CW Loop Operation,       !- Name
    PlantEquipmentOperation:CoolingLoad,  !- Control Scheme 1 Object Type
    Central Chiller Only,    !- Control Scheme 1 Name
    PlantOnSched;            !- Control Scheme 1 Schedule Name

  PlantEquipmentOperation:CoolingLoad,
    Central Chiller Only,    !- Name
    0,                       !- Load Range 1 Lower Limit {W}
    900000,                  !- Load Range 1 Upper Limit {W}
    Cooling Plant;           !- Range 1 Equipment List Name

  PlantEquipmentList,
    Cooling Plant,           !- Name
    PlantComponent:UserDefined,  !- Equipment 1 Object Type
    Central Chiller;         !- Equipment 1 Name

!  Chiller:Electric,
!    Central Chiller,         !- Name
!    AirCooled,               !- Condenser Type
!    autosize,                !- Nominal Capacity {W}
!    3.2,                     !- Nominal COP {W/W}
!    Central Chiller Inlet Node,  !- Chilled Water Inlet Node Name
!    Central Chiller Outlet Node,  !- Chilled Water Outlet Node Name
!    Central Chiller Condenser Inlet Node,  !- Condenser Inlet Node Name
!    Central Chiller Condenser Outlet Node,  !- Condenser Outlet Node Name
!    0.0,                     !- Minimum Part Load Ratio
!    1.0,                     !- Maximum Part Load Ratio
!    0.65,                    !- Optimum Part Load Ratio
!    35.0,                    !- Design Condenser Inlet Temperature {C}
!    2.778,                   !- Temperature Rise Coefficient
!    6.67,                    !- Design Chilled Water Outlet Temperature {C}
!    autosize,                !- Design Chilled Water Flow Rate {m3/s}
!    autosize,                !- Design Condenser Fluid Flow Rate {m3/s}
!    0.9949,                  !- Coefficient 1 of Capacity Ratio Curve
!    -0.045954,               !- Coefficient 2 of Capacity Ratio Curve
!    -0.0013543,              !- Coefficient 3 of Capacity Ratio Curve
!    2.333,                   !- Coefficient 1 of Power Ratio Curve
!    -1.975,                  !- Coefficient 2 of Power Ratio Curve
!    0.6121,                  !- Coefficient 3 of Power Ratio Curve
!    0.03303,                 !- Coefficient 1 of Full Load Ratio Curve
!    0.6852,                  !- Coefficient 2 of Full Load Ratio Curve
!    0.2818,                  !- Coefficient 3 of Full Load Ratio Curve
!    5,                       !- Chilled Water Outlet Temperature Lower Limit {C}
!    VariableFlow;            !- Chiller Flow Mode

  PlantComponent:UserDefined,
    Central Chiller,         !- Name
    ,                        !- Main Model Program Calling Manager Name
    1,                       !- Number of Plant Loop Connections
    Central Chiller Inlet Node,  !- Plant Connection 1 Inlet Node Name
    Central Chiller Outlet Node,  !- Plant Connection 1 Outlet Node Name
    MeetsLoadWithNominalCapacityLowOutLimit,  !- Plant Connection 1 Loading Mode
    NeedsFlowIfLoopOn,       !- Plant Connection 1 Loop Flow Request Mode
    Chiller model init programs,  !- Plant Connection 1 Initialization Program Calling Manager Name
    Chiller model simulation programs,  !- Plant Connection 1 Simulation Program Calling Manager Name
    ,                        !- Plant Connection 2 Inlet Node Name
    ,                        !- Plant Connection 2 Outlet Node Name
    ,                        !- Plant Connection 2 Loading Mode
    ,                        !- Plant Connection 2 Loop Flow Request Mode
    ,                        !- Plant Connection 2 Initialization Program Calling Manager Name
    ,                        !- Plant Connection 2 Simulation Program Calling Manager Name
    ,                        !- Plant Connection 3 Inlet Node Name
    ,                        !- Plant Connection 3 Outlet Node Name
    ,                        !- Plant Connection 3 Loading Mode
    ,                        !- Plant Connection 3 Loop Flow Request Mode
    ,                        !- Plant Connection 3 Initialization Program Calling Manager Name
    ,                        !- Plant Connection 3 Simulation Program Calling Manager Name
    ,                        !- Plant Connection 4 Inlet Node Name
    ,                        !- Plant Connection 4 Outlet Node Name
    ,                        !- Plant Connection 4 Loading Mode
    ,                        !- Plant Connection 4 Loop Flow Request Mode
    ,                        !- Plant Connection 4 Initialization Program Calling Manager Name
    ,                        !- Plant Connection 4 Simulation Program Calling Manager Name
    Central Chiller Condenser Inlet Node,  !- Air Connection Inlet Node Name
    Central Chiller Condenser Outlet Node,  !- Air Connection Outlet Node Name
    ,                        !- Supply Inlet Water Storage Tank Name
    ,                        !- Collection Outlet Water Storage Tank Name
    ;                        !- Ambient Zone Name

  EnergyManagementSystem:ProgramCallingManager,
    Chiller model simulation programs,  !- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    ModelChillerModel;       !- Program Name 1

  EnergyManagementSystem:Program,
    ModelChillerModel,       !- Name
    Set dummy = CW_MyLoad,   !- Program Line 1
    Set dummy = CW_Tin,      !- Program Line 2
    Set dummy = CW_Mdot,     !- <none>
    If CW_MyLoad > (0 - 100),!- <none>
    Set CW_Tout             = CW_Tin,  !- <none>
    Set CW_Mdot_Request     = 0.0,  !- <none>
    Set Chiller_ElectEnergy = 0.0,  !- <none>
    RETURN,                  !- <none>
    ENDIF,                   !- <none>
    Set ABS_CW_MyLoad = @ABS CW_MyLoad,  !- <none>
    IF ABS_CW_MyLoad > Chiller_Cap_Max,  !- <none>
    Set Qdot = Chiller_Cap_Max,  !- <none>
    ELSE,                    !- <none>
    Set Qdot = ABS_CW_MyLoad,!- <none>
    ENDIF,                   !- <none>
    IF CW_Mdot == 0,         !- <none>
    Set Mdot = Chiller_Mdot_Max,  !- <none>
    SEt CW_Mdot_Request = Chiller_Mdot_Max,  !- <none>
    ELSE,                    !- <none>
    Set Mdot = CW_Mdot,      !- <none>
    ENDIF,                   !- <none>
    Set CW_Tout = CW_Tin - (Qdot / (Mdot * CW_Cp)),  !- <none>
    Set EIR     = 1 / 4.6,   !- <none>
    Set Chiller_power = Qdot * EIR,  !- <none>
    Set Chiller_ElectEnergy = Chiller_power * SystemTimestep * 3600;  !- <none>

  EnergyManagementSystem:ProgramCallingManager,
    Chiller model init programs,  !- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    InitEvapChillerModel;    !- Program Name 1

  EnergyManagementSystem:Program,
    InitEvapChillerModel,    !- Name
    Set CWLoopExitTemp = 7.0,!- Program Line 1
    Set CWLoopDeltaTemp = 4.0,  !- Program Line 2
    Set CW_CP = @CPCW CWLoopExitTemp,  !- <none>
    Set CW_rho = @RhoH2O CWLoopExitTemp,  !- <none>
    Set Chiller_Vdot_Design = CWplant_Vdot_Design,  !- <none>
    Set Chiller_Mdot_Min = 0.0,  !- <none>
    Set Chiller_Mdot_Max = Chiller_Vdot_Design * CW_rho,  !- <none>
    Set Chiller_Cap = CW_CP * CW_rho * CWLoopDeltaTemp * CWplant_Vdot_Design,  !- <none>
    Set Chiller_Cap_Min = 0.0,  !- <none>
    Set Chiller_Cap_Max = Chiller_Cap,  !- <none>
    Set Chiller_Cap_Opt = 0.9 * Chiller_Cap;  !- <none>

  EnergyManagementSystem:MeteredOutputVariable,
    Chiller Electricity Consumption,  !- Name
    Chiller_ElectEnergy,     !- EMS Variable Name
    SystemTimestep,          !- Update Frequency
    ModelChillerModel,       !- EMS Program or Subroutine Name
    Electricity,             !- Resource Type
    HVAC,                    !- Group Type
    Cooling,                 !- End-Use Category
    Custom air coolled chiller,  !- End-Use Subcategory
    J;                       !- Units

  EnergyManagementSystem:MeteredOutputVariable,
    CWcoil1 tot cool Energy, !- Name
    CWcoil1_tot_cool_Energy, !- EMS Variable Name
    SystemTimestep,          !- Update Frequency
    MainCWCoil1_ModelOuput,  !- EMS Program or Subroutine Name
    ENERGYTRANSFER,          !- Resource Type
    System,                  !- Group Type
    COOLINGCOILS,            !- End-Use Category
    ,                        !- End-Use Subcategory
    J;                       !- Units

  EnergyManagementSystem:MeteredOutputVariable,
    HWcoil1 tot heat Energy, !- Name
    HWcoil1_tot_heat_Energy, !- EMS Variable Name
    SystemTimestep,          !- Update Frequency
    MainHWCoil1_ModelOuput,  !- EMS Program or Subroutine Name
    ENERGYTRANSFER,          !- Resource Type
    System,                  !- Group Type
    HEATINGCOILS,            !- End-Use Category
    ,                        !- End-Use Subcategory
    J;                       !- Units

  EnergyManagementSystem:MeteredOutputVariable,
    OACoil tot cool Energy,  !- Name
    OACoil_tot_cool_Energy,  !- EMS Variable Name
    SystemTimestep,          !- Update Frequency
    OA_CWCoil_ModelOuput,    !- EMS Program or Subroutine Name
    ENERGYTRANSFER,          !- Resource Type
    System,                  !- Group Type
    COOLINGCOILS,            !- End-Use Category
    ,                        !- End-Use Subcategory
    J;                       !- Units

! input data

  EnergyManagementSystem:InternalVariable,
    CW_Tin,                  !- Name
    Central Chiller,         !- Internal Data Index Key Name
    Inlet Temperature for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    CW_Mdot,                 !- Name
    Central Chiller,         !- Internal Data Index Key Name
    Inlet Mass Flow Rate for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    CW_Cp,                   !- Name
    Central Chiller,         !- Internal Data Index Key Name
    Inlet Specific Heat for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    CW_rho,                  !- Name
    Central Chiller,         !- Internal Data Index Key Name
    Inlet Density for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    CW_MyLoad,               !- Name
    Central Chiller,         !- Internal Data Index Key Name
    Load Request for Plant Connection 1;  !- Internal Data Type

! sizing and inits

  EnergyManagementSystem:Actuator,
    Chiller_Mdot_Min,        !- Name
    Central Chiller,         !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Minimum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Chiller_Mdot_Max,        !- Name
    Central Chiller,         !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Maximum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Chiller_Vdot_Design,     !- Name
    Central Chiller,         !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Design Volume Flow Rate; !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Chiller_Cap_Min,         !- Name
    Central Chiller,         !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Minimum Loading Capacity;!- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Chiller_Cap_Max,         !- Name
    Central Chiller,         !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Maximum Loading Capacity;!- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Chiller_Cap_Opt,         !- Name
    Central Chiller,         !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Optimal Loading Capacity;!- Actuated Component Control Type

  EnergyManagementSystem:InternalVariable,
    CWplant_Vdot_Design,     !- Name
    Chilled Water Loop,      !- Internal Data Index Key Name
    Plant Design Volume Flow Rate;  !- Internal Data Type

! model results

  EnergyManagementSystem:Actuator,
    CW_Tout,                 !- Name
    Central Chiller,         !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    CW_Mdot_Request,         !- Name
    Central Chiller,         !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Mass Flow Rate;          !- Actuated Component Control Type

  SetpointManager:Scheduled,
    Central Chiller Setpoint Manager,  !- Name
    Temperature,             !- Control Variable
    CW Loop Temp Schedule,   !- Schedule Name
    Central Chiller Outlet Node;  !- Setpoint Node or NodeList Name

  OutdoorAir:Node,
    Central Chiller Condenser Inlet Node,  !- Name
    -1.0;                    !- Height Above Ground {m}

  Pump:VariableSpeed,
    CW Circ Pump,            !- Name
    CW Supply Inlet Node,    !- Inlet Node Name
    CW Pump Outlet Node,     !- Outlet Node Name
    autosize,                !- Design Maximum Flow Rate {m3/s}
    179352,                  !- Design Pump Head {Pa}
    autosize,                !- Design Power Consumption {W}
    0.9,                     !- Motor Efficiency
    0.0,                     !- Fraction of Motor Inefficiencies to Fluid Stream
    0,                       !- Coefficient 1 of the Part Load Performance Curve
    1,                       !- Coefficient 2 of the Part Load Performance Curve
    0,                       !- Coefficient 3 of the Part Load Performance Curve
    0,                       !- Coefficient 4 of the Part Load Performance Curve
    0,                       !- Design Minimum Flow Rate {m3/s}
    INTERMITTENT,            !- Pump Control Type
    CoolingPumpAvailSched;   !- Pump Flow Rate Schedule Name

  Output:Variable,*,Site Outdoor Air Drybulb Temperature,hourly;

  Output:Variable,*,Zone Air Temperature,hourly;

  Output:Variable,*,Zone Mean Air Dewpoint Temperature,hourly;

  Output:Variable,*,Zone Air System Sensible Cooling Rate,hourly;

  Output:Variable,*,Zone Air System Sensible Heating Rate,hourly;

  Output:Variable,OA Mixing Box 1 Inlet Node,System Node Temperature,hourly;

  Output:Variable,OA Mixing Box 1 Inlet Node,System Node Mass Flow Rate,hourly;

  Output:Variable,OA Mixing Box 1 Inlet Node,System Node Setpoint Temperature,hourly;

  Output:Variable,OA Mixing Box 1 Inlet Node,System Node Humidity Ratio,hourly;

  Output:Variable,OA Heating Coil 1 Air Outlet Node,System Node Temperature,hourly;

  Output:Variable,OA Heating Coil 1 Air Outlet Node,System Node Mass Flow Rate,hourly;

  Output:Variable,OA Heating Coil 1 Air Outlet Node,System Node Setpoint Temperature,hourly;

  Output:Variable,OA Heating Coil 1 Air Outlet Node,System Node Humidity Ratio,hourly;

  Output:Variable,Mixed Air Node 1,System Node Temperature,hourly;

  Output:Variable,Mixed Air Node 1,System Node Humidity Ratio,hourly;

  Output:Variable,Mixed Air Node 1,System Node Dewpoint Temperature,hourly;

  Output:Variable,VAV Sys 1 Outlet Node,System Node Temperature,hourly;

  Output:Variable,VAV Sys 1 Outlet Node,System Node Mass Flow Rate,hourly;

  Output:Variable,VAV Sys 1 Outlet Node,System Node Humidity Ratio,hourly;

  Output:Variable,VAV Sys 1 Outlet Node,System Node Setpoint Temperature,hourly;

  Output:Variable,OA Cooling Coil 1 Water Inlet Node,System Node Temperature,hourly;

  Output:Variable,OA Cooling Coil 1 Water Inlet Node,System Node Mass Flow Rate,hourly;

  Output:Variable,Main Cooling Coil 1 Water Inlet Node,System Node Mass Flow Rate,hourly;

  Output:Variable,OA Heating Coil 1 Water Inlet Node,System Node Temperature,hourly;

  Output:Variable,OA Heating Coil 1 Water Inlet Node,System Node Mass Flow Rate,hourly;

  Output:Variable,Main Heating Coil 1 Water Inlet Node,System Node Mass Flow Rate,hourly;

  Output:Variable,*,Heating Coil Heating Rate,hourly;

  Output:Variable,*,Plant Supply Side Cooling Demand Rate,hourly;

  Output:Variable,*,Plant Supply Side Heating Demand Rate,hourly;

  Output:Variable,*,Boiler Gas Rate,hourly;

  Output:Variable,*,Boiler Heating Rate,hourly;

  Output:Variable,*,Pump Mass Flow Rate,hourly;

  Output:Variable,*,Pump Outlet Temperature,hourly;

  Output:Variable,*,Space 1 VAV Reheat Coil Total Heating Rate,hourly;

  Output:Variable,*,Space 2 VAV Reheat Coil Total Heating Rate,hourly;

  Output:Variable,*,Space 3 VAV Reheat Coil Total Heating Rate,hourly;

  Output:Variable,*,Space 4 VAV Reheat Coil Total Heating Rate,hourly;

  Output:Variable,*,Space 5 VAV Reheat Coil Total Heating Rate,hourly;

  Output:Variable,*,OA CW Coil Total Cooling Rate,hourly;

  Output:Variable,*,Main CW Coil Total Cooling Rate,hourly;

  Output:Variable,*,Main HW Coil Total Heating Rate,hourly;

  Output:Variable,*,Chiller Electricity Consumption,hourly;

  Output:VariableDictionary,Regular;

  Output:Meter:MeterFileOnly,Electricity:Facility,monthly;

  Output:Meter:MeterFileOnly,Electricity:Building,monthly;

  Output:Meter:MeterFileOnly,InteriorLights:Electricity,monthly;

  Output:Meter:MeterFileOnly,Electricity:HVAC,monthly;

  Output:Meter:MeterFileOnly,Electricity:Plant,monthly;

  Output:Meter:MeterFileOnly,Gas:Facility,monthly;

  Output:Meter:MeterFileOnly,Gas:Plant,monthly;

  Output:Meter:MeterFileOnly,Electricity:Facility,runperiod;

  Output:Meter:MeterFileOnly,Electricity:Building,runperiod;

  Output:Meter:MeterFileOnly,InteriorLights:Electricity,runperiod;

  Output:Meter:MeterFileOnly,Electricity:HVAC,runperiod;

  Output:Meter:MeterFileOnly,Electricity:Plant,runperiod;

  Output:Meter:MeterFileOnly,Gas:Facility,runperiod;

  Output:Meter:MeterFileOnly,Gas:Plant,runperiod;

  Output:Meter:MeterFileOnly,MyGeneralLights,monthly;

  Output:Meter:MeterFileOnly,MyGeneralLights,runperiod;

  Output:Meter:MeterFileOnly,MyBuildingElectric,monthly;

  Output:Meter:MeterFileOnly,MyBuildingElectric,runperiod;

  Output:Meter:MeterFileOnly,MyBuildingOther,monthly;

  Output:Meter:MeterFileOnly,MyBuildingOther,runperiod;

! The following custom meters are set up to illustrate the capabilities
! of custom meters.
! Custom Meter "MyGeneralLights" duplicates the InteriorLights:Electricity meter.
! Custom Meter "MyBuildingElectric" duplicates the Electricity:Building meter (by specifying that meter).
! Custom Meter (Decrement) "MyBuildingOther" uses Electricity:Building as its source meter
!   and subtracts out the values for MyGeneralLights (aka InteriorLights:Electricity).  The
!   resultant value for MyBuildingOther should be equal to the value for the meters
!   Electricity:Building - InteriorLights:Electricity (aka MyGeneralLights)

  Meter:Custom,
    MyGeneralLights,         !- Name
    Electricity,             !- Fuel Type
    SPACE1-1 Lights 1,       !- Key Name 1
    Lights Electric Energy,  !- Output Variable or Meter Name 1
    SPACE2-1 Lights 1,       !- Key Name 2
    Lights Electric Energy,  !- Output Variable or Meter Name 2
    SPACE3-1 Lights 1,       !- Key Name 3
    Lights Electric Energy,  !- Output Variable or Meter Name 3
    SPACE4-1 Lights 1,       !- Key Name 4
    Lights Electric Energy,  !- Output Variable or Meter Name 4
    SPACE5-1 Lights 1,       !- Key Name 5
    Lights Electric Energy;  !- Output Variable or Meter Name 5

  Meter:Custom,
    MyBuildingElectric,      !- Name
    Electricity,             !- Fuel Type
    ,                        !- Key Name 1
    Electricity:Building;    !- Output Variable or Meter Name 1

  Meter:CustomDecrement,
    MyBuildingOther,         !- Name
    Electricity,             !- Fuel Type
    Electricity:Building,    !- Source Meter Name
    ,                        !- Key Name 1
    MyGeneralLights;         !- Output Variable or Meter Name 1

  Output:Surfaces:Drawing,VRML;

  OutputControl:Table:Style,
    HTML;                    !- Column Separator

  Output:Table:SummaryReports,
    AllSummary;              !- Report 1 Name

  Output:Surfaces:List,Details;

  EnergyManagementSystem:Sensor,
    ATU_Avail_Sched,         !- Name
    ReheatCoilAvailSched,    !- Output:Variable or Output:Meter Index Key Name
    Schedule Value;          !- Output:Variable or Output:Meter Name

  Output:EnergyManagementSystem,
    Verbose,                 !- Actuator Availability Dictionary Reporting
    Verbose,                 !- Internal Variable Availability Dictionary Reporting
    ErrorsOnly;              !- EMS Runtime Language Debug Output Level

  EnergyManagementSystem:GlobalVariable,
    DeckAir_Tinlet,          !- Erl Variable 1 Name
    DeckAir_Winlet,          !- Erl Variable 2 Name
    Air_MdotOut,             !- Erl Variable 3 Name
    Air_MdotIn,              !- <none>
    TUAir_Tout,              !- <none>
    TUAir_Wout,              !- <none>
    DamperMin,               !- <none>
    Qdot_Req_toCoolSP,       !- <none>
    Qdot_Req_toHeatSP,       !- <none>
    AirSupMdotDesign,        !- <none>
    DamperPosition,          !- <none>
    HWCoil_Mdot_Max,         !- <none>
    HWCoil_Eff,              !- <none>
    HWCoil_Mdot,             !- <none>
    HWCoil_MdotRequest,      !- <none>
    HWCoil_heat_Power,       !- <none>
    HW_Tin,                  !- <none>
    HW_Cp,                   !- <none>
    HW_Tout,                 !- <none>
    HW_MdotRequest,          !- <none>
    Zone_T,                  !- <none>
    Zone_W,                  !- <none>
    Space1ATU_DesignAirMdot, !- <none>
    Space2ATU_DesignAirMdot, !- <none>
    Space3ATU_DesignAirMdot, !- <none>
    Space4ATU_DesignAirMdot, !- <none>
    Space5ATU_DesignAirMdot, !- <none>
    Zone_Tsp_Cool,           !- <none>
    Zone_Tsp_Heat,           !- <none>
    tot_heat_Power;          !- <none>

  EnergyManagementSystem:InternalVariable,
    Space1ATU_HeatAirMdot,   !- Name
    SPACE1-1,                !- Internal Data Index Key Name
    Final Zone Design Heating Air Mass Flow Rate;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space1ATU_CoolAirMdot,   !- Name
    SPACE1-1,                !- Internal Data Index Key Name
    Final Zone Design Cooling Air Mass Flow Rate;  !- Internal Data Type

  EnergyManagementSystem:Actuator,
    Space1ATU_PrimAir_Tout,  !- Name
    SPACE1-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space1ATU_PrimAir_Wout,  !- Name
    SPACE1-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Humidity Ratio;   !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space1ATU_PrimAir_MdotOut,  !- Name
    SPACE1-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Mass Flow Rate;   !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space1ATU_PrimAir_MdotIn,!- Name
    SPACE1-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Inlet Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space1ATU_HW_Tout,       !- Name
    SPACE1-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space1ATU_HW_MdotRequest,!- Name
    SPACE1-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Mass Flow Rate;          !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space1ATU_HW_MdotMin,    !- Name
    SPACE1-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Minimum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space1ATU_HW_MdotMax,    !- Name
    SPACE1-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Maximum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space1ATU_HW_DesignVdot, !- Name
    SPACE1-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Design Volume Flow Rate; !- Actuated Component Control Type

  EnergyManagementSystem:InternalVariable,
    Space1ATU_PrimAir_Tinlet,!- Name
    SPACE1-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Temperature for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space1ATU_PrimAir_Winlet,!- Name
    SPACE1-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Humidity Ratio for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space1ATU_PrimAir_rho,   !- Name
    SPACE1-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Density for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space1ATU_PrimAir_cp,    !- Name
    SPACE1-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Specific Heat for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space1ATU_Qdot_ToHeatSP, !- Name
    SPACE1-1 VAV REHEAT,     !- Internal Data Index Key Name
    Remaining Sensible Load to Heating Setpoint;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space1ATU_Qdot_ToCoolSP, !- Name
    SPACE1-1 VAV REHEAT,     !- Internal Data Index Key Name
    Remaining Sensible Load to Cooling Setpoint;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space1ATU_HW_Tin,        !- Name
    SPACE1-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Temperature for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space1ATU_HW_MdotIn,     !- Name
    SPACE1-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Mass Flow Rate for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space1ATU_HW_rho,        !- Name
    SPACE1-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Density for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space1ATU_HW_cp,         !- Name
    SPACE1-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Specific Heat for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:Sensor,
    Space1_Tdb,              !- Name
    SPACE1-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Air Temperature;    !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space1_W,                !- Name
    SPACE1-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Air Humidity Ratio; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space1_Tsp_cool,         !- Name
    SPACE1-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Thermostat Cooling Setpoint Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space1_Tsp_heat,         !- Name
    SPACE1-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Thermostat Heating Setpoint Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:OutputVariable,
    Space 1 VAV Reheat Coil Total Heating Rate,  !- Name
    Space1ATU_tot_heat_Power,!- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimestep,          !- Update Frequency
    Space1ATU_ModelOutput,   !- EMS Program or Subroutine Name
    W;                       !- Units

  EnergyManagementSystem:ProgramCallingManager,
    Space1 ATU Init Programs,!- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    InitSpace1ATU;           !- Program Name 1

  EnergyManagementSystem:Program,
    InitSpace1ATU,           !- Name
    Set Space1ATU_DesignAirMdot = @MAX Space1ATU_HeatAirMdot Space1ATU_CoolAirMdot,  !- Program Line 1
    Set HWLoopExitTemp = 82.0,  !- Program Line 2
    Set HWLoopDeltaTemp = 11.0,  !- <none>
    Set HW_CP = @CPCW HWLoopExitTemp,  !- <none>
    Set HW_rho = @RhoH2O HWLoopExitTemp,  !- <none>
    Set HeatCentralSAT = 16.7,  !- <none>
    Set HeatZoneSAT    = 50.0,  !- <none>
    Set AvgSAT = (HeatCentralSAT + HeatZoneSAT) / 2,  !- <none>
    Set HeatingZoneW      = 0.004,  !- <none>
    Set HeatingAir_CP     = @CpAirFnW HeatingZoneW,  !- <none>
    Set HWCoil_DesLoad = (HeatingAir_CP * Space1ATU_DesignAirMdot) * (HeatZoneSAT - HeatCentralSAT),  !- <none>
    Set Space1ATU_HW_DesignVdot = HWCoil_DesLoad / (( HW_rho * HW_CP) * HWLoopDeltaTemp),  !- <none>
    Set Space1ATU_HW_MdotMin = 0.0,  !- <none>
    Set Space1ATU_HW_MdotMax = Space1ATU_HW_DesignVdot * HW_rho;  !- <none>

  EnergyManagementSystem:ProgramCallingManager,
    Space1 ATU Sim Programs, !- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    Space1ATU_ModelInput,    !- Program Name 1
    ATU_Sim_Model,           !- Program Name 2
    Space1ATU_ModelOutput;   !- Program Name 3

  EnergyManagementSystem:Program,
    Space1ATU_ModelInput,    !- Name
    Set DeckAir_Tinlet    = Space1ATU_PrimAir_Tinlet,  !- Program Line 1
    Set DeckAir_Winlet    = Space1ATU_PrimAir_Winlet,  !- Program Line 2
    Set Zone_T            = Space1_Tdb,  !- <none>
    Set Zone_W            = Space1_W,  !- <none>
    Set Zone_Tsp_Cool     = Space1_Tsp_cool,  !- <none>
    Set Zone_Tsp_Heat     = Space1_Tsp_heat,  !- <none>
    Set AirSupMdotDesign  = Space1ATU_DesignAirMdot,  !- <none>
    Set DamperMin         = 0.3,  !- <none>
    Set Qdot_Req_toCoolSP = Space1ATU_Qdot_ToCoolSP,  !- <none>
    Set Qdot_Req_toHeatSP = Space1ATU_Qdot_ToHeatSP,  !- <none>
    Set HWCoil_Mdot_Max   = Space1ATU_HW_MdotMax,  !- <none>
    Set HW_Tin            = Space1ATU_HW_Tin,  !- <none>
    Set HW_Cp             = Space1ATU_HW_cp,  !- <none>
    Set HWCoil_Eff        = 0.7,  !- <none>
    Set HWCoil_Mdot       = Space1ATU_HW_MdotIn;  !- <none>

  EnergyManagementSystem:Program,
    Space1ATU_ModelOutput,   !- Name
    Set Space1ATU_PrimAir_Tout = Air_Tout,  !- Program Line 1
    Set Space1ATU_PrimAir_Wout = Air_Wout,  !- Program Line 2
    Set Space1ATU_PrimAir_MdotOut = Air_MdotOut,  !- <none>
    Set Space1ATU_PrimAir_MdotIn = Air_MdotOut,  !- <none>
    Set Space1ATU_tot_heat_Power = HWCoil_heat_Power,  !- <none>
    SEt Space1ATU_HW_MdotRequest = HW_MdotRequest,  !- <none>
    Set Space1ATU_HW_Tout = HW_Tout;  !- <none>

  EnergyManagementSystem:InternalVariable,
    Space2ATU_HeatAirMdot,   !- Name
    SPACE2-1,                !- Internal Data Index Key Name
    Final Zone Design Heating Air Mass Flow Rate;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space2ATU_CoolAirMdot,   !- Name
    SPACE2-1,                !- Internal Data Index Key Name
    Final Zone Design Cooling Air Mass Flow Rate;  !- Internal Data Type

  EnergyManagementSystem:Actuator,
    Space2ATU_PrimAir_Tout,  !- Name
    SPACE2-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space2ATU_PrimAir_Wout,  !- Name
    SPACE2-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Humidity Ratio;   !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space2ATU_PrimAir_MdotOut,  !- Name
    SPACE2-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Mass Flow Rate;   !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space2ATU_PrimAir_MdotIn,!- Name
    SPACE2-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Inlet Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space2ATU_HW_Tout,       !- Name
    SPACE2-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space2ATU_HW_MdotRequest,!- Name
    SPACE2-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Mass Flow Rate;          !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space2ATU_HW_MdotMin,    !- Name
    SPACE2-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Minimum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space2ATU_HW_MdotMax,    !- Name
    SPACE2-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Maximum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space2ATU_HW_DesignVdot, !- Name
    SPACE2-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Design Volume Flow Rate; !- Actuated Component Control Type

  EnergyManagementSystem:InternalVariable,
    Space2ATU_PrimAir_Tinlet,!- Name
    SPACE2-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Temperature for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space2ATU_PrimAir_Winlet,!- Name
    SPACE2-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Humidity Ratio for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space2ATU_PrimAir_rho,   !- Name
    SPACE2-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Density for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space2ATU_PrimAir_cp,    !- Name
    SPACE2-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Specific Heat for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space2ATU_Qdot_ToHeatSP, !- Name
    SPACE2-1 VAV REHEAT,     !- Internal Data Index Key Name
    Remaining Sensible Load to Heating Setpoint;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space2ATU_Qdot_ToCoolSP, !- Name
    SPACE2-1 VAV REHEAT,     !- Internal Data Index Key Name
    Remaining Sensible Load to Cooling Setpoint;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space2ATU_HW_Tin,        !- Name
    SPACE2-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Temperature for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space2ATU_HW_MdotIn,     !- Name
    SPACE2-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Mass Flow Rate for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space2ATU_HW_rho,        !- Name
    SPACE2-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Density for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space2ATU_HW_cp,         !- Name
    SPACE2-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Specific Heat for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:Sensor,
    Space2_Tdb,              !- Name
    SPACE2-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Air Temperature;    !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space2_W,                !- Name
    SPACE2-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Air Humidity Ratio; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space2_Tsp_cool,         !- Name
    SPACE2-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Thermostat Cooling Setpoint Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space2_Tsp_heat,         !- Name
    SPACE2-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Thermostat Heating Setpoint Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:OutputVariable,
    Space 2 VAV Reheat Coil Total Heating Rate,  !- Name
    Space2ATU_tot_heat_Power,!- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimestep,          !- Update Frequency
    Space2ATU_ModelOutput,   !- EMS Program or Subroutine Name
    W;                       !- Units

  EnergyManagementSystem:ProgramCallingManager,
    Space2 ATU Init Programs,!- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    InitSpace2ATU;           !- Program Name 1

  EnergyManagementSystem:Program,
    InitSpace2ATU,           !- Name
    Set Space2ATU_DesignAirMdot = @MAX Space2ATU_HeatAirMdot Space2ATU_CoolAirMdot,  !- Program Line 1
    Set HWLoopExitTemp = 82.0,  !- Program Line 2
    Set HWLoopDeltaTemp = 11.0,  !- <none>
    Set HW_CP = @CPCW HWLoopExitTemp,  !- <none>
    Set HW_rho = @RhoH2O HWLoopExitTemp,  !- <none>
    Set HeatCentralSAT = 16.7,  !- <none>
    Set HeatZoneSAT    = 50.0,  !- <none>
    Set AvgSAT = (HeatCentralSAT + HeatZoneSAT) / 2,  !- <none>
    Set HeatingZoneW      = 0.004,  !- <none>
    Set HeatingAir_CP     = @CpAirFnW HeatingZoneW,  !- <none>
    Set HWCoil_DesLoad = (HeatingAir_CP * Space2ATU_DesignAirMdot) * (HeatZoneSAT - HeatCentralSAT),  !- <none>
    Set Space2ATU_HW_DesignVdot = HWCoil_DesLoad / (( HW_rho * HW_CP) * HWLoopDeltaTemp),  !- <none>
    Set Space2ATU_HW_MdotMin = 0.0,  !- <none>
    Set Space2ATU_HW_MdotMax = Space2ATU_HW_DesignVdot * HW_rho;  !- <none>

  EnergyManagementSystem:ProgramCallingManager,
    Space2 ATU Sim Programs, !- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    Space2ATU_ModelInput,    !- Program Name 1
    ATU_Sim_Model,           !- Program Name 2
    Space2ATU_ModelOutput;   !- Program Name 3

  EnergyManagementSystem:Program,
    Space2ATU_ModelInput,    !- Name
    Set DeckAir_Tinlet    = Space2ATU_PrimAir_Tinlet,  !- Program Line 1
    Set DeckAir_Winlet    = Space2ATU_PrimAir_Winlet,  !- Program Line 2
    Set Zone_T            = Space2_Tdb,  !- <none>
    Set Zone_W            = Space2_W,  !- <none>
    Set Zone_Tsp_Cool     = Space2_Tsp_cool,  !- <none>
    Set Zone_Tsp_Heat     = Space2_Tsp_heat,  !- <none>
    Set AirSupMdotDesign  = Space2ATU_DesignAirMdot,  !- <none>
    Set DamperMin         = 0.3,  !- <none>
    Set Qdot_Req_toCoolSP = Space2ATU_Qdot_ToCoolSP,  !- <none>
    Set Qdot_Req_toHeatSP = Space2ATU_Qdot_ToHeatSP,  !- <none>
    Set HWCoil_Mdot_Max   = Space2ATU_HW_MdotMax,  !- <none>
    Set HW_Tin            = Space2ATU_HW_Tin,  !- <none>
    Set HW_Cp             = Space2ATU_HW_cp,  !- <none>
    Set HWCoil_Eff        = 0.7,  !- <none>
    Set HWCoil_Mdot       = Space2ATU_HW_MdotIn;  !- <none>

  EnergyManagementSystem:Program,
    Space2ATU_ModelOutput,   !- Name
    Set Space2ATU_PrimAir_Tout = Air_Tout,  !- Program Line 1
    Set Space2ATU_PrimAir_Wout = Air_Wout,  !- Program Line 2
    Set Space2ATU_PrimAir_MdotOut = Air_MdotOut,  !- <none>
    Set Space2ATU_PrimAir_MdotIn = Air_MdotOut,  !- <none>
    Set Space2ATU_tot_heat_Power = HWCoil_heat_Power,  !- <none>
    SEt Space2ATU_HW_MdotRequest = HW_MdotRequest,  !- <none>
    Set Space2ATU_HW_Tout = HW_Tout;  !- <none>

  EnergyManagementSystem:InternalVariable,
    Space3ATU_HeatAirMdot,   !- Name
    SPACE3-1,                !- Internal Data Index Key Name
    Final Zone Design Heating Air Mass Flow Rate;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space3ATU_CoolAirMdot,   !- Name
    SPACE3-1,                !- Internal Data Index Key Name
    Final Zone Design Cooling Air Mass Flow Rate;  !- Internal Data Type

  EnergyManagementSystem:Actuator,
    Space3ATU_PrimAir_Tout,  !- Name
    SPACE3-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space3ATU_PrimAir_Wout,  !- Name
    SPACE3-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Humidity Ratio;   !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space3ATU_PrimAir_MdotOut,  !- Name
    SPACE3-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Mass Flow Rate;   !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space3ATU_PrimAir_MdotIn,!- Name
    SPACE3-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Inlet Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space3ATU_HW_Tout,       !- Name
    SPACE3-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space3ATU_HW_MdotRequest,!- Name
    SPACE3-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Mass Flow Rate;          !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space3ATU_HW_MdotMin,    !- Name
    SPACE3-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Minimum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space3ATU_HW_MdotMax,    !- Name
    SPACE3-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Maximum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space3ATU_HW_DesignVdot, !- Name
    SPACE3-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Design Volume Flow Rate; !- Actuated Component Control Type

  EnergyManagementSystem:InternalVariable,
    Space3ATU_PrimAir_Tinlet,!- Name
    SPACE3-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Temperature for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space3ATU_PrimAir_Winlet,!- Name
    SPACE3-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Humidity Ratio for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space3ATU_PrimAir_rho,   !- Name
    SPACE3-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Density for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space3ATU_PrimAir_cp,    !- Name
    SPACE3-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Specific Heat for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space3ATU_Qdot_ToHeatSP, !- Name
    SPACE3-1 VAV REHEAT,     !- Internal Data Index Key Name
    Remaining Sensible Load to Heating Setpoint;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space3ATU_Qdot_ToCoolSP, !- Name
    SPACE3-1 VAV REHEAT,     !- Internal Data Index Key Name
    Remaining Sensible Load to Cooling Setpoint;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space3ATU_HW_Tin,        !- Name
    SPACE3-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Temperature for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space3ATU_HW_MdotIn,     !- Name
    SPACE3-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Mass Flow Rate for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space3ATU_HW_rho,        !- Name
    SPACE3-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Density for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space3ATU_HW_cp,         !- Name
    SPACE3-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Specific Heat for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:Sensor,
    Space3_Tdb,              !- Name
    SPACE3-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Air Temperature;    !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space3_W,                !- Name
    SPACE3-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Air Humidity Ratio; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space3_Tsp_cool,         !- Name
    SPACE3-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Thermostat Cooling Setpoint Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space3_Tsp_heat,         !- Name
    SPACE3-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Thermostat Heating Setpoint Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:OutputVariable,
    Space 3 VAV Reheat Coil Total Heating Rate,  !- Name
    Space3ATU_tot_heat_Power,!- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimestep,          !- Update Frequency
    Space3ATU_ModelOutput,   !- EMS Program or Subroutine Name
    W;                       !- Units

  EnergyManagementSystem:ProgramCallingManager,
    Space3 ATU Init Programs,!- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    InitSpace3ATU;           !- Program Name 1

  EnergyManagementSystem:Program,
    InitSpace3ATU,           !- Name
    Set Space3ATU_DesignAirMdot = @MAX Space3ATU_HeatAirMdot Space3ATU_CoolAirMdot,  !- Program Line 1
    Set HWLoopExitTemp = 82.0,  !- Program Line 2
    Set HWLoopDeltaTemp = 11.0,  !- <none>
    Set HW_CP = @CPCW HWLoopExitTemp,  !- <none>
    Set HW_rho = @RhoH2O HWLoopExitTemp,  !- <none>
    Set HeatCentralSAT = 16.7,  !- <none>
    Set HeatZoneSAT    = 50.0,  !- <none>
    Set AvgSAT = (HeatCentralSAT + HeatZoneSAT) / 2,  !- <none>
    Set HeatingZoneW      = 0.004,  !- <none>
    Set HeatingAir_CP     = @CpAirFnW HeatingZoneW,  !- <none>
    Set HWCoil_DesLoad = (HeatingAir_CP * Space3ATU_DesignAirMdot) * (HeatZoneSAT - HeatCentralSAT),  !- <none>
    Set Space3ATU_HW_DesignVdot = HWCoil_DesLoad / (( HW_rho * HW_CP) * HWLoopDeltaTemp),  !- <none>
    Set Space3ATU_HW_MdotMin = 0.0,  !- <none>
    Set Space3ATU_HW_MdotMax = Space3ATU_HW_DesignVdot * HW_rho;  !- <none>

  EnergyManagementSystem:ProgramCallingManager,
    Space3 ATU Sim Programs, !- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    Space3ATU_ModelInput,    !- Program Name 1
    ATU_Sim_Model,           !- Program Name 2
    Space3ATU_ModelOutput;   !- Program Name 3

  EnergyManagementSystem:Program,
    Space3ATU_ModelInput,    !- Name
    Set DeckAir_Tinlet    = Space3ATU_PrimAir_Tinlet,  !- Program Line 1
    Set DeckAir_Winlet    = Space3ATU_PrimAir_Winlet,  !- Program Line 2
    Set Zone_T            = Space3_Tdb,  !- <none>
    Set Zone_W            = Space3_W,  !- <none>
    Set Zone_Tsp_Cool     = Space3_Tsp_cool,  !- <none>
    Set Zone_Tsp_Heat     = Space3_Tsp_heat,  !- <none>
    Set AirSupMdotDesign  = Space3ATU_DesignAirMdot,  !- <none>
    Set DamperMin         = 0.3,  !- <none>
    Set Qdot_Req_toCoolSP = Space3ATU_Qdot_ToCoolSP,  !- <none>
    Set Qdot_Req_toHeatSP = Space3ATU_Qdot_ToHeatSP,  !- <none>
    Set HWCoil_Mdot_Max   = Space3ATU_HW_MdotMax,  !- <none>
    Set HW_Tin            = Space3ATU_HW_Tin,  !- <none>
    Set HW_Cp             = Space3ATU_HW_cp,  !- <none>
    Set HWCoil_Eff        = 0.7,  !- <none>
    Set HWCoil_Mdot       = Space3ATU_HW_MdotIn;  !- <none>

  EnergyManagementSystem:Program,
    Space3ATU_ModelOutput,   !- Name
    Set Space3ATU_PrimAir_Tout = Air_Tout,  !- Program Line 1
    Set Space3ATU_PrimAir_Wout = Air_Wout,  !- Program Line 2
    Set Space3ATU_PrimAir_MdotOut = Air_MdotOut,  !- <none>
    Set Space3ATU_PrimAir_MdotIn = Air_MdotOut,  !- <none>
    Set Space3ATU_tot_heat_Power = HWCoil_heat_Power,  !- <none>
    SEt Space3ATU_HW_MdotRequest = HW_MdotRequest,  !- <none>
    Set Space3ATU_HW_Tout = HW_Tout;  !- <none>

  EnergyManagementSystem:InternalVariable,
    Space4ATU_HeatAirMdot,   !- Name
    SPACE4-1,                !- Internal Data Index Key Name
    Final Zone Design Heating Air Mass Flow Rate;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space4ATU_CoolAirMdot,   !- Name
    SPACE4-1,                !- Internal Data Index Key Name
    Final Zone Design Cooling Air Mass Flow Rate;  !- Internal Data Type

  EnergyManagementSystem:Actuator,
    Space4ATU_PrimAir_Tout,  !- Name
    SPACE4-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space4ATU_PrimAir_Wout,  !- Name
    SPACE4-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Humidity Ratio;   !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space4ATU_PrimAir_MdotOut,  !- Name
    SPACE4-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Mass Flow Rate;   !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space4ATU_PrimAir_MdotIn,!- Name
    SPACE4-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Inlet Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space4ATU_HW_Tout,       !- Name
    SPACE4-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space4ATU_HW_MdotRequest,!- Name
    SPACE4-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Mass Flow Rate;          !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space4ATU_HW_MdotMin,    !- Name
    SPACE4-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Minimum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space4ATU_HW_MdotMax,    !- Name
    SPACE4-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Maximum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space4ATU_HW_DesignVdot, !- Name
    SPACE4-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Design Volume Flow Rate; !- Actuated Component Control Type

  EnergyManagementSystem:InternalVariable,
    Space4ATU_PrimAir_Tinlet,!- Name
    SPACE4-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Temperature for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space4ATU_PrimAir_Winlet,!- Name
    SPACE4-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Humidity Ratio for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space4ATU_PrimAir_rho,   !- Name
    SPACE4-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Density for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space4ATU_PrimAir_cp,    !- Name
    SPACE4-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Specific Heat for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space4ATU_Qdot_ToHeatSP, !- Name
    SPACE4-1 VAV REHEAT,     !- Internal Data Index Key Name
    Remaining Sensible Load to Heating Setpoint;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space4ATU_Qdot_ToCoolSP, !- Name
    SPACE4-1 VAV REHEAT,     !- Internal Data Index Key Name
    Remaining Sensible Load to Cooling Setpoint;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space4ATU_HW_Tin,        !- Name
    SPACE4-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Temperature for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space4ATU_HW_MdotIn,     !- Name
    SPACE4-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Mass Flow Rate for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space4ATU_HW_rho,        !- Name
    SPACE4-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Density for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space4ATU_HW_cp,         !- Name
    SPACE4-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Specific Heat for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:Sensor,
    Space4_Tdb,              !- Name
    SPACE4-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Air Temperature;    !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space4_W,                !- Name
    SPACE4-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Air Humidity Ratio; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space4_Tsp_cool,         !- Name
    SPACE4-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Thermostat Cooling Setpoint Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space4_Tsp_heat,         !- Name
    SPACE4-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Thermostat Heating Setpoint Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:OutputVariable,
    Space 4 VAV Reheat Coil Total Heating Rate,  !- Name
    Space4ATU_tot_heat_Power,!- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimestep,          !- Update Frequency
    Space4ATU_ModelOutput,   !- EMS Program or Subroutine Name
    W;                       !- Units

  EnergyManagementSystem:ProgramCallingManager,
    Space4 ATU Init Programs,!- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    InitSpace4ATU;           !- Program Name 1

  EnergyManagementSystem:Program,
    InitSpace4ATU,           !- Name
    Set Space4ATU_DesignAirMdot = @MAX Space4ATU_HeatAirMdot Space4ATU_CoolAirMdot,  !- Program Line 1
    Set HWLoopExitTemp = 82.0,  !- Program Line 2
    Set HWLoopDeltaTemp = 11.0,  !- <none>
    Set HW_CP = @CPCW HWLoopExitTemp,  !- <none>
    Set HW_rho = @RhoH2O HWLoopExitTemp,  !- <none>
    Set HeatCentralSAT = 16.7,  !- <none>
    Set HeatZoneSAT    = 50.0,  !- <none>
    Set AvgSAT = (HeatCentralSAT + HeatZoneSAT) / 2,  !- <none>
    Set HeatingZoneW      = 0.004,  !- <none>
    Set HeatingAir_CP     = @CpAirFnW HeatingZoneW,  !- <none>
    Set HWCoil_DesLoad = (HeatingAir_CP * Space4ATU_DesignAirMdot) * (HeatZoneSAT - HeatCentralSAT),  !- <none>
    Set Space4ATU_HW_DesignVdot = HWCoil_DesLoad / (( HW_rho * HW_CP) * HWLoopDeltaTemp),  !- <none>
    Set Space4ATU_HW_MdotMin = 0.0,  !- <none>
    Set Space4ATU_HW_MdotMax = Space4ATU_HW_DesignVdot * HW_rho;  !- <none>

  EnergyManagementSystem:ProgramCallingManager,
    Space4 ATU Sim Programs, !- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    Space4ATU_ModelInput,    !- Program Name 1
    ATU_Sim_Model,           !- Program Name 2
    Space4ATU_ModelOutput;   !- Program Name 3

  EnergyManagementSystem:Program,
    Space4ATU_ModelInput,    !- Name
    Set DeckAir_Tinlet    = Space4ATU_PrimAir_Tinlet,  !- Program Line 1
    Set DeckAir_Winlet    = Space4ATU_PrimAir_Winlet,  !- Program Line 2
    Set Zone_T            = Space4_Tdb,  !- <none>
    Set Zone_W            = Space4_W,  !- <none>
    Set Zone_Tsp_Cool     = Space4_Tsp_cool,  !- <none>
    Set Zone_Tsp_Heat     = Space4_Tsp_heat,  !- <none>
    Set AirSupMdotDesign  = Space4ATU_DesignAirMdot,  !- <none>
    Set DamperMin         = 0.3,  !- <none>
    Set Qdot_Req_toCoolSP = Space4ATU_Qdot_ToCoolSP,  !- <none>
    Set Qdot_Req_toHeatSP = Space4ATU_Qdot_ToHeatSP,  !- <none>
    Set HWCoil_Mdot_Max   = Space4ATU_HW_MdotMax,  !- <none>
    Set HW_Tin            = Space4ATU_HW_Tin,  !- <none>
    Set HW_Cp             = Space4ATU_HW_cp,  !- <none>
    Set HWCoil_Eff        = 0.7,  !- <none>
    Set HWCoil_Mdot       = Space4ATU_HW_MdotIn;  !- <none>

  EnergyManagementSystem:Program,
    Space4ATU_ModelOutput,   !- Name
    Set Space4ATU_PrimAir_Tout = Air_Tout,  !- Program Line 1
    Set Space4ATU_PrimAir_Wout = Air_Wout,  !- Program Line 2
    Set Space4ATU_PrimAir_MdotOut = Air_MdotOut,  !- <none>
    Set Space4ATU_PrimAir_MdotIn = Air_MdotOut,  !- <none>
    Set Space4ATU_tot_heat_Power = HWCoil_heat_Power,  !- <none>
    SEt Space4ATU_HW_MdotRequest = HW_MdotRequest,  !- <none>
    Set Space4ATU_HW_Tout = HW_Tout;  !- <none>

  EnergyManagementSystem:InternalVariable,
    Space5ATU_HeatAirMdot,   !- Name
    SPACE5-1,                !- Internal Data Index Key Name
    Final Zone Design Heating Air Mass Flow Rate;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space5ATU_CoolAirMdot,   !- Name
    SPACE5-1,                !- Internal Data Index Key Name
    Final Zone Design Cooling Air Mass Flow Rate;  !- Internal Data Type

  EnergyManagementSystem:Actuator,
    Space5ATU_PrimAir_Tout,  !- Name
    SPACE5-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space5ATU_PrimAir_Wout,  !- Name
    SPACE5-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Humidity Ratio;   !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space5ATU_PrimAir_MdotOut,  !- Name
    SPACE5-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Outlet Mass Flow Rate;   !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space5ATU_PrimAir_MdotIn,!- Name
    SPACE5-1 VAV Reheat,     !- Actuated Component Unique Name
    Primary Air Connection,  !- Actuated Component Type
    Inlet Mass Flow Rate;    !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space5ATU_HW_Tout,       !- Name
    SPACE5-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Outlet Temperature;      !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space5ATU_HW_MdotRequest,!- Name
    SPACE5-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Mass Flow Rate;          !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space5ATU_HW_MdotMin,    !- Name
    SPACE5-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Minimum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space5ATU_HW_MdotMax,    !- Name
    SPACE5-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Maximum Mass Flow Rate;  !- Actuated Component Control Type

  EnergyManagementSystem:Actuator,
    Space5ATU_HW_DesignVdot, !- Name
    SPACE5-1 VAV REHEAT,     !- Actuated Component Unique Name
    Plant Connection 1,      !- Actuated Component Type
    Design Volume Flow Rate; !- Actuated Component Control Type

  EnergyManagementSystem:InternalVariable,
    Space5ATU_PrimAir_Tinlet,!- Name
    SPACE5-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Temperature for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space5ATU_PrimAir_Winlet,!- Name
    SPACE5-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Humidity Ratio for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space5ATU_PrimAir_rho,   !- Name
    SPACE5-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Density for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space5ATU_PrimAir_cp,    !- Name
    SPACE5-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Specific Heat for Primary Air Connection;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space5ATU_Qdot_ToHeatSP, !- Name
    SPACE5-1 VAV REHEAT,     !- Internal Data Index Key Name
    Remaining Sensible Load to Heating Setpoint;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space5ATU_Qdot_ToCoolSP, !- Name
    SPACE5-1 VAV REHEAT,     !- Internal Data Index Key Name
    Remaining Sensible Load to Cooling Setpoint;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space5ATU_HW_Tin,        !- Name
    SPACE5-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Temperature for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space5ATU_HW_MdotIn,     !- Name
    SPACE5-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Mass Flow Rate for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space5ATU_HW_rho,        !- Name
    SPACE5-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Density for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:InternalVariable,
    Space5ATU_HW_cp,         !- Name
    SPACE5-1 VAV REHEAT,     !- Internal Data Index Key Name
    Inlet Specific Heat for Plant Connection 1;  !- Internal Data Type

  EnergyManagementSystem:Sensor,
    Space5_Tdb,              !- Name
    SPACE5-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Air Temperature;    !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space5_W,                !- Name
    SPACE5-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Air Humidity Ratio; !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space5_Tsp_cool,         !- Name
    SPACE5-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Thermostat Cooling Setpoint Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:Sensor,
    Space5_Tsp_heat,         !- Name
    SPACE5-1,                !- Output:Variable or Output:Meter Index Key Name
    Zone Thermostat Heating Setpoint Temperature;  !- Output:Variable or Output:Meter Name

  EnergyManagementSystem:OutputVariable,
    Space 5 VAV Reheat Coil Total Heating Rate,  !- Name
    Space5ATU_tot_heat_Power,!- EMS Variable Name
    Averaged,                !- Type of Data in Variable
    SystemTimestep,          !- Update Frequency
    Space5ATU_ModelOutput,   !- EMS Program or Subroutine Name
    W;                       !- Units

  EnergyManagementSystem:ProgramCallingManager,
    Space5 ATU Init Programs,!- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    InitSpace5ATU;           !- Program Name 1

  EnergyManagementSystem:Program,
    InitSpace5ATU,           !- Name
    Set Space5ATU_DesignAirMdot = @MAX Space5ATU_HeatAirMdot Space5ATU_CoolAirMdot,  !- Program Line 1
    Set HWLoopExitTemp = 82.0,  !- Program Line 2
    Set HWLoopDeltaTemp = 11.0,  !- <none>
    Set HW_CP = @CPCW HWLoopExitTemp,  !- <none>
    Set HW_rho = @RhoH2O HWLoopExitTemp,  !- <none>
    Set HeatCentralSAT = 16.7,  !- <none>
    Set HeatZoneSAT    = 50.0,  !- <none>
    Set AvgSAT = (HeatCentralSAT + HeatZoneSAT) / 2,  !- <none>
    Set HeatingZoneW      = 0.004,  !- <none>
    Set HeatingAir_CP     = @CpAirFnW HeatingZoneW,  !- <none>
    Set HWCoil_DesLoad = (HeatingAir_CP * Space4ATU_DesignAirMdot) * (HeatZoneSAT - HeatCentralSAT),  !- <none>
    Set Space5ATU_HW_DesignVdot = HWCoil_DesLoad / (( HW_rho * HW_CP) * HWLoopDeltaTemp),  !- <none>
    Set Space5ATU_HW_MdotMin = 0.0,  !- <none>
    Set Space5ATU_HW_MdotMax = Space5ATU_HW_DesignVdot * HW_rho;  !- <none>

  EnergyManagementSystem:ProgramCallingManager,
    Space5 ATU Sim Programs, !- Name
    UserDefinedComponentModel,  !- EnergyPlus Model Calling Point
    Space5ATU_ModelInput,    !- Program Name 1
    ATU_Sim_Model,           !- Program Name 2
    Space5ATU_ModelOutput;   !- Program Name 3

  EnergyManagementSystem:Program,
    Space5ATU_ModelInput,    !- Name
    Set DeckAir_Tinlet    = Space5ATU_PrimAir_Tinlet,  !- Program Line 1
    Set DeckAir_Winlet    = Space5ATU_PrimAir_Winlet,  !- Program Line 2
    Set Zone_T            = Space5_Tdb,  !- <none>
    Set Zone_W            = Space5_W,  !- <none>
    Set Zone_Tsp_Cool     = Space5_Tsp_cool,  !- <none>
    Set Zone_Tsp_Heat     = Space5_Tsp_heat,  !- <none>
    Set AirSupMdotDesign  = Space5ATU_DesignAirMdot,  !- <none>
    Set DamperMin         = 0.3,  !- <none>
    Set Qdot_Req_toCoolSP = Space5ATU_Qdot_ToCoolSP,  !- <none>
    Set Qdot_Req_toHeatSP = Space5ATU_Qdot_ToHeatSP,  !- <none>
    Set HWCoil_Mdot_Max   = Space5ATU_HW_MdotMax,  !- <none>
    Set HW_Tin            = Space5ATU_HW_Tin,  !- <none>
    Set HW_Cp             = Space5ATU_HW_cp,  !- <none>
    Set HWCoil_Eff        = 0.7,  !- <none>
    Set HWCoil_Mdot       = Space5ATU_HW_MdotIn;  !- <none>

  EnergyManagementSystem:Program,
    Space5ATU_ModelOutput,   !- Name
    Set Space5ATU_PrimAir_Tout = Air_Tout,  !- Program Line 1
    Set Space5ATU_PrimAir_Wout = Air_Wout,  !- Program Line 2
    Set Space5ATU_PrimAir_MdotOut = Air_MdotOut,  !- <none>
    Set Space5ATU_PrimAir_MdotIn = Air_MdotOut,  !- <none>
    Set Space5ATU_tot_heat_Power = HWCoil_heat_Power,  !- <none>
    SEt Space5ATU_HW_MdotRequest = HW_MdotRequest,  !- <none>
    Set Space5ATU_HW_Tout = HW_Tout;  !- <none>

!end terminal
  !
      !- call hot water coil model
      !unload HW coil model results
    ! run at full damper open (for good zone air mixing) and
      !- call hot water coil model
      !unload HW coil model results
      !unload HW coil model results

  EnergyManagementSystem:Program,
    ATU_Sim_Model,           !- Name
    IF (ATU_Avail_Sched == 0.0),  !- Program Line 1
    Set Air_MdotOut     = 0.0,  !- Program Line 2
    Set HW_MdotRequest  = 0.0,  !- <none>
    Set HW_Tout    = HW_Tin, !- <none>
    Set HWCoil_heat_Power    = 0.0,  !- <none>
    Set Air_Tout             = DeckAir_Tinlet,  !- <none>
    Set Air_Wout             = DeckAir_Winlet,  !- <none>
    Set DamperPosition = DamperMin,  !- <none>
    RETURN,                  !- <none>
    ENDIF,                   !- <none>
    Set Zone_H = @HFnTdbW Zone_T Zone_W,  !- <none>
    Set Zone_H_AtCoolSp = @HFnTdbW Zone_Tsp_Cool Zone_W,  !- <none>
    Set Zone_H_AtHeatSp = @HFnTdbW Zone_Tsp_Heat Zone_W,  !- <none>
    Set SupAir_H = @HFnTdbW DeckAir_Tinlet DeckAir_Winlet,  !- <none>
    IF Qdot_Req_toCoolSP < (0 - 10.0),  !- <none>
    Set ABS_Qdot_Cool = @ABS Qdot_Req_toCoolSP,  !- <none>
    Set Air_Mdot = ABS_Qdot_Cool / (Zone_H_AtCoolSp - SupAir_H),  !- <none>
    Set Air_Mdot = @MIN AirSupMdotDesign Air_Mdot,  !- <none>
    Set DamperPosition = Air_Mdot / AirSupMdotDesign,  !- <none>
    IF DamperPosition < DamperMin,  !- <none>
    Set Air_Mdot = DamperMin * AirSupMdotDesign,  !- <none>
    Set HoutDesired = Zone_H_AtHeatSp - ABS_Qdot_Cool/Air_Mdot,  !- <none>
    Set Air_Tsp = @TdbFnHW HoutDesired DeckAir_Winlet,  !- <none>
    Set Water_Mdot    = HWCoil_Mdot,  !- <none>
    Set Air_Tinlet    = DeckAir_Tinlet,  !- <none>
    Set Air_Winlet    = DeckAir_Winlet,  !- <none>
    Set Water_Tinlet  = HW_Tin,  !- <none>
    Set Coil_Eff      = HWCoil_Eff,  !- <none>
    Set Water_Mdot_Max = HWCoil_Mdot_Max,  !- <none>
    Set Water_cp       = HW_Cp,  !- <none>
    RUN HW_Coil_Sim_Model,   !- <none>
    Set HW_MdotRequest      = Water_MdotRequest,  !- <none>
    Set Air_Tout            = Air_Tout,  !- <none>
    Set Air_Wout            = Air_Wout,  !- <none>
    Set HWCoil_heat_Power   = Tot_heat_Power,  !- <none>
    Set HW_Tout   = Water_Tout,  !- <none>
    ELSE,                    !- <none>
    Set HW_MdotRequest       = 0.0,  !- <none>
    Set Air_Tout             = DeckAir_Tinlet,  !- <none>
    Set Air_Wout             = DeckAir_Winlet,  !- <none>
    Set HWCoil_heat_Power    = 0.0,  !- <none>
    Set HW_Tout    = HW_Tin, !- <none>
    Set Air_MdotOut = Air_Mdot,  !- <none>
    ENDIF,                   !- <none>
    ELSEIF Qdot_Req_toHeatSP > 10.0,  !- <none>
    Set DamperPosition = 1.0,!- <none>
    Set Air_Mdot = AirSupMdotDesign,  !- <none>
    Set ABS_Qdot_heat = @ABS Qdot_Req_toHeatSP,  !- <none>
    Set HoutDesired   = Zone_H_AtHeatSp + ABS_Qdot_Heat/Air_Mdot,  !- <none>
    Set Air_Tsp = @TdbFnHW HoutDesired DeckAir_Winlet,  !- <none>
    Set Water_Mdot    = HWCoil_Mdot,  !- <none>
    Set Air_Tinlet    = DeckAir_Tinlet,  !- <none>
    Set Air_Winlet    = DeckAir_Winlet,  !- <none>
    Set Water_Tinlet  = HW_Tin,  !- <none>
    Set Coil_Eff      = HWCoil_Eff,  !- <none>
    Set Water_Mdot_Max = HWCoil_Mdot_Max,  !- <none>
    Set Water_cp       = HW_Cp,  !- <none>
    RUN HW_Coil_Sim_Model,   !- <none>
    Set HW_MdotRequest      = Water_MdotRequest,  !- <none>
    Set Air_Tout            = Air_Tout,  !- <none>
    Set Air_Wout            = Air_Wout,  !- <none>
    Set HWCoil_heat_Power   = Tot_heat_Power,  !- <none>
    Set HW_Tout   = Water_Tout,  !- <none>
    ELSE,                    !- <none>
    Set DamperPosition = DamperMin,  !- <none>
    Set Air_Mdot = DamperPosition * AirSupMdotDesign,  !- <none>
    Set HoutDesired   = Zone_H_AtHeatSp,  !- <none>
    Set Air_Tsp = @TdbFnHW HoutDesired DeckAir_Winlet,  !- <none>
    Set Air_Tinlet    = DeckAir_Tinlet,  !- <none>
    Set Air_Winlet    = DeckAir_Winlet,  !- <none>
    Set Water_Tinlet  = HW_Tin,  !- <none>
    Set Coil_Eff      = HWCoil_Eff,  !- <none>
    Set Water_Mdot_Max = HWCoil_Mdot_Max,  !- <none>
    Set Water_cp       = HW_Cp,  !- <none>
    RUN HW_Coil_Sim_Model,   !- <none>
    Set HW_MdotRequest      = Water_MdotRequest,  !- <none>
    Set Air_Tout            = Air_Tout,  !- <none>
    Set Air_Wout            = Air_Wout,  !- <none>
    Set HWCoil_heat_Power   = Tot_heat_Power,  !- <none>
    Set HW_Tout   = Water_Tout,  !- <none>
    ENDIF,                   !- <none>
    Set Air_MdotOut = Air_Mdot;  !- <none>

  EnergyManagementSystem:Program,
    HW_Coil_Sim_Model,       !- Name
    IF Air_Mdot == 0.0,      !- Program Line 1
    SET Air_Tout = Air_Tinlet,  !- Program Line 2
    SET Air_Wout = Air_Winlet,  !- <none>
    Set Air_MdotOut = Air_Mdot,  !- <none>
    Set tot_heat_Power = 0.0,!- <none>
    Set Water_Tout = Water_Tinlet,  !- <none>
    Set Water_MdotRequest = 0.0,  !- <none>
    RETURN,                  !- <none>
    ENDIF,                   !- <none>
    IF Air_Tinlet > Air_Tsp, !- <none>
    SET Air_Tout          = Air_Tinlet,  !- <none>
    SET Air_Wout          = Air_Winlet,  !- <none>
    Set Air_MdotOut       = Air_Mdot,  !- <none>
    Set tot_heat_Power    = 0.0,  !- <none>
    Set Water_Tout        = Water_Tinlet,  !- <none>
    Set Water_MdotRequest = 0.0,  !- <none>
    RETURN,                  !- <none>
    ENDIF,                   !- <none>
    Set AirIn_Enth     = @HFnTdbW Air_Tinlet Air_Winlet,  !- <none>
    Set AirOut_Enth_Limit = @HFnTdbW Water_Tinlet Air_Winlet,  !- <none>
    Set MaxQdot      = Coil_Eff * Air_Mdot * (AirOut_Enth_Limit - AirIn_Enth ),  !- <none>
    IF MaxQdot <= 0.0,       !- <none>
    SET Air_Tout          = Air_Tinlet,  !- <none>
    SET Air_Wout          = Air_Winlet,  !- <none>
    Set Air_MdotOut       = Air_Mdot,  !- <none>
    Set tot_heat_Power    = 0.0,  !- <none>
    Set Water_Tout        = Water_Tinlet,  !- <none>
    Set Water_MdotRequest = 0.0,  !- <none>
    RETURN,                  !- <none>
    ENDIF,                   !- <none>
    Set Air_Wout = Air_Winlet,  !- <none>
    Set Air_HoutSP = @HFnTdbW Air_Tsp Air_Wout,  !- <none>
    Set Qdot_SP    = Air_Mdot * (Air_HoutSP - AirIn_Enth ),  !- <none>
    IF Qdot_SP > MaxQdot,    !- <none>
    Set Air_Hout = AirIn_Enth + (MaxQdot/Air_Mdot),  !- <none>
    ELSE,                    !- <none>
    Set Air_Hout = Air_HoutSP,  !- <none>
    ENDIF,                   !- <none>
    Set Air_Tout = @TdbFnHW Air_Hout Air_Wout,  !- <none>
    Set ActualQdot  = Air_Mdot * (Air_Hout - AirIn_Enth),  !- <none>
    Set Water_partLoad = ActualQdot / MaxQdot,  !- <none>
    Set Water_MdotRequest = Water_Mdot_Max * Water_PartLoad,  !- <none>
    Set HW_tempFall = ActualQdot/(Water_MdotRequest * Water_cp),  !- <none>
    Set Water_Tout = Water_Tinlet - HW_tempFall,  !- <none>
    Set tot_heat_Power = ActualQdot;  !- <none>

